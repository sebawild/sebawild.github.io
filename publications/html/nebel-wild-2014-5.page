<div id="pf5" class="pf w0 h0" data-page-no="5"><div class="pc pc5 w0 h0"><div class="t m0 x0 hc y1 ff1 fs0 fc0 sc0 ls0 ws0">Pivot Sampling in Dual-Pivot Quicksort<span class="_ _17"> </span><span class="ff2">5</span></div><div class="t m0 x0 hc y27 ff2 fs0 fc0 sc0 ls0 ws0">The<span class="_ _2"> </span>follo<span class="_ _3"></span>wing<span class="_ _2"> </span>sections<span class="_ _8"> </span>are<span class="_ _2"> </span>dev<span class="_ _3"></span>oted<span class="_ _2"> </span>to<span class="_ _2"> </span>the proof<span class="_ _2"> </span>of<span class="_ _2"> </span>Theorem<span class="_ _8"> </span>4.1.<span class="_ _27"> </span>Section<span class="_ _2"> </span>5<span class="_ _2"> </span>sets up<span class="_ _2"> </span>a<span class="_ _2"> </span>recurrence<span class="_ _8"> </span>of<span class="_ _2"> </span>costs</div><div class="t m0 x0 hc y28 ff2 fs0 fc0 sc0 ls0 ws0">and<span class="_ _2"> </span>characterizes<span class="_ _2"> </span>the distribution<span class="_ _2"> </span>of<span class="_ _2"> </span>costs<span class="_ _8"> </span>of<span class="_ _2"> </span>one<span class="_ _2"> </span>partitioning<span class="_ _2"> </span>step.<span class="_ _14"> </span>The<span class="_ _2"> </span>expected<span class="_ _2"> </span>v<span class="_ _3"></span>alues<span class="_ _2"> </span>of<span class="_ _2"> </span>the<span class="_ _2"> </span>latter are</div><div class="t m0 x0 hc y29 ff2 fs0 fc0 sc0 ls0 ws0">computed<span class="_ _2"> </span>in<span class="_ _2"> </span>Section<span class="_ _2"> </span>6.<span class="_ _b"> </span>Finally<span class="_ _3"></span>,<span class="_ _2"> </span>Section<span class="_ _2"> </span>7<span class="_ _2"> </span>provides<span class="_ _2"> </span>a<span class="_ _2"> </span>generic<span class="_ _2"> </span>solution<span class="_ _2"> </span>to<span class="_ _2"> </span>the<span class="_ _2"> </span>recurrence<span class="_ _2"> </span>of<span class="_ _2"> </span>the<span class="_ _2"> </span>expected</div><div class="t m0 x0 hc y2a ff2 fs0 fc0 sc0 ls0 ws0">costs; in combination with the expected partitioning costs, this concludes our proof.</div><div class="t m0 x0 h4 yd9 ff9 fs2 fc0 sc0 ls0 ws0">5<span class="_ _10"> </span>Distributional Analysis</div><div class="t m0 x0 h13 yda ff4 fs9 fc0 sc0 ls0 ws0">5.1<span class="_ _19"> </span>Recurrence Equations of Costs</div><div class="t m0 x0 h6 ydb ff2 fs0 fc0 sc0 ls0 ws0">Let<span class="_ _2"> </span>us<span class="_ _2"> </span>denote<span class="_ _c"> </span>by<span class="_ _2"> </span><span class="ff6">C</span></div><div class="t m0 xe0 hf ydc fff fs6 fc0 sc0 ls0 ws0">n</div><div class="t m0 xe1 h6 ydb ff2 fs0 fc0 sc0 ls0 ws0">the<span class="_ _2"> </span><span class="ff1">costs<span class="_ _2"> </span></span>of<span class="_ _c"> </span><span class="ff6">Y</span></div><div class="t m0 xe2 hf ydd fff fs6 fc0 sc0 ls0 ws0">w</div><div class="t m0 x1b h19 yde ff15 fs6 fc0 sc0 ls0 ws0">t</div><div class="t m0 x44 h6 ydb ff2 fs0 fc0 sc0 ls0 ws0">on<span class="_ _2"> </span>a<span class="_ _2"> </span>random<span class="_ _c"> </span>permutation<span class="_ _2"> </span>of<span class="_ _2"> </span>size<span class="_ _c"> </span><span class="ff6">n<span class="_ _9"> </span></span>—<span class="_ _a"> </span>where<span class="_ _c"> </span>dif<span class="_ _3"></span>ferent<span class="_ _c"> </span>“cost<span class="_ _2"> </span>mea-</div><div class="t m0 x0 h6 ydf ff2 fs0 fc0 sc0 ls0 ws0">sures”,<span class="_ _c"> </span>like<span class="_ _c"> </span>the<span class="_ _c"> </span>number<span class="_ _c"> </span>of<span class="_ _c"> </span>comparisons,<span class="_ _c"> </span>will<span class="_ _c"> </span>take<span class="_ _c"> </span>the<span class="_ _c"> </span>place<span class="_ _c"> </span>of<span class="_ _c"> </span><span class="ff6">C</span></div><div class="t m0 xe3 hf ye0 fff fs6 fc0 sc0 ls0 ws0">n</div><div class="t m0 xe4 h6 ydf ff2 fs0 fc0 sc0 ls0 ws0">later<span class="_ _0"></span>.<span class="_ _e"> </span><span class="ff6">C</span></div><div class="t m0 xe5 hf ye0 fff fs6 fc0 sc0 ls0 ws0">n</div><div class="t m0 xe6 hc ydf ff2 fs0 fc0 sc0 ls0 ws0">is<span class="_ _c"> </span>a<span class="_ _c"> </span>non-negati<span class="_ _3"></span>ve<span class="_ _2"> </span><span class="ff1">random</span></div><div class="t m0 x0 h6 ye1 ff2 fs0 fc0 sc0 ls0 ws0">variable whose<span class="_ _2"> </span>distrib<span class="_ _3"></span>ution<span class="_ _2"> </span>depends<span class="_ _8"> </span>on<span class="_ _2"> </span><span class="ff6">n</span>.<span class="_ _14"> </span>The<span class="_ _8"> </span>total<span class="_ _2"> </span>costs<span class="_ _8"> </span>decompose<span class="_ _2"> </span>into<span class="_ _2"> </span>those for<span class="_ _2"> </span>the ﬁrst<span class="_ _2"> </span>partitioning</div><div class="t m0 x0 hc ye2 ff2 fs0 fc0 sc0 ls0 ws0">step plus<span class="_ _8"> </span>the<span class="_ _8"> </span>costs<span class="_ _2"> </span>for recursi<span class="_ _3"></span>vely solving<span class="_ _8"> </span>subproblems.<span class="_ _f"> </span>As Y<span class="_ _0"></span>aroslavskiy’<span class="_ _0"></span>s partitioning<span class="_ _8"> </span>method<span class="_ _2"> </span>preserv<span class="_ _3"></span>es</div><div class="t m0 x0 h6 ye3 ff2 fs0 fc0 sc0 ls0 ws0">randomness<span class="_ _2"> </span>(see<span class="_ _2"> </span>Appendix<span class="_ _c"> </span>B),<span class="_ _c"> </span>we<span class="_ _2"> </span>can<span class="_ _2"> </span>express<span class="_ _2"> </span>the<span class="_ _c"> </span>total<span class="_ _2"> </span>costs<span class="_ _2"> </span><span class="ff6">C</span></div><div class="t m0 x8f hf ye4 fff fs6 fc0 sc0 ls0 ws0">n</div><div class="t m0 xe7 hc ye3 ff2 fs0 fc0 sc0 ls0 ws0">recursiv<span class="_ _3"></span>ely<span class="_ _2"> </span>in<span class="_ _c"> </span>terms<span class="_ _2"> </span>of<span class="_ _c"> </span>the<span class="_ _2"> </span>same<span class="_ _2"> </span>cost</div><div class="t m0 x0 h6 ye5 ff2 fs0 fc0 sc0 ls0 ws0">function<span class="_ _2"> </span>with<span class="_ _c"> </span>smaller<span class="_ _c"> </span>arguments:<span class="_ _27"> </span>for<span class="_ _c"> </span>sizes<span class="_ _c"> </span><span class="ff6">J</span></div><div class="t m0 xe8 hf ye6 ffb fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 xe9 h6 ye5 ff2 fs0 fc0 sc0 ls0 ws0">,<span class="_ _c"> </span><span class="ff6">J</span></div><div class="t m0 x8 hf ye6 ffb fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 xb5 h6 ye5 ff2 fs0 fc0 sc0 ls0 ws0">and<span class="_ _2"> </span><span class="ff6">J</span></div><div class="t m0 xea hf ye6 ffb fs6 fc0 sc0 ls0 ws0">3</div><div class="t m0 xeb hc ye5 ff2 fs0 fc0 sc0 ls0 ws0">of<span class="_ _2"> </span>the<span class="_ _c"> </span>three<span class="_ _c"> </span>subproblems,<span class="_ _c"> </span>the<span class="_ _c"> </span>costs<span class="_ _2"> </span>of<span class="_ _c"> </span>corre-</div><div class="t m0 x0 h6 ye7 ff2 fs0 fc0 sc0 ls0 ws0">sponding<span class="_ _c"> </span>recursive<span class="_ _c"> </span>calls<span class="_ _c"> </span>are<span class="_ _c"> </span>distributed<span class="_ _c"> </span>like<span class="_ _f"> </span><span class="ff6">C</span></div><div class="t m0 xec hf ye8 fff fs6 fc0 sc0 ls0 ws0">J</div><div class="t m0 x55 h15 ye9 ff13 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x56 h6 ye7 ff2 fs0 fc0 sc0 ls0 ws0">,<span class="_ _f"> </span><span class="ff6">C</span></div><div class="t m0 xa hf ye8 fff fs6 fc0 sc0 ls0 ws0">J</div><div class="t m0 xb h15 ye9 ff13 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xc h6 ye7 ff2 fs0 fc0 sc0 ls0 ws0">and<span class="_ _c"> </span><span class="ff6">C</span></div><div class="t m0 x72 hf ye8 fff fs6 fc0 sc0 ls0 ws0">J</div><div class="t m0 x8e h15 ye9 ff13 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m0 xce h6 ye7 ff2 fs0 fc0 sc0 ls0 ws0">,<span class="_ _f"> </span>and<span class="_ _f"> </span>conditioned<span class="_ _c"> </span>on<span class="_ _f"> </span><span class="ffd">J<span class="_ _b"> </span><span class="ff5">=<span class="_ _12"> </span>(<span class="ff6">J</span></span></span></div><div class="t m0 xed hf ye8 ffb fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 xee h6 ye7 ff6 fs0 fc0 sc0 ls0 ws0">,<span class="_ _9"> </span>J</div><div class="t m0 xef hf ye8 ffb fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 x93 h6 ye7 ff6 fs0 fc0 sc0 ls0 ws0">,<span class="_ _9"> </span>J</div><div class="t m0 xf0 hf ye8 ffb fs6 fc0 sc0 ls0 ws0">3</div><div class="t m0 xf1 h6 ye7 ff5 fs0 fc0 sc0 ls0 ws0">)<span class="ff2">,</span></div><div class="t m0 x0 hc yea ff2 fs0 fc0 sc0 ls0 ws0">these<span class="_ _2"> </span>random<span class="_ _c"> </span>variables<span class="_ _2"> </span>are<span class="_ _2"> </span>independent.<span class="_ _1b"> </span>Note,<span class="_ _2"> </span>howe<span class="_ _d"></span>ver<span class="_ _3"></span>,<span class="_ _c"> </span>that<span class="_ _2"> </span>the<span class="_ _c"> </span>subproblem<span class="_ _2"> </span>sizes<span class="_ _c"> </span>are<span class="_ _2"> </span>themselves<span class="_ _2"> </span>ran-</div><div class="t m0 x0 h6 yeb ff2 fs0 fc0 sc0 ls0 ws0">dom and<span class="_ _8"> </span>inter-dependent.<span class="_ _c"> </span>Denoting by<span class="_ _8"> </span><span class="ff6">T</span></div><div class="t m0 xf2 hf yec fff fs6 fc0 sc0 ls0 ws0">n</div><div class="t m0 xcd hc yeb ff2 fs0 fc0 sc0 ls0 ws0">the costs<span class="_ _8"> </span>of<span class="_ _8"> </span>the<span class="_ _8"> </span>ﬁrst<span class="_ _2"> </span>partitioning step, we obtain<span class="_ _2"> </span>the follo<span class="_ _3"></span>wing</div><div class="t m0 x0 h6 yed ff1 fs0 fc0 sc0 ls0 ws0">distributional r<span class="_ _0"></span>ecurrence <span class="ff2">for the family <span class="ff5">(<span class="ff6">C</span></span></span></div><div class="t m0 xc0 hf yee fff fs6 fc0 sc0 ls0 ws0">n</div><div class="t m0 xf3 h6 yed ff5 fs0 fc0 sc0 ls0 ws0">)</div><div class="t m0 xf4 hf yee fff fs6 fc0 sc0 ls0 ws0">n<span class="ff17">∈<span class="ff1a">N</span></span></div><div class="t m0 x56 hc yed ff2 fs0 fc0 sc0 ls0 ws0">of random variables:</div><div class="t m0 xf5 h6 yef ff6 fs0 fc0 sc0 ls0 ws0">C</div><div class="t m0 x2 hf yf0 fff fs6 fc0 sc0 ls0 ws0">n</div><div class="t m0 x9c hf yf1 ff17 fs6 fc0 sc0 ls0 ws0">D</div><div class="t m0 xf6 h6 yef ff5 fs0 fc0 sc0 ls0 ws0">=</div><div class="t m0 xf7 h16 yf2 ff14 fs0 fc0 sc0 ls0 ws0">(</div><div class="t m0 x85 h6 yf3 ff6 fs0 fc0 sc0 ls0 ws0">T</div><div class="t m0 xf8 hf yf4 fff fs6 fc0 sc0 ls0 ws0">n</div><div class="t m0 x1c h6 yf3 ff5 fs0 fc0 sc0 ls0 ws0">+<span class="_ _12"> </span><span class="ff6">C</span></div><div class="t m0 xec hf yf4 fff fs6 fc0 sc0 ls0 ws0">J</div><div class="t m0 xd8 h15 yf5 ff13 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x9f h6 yf3 ff5 fs0 fc0 sc0 ls0 ws0">+<span class="_ _11"> </span><span class="ff6">C</span></div><div class="t m0 xf9 hf yf6 ff17 fs6 fc0 sc0 ls0 ws0">0</div><div class="t m0 x98 hf yf7 fff fs6 fc0 sc0 ls0 ws0">J</div><div class="t m0 xfa h15 yf8 ff13 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xd h6 yf3 ff5 fs0 fc0 sc0 ls0 ws0">+<span class="_ _11"> </span><span class="ff6">C</span></div><div class="t m0 xa0 hf yf6 ff17 fs6 fc0 sc0 ls0 ws0">00</div><div class="t m0 x1f hf yf7 fff fs6 fc0 sc0 ls0 ws0">J</div><div class="t m0 x72 h15 yf8 ff13 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m0 x8e h6 yf3 ff6 fs0 fc0 sc0 ls0 ws0">,<span class="_ _16"> </span><span class="ff2">for </span>n<span class="_ _2"> </span>&gt;<span class="_ _8"> </span>w<span class="ff5">;</span></div><div class="t m0 x85 h6 yf9 ff6 fs0 fc0 sc0 ls0 ws0">W</div><div class="t m0 x70 hf yfa fff fs6 fc0 sc0 ls0 ws0">n</div><div class="t m0 x71 h6 yf9 ff6 fs0 fc0 sc0 ls0 ws0">,<span class="_ _28"> </span><span class="ff2">for </span>n<span class="_ _8"> </span><span class="ffc">≤<span class="_ _2"> </span></span>w.</div><div class="t m0 xfb hc yef ff2 fs0 fc0 sc0 ls0 ws0">(5.1)</div><div class="t m0 x0 h6 yfb ff2 fs0 fc0 sc0 ls0 ws0">Here<span class="_ _c"> </span><span class="ff6">W</span></div><div class="t m0 xbc hf yfc fff fs6 fc0 sc0 ls0 ws0">n</div><div class="t m0 x6 h6 yfb ff2 fs0 fc0 sc0 ls0 ws0">denotes<span class="_ _c"> </span>the<span class="_ _c"> </span>cost<span class="_ _c"> </span>of<span class="_ _f"> </span>Insertionsort<span class="_ _21"></span>ing<span class="_ _f"> </span>a<span class="_ _c"> </span>random<span class="_ _c"> </span>permutation<span class="_ _c"> </span>of<span class="_ _f"> </span>size<span class="_ _c"> </span><span class="ff6">n</span>.<span class="_ _29"> </span><span class="ff5">(<span class="ff6">C</span></span></div><div class="t m0 x17 hf yfd ff17 fs6 fc0 sc0 ls0 ws0">0</div><div class="t m0 xfc hf yfe fff fs6 fc0 sc0 ls0 ws0">j</div><div class="t m0 x33 h6 yfb ff5 fs0 fc0 sc0 ls0 ws0">)</div><div class="t m0 xfd hf yfc fff fs6 fc0 sc0 ls0 ws0">j<span class="_ _21"></span><span class="ff17">∈<span class="ff1a">N</span></span></div><div class="t m0 x18 h6 yfb ff2 fs0 fc0 sc0 ls0 ws0">and<span class="_ _c"> </span><span class="ff5">(<span class="ff6">C</span></span></div><div class="t m0 xfe hf yfd ff17 fs6 fc0 sc0 ls0 ws0">00</div><div class="t m0 xff hf yfe fff fs6 fc0 sc0 ls0 ws0">j</div><div class="t m0 x100 h6 yfb ff5 fs0 fc0 sc0 ls0 ws0">)</div><div class="t m0 x101 hf yfc fff fs6 fc0 sc0 ls0 ws0">j<span class="_ _21"></span><span class="ff17">∈<span class="ff1a">N</span></span></div><div class="t m0 x0 h6 yff ff2 fs0 fc0 sc0 ls0 ws0">are independent<span class="_ _2"> </span>copies of<span class="_ _8"> </span><span class="ff5">(<span class="ff6">C</span></span></div><div class="t m0 x102 hf y100 fff fs6 fc0 sc0 ls0 ws0">j</div><div class="t m0 x103 h6 yff ff5 fs0 fc0 sc0 ls0 ws0">)</div><div class="t m0 x104 hf y100 fff fs6 fc0 sc0 ls0 ws0">j<span class="_ _21"></span><span class="ff17">∈<span class="ff1a">N</span></span></div><div class="t m0 xbe h6 yff ff2 fs0 fc0 sc0 ls0 ws0">,<span class="_ _8"> </span><span class="ff1">i.<span class="_ _4"></span>e.</span>,<span class="_ _8"> </span>for<span class="_ _2"> </span>all <span class="ff6">j<span class="_ _6"></span></span>,<span class="_ _2"> </span>the variables <span class="ff6">C</span></div><div class="t m0 x8f hf y100 fff fs6 fc0 sc0 ls0 ws0">j</div><div class="t m0 xe3 h6 yff ff2 fs0 fc0 sc0 ls0 ws0">,<span class="_ _8"> </span><span class="ff6">C</span></div><div class="t m0 x105 hf y101 ff17 fs6 fc0 sc0 ls0 ws0">0</div><div class="t m0 xad hf y102 fff fs6 fc0 sc0 ls0 ws0">j</div><div class="t m0 x106 h6 yff ff2 fs0 fc0 sc0 ls0 ws0">and <span class="ff6">C</span></div><div class="t m0 x2a hf y101 ff17 fs6 fc0 sc0 ls0 ws0">00</div><div class="t m0 x107 hf y102 fff fs6 fc0 sc0 ls0 ws0">j</div><div class="t m0 x3b hc yff ff2 fs0 fc0 sc0 ls0 ws0">are identically<span class="_ _2"> </span>distrib<span class="_ _3"></span>uted</div><div class="t m0 x0 h6 y103 ff2 fs0 fc0 sc0 ls0 ws0">and<span class="_ _2"> </span>for<span class="_ _2"> </span>all<span class="_ _2"> </span><span class="ffd">j<span class="_ _2"> </span><span class="ffc">∈<span class="_ _8"> </span><span class="ff10">N</span></span></span></div><div class="t m0 xd2 hf y104 ffb fs6 fc0 sc0 ls0 ws0">3</div><div class="t m0 x9a h6 y103 ff2 fs0 fc0 sc0 ls0 ws0">,<span class="_ _2"> </span><span class="ff6">C</span></div><div class="t m0 x81 hf y105 fff fs6 fc0 sc0 ls0 ws0">j</div><div class="t m0 x62 h15 y106 ff13 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x108 h6 y103 ff2 fs0 fc0 sc0 ls0 ws0">,<span class="_ _2"> </span><span class="ff6">C</span></div><div class="t m0 xf5 hf y104 ff17 fs6 fc0 sc0 ls0 ws0">0</div><div class="t m0 x109 hf y107 fff fs6 fc0 sc0 ls0 ws0">j</div><div class="t m0 x10a h15 y108 ff13 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x10b h6 y103 ff2 fs0 fc0 sc0 ls0 ws0">and<span class="_ _2"> </span><span class="ff6">C</span></div><div class="t m0 x1b hf y104 ff17 fs6 fc0 sc0 ls0 ws0">00</div><div class="t m0 x1b hf y107 fff fs6 fc0 sc0 ls0 ws0">j</div><div class="t m0 xe2 h15 y108 ff13 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m0 x85 h6 y103 ff2 fs0 fc0 sc0 ls0 ws0">are<span class="_ _2"> </span>totally<span class="_ _2"> </span>independent,<span class="_ _c"> </span>and<span class="_ _2"> </span>they<span class="_ _2"> </span>are<span class="_ _2"> </span>also<span class="_ _2"> </span>independent<span class="_ _2"> </span>of<span class="_ _2"> </span><span class="ff6">T</span></div><div class="t m0 x10c hf y105 fff fs6 fc0 sc0 ls0 ws0">n</div><div class="t m0 x93 hc y103 ff2 fs0 fc0 sc0 ls0 ws0">.<span class="_ _12"> </span>W<span class="_ _0"></span>e</div><div class="t m0 x0 h6 y109 ff2 fs0 fc0 sc0 ls0 ws0">call<span class="_ _c"> </span><span class="ff6">T</span></div><div class="t m0 x10d hf y10a fff fs6 fc0 sc0 ls0 ws0">n</div><div class="t m0 xbc hc y109 ff2 fs0 fc0 sc0 ls0 ws0">the<span class="_ _c"> </span><span class="ff1">toll<span class="_ _f"> </span>function<span class="_ _c"> </span></span>of<span class="_ _f"> </span>the<span class="_ _c"> </span>recurrence,<span class="_ _f"> </span>as<span class="_ _f"> </span>it<span class="_ _c"> </span>quantiﬁes<span class="_ _f"> </span>the<span class="_ _c"> </span>“toll”<span class="_ _f"> </span>we<span class="_ _c"> </span>have<span class="_ _c"> </span>to<span class="_ _c"> </span>pay<span class="_ _f"> </span>for<span class="_ _c"> </span>unfolding<span class="_ _f"> </span>the</div><div class="t m0 x0 hc y10b ff2 fs0 fc0 sc0 ls0 ws0">recurrence once.<span class="_ _f"> </span>Different cost<span class="_ _2"> </span>measures only<span class="_ _8"> </span>differ in<span class="_ _8"> </span>the<span class="_ _2"> </span>toll functions,<span class="_ _8"> </span>such<span class="_ _2"> </span>that we<span class="_ _8"> </span>can<span class="_ _2"> </span>treat them all</div><div class="t m0 x0 hc y10c ff2 fs0 fc0 sc0 ls0 ws0">in a<span class="_ _2"> </span>uniform fashion by<span class="_ _8"> </span>studying<span class="_ _2"> </span>(5.1).<span class="_ _c"> </span>T<span class="_ _0"></span>aking expectations<span class="_ _8"> </span>on<span class="_ _2"> </span>both sides, we<span class="_ _2"> </span>ﬁnd a recurrence<span class="_ _2"> </span>equation</div><div class="t m0 x0 h6 y10d ff2 fs0 fc0 sc0 ls0 ws0">for the <span class="ff1">expected </span>costs <span class="ff10">E<span class="ff5">[<span class="ff6">C</span></span></span></div><div class="t m0 x41 hf y10e fff fs6 fc0 sc0 ls0 ws0">n</div><div class="t m0 x57 h6 y10d ff5 fs0 fc0 sc0 ls0 ws0">]<span class="ff2">:</span></div><div class="t m0 x99 h6 y10f ff10 fs0 fc0 sc0 ls0 ws0">E<span class="ff5">[<span class="ff6">C</span></span></div><div class="t m0 x10e hf y110 fff fs6 fc0 sc0 ls0 ws0">n</div><div class="t m0 x61 h6 y10f ff5 fs0 fc0 sc0 ls0 ws0">]<span class="_ _23"> </span>=</div><div class="t m0 x10f h16 y111 ff14 fs0 fc0 sc0 ls0 ws0"></div><div class="t m0 x10f h16 y112 ff14 fs0 fc0 sc0 ls0 ws0"></div><div class="t m0 x10f h16 y113 ff14 fs0 fc0 sc0 ls0 ws0"></div><div class="t m0 x10f h16 y114 ff14 fs0 fc0 sc0 ls0 ws0"></div><div class="t m0 x10f h16 y115 ff14 fs0 fc0 sc0 ls0 ws0"></div><div class="t m0 x10f h16 y116 ff14 fs0 fc0 sc0 ls0 ws0"></div><div class="t m0 x10f h16 y117 ff14 fs0 fc0 sc0 ls0 ws0"></div><div class="t m0 x41 h6 y118 ff10 fs0 fc0 sc0 ls0 ws0">E<span class="ff5">[<span class="ff6">T</span></span></div><div class="t m0 x66 hf y119 fff fs6 fc0 sc0 ls0 ws0">n</div><div class="t m0 x110 h6 y118 ff5 fs0 fc0 sc0 ls0 ws0">]<span class="_ _12"> </span>+</div><div class="t m0 x68 h16 y11a ff14 fs0 fc0 sc0 ls0 ws0">X</div><div class="t m0 x111 hf y11b ff15 fs6 fc0 sc0 ls0 ws0">j<span class="ffb">=(<span class="fff">j</span></span></div><div class="t m0 x112 h15 y11c ff13 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x85 hf y11b fff fs6 fc0 sc0 ls0 ws0">,j</div><div class="t m0 xf8 h15 y11c ff13 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x70 hf y11b fff fs6 fc0 sc0 ls0 ws0">,j</div><div class="t m0 x71 h15 y11c ff13 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m0 xcd hf y11b ffb fs6 fc0 sc0 ls0 ws0">)</div><div class="t m0 x110 hf y11d fff fs6 fc0 sc0 ls0 ws0">j</div><div class="t m0 x9c h15 y11e ff13 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x111 hf y11d ffb fs6 fc0 sc0 ls0 ws0">+<span class="fff">j</span></div><div class="t m0 x113 h15 y11e ff13 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x68 hf y11d ffb fs6 fc0 sc0 ls0 ws0">+<span class="fff">j</span></div><div class="t m0 x52 h15 y11e ff13 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m0 x88 hf y11d ffb fs6 fc0 sc0 ls0 ws0">=<span class="fff">n<span class="ff17">−</span></span>2</div><div class="t m0 x70 h6 y118 ff10 fs0 fc0 sc0 ls0 ws0">P<span class="ff5">(<span class="ffd">J<span class="_ _8"> </span></span>= <span class="ffd">j</span>)</span></div><div class="t m0 x9f h16 y11f ff14 fs0 fc0 sc0 ls0 ws0"></div><div class="t m0 x6c h6 y118 ff10 fs0 fc0 sc0 ls0 ws0">E<span class="ff5">[<span class="ff6">C</span></span></div><div class="t m0 x39 hf y119 fff fs6 fc0 sc0 ls0 ws0">j</div><div class="t m0 xc h15 y120 ff13 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xd h6 y118 ff5 fs0 fc0 sc0 ls0 ws0">]<span class="_ _11"> </span>+<span class="_ _11"> </span><span class="ff10">E</span>[<span class="ff6">C</span></div><div class="t m0 x8f hf y119 fff fs6 fc0 sc0 ls0 ws0">j</div><div class="t m0 x10 h15 y120 ff13 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x46 h6 y118 ff5 fs0 fc0 sc0 ls0 ws0">]<span class="_ _11"> </span>+<span class="_ _11"> </span><span class="ff10">E</span>[<span class="ff6">C</span></div><div class="t m0 x22 hf y119 fff fs6 fc0 sc0 ls0 ws0">j</div><div class="t m0 x3a h15 y120 ff13 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m0 xe5 h6 y118 ff5 fs0 fc0 sc0 ls0 ws0">]</div><div class="t m0 x2a h16 y11f ff14 fs0 fc0 sc0 ls0 ws0"></div><div class="t m0 x2b h6 y118 ff6 fs0 fc0 sc0 ls0 ws0">,<span class="_ _16"> </span><span class="ff2">for </span>n<span class="_ _2"> </span>&gt;<span class="_ _8"> </span>w<span class="ff5">;</span></div><div class="t m0 x41 h6 y121 ff10 fs0 fc0 sc0 ls0 ws0">E<span class="ff5">[<span class="ff6">W</span></span></div><div class="t m0 x104 hf y122 fff fs6 fc0 sc0 ls0 ws0">n</div><div class="t m0 x9c h6 y121 ff5 fs0 fc0 sc0 ls0 ws0">]<span class="ff6">,<span class="_ _2a"> </span><span class="ff2">for </span>n<span class="_ _8"> </span><span class="ffc">≤<span class="_ _2"> </span></span>w.</span></div><div class="t m0 xfb hc y10f ff2 fs0 fc0 sc0 ls0 ws0">(5.2)</div><div class="t m0 x0 h6 y123 ff2 fs0 fc0 sc0 ls0 ws0">A simple combinatorial<span class="_ _2"> </span>ar<span class="_ _3"></span>gument gives access to <span class="ff10">P<span class="ff5">(<span class="ffd">J<span class="_ _2"> </span></span>=<span class="_ _2"> </span><span class="ffd">j</span>)</span></span>, the probability<span class="_ _2"> </span>of <span class="ffd">J<span class="_ _2"> </span><span class="ff5">= </span>j</span>:<span class="_ _2"> </span>of<span class="_ _8"> </span>the</div><div class="t m0 x114 h16 y124 ff14 fs0 fc0 sc0 ls0 ws0"></div><div class="t m0 xa3 hf y125 fff fs6 fc0 sc0 ls0 ws0">n</div><div class="t m0 xa3 hf y126 fff fs6 fc0 sc0 ls0 ws0">k</div><div class="t m0 x115 h16 y124 ff14 fs0 fc0 sc0 ls0 ws0"></div><div class="t m0 x116 hc y123 ff2 fs0 fc0 sc0 ls0 ws0">different</div><div class="t m0 x0 h6 y127 ff2 fs0 fc0 sc0 ls0 ws0">size<span class="_ _2"> </span><span class="ff6">k<span class="_ _2"> </span></span>samples<span class="_ _2"> </span>of<span class="_ _2"> </span><span class="ff6">n<span class="_ _8"> </span></span>elements,<span class="_ _2"> </span>those<span class="_ _2"> </span>contribute<span class="_ _2"> </span>to<span class="_ _8"> </span>the<span class="_ _2"> </span>probability<span class="_ _2"> </span>of<span class="_ _2"> </span><span class="ffc">{<span class="ffd">J<span class="_ _c"> </span><span class="ff5">=<span class="_ _f"> </span></span>j</span>}</span>,<span class="_ _2"> </span>in<span class="_ _2"> </span>which<span class="_ _2"> </span>e<span class="_ _3"></span>xactly<span class="_ _2"> </span><span class="ff6">t</span></div><div class="t m0 xdf hf y128 ffb fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 xfe hc y127 ff2 fs0 fc0 sc0 ls0 ws0">of<span class="_ _2"> </span>the</div><div class="t m0 x0 h6 y129 ff2 fs0 fc0 sc0 ls0 ws0">sample<span class="_ _11"> </span>elements<span class="_ _11"> </span>are<span class="_ _a"> </span>chosen from<span class="_ _a"> </span>the<span class="_ _11"> </span>ov<span class="_ _3"></span>erall <span class="ff6">j</span></div><div class="t m0 x53 hf y12a ffb fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x38 h6 y129 ff2 fs0 fc0 sc0 ls0 ws0">small<span class="_ _11"> </span>elements;<span class="_ _11"> </span>and<span class="_ _11"> </span>like<span class="_ _3"></span>wise<span class="_ _11"> </span><span class="ff6">t</span></div><div class="t m0 xe5 hf y12a ffb fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 x117 h6 y129 ff2 fs0 fc0 sc0 ls0 ws0">of<span class="_ _11"> </span>the<span class="_ _11"> </span><span class="ff6">j</span></div><div class="t m0 x118 hf y12a ffb fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 x34 hc y129 ff2 fs0 fc0 sc0 ls0 ws0">medium<span class="_ _11"> </span>elements</div><div class="t m0 x0 h6 y12b ff2 fs0 fc0 sc0 ls0 ws0">and <span class="ff6">t</span></div><div class="t m0 x24 hf y12c ffb fs6 fc0 sc0 ls0 ws0">3</div><div class="t m0 x119 h6 y12b ff2 fs0 fc0 sc0 ls0 ws0">of the <span class="ff6">j</span></div><div class="t m0 x11a hf y12c ffb fs6 fc0 sc0 ls0 ws0">3</div><div class="t m0 x10e hc y12b ff2 fs0 fc0 sc0 ls0 ws0">large ones are contained in the sample.<span class="_ _2"> </span>W<span class="_ _0"></span>e thus ha<span class="_ _3"></span>ve</div><div class="t m0 x110 h6 y12d ff10 fs0 fc0 sc0 ls0 ws0">P<span class="ff5">(<span class="ffd">J<span class="_ _8"> </span></span>= <span class="ffd">j</span>)<span class="_ _23"> </span>=</span></div><div class="t m0 xe9 h16 y12e ff14 fs0 fc0 sc0 ls0 ws0"></div><div class="t m0 x55 h6 y12f ff6 fs0 fc0 sc0 ls0 ws0">j</div><div class="t m0 x56 hf y130 ffb fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x55 h6 y131 ff6 fs0 fc0 sc0 ls0 ws0">t</div><div class="t m0 x56 hf y132 ffb fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x9 h16 y12e ff14 fs0 fc0 sc0 ls0 ws0"></div><div class="t m0 x98 h6 y12f ff6 fs0 fc0 sc0 ls0 ws0">j</div><div class="t m0 xfa hf y130 ffb fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 xf9 h6 y131 ff6 fs0 fc0 sc0 ls0 ws0">t</div><div class="t m0 xfa hf y132 ffb fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 x3 h16 y12e ff14 fs0 fc0 sc0 ls0 ws0"></div><div class="t m0 x11b h6 y12f ff6 fs0 fc0 sc0 ls0 ws0">j</div><div class="t m0 x1f hf y130 ffb fs6 fc0 sc0 ls0 ws0">3</div><div class="t m0 x11b h6 y131 ff6 fs0 fc0 sc0 ls0 ws0">t</div><div class="t m0 x1f hf y132 ffb fs6 fc0 sc0 ls0 ws0">3</div><div class="t m0 x72 h16 y12e ff14 fs0 fc0 sc0 ls0 ws0"></div><div class="t m0 xe4 h6 y12f ff6 fs0 fc0 sc0 ls0 ws0">n</div><div class="t m0 x11c h6 y131 ff6 fs0 fc0 sc0 ls0 ws0">k</div><div class="t m0 x29 h16 y12e ff14 fs0 fc0 sc0 ls0 ws0"></div><div class="t m0 x11d h6 y12d ff6 fs0 fc0 sc0 ls0 ws0">.<span class="_ _2b"> </span><span class="ff2">(5.3)</span></div><a class="l" href="#pf4" data-dest-detail='[4,"XYZ",81.963,332.051,null]'><div class="d m1" style="border-style:none;position:absolute;left:481.037368px;bottom:1202.680773px;width:53.326000px;height:10.904000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf5" data-dest-detail='[5,"XYZ",81.963,671.256,null]'><div class="d m1" style="border-style:none;position:absolute;left:578.783623px;bottom:1202.680773px;width:39.777000px;height:10.904000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf8" data-dest-detail='[8,"XYZ",81.963,590.759,null]'><div class="d m1" style="border-style:none;position:absolute;left:225.423165px;bottom:1162.514531px;width:39.951000px;height:10.904000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf8" data-dest-detail='[8,"XYZ",81.963,374.51,null]'><div class="d m1" style="border-style:none;position:absolute;left:357.548431px;bottom:1162.514531px;width:39.951000px;height:10.904000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",81.963,729.043,null]'><div class="d m1" style="border-style:none;position:absolute;left:253.697445px;bottom:953.851659px;width:51.142000px;height:10.957000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf5" data-dest-detail='[5,"XYZ",481.305,495.643,null]'><div class="d m1" style="border-style:none;position:absolute;left:366.527460px;bottom:651.198772px;width:14.446000px;height:10.530000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.679893,0.000000,0.000000,1.679893,0.000000,0.000000]}'></div></div>
