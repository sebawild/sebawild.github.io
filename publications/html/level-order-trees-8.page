<div id="pf8" class="pf w0 h0" data-page-no="8"><div class="pc pc8 w0 h0"><img class="bi x138 y15d w6 h1c" alt="" src="data:image/png;base64,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"/><div class="t m0 x32 h5 y2c ff1 fs3 fc0 sc0 ls0 ws0">8<span class="_ _14"> </span>Breadth-First<span class="_ _a"> </span>Rank/Select<span class="_ _e"> </span>in<span class="_ _a"> </span>T<span class="_ _6"></span>rees<span class="_ _a"> </span>and<span class="_ _e"> </span>Distance<span class="_ _a"> </span>Oracles<span class="_ _a"> </span>for<span class="_ _e"> </span>Interval<span class="_ _a"> </span>Graphs</div><div class="t m2 x33 h7 y2d ff3 fs4 fc0 sc0 ls0 ws0">bits<span class="_ _e"> </span>indicating<span class="_ _e"> </span>whether<span class="_ _e"> </span>the<span class="_ _e"> </span>low<span class="_ _2"></span>est<span class="_ _e"> </span>level<span class="_ _e"> </span>are<span class="_ _e"> </span>promoted</div><div class="t m0 xe5 h7 y2d ff4 fs4 fc0 sc0 ls0 ws0">s</div><div class="t m2 x6 h7 y2d ff3 fs4 fc0 sc0 ls0 ws0">-no<span class="_ _7"></span>des,<span class="_ _e"> </span>and<span class="_ _e"> </span>whether<span class="_ _e"> </span>the<span class="_ _e"> </span>ro<span class="_ _7"></span>ot<span class="_ _a"> </span>is<span class="_ _e"> </span>a</div><div class="t m1 x33 h7 y2e ff3 fs4 fc0 sc0 ls0 ws0">dumm<span class="_ _5"></span>y<span class="_ _4"> </span>ro<span class="_ _7"></span>ot.<span class="_ _3"> </span>W<span class="_ _6"></span>e<span class="_ _e"> </span>store<span class="_ _4"> </span>a<span class="_ _e"> </span>v<span class="_ _6"></span>ariable-cell<span class="_ _e"> </span>arra<span class="_ _5"></span>y<span class="_ _4"> </span>of<span class="_ _e"> </span>the<span class="_ _4"> </span><span class="ff7">typ<span class="_ _2"></span>es<span class="_ _a"> </span><span class="ff3">of<span class="_ _e"> </span>all<span class="_ _4"> </span>micro<span class="_ _e"> </span>trees<span class="_ _4"> </span>in</span></span></div><div class="t m0 x4e h7 y2e ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m1 x7d h7 y2e ff3 fs4 fc0 sc0 ls0 ws0">-order.<span class="_ _3"> </span>The</div><div class="t m0 x15f h9 y2e ff9 fs4 fc0 sc0 ls0 ws0">BP</div><div class="t m1 x33 h7 y2f ff3 fs4 fc0 sc0 ls0 ws0">of<span class="_ _4"> </span>all<span class="_ _4"> </span>micro<span class="_ _4"> </span>trees<span class="_ _4"> </span>will<span class="_ _4"> </span>sum<span class="_ _4"> </span>to<span class="_ _4"> </span><span class="ff6">2(</span></div><div class="t m0 x10b h7 y2f ff4 fs4 fc0 sc0 ls0 ws0">n</div><div class="t m1 x160 h7 y2f ff6 fs4 fc0 sc0 ls0 ws0">+</div><div class="t m0 x161 h7 y2f ff4 fs4 fc0 sc0 ls0 ws0">O</div><div class="t m1 xe2 h7 y2f ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x14c h7 y2f ff4 fs4 fc0 sc0 ls0 ws0">n/H</div><div class="t m0 xf8 h17 y15e ff17 fs5 fc0 sc0 ls0 ws0">0</div><div class="t m1 x162 h7 y2f ff6 fs4 fc0 sc0 ls0 ws0">) = 2</div><div class="t m0 x10d h7 y2f ff4 fs4 fc0 sc0 ls0 ws0">n</div><div class="t m1 x77 h7 y2f ff6 fs4 fc0 sc0 ls0 ws0">+</div><div class="t m0 x159 h7 y2f ff4 fs4 fc0 sc0 ls0 ws0">o</div><div class="t m1 x11a h7 y2f ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x163 h7 y2f ff4 fs4 fc0 sc0 ls0 ws0">n</div><div class="t m1 x26 h7 y2f ff6 fs4 fc0 sc0 ls0 ws0">)<span class="_ _4"> </span><span class="ff3">bits<span class="_ _4"> </span>of<span class="_ _4"> </span>space;<span class="_ _4"> </span>the<span class="_ _4"> </span>other<span class="_ _4"> </span>comp<span class="_ _7"></span>onents</span></div><div class="t m5 x33 h7 y30 ff3 fs4 fc0 sc0 ls0 ws0">of<span class="_ _4"> </span>the<span class="_ _e"> </span>t<span class="_ _2"></span>yp<span class="_ _7"></span>e<span class="_ _e"> </span>are<span class="_ _4"> </span>asymptotically<span class="_ _4"> </span>negligible.<span class="_ _3"> </span>T<span class="_ _5"></span>yp<span class="_ _7"></span>e<span class="_ _4"> </span>consists<span class="_ _e"> </span>of<span class="_ _4"> </span>at<span class="_ _4"> </span>most</div><div class="t m0 x158 h7 y30 ff5 fs4 fc0 sc0 ls0 ws0">∼</div><div class="t m0 xf1 h13 y15f ff11 fs5 fc0 sc0 ls0 ws0">1</div><div class="t m0 xf1 h13 y160 ff11 fs5 fc0 sc0 ls0 ws0">2</div><div class="t m0 x164 h7 y30 ff6 fs4 fc0 sc0 ls0 ws0">lg<span class="_ _13"> </span><span class="ff4">n</span></div><div class="t m5 x165 h7 y30 ff3 fs4 fc0 sc0 ls0 ws0">bits,<span class="_ _4"> </span>so<span class="_ _e"> </span>w<span class="_ _2"></span>e<span class="_ _e"> </span>can</div><div class="t m24 x33 h7 y31 ff3 fs4 fc0 sc0 ls0 ws0">store<span class="_ _4"> </span>a<span class="_ _4"> </span>table<span class="_ _e"> </span>of<span class="_ _4"> </span>all<span class="_ _4"> </span>p<span class="_ _7"></span>ossible<span class="_ _4"> </span>types<span class="_ _e"> </span>with<span class="_ _4"> </span>v<span class="_ _2"></span>arious<span class="_ _4"> </span>additional<span class="_ _4"> </span>precomputed<span class="_ _e"> </span>local<span class="_ _e"> </span>operations<span class="_ _e"> </span>in</div><div class="t m0 x33 h7 y32 ff4 fs4 fc0 sc0 ls0 ws0">O<span class="_ _7"></span><span class="ff6">(</span></div><div class="t m0 x138 h7 y161 ff5 fs4 fc0 sc0 ls0 ws0">√</div><div class="t m0 x11d h7 y32 ff4 fs4 fc0 sc0 ls0 ws0">n<span class="_ _13"> </span><span class="ff6">p<span class="_ _7"></span>olylog(</span>n<span class="ff6">))<span class="_ _e"> </span><span class="ff3">bits.</span></span></div><div class="t m0 x33 h6 y162 ff1 fs1 fc0 sc0 ls0 ws0">5.1<span class="_ _21"> </span>Preo<span class="_ _6"></span>r<span class="_ _7"></span>der<span class="_ _d"> </span>rank/select</div><div class="t m2 x45 h7 y163 ff3 fs4 fc0 sc0 ls0 ws0">W<span class="_ _6"></span>e<span class="_ _e"> </span>ﬁrst<span class="_ _a"> </span>consider<span class="_ _e"> </span>how<span class="_ _e"> </span>to<span class="_ _e"> </span>conv<span class="_ _2"></span>ert<span class="_ _a"> </span>b<span class="_ _7"></span>etw<span class="_ _2"></span>een<span class="_ _e"> </span>global<span class="_ _a"> </span>preorder<span class="_ _e"> </span>ranks<span class="_ _a"> </span>and</div><div class="t m0 xe7 h7 y163 ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m2 x166 h7 y163 ff3 fs4 fc0 sc0 ls0 ws0">-names.<span class="_ _15"> </span>Let<span class="_ _e"> </span>us<span class="_ _a"> </span>ﬁx</div><div class="t m2 x33 h7 y164 ff3 fs4 fc0 sc0 ls0 ws0">one<span class="_ _e"> </span>lev<span class="_ _2"></span>el<span class="_ _e"> </span>of<span class="_ _e"> </span>subtrees,<span class="_ _e"> </span>say<span class="_ _4"> </span>mini<span class="_ _e"> </span>trees. Consider<span class="_ _e"> </span>the<span class="_ _e"> </span>sequence</div><div class="t m0 x167 h7 y164 ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x107 h13 y165 ff11 fs5 fc0 sc0 ls0 ws0">1</div><div class="t m2 x168 h7 y164 ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x110 h7 y164 ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m2 x9f h7 y164 ff6 fs4 fc0 sc0 ls0 ws0">)<span class="_ _e"> </span><span class="ff3">for<span class="_ _e"> </span>all<span class="_ _4"> </span>the<span class="_ _e"> </span>no<span class="_ _7"></span>des</span></div><div class="t m0 x93 h7 y164 ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m2 xbb h7 y164 ff3 fs4 fc0 sc0 ls0 ws0">in<span class="_ _e"> </span>a</div><div class="t m1c x33 h7 y166 ff3 fs4 fc0 sc0 ls0 ws0">preorder<span class="_ _4"> </span>trav<span class="_ _2"></span>ersal.<span class="_ _3"> </span>A<span class="_ _4"> </span>no<span class="_ _7"></span>de</div><div class="t m0 x10a h7 y166 ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m1c xff h7 y166 ff3 fs4 fc0 sc0 ls0 ws0">so<span class="_ _4"> </span>that</div><div class="t m0 x14c h7 y166 ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 xda h13 y167 ff11 fs5 fc0 sc0 ls0 ws0">1</div><div class="t m1c x10c h7 y166 ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x72 h7 y166 ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m1c xa6 h7 y166 ff6 fs4 fc0 sc0 ls0 ws0">)</div><div class="t m0 xa8 h7 y166 ff5 fs4 fc0 sc0 ls0 ws0">6</div><div class="t m1c xa8 h7 y166 ff6 fs4 fc0 sc0 ls0 ws0">=</div><div class="t m0 x156 h7 y166 ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x73 h13 y167 ff11 fs5 fc0 sc0 ls0 ws0">1</div><div class="t m1c x10d h7 y166 ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x44 h7 y166 ff4 fs4 fc0 sc0 ls0 ws0">v<span class="_ _10"> </span><span class="ff5">−</span></div><div class="t m1c xf9 h7 y166 ff6 fs4 fc0 sc0 ls0 ws0">1)<span class="_ _4"> </span><span class="ff3">is<span class="_ _e"> </span>called<span class="_ _4"> </span>a<span class="_ _4"> </span><span class="ff7">(tier-1)<span class="_ _e"> </span>pr<span class="_ _2"></span>e<span class="_ _2"></span>or<span class="_ _2"></span>der<span class="_ _e"> </span>changer</span></span></div><div class="t m1b x33 h7 yed ff3 fs4 fc0 sc0 ls0 ws0">[</div><div class="t m0 x15d h7 yed ff3 fs4 fc0 sc0 ls0 ws0">18</div><div class="t m1b x138 h7 yed ff3 fs4 fc0 sc0 ls0 ws0">,<span class="_ _4"> </span>Def.<span class="_ _13"> </span>4.1].<span class="_ _3"> </span>Similarly<span class="_ _6"></span>,<span class="_ _e"> </span>nodes</div><div class="t m0 xcb h7 yed ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m1b x86 h7 yed ff3 fs4 fc0 sc0 ls0 ws0">with</div><div class="t m0 x14c h7 yed ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x1c h13 y168 ff11 fs5 fc0 sc0 ls0 ws0">2</div><div class="t m1b x10c h7 yed ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x72 h7 yed ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m1b xa6 h7 yed ff6 fs4 fc0 sc0 ls0 ws0">)</div><div class="t m0 xa8 h7 yed ff5 fs4 fc0 sc0 ls0 ws0">6</div><div class="t m1b xa8 h7 yed ff6 fs4 fc0 sc0 ls0 ws0">=</div><div class="t m0 x156 h7 yed ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x73 h13 y168 ff11 fs5 fc0 sc0 ls0 ws0">2</div><div class="t m1b x10d h7 yed ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x44 h7 yed ff4 fs4 fc0 sc0 ls0 ws0">v<span class="_ _10"> </span><span class="ff5">−</span></div><div class="t m1b xf9 h7 yed ff6 fs4 fc0 sc0 ls0 ws0">1)<span class="_ _4"> </span><span class="ff3">are<span class="_ _e"> </span>called<span class="_ _4"> </span><span class="ff7">(tier-2)<span class="_ _e"> </span>pr<span class="_ _2"></span>e<span class="_ _5"></span>or<span class="_ _2"></span>der<span class="_ _e"> </span>changers<span class="ff3">.</span></span></span></div><div class="t m1d x45 h7 yee ff3 fs4 fc0 sc0 ls0 ws0">W<span class="_ _6"></span>e<span class="_ _4"> </span>will<span class="_ _e"> </span>associate<span class="_ _e"> </span>with<span class="_ _4"> </span>each<span class="_ _4"> </span>no<span class="_ _7"></span>de</div><div class="t m0 x19 h7 yee ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m1d xf5 h7 yee ff3 fs4 fc0 sc0 ls0 ws0">“its”<span class="_ _4"> </span>tier-1<span class="_ _e"> </span>(tier-2)<span class="_ _4"> </span>preorder<span class="_ _e"> </span>c<span class="_ _2"></span>hanger</div><div class="t m0 x166 h7 yee ff4 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m1d x148 h7 yee ff3 fs4 fc0 sc0 ls0 ws0">,<span class="_ _4"> </span>which<span class="_ _4"> </span>is<span class="_ _e"> </span>the<span class="_ _4"> </span>last</div><div class="t m2 x33 h7 yef ff3 fs4 fc0 sc0 ls0 ws0">preorder<span class="_ _4"> </span>changer<span class="_ _4"> </span>preceding</div><div class="t m0 x169 h7 yef ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m2 x129 h7 yef ff3 fs4 fc0 sc0 ls0 ws0">in<span class="_ _4"> </span>preorder,</div><div class="t m0 xa8 h7 yef ff3 fs4 fc0 sc0 ls0 ws0">i.<span class="_ _b"></span>e.</div><div class="t m2 xdb h7 yef ff3 fs4 fc0 sc0 ls0 ws0">,</div><div class="t m0 x10d h7 yef ff6 fs4 fc0 sc0 ls0 ws0">max<span class="ff5">{<span class="ff4">u<span class="_ _9"> </span></span>∈</span></div><div class="t m2 x103 h7 yef ff6 fs4 fc0 sc0 ls0 ws0">[1</div><div class="t m0 x145 h7 yef ff4 fs4 fc0 sc0 ls0 ws0">..v</div><div class="t m2 x82 h7 yef ff6 fs4 fc0 sc0 ls0 ws0">] :</div><div class="t m0 x9e h7 yef ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 xc6 h13 y169 ff11 fs5 fc0 sc0 ls0 ws0">1</div><div class="t m2 x111 h7 yef ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x89 h7 yef ff4 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m2 x16a h7 yef ff6 fs4 fc0 sc0 ls0 ws0">)</div><div class="t m0 x16b h7 yef ff5 fs4 fc0 sc0 ls0 ws0">6</div><div class="t m2 x16b h7 yef ff6 fs4 fc0 sc0 ls0 ws0">=</div><div class="t m0 x166 h7 yef ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x15e h13 y169 ff11 fs5 fc0 sc0 ls0 ws0">1</div><div class="t m2 xb5 h7 yef ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x4e h7 yef ff4 fs4 fc0 sc0 ls0 ws0">u<span class="_ _10"> </span><span class="ff5">−</span></div><div class="t m2 x8f h7 yef ff6 fs4 fc0 sc0 ls0 ws0">1)</div><div class="t m0 xb9 h7 yef ff5 fs4 fc0 sc0 ls0 ws0">}</div><div class="t m2 x9a h7 yef ff3 fs4 fc0 sc0 ls0 ws0">;<span class="_ _4"> </span>(Recall</div><div class="t m0 x33 h7 yf0 ff3 fs4 fc0 sc0 ls0 ws0">that<span class="_ _4"> </span>we<span class="_ _4"> </span>identify<span class="_ _4"> </span>nodes<span class="_ _e"> </span>with<span class="_ _4"> </span>their<span class="_ _e"> </span>preorder<span class="_ _4"> </span>rank.)</div><div class="t m13 x37 h7 yf1 ff3 fs4 fc0 sc0 ls0 ws0">By<span class="_ _4"> </span>Lemma<span class="_ _e"> </span>3,<span class="_ _4"> </span>the<span class="_ _e"> </span>n<span class="_ _2"></span>umber<span class="_ _e"> </span>of<span class="_ _4"> </span>tier-1<span class="_ _4"> </span>preorder<span class="_ _e"> </span>c<span class="_ _2"></span>hangers<span class="_ _e"> </span>is</div><div class="t m0 x9d h7 yf1 ff4 fs4 fc0 sc0 ls0 ws0">O</div><div class="t m13 x82 h7 yf1 ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x14a h7 yf1 ff4 fs4 fc0 sc0 ls0 ws0">n/H</div><div class="t m13 x89 h7 yf1 ff6 fs4 fc0 sc0 ls0 ws0">)<span class="ff3">,<span class="_ _4"> </span>since<span class="_ _e"> </span>the<span class="_ _4"> </span>only<span class="_ _e"> </span>times<span class="_ _4"> </span>a</span></div><div class="t m2 x33 h7 yf2 ff3 fs4 fc0 sc0 ls0 ws0">mini-tree<span class="_ _4"> </span>can<span class="_ _4"> </span>b<span class="_ _7"></span>e<span class="_ _e"> </span>brok<span class="_ _2"></span>en<span class="_ _e"> </span>up<span class="_ _4"> </span>is<span class="_ _4"> </span>through<span class="_ _4"> </span>the<span class="_ _e"> </span>external<span class="_ _4"> </span>edge<span class="_ _4"> </span>(once<span class="_ _e"> </span>per<span class="_ _4"> </span>tree),<span class="_ _e"> </span>the<span class="_ _4"> </span>tw<span class="_ _2"></span>o<span class="_ _4"> </span>diﬀerent</div><div class="t m2 x33 h7 yf3 ff3 fs4 fc0 sc0 ls0 ws0">blo<span class="_ _7"></span>c<span class="_ _5"></span>ks<span class="_ _3"> </span>of<span class="_ _3"> </span>child<span class="_ _5"></span>ren<span class="_ _3"> </span>of<span class="_ _3"> </span>the<span class="_ _3"> </span>ro<span class="_ _7"></span>ot, or<span class="_ _d"> </span>at<span class="_ _3"> </span>slabb<span class="_ _7"></span>ed<span class="_ _3"> </span>edges.<span class="_ _c"> </span>Similarly<span class="_ _6"></span>, we<span class="_ _d"> </span>hav<span class="_ _2"></span>e</div><div class="t m0 x74 h7 yf3 ff4 fs4 fc0 sc0 ls0 ws0">O</div><div class="t m2 x14f h7 yf3 ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x4f h7 yf3 ff4 fs4 fc0 sc0 ls0 ws0">n/H</div><div class="t m0 x91 h17 y16a ff17 fs5 fc0 sc0 ls0 ws0">0</div><div class="t m2 xc0 h7 yf3 ff6 fs4 fc0 sc0 ls0 ws0">)<span class="_ _3"> </span><span class="ff3">tier-2</span></div><div class="t m13 x33 h7 yf4 ff3 fs4 fc0 sc0 ls0 ws0">preorder<span class="_ _4"> </span>changers.<span class="_ _d"> </span>W<span class="_ _6"></span>e<span class="_ _e"> </span>can<span class="_ _4"> </span>th<span class="_ _5"></span>us<span class="_ _4"> </span>store<span class="_ _e"> </span>a<span class="_ _4"> </span>compressed<span class="_ _4"> </span>bitvector<span class="_ _4"> </span>(Lemma<span class="_ _e"> </span>1)<span class="_ _4"> </span>to<span class="_ _4"> </span>indicate<span class="_ _e"> </span>whic<span class="_ _2"></span>h</div><div class="t m2 x33 h7 yf5 ff3 fs4 fc0 sc0 ls0 ws0">no<span class="_ _7"></span>des<span class="_ _e"> </span>in<span class="_ _a"> </span>a<span class="_ _e"> </span>preorder<span class="_ _a"> </span>tra<span class="_ _2"></span>versal<span class="_ _e"> </span>are<span class="_ _e"> </span>(tier-1/tier-2)<span class="_ _a"> </span>preorder<span class="_ _e"> </span>changers.<span class="_ _15"> </span>The<span class="_ _e"> </span>space<span class="_ _e"> </span>for<span class="_ _a"> </span>that<span class="_ _e"> </span>is</div><div class="t m0 x33 h7 y16b ff4 fs4 fc0 sc0 ls0 ws0">O</div><div class="t m1 x16c h7 y16b ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x13f h13 y16c ff15 fs5 fc0 sc0 ls0 ws0">n</div><div class="t m0 x16d h13 y16d ff15 fs5 fc0 sc0 ls0 ws0">H</div><div class="t m0 xdf h7 y16b ff6 fs4 fc0 sc0 ls0 ws0">log</div><div class="t m1 x16e h7 y16b ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x112 h7 y16b ff4 fs4 fc0 sc0 ls0 ws0">H</div><div class="t m1 x79 h7 y16b ff6 fs4 fc0 sc0 ls0 ws0">)<span class="_ _7"></span>+</div><div class="t m0 xe h7 y16b ff4 fs4 fc0 sc0 ls0 ws0">n</div><div class="t m0 x96 h13 y16e ff11 fs5 fc0 sc0 ls0 ws0">log<span class="_ _1b"> </span>log<span class="_ _1b"> </span><span class="ff15">n</span></div><div class="t m0 x16f h13 y16d ff11 fs5 fc0 sc0 ls0 ws0">log<span class="_ _1b"> </span><span class="ff15">n</span></div><div class="t m1 xed h7 y16b ff6 fs4 fc0 sc0 ls0 ws0">) =</div><div class="t m0 xa3 h7 y16b ff4 fs4 fc0 sc0 ls0 ws0">o</div><div class="t m1 x15 h7 y16b ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x65 h7 y16b ff4 fs4 fc0 sc0 ls0 ws0">n</div><div class="t m1 xff h7 y16b ff6 fs4 fc0 sc0 ls0 ws0">)<span class="_ _10"> </span><span class="ff3">for<span class="_ _10"> </span>tier<span class="_ _10"> </span>1<span class="_ _10"> </span>and</span></div><div class="t m0 x170 h7 y16b ff4 fs4 fc0 sc0 ls0 ws0">O</div><div class="t m1 x7f h7 y16b ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x15b h13 y16c ff15 fs5 fc0 sc0 ls0 ws0">n</div><div class="t m0 x80 h13 y16d ff15 fs5 fc0 sc0 ls0 ws0">H</div><div class="t m0 x44 h1a y16f ff19 fs9 fc0 sc0 ls0 ws0">0</div><div class="t m0 x98 h7 y16b ff6 fs4 fc0 sc0 ls0 ws0">log<span class="_ _13"> </span><span class="ff4">H</span></div><div class="t m0 xe4 h17 y170 ff17 fs5 fc0 sc0 ls0 ws0">0</div><div class="t m1 x5 h7 y16b ff6 fs4 fc0 sc0 ls0 ws0">+</div><div class="t m0 x128 h7 y16b ff4 fs4 fc0 sc0 ls0 ws0">n</div><div class="t m0 x50 h13 y16e ff11 fs5 fc0 sc0 ls0 ws0">log<span class="_ _1b"> </span>log<span class="_ _1b"> </span><span class="ff15">n</span></div><div class="t m0 x29 h13 y16d ff11 fs5 fc0 sc0 ls0 ws0">log<span class="_ _1b"> </span><span class="ff15">n</span></div><div class="t m1 x111 h7 y16b ff6 fs4 fc0 sc0 ls0 ws0">) =</div><div class="t m0 x16b h7 y16b ff4 fs4 fc0 sc0 ls0 ws0">O</div><div class="t m1 x5a h7 y16b ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x52 h7 y16b ff4 fs4 fc0 sc0 ls0 ws0">n</div><div class="t m0 xb5 h13 y171 ff11 fs5 fc0 sc0 ls0 ws0">(log<span class="_ _1b"> </span>log<span class="_ _1b"> </span><span class="ff15">n</span>)</div><div class="t m0 xaf h19 y172 ff18 fs9 fc0 sc0 ls0 ws0">3</div><div class="t m0 x7d h13 y16d ff11 fs5 fc0 sc0 ls0 ws0">log<span class="_ _1b"> </span><span class="ff15">n</span></div><div class="t m1 x91 h7 y16b ff6 fs4 fc0 sc0 ls0 ws0">) =</div><div class="t m0 xb1 h7 y16b ff4 fs4 fc0 sc0 ls0 ws0">o</div><div class="t m1 x3a h7 y16b ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x171 h7 y16b ff4 fs4 fc0 sc0 ls0 ws0">n</div><div class="t m1 x3b h7 y16b ff6 fs4 fc0 sc0 ls0 ws0">)</div><div class="t m0 x33 h7 y173 ff3 fs4 fc0 sc0 ls0 ws0">for<span class="_ _4"> </span>tier<span class="_ _e"> </span>2.</div><div class="t m1 x37 h7 y174 ff3 fs4 fc0 sc0 ls0 ws0">W<span class="_ _6"></span>e<span class="_ _9"> </span>will<span class="_ _4"> </span>additionally<span class="_ _4"> </span>store<span class="_ _9"> </span>a<span class="_ _4"> </span>compressed<span class="_ _4"> </span>bitv<span class="_ _2"></span>ector<span class="_ _4"> </span>indicating<span class="_ _4"> </span>preorder<span class="_ _9"> </span>changers<span class="_ _9"> </span>by</div><div class="t m0 x149 h7 y174 ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m1 xb0 h7 y174 ff3 fs4 fc0 sc0 ls0 ws0">-name,</div><div class="t m0 x33 h7 y175 ff3 fs4 fc0 sc0 ls0 ws0">i.<span class="_ _b"></span>e.</div><div class="t m1e x13f h7 y175 ff3 fs4 fc0 sc0 ls0 ws0">,<span class="_ _4"> </span>we<span class="_ _4"> </span>tra<span class="_ _5"></span>v<span class="_ _2"></span>erse<span class="_ _e"> </span>all<span class="_ _4"> </span>no<span class="_ _7"></span>des<span class="_ _4"> </span>in</div><div class="t m0 xac h7 y175 ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m1e xcb h7 y175 ff3 fs4 fc0 sc0 ls0 ws0">-order<span class="_ _4"> </span>and<span class="_ _e"> </span>add<span class="_ _4"> </span>a<span class="_ _4"> </span><span class="ff6">1<span class="_ _e"> </span></span>if<span class="_ _4"> </span>the<span class="_ _4"> </span>current<span class="_ _4"> </span>no<span class="_ _7"></span>de<span class="_ _4"> </span>is<span class="_ _e"> </span>a<span class="_ _4"> </span>preorder<span class="_ _4"> </span>changer,</div><div class="t m1f x33 h7 y176 ff3 fs4 fc0 sc0 ls0 ws0">and<span class="_ _4"> </span>a<span class="_ _e"> </span><span class="ff6">0<span class="_ _4"> </span></span>if<span class="_ _e"> </span>not.<span class="_ _3"> </span>Again,<span class="_ _4"> </span>we<span class="_ _4"> </span>can<span class="_ _e"> </span>aﬀord<span class="_ _4"> </span>to<span class="_ _e"> </span>this<span class="_ _4"> </span>using<span class="_ _e"> </span>Lemma<span class="_ _4"> </span>1<span class="_ _e"> </span>for<span class="_ _4"> </span>tier-1<span class="_ _e"> </span>and<span class="_ _4"> </span>tier-2<span class="_ _e"> </span>in<span class="_ _4"> </span>the<span class="_ _e"> </span>same</div><div class="t m1c x33 h7 y177 ff3 fs4 fc0 sc0 ls0 ws0">space<span class="_ _4"> </span>as<span class="_ _e"> </span>abov<span class="_ _2"></span>e.<span class="_ _3"> </span>(The<span class="_ _4"> </span>universe<span class="_ _4"> </span>gro<span class="_ _5"></span>ws<span class="_ _4"> </span>to</div><div class="t m0 x72 h7 y177 ff4 fs4 fc0 sc0 ls0 ws0">n<span class="_ _13"> </span><span class="ff6">p<span class="_ _7"></span>olylog</span></div><div class="t m1c x77 h7 y177 ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x41 h7 y177 ff4 fs4 fc0 sc0 ls0 ws0">n</div><div class="t m1c x159 h7 y177 ff6 fs4 fc0 sc0 ls0 ws0">)<span class="ff3">,<span class="_ _4"> </span>but<span class="_ _e"> </span>that<span class="_ _4"> </span>do<span class="_ _7"></span>es<span class="_ _4"> </span>not<span class="_ _e"> </span>aﬀect<span class="_ _4"> </span>the<span class="_ _4"> </span>space<span class="_ _4"> </span>by</span></div><div class="t m0 x33 h7 y178 ff3 fs4 fc0 sc0 ls0 ws0">more<span class="_ _4"> </span>than<span class="_ _e"> </span>a<span class="_ _4"> </span>constant<span class="_ _4"> </span>factor).</div><div class="t m2 x37 h7 y179 ff3 fs4 fc0 sc0 ls0 ws0">In<span class="_ _e"> </span>the<span class="_ _a"> </span>same<span class="_ _e"> </span>space,<span class="_ _a"> </span>we<span class="_ _e"> </span>can<span class="_ _e"> </span>store</div><div class="t m0 x1b h7 y179 ff4 fs4 fc0 sc0 ls0 ws0">O</div><div class="t m2 x119 h7 y179 ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x36 h7 y179 ff6 fs4 fc0 sc0 ls0 ws0">log<span class="_ _13"> </span><span class="ff4">n</span></div><div class="t m2 x1f h7 y179 ff6 fs4 fc0 sc0 ls0 ws0">)<span class="_ _e"> </span><span class="ff3">bits<span class="_ _a"> </span>for<span class="_ _e"> </span>each<span class="_ _e"> </span>tier-1<span class="_ _e"> </span>changer<span class="_ _e"> </span>and</span></div><div class="t m0 x75 h7 y179 ff4 fs4 fc0 sc0 ls0 ws0">O</div><div class="t m2 xb9 h7 y179 ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 xc9 h7 y179 ff6 fs4 fc0 sc0 ls0 ws0">log<span class="_ _13"> </span>log<span class="_ _11"> </span><span class="ff4">n</span></div><div class="t m2 x3b h7 y179 ff6 fs4 fc0 sc0 ls0 ws0">)</div><div class="t m12 x33 h7 y17a ff3 fs4 fc0 sc0 ls0 ws0">bits<span class="_ _4"> </span>for<span class="_ _e"> </span>eac<span class="_ _5"></span>h<span class="_ _4"> </span>tier-2<span class="_ _e"> </span>changer,<span class="_ _4"> </span>and<span class="_ _4"> </span>with<span class="_ _e"> </span>ab<span class="_ _7"></span>o<span class="_ _5"></span>v<span class="_ _5"></span>e<span class="_ _4"> </span>bitvectors,<span class="_ _4"> </span>we<span class="_ _4"> </span>can<span class="_ _e"> </span>access<span class="_ _4"> </span>that<span class="_ _e"> </span>information<span class="_ _4"> </span>given</div><div class="t m0 x33 h7 y17b ff3 fs4 fc0 sc0 ls0 ws0">global<span class="_ _4"> </span>preorder<span class="_ _e"> </span>or<span class="_ _4"> </span><span class="ff4">τ<span class="_ _1b"></span></span>-names.</div><div class="t m0 x33 h7 y17c ff1 fs4 fc0 sc0 ls0 ws0">Select</div><div class="t m2 xef h7 y17c ff3 fs4 fc0 sc0 ls0 ws0">Giv<span class="_ _5"></span>en<span class="_ _a"> </span>the<span class="_ _e"> </span>preorder<span class="_ _a"> </span>num<span class="_ _2"></span>b<span class="_ _7"></span>er<span class="_ _a"> </span>of<span class="_ _a"> </span>a<span class="_ _a"> </span>no<span class="_ _7"></span>de</div><div class="t m0 x44 h7 y17c ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m2 x98 h7 y17c ff3 fs4 fc0 sc0 ls0 ws0">,<span class="_ _a"> </span>we<span class="_ _e"> </span>wan<span class="_ _2"></span>t<span class="_ _a"> </span>to<span class="_ _a"> </span>ﬁnd</div><div class="t m0 x16a h7 y17c ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m2 x8 h7 y17c ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x172 h7 y17c ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m2 x5a h7 y17c ff6 fs4 fc0 sc0 ls0 ws0">)<span class="ff3">.<span class="_ _0"> </span>Let</span></div><div class="t m0 x151 h7 y17c ff4 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m2 x90 h7 y17c ff3 fs4 fc0 sc0 ls0 ws0">and</div><div class="t m0 xf2 h7 y17c ff4 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m0 xb1 h17 y17d ff17 fs5 fc0 sc0 ls0 ws0">0</div><div class="t m2 x15f h7 y17c ff3 fs4 fc0 sc0 ls0 ws0">b<span class="_ _7"></span>e</div><div class="t m2 x33 h7 y17e ff3 fs4 fc0 sc0 ls0 ws0">the<span class="_ _a"> </span>tier-1<span class="_ _a"> </span>resp.<span class="_ _a"> </span>tier-2<span class="_ _a"> </span>preorder<span class="_ _a"> </span>changers<span class="_ _a"> </span>associated<span class="_ _d"> </span>with</div><div class="t m0 x28 h7 y17e ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m2 x12e h7 y17e ff3 fs4 fc0 sc0 ls0 ws0">.<span class="_ _0"> </span>The<span class="_ _a"> </span>core<span class="_ _a"> </span>observ<span class="_ _2"></span>ation<span class="_ _a"> </span>is<span class="_ _a"> </span>that</div><div class="t m0 x33 h7 y17f ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 xf3 h13 y180 ff11 fs5 fc0 sc0 ls0 ws0">1</div><div class="t m1f x146 h7 y17f ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x138 h7 y17f ff4 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m1f xde h7 y17f ff6 fs4 fc0 sc0 ls0 ws0">) =</div><div class="t m0 x16e h7 y17f ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x71 h13 y180 ff11 fs5 fc0 sc0 ls0 ws0">1</div><div class="t m1f x173 h7 y17f ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x174 h7 y17f ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m1f x175 h7 y17f ff6 fs4 fc0 sc0 ls0 ws0">)<span class="_ _4"> </span><span class="ff3">and</span></div><div class="t m0 x6f h7 y17f ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x4b h13 y180 ff11 fs5 fc0 sc0 ls0 ws0">2</div><div class="t m1f xd8 h7 y17f ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x12 h7 y17f ff4 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m0 x12d h17 y181 ff17 fs5 fc0 sc0 ls0 ws0">0</div><div class="t m1f x4d h7 y17f ff6 fs4 fc0 sc0 ls0 ws0">) =</div><div class="t m0 xf4 h7 y17f ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x65 h13 y180 ff11 fs5 fc0 sc0 ls0 ws0">2</div><div class="t m1f xac h7 y17f ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x7e h7 y17f ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m1f x18 h7 y17f ff6 fs4 fc0 sc0 ls0 ws0">)<span class="ff3">,<span class="_ _4"> </span>since<span class="_ _e"> </span>a<span class="_ _4"> </span>no<span class="_ _7"></span>des<span class="_ _e"> </span>tier-1<span class="_ _4"> </span>(tier-2)<span class="_ _e"> </span>preorder<span class="_ _4"> </span>changer<span class="_ _4"> </span>by<span class="_ _4"> </span>deﬁnition</span></div><div class="t m14 x33 h7 y182 ff3 fs4 fc0 sc0 ls0 ws0">lies<span class="_ _4"> </span>in<span class="_ _4"> </span>the<span class="_ _e"> </span>same<span class="_ _4"> </span>mini<span class="_ _4"> </span>(micro)<span class="_ _4"> </span>tree<span class="_ _e"> </span>as</div><div class="t m0 x14c h7 y182 ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m14 x176 h7 y182 ff3 fs4 fc0 sc0 ls0 ws0">.<span class="_ _d"> </span>W<span class="_ _6"></span>e<span class="_ _4"> </span>thus<span class="_ _4"> </span>store<span class="_ _4"> </span>the<span class="_ _e"> </span>arra<span class="_ _2"></span>y<span class="_ _4"> </span>of</div><div class="t m0 x12f h7 y182 ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x8b h13 y183 ff11 fs5 fc0 sc0 ls0 ws0">1</div><div class="t m14 x16b h7 y182 ff3 fs4 fc0 sc0 ls0 ws0">-n<span class="_ _5"></span>um<span class="_ _2"></span>b<span class="_ _17"></span>ers<span class="_ _4"> </span>of<span class="_ _4"> </span>all<span class="_ _e"> </span>tier-1</div><div class="t m2 x33 h7 y184 ff3 fs4 fc0 sc0 ls0 ws0">preorder<span class="_ _e"> </span>c<span class="_ _2"></span>hangers<span class="_ _e"> </span>as<span class="_ _e"> </span>they<span class="_ _e"> </span>are<span class="_ _e"> </span>visited<span class="_ _4"> </span>by<span class="_ _4"> </span>a<span class="_ _e"> </span>preorder<span class="_ _e"> </span>trav<span class="_ _2"></span>ersal<span class="_ _e"> </span>of</div><div class="t m0 x177 h7 y184 ff4 fs4 fc0 sc0 ls0 ws0">T</div><div class="t m2 x125 h7 y184 ff3 fs4 fc0 sc0 ls0 ws0">. Using<span class="_ _e"> </span>rank<span class="_ _e"> </span>and<span class="_ _4"> </span>select</div><div class="t m2 x33 h7 y185 ff3 fs4 fc0 sc0 ls0 ws0">on<span class="_ _e"> </span>the<span class="_ _4"> </span>bitvectors<span class="_ _e"> </span>from<span class="_ _4"> </span>ab<span class="_ _7"></span>ov<span class="_ _2"></span>e,<span class="_ _e"> </span>we<span class="_ _4"> </span>ﬁnd</div><div class="t m0 x178 h7 y185 ff4 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m2 x12a h7 y185 ff3 fs4 fc0 sc0 ls0 ws0">,<span class="_ _e"> </span>for<span class="_ _e"> </span>whic<span class="_ _2"></span>h<span class="_ _e"> </span>we<span class="_ _4"> </span>lo<span class="_ _7"></span>ok<span class="_ _e"> </span>up</div><div class="t m0 x179 h7 y185 ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x17a h13 y186 ff11 fs5 fc0 sc0 ls0 ws0">1</div><div class="t m2 xc7 h7 y185 ff3 fs4 fc0 sc0 ls0 ws0">. The<span class="_ _e"> </span>procedure<span class="_ _e"> </span>applies,</div><div class="t m20 x45 h7 y187 ff7 fs4 fc0 sc0 ls0 ws0">mutatis<span class="_ _e"> </span>mutandis<span class="ff3">,<span class="_ _e"> </span>to</span></div><div class="t m0 x12 h7 y187 ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x17b h13 y188 ff11 fs5 fc0 sc0 ls0 ws0">2</div><div class="t m20 x85 h7 y187 ff3 fs4 fc0 sc0 ls0 ws0">using<span class="_ _4"> </span>the<span class="_ _e"> </span>tier-2<span class="_ _4"> </span>preorder<span class="_ _e"> </span>changer</div><div class="t m0 x103 h7 y187 ff4 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m0 x104 h17 y189 ff17 fs5 fc0 sc0 ls0 ws0">0</div><div class="t m20 x50 h7 y187 ff3 fs4 fc0 sc0 ls0 ws0">.<span class="_ _3"> </span>Since</div><div class="t m0 xd0 h7 y187 ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x158 h13 y188 ff11 fs5 fc0 sc0 ls0 ws0">2</div><div class="t m20 x8 h7 y187 ff3 fs4 fc0 sc0 ls0 ws0">is<span class="_ _4"> </span>lo<span class="_ _7"></span>cal<span class="_ _e"> </span>to<span class="_ _e"> </span>a<span class="_ _4"> </span>mini<span class="_ _e"> </span>tree,</div><div class="t m0 x33 h7 y18a ff6 fs4 fc0 sc0 ls0 ws0">lg<span class="_ _13"> </span><span class="ff4">M</span></div><div class="t m1 xdf h7 y18a ff6 fs4 fc0 sc0 ls0 ws0">=</div><div class="t m0 x70 h7 y18a ff4 fs4 fc0 sc0 ls0 ws0">O</div><div class="t m1 xa1 h7 y18a ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x42 h7 y18a ff6 fs4 fc0 sc0 ls0 ws0">log<span class="_ _13"> </span>log<span class="_ _11"> </span><span class="ff4">n</span></div><div class="t m1 xd6 h7 y18a ff6 fs4 fc0 sc0 ls0 ws0">)<span class="_ _4"> </span><span class="ff3">bits<span class="_ _4"> </span>suﬃce,<span class="_ _4"> </span>so<span class="_ _e"> </span>w<span class="_ _2"></span>e<span class="_ _4"> </span>can<span class="_ _e"> </span>aﬀord<span class="_ _4"> </span>to<span class="_ _4"> </span>store</span></div><div class="t m0 x14e h7 y18a ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x103 h13 y18b ff11 fs5 fc0 sc0 ls0 ws0">2</div><div class="t m1 x10f h7 y18a ff3 fs4 fc0 sc0 ls0 ws0">for<span class="_ _4"> </span>every<span class="_ _4"> </span>tier-2<span class="_ _4"> </span>c<span class="_ _2"></span>hanger.<span class="_ _3"> </span>W<span class="_ _6"></span>e<span class="_ _4"> </span>also</div><div class="t m4 x33 h7 y18c ff3 fs4 fc0 sc0 ls0 ws0">store<span class="_ _4"> </span>the</div><div class="t m0 x17c h7 y18c ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x42 h13 y18d ff11 fs5 fc0 sc0 ls0 ws0">3</div><div class="t m4 x43 h7 y18c ff3 fs4 fc0 sc0 ls0 ws0">-n<span class="_ _5"></span>um<span class="_ _2"></span>b<span class="_ _7"></span>er<span class="_ _e"> </span>for<span class="_ _4"> </span>each<span class="_ _4"> </span>tier-2<span class="_ _e"> </span>c<span class="_ _2"></span>hanger<span class="_ _e"> </span>in<span class="_ _4"> </span>the<span class="_ _e"> </span>same<span class="_ _4"> </span>space.<span class="_ _3"> </span>W<span class="_ _6"></span>e<span class="_ _4"> </span>can<span class="_ _e"> </span>then<span class="_ _4"> </span>obtain</div><div class="t m0 x91 h7 y18c ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x92 h13 y18d ff11 fs5 fc0 sc0 ls0 ws0">3</div><div class="t m4 x93 h7 y18c ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 xba h7 y18c ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m4 x69 h7 y18c ff6 fs4 fc0 sc0 ls0 ws0">)<span class="_ _4"> </span><span class="ff3">as</span></div><div class="t m0 x33 h7 y18e ff3 fs4 fc0 sc0 ls0 ws0">the<span class="_ _4"> </span>sum<span class="_ _e"> </span><span class="ff4">τ</span></div><div class="t m0 x78 h13 y18f ff11 fs5 fc0 sc0 ls0 ws0">3</div><div class="t m0 x17d h7 y18e ff6 fs4 fc0 sc0 ls0 ws0">(<span class="ff4">u</span></div><div class="t m0 xd5 h17 y190 ff17 fs5 fc0 sc0 ls0 ws0">0</div><div class="t m0 x150 h7 y18e ff6 fs4 fc0 sc0 ls0 ws0">)<span class="_ _4"> </span><span class="ff3">and<span class="_ _e"> </span>the<span class="_ _4"> </span>distance<span class="_ _e"> </span>from<span class="_ _4"> </span>the<span class="_ _4"> </span>last<span class="_ _e"> </span>1<span class="_ _4"> </span>in<span class="_ _e"> </span>the<span class="_ _4"> </span>bit<span class="_ _4"> </span>vector<span class="_ _4"> </span>indicating<span class="_ _e"> </span><span class="ff4">τ</span></span></div><div class="t m0 x3f h13 y18f ff11 fs5 fc0 sc0 ls0 ws0">2</div><div class="t m0 x123 h7 y18e ff3 fs4 fc0 sc0 ls0 ws0">c<span class="_ _5"></span>hangers.</div><div class="t m0 x33 h7 y191 ff1 fs4 fc0 sc0 ls0 ws0">Rank<span class="_ _27"> </span><span class="ff3">F<span class="_ _6"></span>or<span class="_ _4"> </span>space<span class="_ _e"> </span>purposes,<span class="_ _e"> </span>see<span class="_ _4"> </span>App<span class="_ _7"></span>endix<span class="_ _e"> </span>B<span class="_ _4"> </span>for<span class="_ _4"> </span>the<span class="_ _e"> </span>full<span class="_ _4"> </span>description.</span></div><div class="t m0 x33 h6 y192 ff1 fs1 fc0 sc0 ls0 ws0">5.2<span class="_ _21"> </span>Level-o<span class="_ _2"></span>rder<span class="_ _d"> </span>rank/select</div><div class="t m3 x33 h7 y193 ff3 fs4 fc0 sc0 ls0 ws0">Let</div><div class="t m0 x12b h7 y193 ff4 fs4 fc0 sc0 ls0 ws0">w</div><div class="t m0 xd1 h13 y194 ff11 fs5 fc0 sc0 ls0 ws0">1</div><div class="t m0 xbc h7 y193 ff4 fs4 fc0 sc0 ls0 ws0">,<span class="_ _13"> </span>.<span class="_ _13"> </span>.<span class="_ _13"> </span>.<span class="_ _13"> </span>,<span class="_ _13"> </span>w</div><div class="t m0 x4a h13 y194 ff15 fs5 fc0 sc0 ls0 ws0">n</div><div class="t m3 x6e h7 y193 ff3 fs4 fc0 sc0 ls0 ws0">b<span class="_ _7"></span>e<span class="_ _4"> </span>the<span class="_ _e"> </span>no<span class="_ _7"></span>des<span class="_ _e"> </span>of</div><div class="t m0 xcc h7 y193 ff4 fs4 fc0 sc0 ls0 ws0">T</div><div class="t m3 x17e h7 y193 ff3 fs4 fc0 sc0 ls0 ws0">in<span class="_ _4"> </span>level<span class="_ _4"> </span>order,</div><div class="t m0 xab h7 y193 ff3 fs4 fc0 sc0 ls0 ws0">i.<span class="_ _b"></span>e.</div><div class="t m3 x39 h7 y193 ff3 fs4 fc0 sc0 ls0 ws0">,</div><div class="t m0 x11a h7 y193 ff4 fs4 fc0 sc0 ls0 ws0">w</div><div class="t m0 x153 h13 y194 ff15 fs5 fc0 sc0 ls0 ws0">i</div><div class="t m3 xe5 h7 y193 ff3 fs4 fc0 sc0 ls0 ws0">is<span class="_ _4"> </span>the</div><div class="t m0 x167 h7 y193 ff4 fs4 fc0 sc0 ls0 ws0">i</div><div class="t m3 x107 h7 y193 ff3 fs4 fc0 sc0 ls0 ws0">th<span class="_ _4"> </span>no<span class="_ _7"></span>de<span class="_ _e"> </span>visited<span class="_ _e"> </span>in<span class="_ _4"> </span>the<span class="_ _e"> </span>left-to-</div><div class="t m1a x33 h7 y195 ff3 fs4 fc0 sc0 ls0 ws0">righ<span class="_ _5"></span>t<span class="_ _4"> </span>breadth-ﬁrst<span class="_ _e"> </span>tra<span class="_ _2"></span>versal<span class="_ _4"> </span>of</div><div class="t m0 x129 h7 y195 ff4 fs4 fc0 sc0 ls0 ws0">T</div><div class="t m1a xe1 h7 y195 ff3 fs4 fc0 sc0 ls0 ws0">.<span class="_ _3"> </span>Similar<span class="_ _4"> </span>to<span class="_ _e"> </span>the<span class="_ _4"> </span>preorder,<span class="_ _e"> </span>we<span class="_ _4"> </span>call<span class="_ _4"> </span>a<span class="_ _e"> </span>no<span class="_ _7"></span>de</div><div class="t m0 x52 h7 y195 ff4 fs4 fc0 sc0 ls0 ws0">w</div><div class="t m0 xb5 h13 y196 ff15 fs5 fc0 sc0 ls0 ws0">i</div><div class="t m1a x74 h7 y195 ff3 fs4 fc0 sc0 ls0 ws0">a<span class="_ _4"> </span><span class="ff7">tier-1<span class="_ _a"> </span>(tier-2)</span></div><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",116.079,582.99,null]'><div class="d m7" style="border-style:none;position:absolute;left:192.519608px;bottom:909.240196px;width:11.955000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf6" data-dest-detail='[6,"XYZ",116.079,277.501,null]'><div class="d m7" style="border-style:none;position:absolute;left:296.290850px;bottom:820.521242px;width:6.984000px;height:11.955000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf5" data-dest-detail='[5,"XYZ",99.071,721.288,null]'><div class="d m7" style="border-style:none;position:absolute;left:635.557190px;bottom:757.032680px;width:42.613000px;height:11.956000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf5" data-dest-detail='[5,"XYZ",99.071,721.288,null]'><div class="d m7" style="border-style:none;position:absolute;left:541.184641px;bottom:628.495098px;width:42.203000px;height:10.792000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",99.071,292.421,null]'><div class="d m7" style="border-style:none;position:absolute;left:413.233660px;bottom:244.336601px;width:54.712000px;height:10.849000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.633987,0.000000,0.000000,1.633987,0.000000,0.000000]}'></div></div>
