<div id="pf5" class="pf w0 h0" data-page-no="5"><div class="pc pc5 w0 h0"><img class="bi x0 yd2 w3 h1d" alt="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAo4AAAQkCAIAAAB8OwgFAAAACXBIWXMAABYlAAAWJQFJUiTwAAANaklEQVR42u3YUQqDMABEwW4x979wYPvRC5QKEuPMDbIqD5O2L9hIEiMAO3mbAABWdpiALZ25Lkry5Numhx/fpHeZ9ORnfpen/z2pv2oAWJpUA4BUAwBSDQBSDQBINQAg1QAg1QCAVAOAVAMAUg0ASDUASDUAINUAINUAgFQDAFINAFINAEg1AEg1ACDVAIBUA4BUAwBSDQBSbQIAkGoA4E9pawW2eqcTIwBSDQBcxAU4AEg1ACDVACDVAIBUAwBSDQBSDQBINQBINQAg1QCAVAOAVAMAUg0AUg0ASDUAINUAINUAgFQDgFQDAFINAEg1AEg1ACDVACDVJgAAqQYApBoApBoAkGoAQKoBQKoBAKkGAKkGAKQaAJBqAJBqAECqAUCqAQCpBgCkGgCkGgCQagCQagBAqgEAqQYAqQYApBoApBoAkGoAQKoBQKoBAKkGAKQaAKQaAJBqAJBqAECqAQCpBgCpBgCkGgCkGgCQagBAqgFAqgEAqQYAqQYApBoAkGoAkGoAQKoBQKoBAKkGAKQaAKQaAJBqAECqAUCqAQCpBgCpBgCkGgCQagCQagBAqgFAqgEAqQYApBoApBoAkGoAkGoAQKoBAKkGAKkGAKQaAKQaAJBqAECqAUCqAQCpBgCkGgCkGgCQagCQagBAqgEAqQYAqQYApBoApBoAkGoAQKoBQKoBAKkGAKkGAKQaAJBqAJBqAECqAUCqAQCpBgCkGgCkGgCQagBAqgFAqgEAqQYAqQYApBoAkGoAkGoAQKoBQKoBAKkGAKQaAKQaAJBqAJBqAECqAQCpBgCpBgCkGgCkGgCQagBAqgFAqgEAqQYApBoApBoAkGoAkGoAQKoBAKkGAKkGAKQaAKQaAJBqAECqAUCqAQCpBgCpBgCkGgCQagCQagBAqgFAqgEAqQYApBoApBoAkGoAQKoBQKoBAKkGAKkGAKQaAJBqAJBqAECqAUCqAQCpBgCkGgCkGgCQagCQagBAqgEAqQYAqQYApBoApBoAkGoAQKoBQKoBAKkGAKQaAKQaAJBqAJBqAECqAQCpBgCpBgCkGgCkGgCQagBAqgFAqgEAqQYAqQYApBoAkGoAkGoAQKoBQKoBAKkGAKQaAKQaAJBqAECqAUCqAQCpBgCpBgCkGgCQagCQagBAqgFAqgEAqQYApBoApBoAkGoAkGoAQKoBAKkGAKkGAKQaAKQaAJBqAECqAUCqAQCpBgCkGgCkGgCQagCQagBAqgEAqQYAqQYApBoApBoAkGoAQKoBQKoBAKkGAKkGAKQaAJBqAJBqAECqAUCqAQCpBgCkGgCkGgCQagBAqgFAqgEAqQYAqQYApBoAkGoAkGoAQKoBQKoBAKkGAKQaAKQaAJBqAJBqAECqAQCpBgCpBgCkGgCkGgCQagBAqgFAqgEAqQYAqTYBAEg1ACDVACDVAIBUAwBSDQBSDQBINQBINQAg1QCAVAOAVAMAUg0AUg0ASDUAINUAINUAgFQDgFQDAFINAEg1AEg1ACDVACDVAIBUAwBSDQBSDQBINQAg1QAg1QCAVAOAVAMAUg0ASDUASDUAINUAINUAgFQDAFINAFINAEg1AEg1ACDVAIBUA4BUAwBSDQBSDQBINQAg1QAg1QCAVAMAUg0AUg0ASDUASDUAINUAgFQDgFQDAFINAFINAEg1ACDVACDVAIBUA4BUAwBSDQBINQBINQAg1QAg1QCAVAMAUg0AUg0ASDUAINUAINUAgFQDgFQDAFINAEg1AEg1ACDVACDVAIBUAwBSDQBSDQBINQBINQAg1QCAVAOAVAMAUg0AUg0ASDUAINUAINUAgFQDAFINAFINAEg1AEg1ACDVAIBUA4BUAwBSDQBSDQBINQAg1QAg1QCAVAOAVAMAUg0ASDUASDUAINUAINUAgFQDAFINAFINAEg1ACDVACDVAIBUA4BUAwBSDQBINQBINQAg1QAg1QCAVAMAUg0AUg0ASDUASDUAINUAgFQDgFQDAFINAFINAEg1ACDVACDVAIBUAwBSDQBSDQBINQBINQAg1QCAVAOAVAMAUg0AUg0ASDUAINUAINUAgFQDgFQDAFINAEg1AEg1ACDVACDVAIBUAwBSDQBSDQBINQAg1QAg1QCAVAOAVAMAUg0ASDUASDUAINUAINUAgFQDAFINAFINAEg1AEg1ACDVAIBUA4BUAwBSDQBSDQBINQAg1QAg1QCAVAMAUg0AUg0ASDUASDUAINUAgFQDgFQDAFINAFINAEg1ACDVACDVAIBUA4BUAwBSDQBINQBINQAg1QAg1QCAVAMAUg0AUg0ASDUAINUAINUAgFQDgFQDAFINAEg1AEg1ACDVACDVAIBUAwBSDQBSDQBINQBINQAg1QCAVAOAVAMAUg0AUg0ASDUAINUAINUAgFQDAFINAFINAEg1AEg1ACDVAIBUA4BUAwBSDQBSDQBINQAg1QAg1QCAVAOAVAMAUg0ASDUASDUAINUAINUAgFQDAFINAFINAEg1AEi1CQBAqgEAqQYAqQYApBoAkGoAkGoAQKoBQKoBAKkGAKQaAKQaAJBqAJBqAECqAQCpBgCpBgCkGgCkGgCQagBAqgFAqgEAqQYAqQYApBoAkGoAkGoAQKoBAKkGAKkGAKQaAKQaAJBqAECqAUCqAQCpBgCpBgCkGgCQagCQagBAqgFAqgEAqQYApBoApBoAkGoAkGoAQKoBAKkGAKkGAKQaAJBqAJBqAECqAUCqAQCpBgCkGgCkGgCQagCQagBAqgEAqQYAqQYApBoApBoAkGoAQKoBQKoBAKkGAKkGAKQaAJBqAJBqAECqAQCpBgCpBgCkGgCkGgCQagBAqgFAqgEAqQYAqQYApBoAkGoAkGoAQKoBQKoBAKkGAKQaAKQaAJBqAJBqAECqAQCpBgCpBgCkGgCQagCQagBAqgFAqgEAqQYApBoApBoAkGoAkGoAQKoBAKkGAKkGAKQaAKQaAJBqAECqAUCqAQCpBgCpBgCkGgCQagCQagBAqgEAqQYAqQYApBoApBoAkGoAQKoBQKoBAKkGAKkGAKQaAJBqAJBqAECqAUCqAQCpBgCkGgCkGgCQagCQagBAqgEAqQYAqQYApBoAkGoAkGoAQKoBQKoBAKkGAKQaAKQaAJBqAJBqAECqAQCpBgCpBgCkGgCkGgCQagBAqgFAqgEAqQYAqQYApBoAkGoAkGoAQKoBAKkGAKkGAKQaAKQaAJBqAECqAUCqAQCpBgCpBgCkGgCQagCQagBAqgFAqgEAqQYApBoApBoAkGoAkGoAQKoBAKkGAKkGAKQaAJBqAJBqAECqAUCqAQCpBgCkGgCkGgCQagCQagBAqgEAqQYAqQYApBoApBoAkGoAQKoBQKoBAKkGAKkGAKQaAJBqAJBqAECqAQCpBgCpBgCkGgCkGgCQagBAqgFAqgEAqQYAqQYApBoAkGoAkGoAQKoBQKoBAKkGAKQaAKQaAJBqAJBqAECqAQCpBgCpBgCkGgCQagCQagBAqgFAqgEAqQYApBoApBoAkGoAkGoAQKoBAKkGAKkGAKQaAKQaAJBqAECqAUCqAQCpBgCpBgCkGgCQagCQagBAqgFAqk0AAFINAEg1AEg1ACDVAIBUA4BUAwBSDQBSDQBINQAg1QAg1QCAVAOAVAMAUg0ASDUASDUAINUAINUAgFQDAFINAFINAEg1AEg1ACDVAIBUA4BUAwBSDQBINQBINQAg1QAg1QCAVAMAUg0AUg0ASDUASDUAINUAgFQDgFQDAFINAFINAEg1ACDVACDVAIBUA4BUAwBSDQBINQBINQAg1QCAVAOAVAMAUg0AUg0ASDUAINUAINUAgFQDgFQDAFINAEg1AEg1ACDVACDVAIBUAwBSDQBSDQBINQBINQAg1QCAVAOAVAMAUg0ASDUASDUAINUAINUAgFQDAFINAFINAEg1AEg1ACDVAIBUA4BUAwBSDQBSDQBINQAg1QAg1QCAVAOAVAMAUg0ASDUASDUAINUAgFQDgFQDAFINAFINAEg1ACDVACDVAIBUA4BUAwBSDQBINQBINQAg1QAg1QCAVAMAUg0AUg0ASDUASDUAINUAgFQDgFQDAFINAEg1AEg1ACDVACDVAIBUAwBSDQBSDQBINQBINQAg1QCAVAOAVAMAUg0AUg0ASDUAINUAINUAgFQDgFQDAFINAEg1AEg1ACDVAIBUA4BUAwBSDQBSDQBINQAg1QAg1QCAVAOAVAMAUg0ASDUASDUAINUAINUAgFQDAFINAFINAEg1AEg1ACDVAIBUA4BUAwBSDQBINQBINQAg1QAg1QCAVAMAUg0AUg0ASDUASDUAINUAgFQDgFQDAFINAFINAEg1ACDVACDVAIBUA4BUAwBSDQBINQBINQAg1QCAVAOAVAMAUg0AUg0ASDUAINUAINUAgFQDgFQDAFINAEg1AEg1ACDVACDVAIBUAwBSDQBSDQBINQBINQAg1QCAVAOAVAMAUg0ASDUASDUAINUAINUAgFQDAFINAFINAEg1AEg1ACDVAIBUA4BUAwBSDQBSDQBINQAg1QAg1QCAVAOAVAMA6znmnGMMQwC/aGsEuNgH6s4pR+IS5w8AAAAASUVORK5CYII="/><div class="t m0 x9 hd y2e ff5 fs5 fc0 sc0 ls0 ws0">2.<span class="_ _e"> </span>Preliminaries</div><div class="t m14 x0 h7 y2f ff2 fs5 fc0 sc0 ls0 ws0">and the medium elements<span class="_ _2"></span>.<span class="_ _4"> </span>Finally</div><div class="t m0 x8b h8 y2f ff4 fs6 fc0 sc0 ls0 ws0">q</div><div class="t m14 x8c h7 y2f ff2 fs5 fc0 sc0 ls0 ws0">separates the medium and large elements<span class="_ _2"></span>.<span class="_ _4"> </span>After recursively</div><div class="t m0 x0 h7 y30 ff2 fs5 fc0 sc0 ls0 ws0">sorting these three regions, the whole arra<span class="_ _2"></span>y is in order<span class="_ _6"></span>.</div><div class="t m1 xd h7 y31 ff2 fs5 fc0 sc0 ls0 ws0">Y<span class="_ _6"></span>aroslavskiy’s<span class="_ _8"> </span>partitioning<span class="_ _9"> </span>algorithm<span class="_ _9"> </span>is<span class="_ _9"> </span>an<span class="_ _9"> </span>asymmetric<span class="_ _9"> </span>generalization<span class="_ _9"> </span>of<span class="_ _9"> </span>Hoare’s<span class="_ _9"> </span>crossing</div><div class="t m25 x0 h7 y32 ff2 fs5 fc0 sc0 ls0 ws0">pointers technique:<span class="_ _b"> </span>The index pointers</div><div class="t m0 x70 h8 y32 ff4 fs6 fc0 sc0 ls0 ws0">k</div><div class="t m25 x41 h7 y32 ff2 fs5 fc0 sc0 ls0 ws0">and</div><div class="t m0 x8d h8 y32 ff4 fs6 fc0 sc0 ls0 ws0">g</div><div class="t m25 x8e h7 y32 ff2 fs5 fc0 sc0 ls0 ws0">start at the left and<span class="_ _5"> </span>right ends<span class="_ _2"></span>, respectively<span class="_ _6"></span>, and</div><div class="t m1 x0 h7 y33 ff2 fs5 fc0 sc0 ls0 ws0">are moved towards<span class="_ _5"> </span>each other until they cross<span class="_ _2"></span>.<span class="_ _4"> </span>Additionally<span class="_ _6"></span>, pointer</div><div class="t m0 x18 h1e y33 ffc fs4 fc0 sc0 ls0 ws0">`</div><div class="t m1 x8f h7 y33 ff2 fs5 fc0 sc0 ls0 ws0">marks the position of the</div><div class="t m0 x0 h7 y34 ff2 fs5 fc0 sc0 ls0 ws0">rightmost small element, such that the array is kept invariably in the following form:</div><div class="t m0 x90 h8 yd3 ff4 fs6 fc0 sc0 ls0 ws0">p<span class="_ _28"> </span>q</div><div class="t m0 x91 h8 yd4 ff3 fs2 fc0 sc0 ls0 ws0">&lt;<span class="_ _5"> </span><span class="ff4 fs6">p</span></div><div class="t m0 x92 h1e yd5 ffc fs4 fc0 sc0 ls0 ws0">`</div><div class="t m0 x4a h8 yd4 ff3 fs2 fc0 sc0 ls0 ws0">≥<span class="_ _21"> </span><span class="ff4 fs6">q</span></div><div class="t m0 x93 h8 yd6 ff4 fs6 fc0 sc0 ls0 ws0">g</div><div class="t m0 x70 h8 yd4 ff4 fs6 fc0 sc0 ls0 ws0">p<span class="_ _13"> </span><span class="ff3 fs2">≤<span class="_ _a"> </span>◦<span class="_ _13"> </span>≤<span class="_ _21"> </span></span>q</div><div class="t m0 x13 h8 yd7 ff4 fs6 fc0 sc0 ls0 ws0">k</div><div class="t m0 x94 h4 yd8 ff3 fs2 fc0 sc0 ls0 ws0">←<span class="_ _29"></span>→<span class="_ _2a"> </span>→</div><div class="t m0 x33 h7 yd9 ff2 fs5 fc0 sc0 ls0 ws0">?</div><div class="t m0 x0 h7 yda ff2 fs5 fc0 sc0 ls0 ws0">Our Algorithm 1 differs from Algorithm 3 of [Wild and Nebel, 2012] as follows:</div><div class="t m0 x49 h7 ydb ff2 fs5 fc0 sc0 ls0 ws0">•</div><div class="t m17 x3 h7 ydb ff2 fs5 fc0 sc0 ls0 ws0">F<span class="_ _2"></span>or lists of length less than</div><div class="t m0 x95 h8 ydb ff4 fs6 fc0 sc0 ls0 ws0">M</div><div class="t m17 x5 h7 ydb ff2 fs5 fc0 sc0 ls0 ws0">, we switch to<span class="_ _b"> </span>I<span class="_ _3"></span><span class="fs8">N<span class="_ _3"></span>S<span class="_ _3"></span>E<span class="_ _3"></span>R<span class="_ _3"></span>T<span class="_ _3"></span>I<span class="_ _3"></span>O<span class="_ _3"></span>N<span class="_ _3"></span></span>S<span class="_ _3"></span><span class="fs8">O<span class="_ _3"></span>R<span class="_ _3"></span>T<span class="_ _3"></span></span>.</div><div class="t m0 x96 hf ydc ff2 fsb fc0 sc0 ls0 ws0">5</div><div class="t m17 x97 h7 ydb ff2 fs5 fc0 sc0 ls0 ws0">A possible implementation is</div><div class="t m0 x3 h7 ydd ff2 fs5 fc0 sc0 ls0 ws0">given in Appendix B. The case<span class="_ _b"> </span><span class="ff4 fs6">M <span class="ff3 fs2">=<span class="_ _10"> </span></span></span><span class="fsa">1<span class="_ _16"> </span></span>corresponds to not using Insertionsort at all.</div><div class="t m0 x49 h7 yde ff2 fs5 fc0 sc0 ls0 ws0">•</div><div class="t m1 x3 h7 yde ff2 fs5 fc0 sc0 ls0 ws0">The<span class="_ _4"> </span>swap<span class="_ _4"> </span>of</div><div class="t m27 x61 h1c ydf ff7 fs19 fc0 sc0 ls0 ws0">A</div><div class="t m0 x98 he yde ff2 fsa fc0 sc0 ls0 ws0">[<span class="_ _3"></span><span class="ff4 fs6">k</span>]</div><div class="t m1 x99 h7 yde ff2 fs5 fc0 sc0 ls0 ws0">and</div><div class="t m27 x9a h1c ydf ff7 fs19 fc0 sc0 ls0 ws0">A</div><div class="t m0 x6c he yde ff2 fsa fc0 sc0 ls0 ws0">[<span class="_ _f"></span><span class="ff4 fs6">g</span>]</div><div class="t m1 x9b h7 yde ff2 fs5 fc0 sc0 ls0 ws0">has<span class="_ _4"> </span>been<span class="_ _8"> </span>moved<span class="_ _b"> </span>behind<span class="_ _8"> </span>the<span class="_ _4"> </span>check</div><div class="t m27 x97 h1c ydf ff7 fs19 fc0 sc0 ls0 ws0">A</div><div class="t m0 x18 he yde ff2 fsa fc0 sc0 ls0 ws0">[<span class="_ _f"></span><span class="ff4 fs6">g</span>] <span class="ff3 fs2">≥<span class="_ _16"> </span><span class="ff4 fs6">p</span></span></div><div class="t m1 x9c h7 yde ff2 fs5 fc0 sc0 ls0 ws0">.<span class="_ _1"> </span>Thereby<span class="_ _7"></span>,<span class="_ _8"> </span>we<span class="_ _4"> </span>never</div><div class="t m1 x3 h7 ye0 ff2 fs5 fc0 sc0 ls0 ws0">use<span class="_ _8"> </span>arra<span class="_ _2"></span>y<span class="_ _8"> </span>positions<span class="_ _4"> </span>in<span class="_ _8"> </span>a<span class="_ _8"> </span>key<span class="_ _4"> </span>comparison<span class="_ _8"> </span>after<span class="_ _4"> </span>we<span class="_ _8"> </span>have<span class="_ _4"> </span>overwritten<span class="_ _8"> </span>their<span class="_ _4"> </span>contents<span class="_ _8"> </span>in<span class="_ _8"> </span>one</div><div class="t m0 x3 h7 ye1 ff2 fs5 fc0 sc0 ls0 ws0">partitioning step; see F<span class="_ _0"></span>act 2.3 below<span class="_ _6"></span>.<span class="_ _4"> </span>(This is just to simplify discussions.)</div><div class="t m0 x49 h7 ye2 ff2 fs5 fc0 sc0 ls0 ws0">•</div><div class="t m1 x3 h7 ye2 ff2 fs5 fc0 sc0 ls0 ws0">The<span class="_ _b"> </span>comparison<span class="_ _b"> </span>in<span class="_ _b"> </span>line<span class="_ _b"> </span>15<span class="_ _b"> </span>has<span class="_ _b"> </span>been<span class="_ _b"> </span>made<span class="_ _b"> </span>non-strict.<span class="_ _11"> </span>F<span class="_ _2"></span>or<span class="_ _b"> </span>distinct<span class="_ _b"> </span>elements<span class="_ _b"> </span>this<span class="_ _b"> </span>makes<span class="_ _b"> </span>no</div><div class="t m25 x3 h7 ye3 ff2 fs5 fc0 sc0 ls0 ws0">difference, but<span class="_ _5"> </span>it drastically improves performance in case of many<span class="_ _5"> </span>equal keys [Wild,<span class="_ _5"> </span>2012,</div><div class="t m1 x3 h7 ye4 ff2 fs5 fc0 sc0 ls0 ws0">p.<span class="_ _10"> </span>54].<span class="_ _1"> </span>The<span class="_ _4"> </span>reader<span class="_ _4"> </span>might<span class="_ _8"> </span>ﬁnd<span class="_ _b"> </span>it<span class="_ _8"> </span>instructive<span class="_ _4"> </span>to<span class="_ _4"> </span>consider<span class="_ _4"> </span>the<span class="_ _8"> </span>behavior<span class="_ _b"> </span>on<span class="_ _8"> </span>an<span class="_ _b"> </span>array<span class="_ _4"> </span>with<span class="_ _8"> </span>all</div><div class="t m0 x3 h7 ye5 ff2 fs5 fc0 sc0 ls0 ws0">elements equal.</div><div class="t m25 xd h7 ye6 ff2 fs5 fc0 sc0 ls0 ws0">Note that partitioning an array<span class="_ _5"> </span>around two pivots is similar in nature to the<span class="_ _5"> </span><span class="ff4">Dutch National</span></div><div class="t m0 x0 h7 ye7 ff4 fs5 fc0 sc0 ls0 ws0">Flag Problem (DNFP) <span class="ff2">posed by Dijkstra [1976] as a programming exercise:</span></div><div class="t m1f x3 hd ye8 ff5 fs5 fc0 sc0 ls0 ws0">Given an array<span class="_ _5"> </span>of</div><div class="t m0 x40 h8 ye8 ff4 fs6 fc0 sc0 ls0 ws0">n</div><div class="t m1f x5b hd ye8 ff5 fs5 fc0 sc0 ls0 ws0">red, white and blue pebbles<span class="_ _2"></span>, rearrange them by<span class="_ _5"> </span>swaps<span class="_ _2"></span>, such that</div><div class="t m1c x3 hd ye9 ff5 fs5 fc0 sc0 ls0 ws0">the colors form the Dutch national ﬂag:<span class="_ _8"> </span>red, white and blue in contiguous regions.<span class="_ _4"> </span>Each</div><div class="t md x3 hd yea ff5 fs5 fc0 sc0 ls0 ws0">pebble may be inspected only once and only a constant amount of extra storage may be</div><div class="t m0 x3 hd yeb ff5 fs5 fc0 sc0 ls0 ws0">used.</div><div class="t m28 x0 h7 yec ff2 fs5 fc0 sc0 ls0 ws0">Dijkstra assumes an operation “buck” that tells us<span class="_ _b"> </span>an element’s color in one shot, so any algorithm</div><div class="t m1 x0 h7 yed ff2 fs5 fc0 sc0 ls0 ws0">must use exactly</div><div class="t m0 x28 h8 yed ff4 fs6 fc0 sc0 ls0 ws0">n</div><div class="t m1 x69 h7 yed ff2 fs5 fc0 sc0 ls0 ws0">buck-operations<span class="_ _2"></span>.<span class="_ _4"> </span>Performance differences<span class="_ _5"> </span>only concern the number of sw<span class="_ _2"></span>aps</div><div class="t m0 x0 h7 yee ff2 fs5 fc0 sc0 ls0 ws0">needed.</div><div class="t m1 xd h7 yef ff2 fs5 fc0 sc0 ls0 ws0">Interestingly<span class="_ _7"></span>,<span class="_ _b"> </span>Meyer gave<span class="_ _b"> </span>an algorithm<span class="_ _b"> </span>for the<span class="_ _b"> </span>DNFP which is<span class="_ _b"> </span>essentially<span class="_ _b"> </span>equivalent to<span class="_ _b"> </span>Y<span class="_ _6"></span>ar-</div><div class="t m1 x0 h7 yf0 ff2 fs5 fc0 sc0 ls0 ws0">oslavskiy’<span class="_ _2"></span>s<span class="_ _8"> </span>partitioning<span class="_ _8"> </span>method.<span class="_ _15"> </span>Indeed,<span class="_ _8"> </span>it<span class="_ _8"> </span>even<span class="_ _8"> </span>outperforms<span class="_ _8"> </span>the<span class="_ _4"> </span>algorithm<span class="_ _8"> </span>proposed<span class="_ _8"> </span>by<span class="_ _8"> </span>Dijk-</div><div class="t m2 x0 h7 yf1 ff2 fs5 fc0 sc0 ls0 ws0">stra [McMaster, 1978]!<span class="_ _b"> </span>Y<span class="_ _0"></span>et, the real advantage<span class="_ _5"> </span>of Y<span class="_ _6"></span>aroslavskiy’<span class="_ _2"></span>s partitioning scheme<span class="_ _a"> </span>—<span class="_ _a"> </span>the reduced</div><div class="t m29 x0 h7 yf2 ff2 fs5 fc0 sc0 ls0 ws0">expected number of key comparisons<span class="_ _a"> </span>—<span class="_ _13"> </span>is hidden by the atomic buck operation; its potential use in</div><div class="t m0 x0 h7 yf3 ff2 fs5 fc0 sc0 ls0 ws0">Quicksort went unnoticed.</div><div class="t m0 x0 h9 yf4 ff1 fs1 fc0 sc0 ls0 ws0">2.<span class="_ _d"> </span>Preliminaries</div><div class="t m1 x0 h7 yf5 ff2 fs5 fc0 sc0 ls0 ws0">In<span class="_ _b"> </span>this<span class="_ _b"> </span>section,<span class="_ _4"> </span>we<span class="_ _b"> </span>recall<span class="_ _b"> </span>elementary<span class="_ _b"> </span>deﬁnitions<span class="_ _4"> </span>and<span class="_ _b"> </span>collect<span class="_ _b"> </span>some<span class="_ _4"> </span>notation<span class="_ _b"> </span>and<span class="_ _b"> </span>basic<span class="_ _b"> </span>facts<span class="_ _4"> </span>used</div><div class="t m0 x0 h7 yf6 ff2 fs5 fc0 sc0 ls0 ws0">throughout this paper<span class="_ _6"></span>.</div><div class="t m1 xd h7 yf7 ff2 fs5 fc0 sc0 ls0 ws0">By</div><div class="t m0 x9d h1f yf7 ffd fs2 fc0 sc0 ls0 ws0">H</div><div class="t m0 x9e h14 yf8 ff4 fs11 fc0 sc0 ls0 ws0">n</div><div class="t m0 x9f he yf9 ff2 fsa fc0 sc0 ls0 ws0">:</div><div class="t m0 x80 h4 yf7 ff3 fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x81 h20 yfa ffe fs2 fc0 sc0 ls0 ws0">P</div><div class="t m0 xa0 h14 yfb ff4 fs11 fc0 sc0 ls0 ws0">n</div><div class="t m0 xa0 h21 yfc ff4 fs11 fc0 sc0 ls0 ws0">i<span class="ff3 fs1a">=<span class="ff2 fs1b">1</span></span></div><div class="t m0 xa1 he yf7 ff2 fsa fc0 sc0 ls0 ws0">1<span class="_ _10"> </span>/<span class="_ _13"> </span><span class="ff4 fs6">i</span></div><div class="t m1 x39 h7 yf7 ff2 fs5 fc0 sc0 ls0 ws0">,<span class="_ _b"> </span>we<span class="_ _4"> </span>denote<span class="_ _b"> </span>the</div><div class="t m0 x8c h8 yf7 ff4 fs6 fc0 sc0 ls0 ws0">n</div><div class="t m1 x92 h7 yf7 ff2 fs5 fc0 sc0 ls0 ws0">th<span class="_ _b"> </span><span class="ff4">Harmonic<span class="_ _b"> </span>Number</span>.<span class="_ _12"> </span>W<span class="_ _2"></span>e<span class="_ _b"> </span>use</div><div class="t m0 xa2 h1e yf7 ffc fs4 fc0 sc0 ls0 ws0">δ</div><div class="t m0 xa3 h14 yfd ff4 fs11 fc0 sc0 ls0 ws0">i<span class="_ _3"></span>j</div><div class="t m1 x23 h7 yf7 ff2 fs5 fc0 sc0 ls0 ws0">for<span class="_ _b"> </span>the<span class="_ _b"> </span><span class="ff4">Kronecker<span class="_ _b"> </span>delta</span>,</div><div class="t m1 x0 h7 yfe ff2 fs5 fc0 sc0 ls0 ws0">which<span class="_ _b"> </span>is<span class="_ _b"> </span>deﬁned<span class="_ _4"> </span>to<span class="_ _b"> </span>be</div><div class="t m0 x66 he yfe ff2 fsa fc0 sc0 ls0 ws0">1</div><div class="t m1 x5a h7 yfe ff2 fs5 fc0 sc0 ls0 ws0">if</div><div class="t m0 x56 h8 yfe ff4 fs6 fc0 sc0 ls0 ws0">i <span class="ff3 fs2">=<span class="_ _b"> </span></span>j</div><div class="t m1 x63 h7 yfe ff2 fs5 fc0 sc0 ls0 ws0">and</div><div class="t m0 xa4 he yfe ff2 fsa fc0 sc0 ls0 ws0">0</div><div class="t m1 x92 h7 yfe ff2 fs5 fc0 sc0 ls0 ws0">otherwise.<span class="_ _11"> </span>W<span class="_ _2"></span>e<span class="_ _b"> </span>deﬁne</div><div class="t m0 x94 he yfe ff4 fs6 fc0 sc0 ls0 ws0">x<span class="_ _f"></span><span class="ff2 fsa">ln(<span class="_ _3"></span></span>x<span class="ff2 fsa">)<span class="_ _21"> </span><span class="ff3 fs2">=<span class="_ _13"> </span></span>0</span></div><div class="t m1 xa5 h7 yfe ff2 fs5 fc0 sc0 ls0 ws0">for</div><div class="t m0 xa6 he yfe ff4 fs6 fc0 sc0 ls0 ws0">x<span class="_ _21"> </span><span class="ff3 fs2">=<span class="_ _13"> </span><span class="ff2 fsa">0</span></span></div><div class="t m1 xa7 h7 yfe ff2 fs5 fc0 sc0 ls0 ws0">,<span class="_ _4"> </span>so<span class="_ _b"> </span>that</div><div class="t m0 xa8 he yfe ff4 fs6 fc0 sc0 ls0 ws0">x<span class="_ _21"> </span><span class="ff3 fs2">7→<span class="_ _21"> </span></span>x<span class="_ _10"> </span><span class="ff2 fsa">ln(<span class="_ _3"></span></span>x<span class="ff2 fsa">)</span></div><div class="t m0 x0 h7 yff ff2 fs5 fc0 sc0 ls0 ws0">becomes a continuous function on <span class="fsa">[0<span class="fs6">,<span class="_ _f"></span><span class="ff3 fs2">∞</span></span>)</span>.</div><div class="t m1 xd h7 y100 ff2 fs5 fc0 sc0 ls0 ws0">The<span class="_ _4"> </span><span class="ff4">probability<span class="_ _4"> </span></span>of<span class="_ _4"> </span>an<span class="_ _8"> </span>event</div><div class="t m0 xa9 h8 y100 ff4 fs6 fc0 sc0 ls0 ws0">E</div><div class="t m1 x3d h7 y100 ff2 fs5 fc0 sc0 ls0 ws0">is<span class="_ _4"> </span>denoted<span class="_ _4"> </span>by</div><div class="t m0 xaa he y100 fff fs2 fc0 sc0 ls0 ws0">P<span class="ff2 fsa">[<span class="ff4 fs6">E<span class="_ _3"></span></span>]</span></div><div class="t m1 x32 h7 y100 ff2 fs5 fc0 sc0 ls0 ws0">and<span class="_ _4"> </span>we<span class="_ _4"> </span>write</div><div class="t m0 xab h22 y100 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 xac h23 y101 ff2 fs1a fc0 sc0 ls0 ws0">{<span class="ff4 fs11">E<span class="_ _3"></span></span>}</div><div class="t m1 x4f h7 y100 ff2 fs5 fc0 sc0 ls0 ws0">for<span class="_ _4"> </span>its<span class="_ _4"> </span><span class="ff4">indicator<span class="_ _4"> </span>random</span></div><div class="t m18 x0 h7 y102 ff4 fs5 fc0 sc0 ls0 ws0">variable<span class="ff2">, which is</span></div><div class="t m0 x7a he y102 ff2 fsa fc0 sc0 ls0 ws0">1</div><div class="t m18 x98 h7 y102 ff2 fs5 fc0 sc0 ls0 ws0">if the event occurs and</div><div class="t m0 xad he y102 ff2 fsa fc0 sc0 ls0 ws0">0</div><div class="t m18 xae h7 y102 ff2 fs5 fc0 sc0 ls0 ws0">otherwise.<span class="_ _b"> </span>F<span class="_ _2"></span>or a random variable</div><div class="t m0 x20 h8 y102 ff4 fs6 fc0 sc0 ls0 ws0">X</div><div class="t m18 xaf h7 y102 ff2 fs5 fc0 sc0 ls0 ws0">, let</div><div class="t m0 xb0 he y102 fff fs2 fc0 sc0 ls0 ws0">E<span class="ff2 fsa">[<span class="_ _3"></span><span class="ff4 fs6">X<span class="_ _10"> </span></span>]</span></div><div class="t m18 xb1 h7 y102 ff2 fs5 fc0 sc0 ls0 ws0">,</div><div class="t m0 xb2 he y102 ff2 fsa fc0 sc0 ls0 ws0">V<span class="_ _0"></span>ar(<span class="_ _3"></span><span class="ff4 fs6">X<span class="_ _10"> </span></span>)</div><div class="t m18 x0 h7 y103 ff2 fs5 fc0 sc0 ls0 ws0">and</div><div class="t m0 x57 he y103 ffd fs2 fc0 sc0 ls0 ws0">L<span class="_ _a"> </span><span class="ff2 fsa">(<span class="_ _3"></span><span class="ff4 fs6">X<span class="_ _10"> </span></span>)</span></div><div class="t m18 xb3 h7 y103 ff2 fs5 fc0 sc0 ls0 ws0">denote its <span class="ff4">expectation</span>, <span class="ff4">variance </span>and <span class="ff4">distribution</span>, respectively<span class="_ _7"></span>.</div><div class="t m0 xb4 h8 y103 ff4 fs6 fc0 sc0 ls0 ws0">X</div><div class="t m0 xb5 h24 y104 ffd fs1c fc0 sc0 ls0 ws0">D</div><div class="t m0 xb6 h8 y103 ff3 fs2 fc0 sc0 ls0 ws0">=<span class="_ _a"> </span><span class="ff4 fs6">Y</span></div><div class="t m18 x26 h7 y103 ff2 fs5 fc0 sc0 ls0 ws0">means that</div><div class="t m0 x45 h8 y103 ff4 fs6 fc0 sc0 ls0 ws0">X</div><div class="t m18 xb7 h7 y103 ff2 fs5 fc0 sc0 ls0 ws0">has</div><div class="t m0 x0 h7 y105 ff2 fs5 fc0 sc0 ls0 ws0">the <span class="ff4">same distribution </span>as <span class="ff4 fs6">Y<span class="_ _10"> </span></span>.</div><div class="t m0 xe h10 y106 ff2 fsc fc0 sc0 ls0 ws0">5</div><div class="t m1 xf hb y107 ff2 fs8 fc0 sc0 ls0 ws0">Note that even<span class="_ _5"> </span>if Sedgewick<span class="_ _5"> </span>[1977] proposes<span class="_ _5"> </span>to use<span class="_ _5"> </span>one ﬁnal<span class="_ _5"> </span>run of<span class="_ _5"> </span>Insertionsort over<span class="_ _5"> </span>the entire<span class="_ _5"> </span>input array<span class="_ _6"></span>,<span class="_ _5"> </span>modern</div><div class="t m0 x27 hb y108 ff2 fs8 fc0 sc0 ls0 ws0">cache hierarchies suggest to immediately sort small subarrays as done in our implementation.</div><div class="t m0 x11 h7 y2c ff2 fs5 fc0 sc0 ls0 ws0">5</div><a class="l" href="#pf4" data-dest-detail='[4,"XYZ",74.409,771.732,null]'><div class="d mf" style="border-style:none;position:absolute;left:242.336328px;bottom:1067.227639px;width:7.531000px;height:11.343000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf29" data-dest-detail='[41,"XYZ",49.503,319.429,null]'><div class="d mf" style="border-style:none;position:absolute;left:473.224185px;bottom:1067.227639px;width:73.225000px;height:11.343000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf29" data-dest-detail='[41,"XYZ",49.503,319.429,null]'><div class="d mf" style="border-style:none;position:absolute;left:602.191252px;bottom:1067.227639px;width:24.149000px;height:11.343000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf5" data-dest-detail='[5,"XYZ",82.38,159.03,null]'><div class="d mf" style="border-style:none;position:absolute;left:638.132564px;bottom:1034.056471px;width:6.700000px;height:12.866000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf1e" data-dest-detail='[30,"XYZ",74.409,299.715,null]'><div class="d mf" style="border-style:none;position:absolute;left:310.217445px;bottom:1013.973350px;width:9.186000px;height:11.342000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf7" data-dest-detail='[7,"XYZ",74.409,773.725,null]'><div class="d mf" style="border-style:none;position:absolute;left:371.452906px;bottom:940.484750px;width:15.841000px;height:11.342000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf29" data-dest-detail='[41,"XYZ",49.503,339.354,null]'><div class="d mf" style="border-style:none;position:absolute;left:786.875332px;bottom:887.079271px;width:23.930000px;height:11.342000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf29" data-dest-detail='[41,"XYZ",49.503,339.354,null]'><div class="d mf" style="border-style:none;position:absolute;left:833.109348px;bottom:887.079271px;width:24.503000px;height:11.342000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf28" data-dest-detail='[40,"XYZ",49.503,710.362,null]'><div class="d mf" style="border-style:none;position:absolute;left:368.190554px;bottom:793.615063px;width:40.188000px;height:11.417000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf28" data-dest-detail='[40,"XYZ",49.503,710.362,null]'><div class="d mf" style="border-style:none;position:absolute;left:442.581256px;bottom:793.615063px;width:24.149000px;height:11.417000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf29" data-dest-detail='[41,"XYZ",49.503,678.084,null]'><div class="d mf" style="border-style:none;position:absolute;left:163.576223px;bottom:566.644716px;width:47.724000px;height:11.343000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf29" data-dest-detail='[41,"XYZ",49.503,678.084,null]'><div class="d mf" style="border-style:none;position:absolute;left:249.371720px;bottom:566.644716px;width:23.706000px;height:11.343000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf29" data-dest-detail='[41,"XYZ",49.503,454.92,null]'><div class="d mf" style="border-style:none;position:absolute;left:247.582634px;bottom:246.801484px;width:41.536000px;height:11.184000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf29" data-dest-detail='[41,"XYZ",49.503,454.92,null]'><div class="d mf" style="border-style:none;position:absolute;left:322.564659px;bottom:246.801484px;width:20.072000px;height:11.184000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.679893,0.000000,0.000000,1.679893,0.000000,0.000000]}'></div></div>
