<div id="pf3" class="pf w0 h0" data-page-no="3"><div class="pc pc3 w0 h0"><img class="bi x0 y5b w3 h11" alt="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABAIAAADICAIAAAD9ftQjAAAACXBIWXMAABYlAAAWJQFJUiTwAAADoklEQVR42u3ZwQ2AIBBEUTF0YIkk9ERiQTRlliL0sIb3Spjbz5Qx7gPS670ZAQDgK6cJAABgNyUirAAAAFvxBgAAgAwAAABkAAAAIAMAAAAZAAAAyAAAAEAGAAAAMgAAAJABAACADAAAAGQAAAAgAwAAABkAAADIAAAAQAYAAAAyAAAAZAAAACADAAAAGQAAAMgAAABABgAAADIAAACQAQAAgAwAAABkAAAAIAMAAAAZAAAAyAAAAEAGAAAAMgAAAJABAAAgAwAAABkAAADIAAAAQAYAAAAyAAAAkAEAAIAMAAAAZAAAACADAAAAGQAAAMgAAABABgAAADIAAACQAQAAgAwAAAAZAAAAyAAAAEAGAAAAMgAAAJABAACADAAAAGQAAAAgAwAAABkAAADIAAAAQAYAAAAyAAAAkAEAAIAMAAAAZAAAAMgAAABABgAAADIAAACQAQAAgAwAAABkAAAAIAMAAAAZAAAAyAAAAEAGAAAAMgAAAJABAACADAAAAGQAAAAgAwAAQAYAAAAyAAAAkAEAAIAMAAAAZAAAACADAAAAGQAAAMgAAABABgAAADIAAACQAQAAgAwAAABkAAAAIAMAAAAZAAAAyAAAAJABAACADAAAAGQAAAAgAwAAABkAAADIAAAAQAYAAAAyAAAAkAEAAIAMAAAAZAAAACADAAAAGQAAAMgAAABABgAAgAwAAABkAAAAIAMAAAAZAAAAyAAAAEAGAAAAMgAAAJABAACADAAAAGQAAAAgAwAAABkAAADIAAAAQAYAAAAyAAAAZAAAACADAAAAGQAAAMgAAABABgAAADIAAACQAQAAgAwAAABkAAAAIAMAAAAZAAAAyAAAAEAGAAAAMgAAAJABAAAgAwAAABkAAADIAAAAQAYAAAAyAAAAkAEAAIAMAAAAZAAAACADAAAAGQAAAMgAAABABgAAADIAAACQAQAAgAwAAAAZAAAAyAAAAEAGAAAAMgAAAJABAACADAAAAGQAAACQRDUBAMAbz7yMwO94AwAAQAYAAAAyAAAAkAEAAIAMAAAAZAAAACADAAAAGQAAAMgAAABABgAAADIAAACQAQAAgAwAAABkAAAAIAMAAAAZAAAAMgAAAJABAACADAAAAGQAAAAgAwAAABkAAADIAAAAQAYAAAAyAAAAkAEAAIAMAAAAZAAAACADAAAAGQAAAMgAAACQAQAAgAwAAABkAAAAIAMAAAAZAAAAyAAAACCdBa/2CWOFv+YHAAAAAElFTkSuQmCC"/><div class="t m0 x0 h6 y31 ff1 fs3 fc0 sc0 ls0 ws0">C.<span class="_ _a"> </span>M.<span class="_ _8"> </span>Rysgaa<span class="_ _1"></span>rd,<span class="_ _8"> </span>S.<span class="_ _a"> </span>Wild.<span class="_ _13"> </span>3</div><div class="t m8 x0 h8 y5c ff8 fs4 fc0 sc0 ls0 ws0">comp<span class="_ _3"></span>etitiv<span class="_ _1"></span>e<span class="_ _7"> </span>with<span class="_ _7"> </span>B-trees<span class="_ _7"> </span>in<span class="_ _7"> </span>terms<span class="_ _7"> </span>of<span class="_ _7"> </span>their<span class="_ _e"> </span>I/O<span class="_ _7"> </span>eﬃciency<span class="_ _b"></span>,<span class="_ _7"> </span>thus<span class="_ _7"> </span>losing<span class="_ _7"> </span>their<span class="_ _e"> </span>adaptive<span class="_ _7"> </span>adv<span class="_ _b"></span>antages</div><div class="t m0 x4 h8 y5d ff8 fs4 fc0 sc0 ls0 ws0">when<span class="_ _6"> </span>data<span class="_ _9"> </span>resides<span class="_ _9"> </span>on<span class="_ _9"> </span>secondary<span class="_ _9"> </span>storage.</div><div class="t m17 x3 h8 y5e ff8 fs4 fc0 sc0 ls0 ws0">In<span class="_ _9"> </span>this<span class="_ _9"> </span>pap<span class="_ _3"></span>er,<span class="_ _6"> </span>we<span class="_ _6"> </span>present<span class="_ _6"> </span><span class="ff9">lazy<span class="_ _a"> </span>B-tr<span class="_ _1"></span>e<span class="_ _1"></span>es<span class="ff8">,<span class="_ _9"> </span>an<span class="_ _9"> </span>I/O-eﬃcient<span class="_ _6"> </span>v<span class="_ _1"></span>ariant<span class="_ _6"> </span>of<span class="_ _9"> </span>the<span class="_ _9"> </span>original<span class="_ _9"> </span>lazy<span class="_ _9"> </span>search</span></span></div><div class="t m8 x0 h8 y5f ff8 fs4 fc0 sc0 ls0 ws0">trees<span class="_ _7"> </span>[</div><div class="t m0 x54 h8 y5f ff8 fs4 fc0 sc0 ls0 ws0">44</div><div class="t m8 x57 h8 y5f ff8 fs4 fc0 sc0 ls0 ws0">].</div><div class="t m0 x58 h10 y60 ff13 fs9 fc0 sc0 ls0 ws0">2</div><div class="t m8 x39 h8 y5f ff8 fs4 fc0 sc0 ls0 ws0">Lazy<span class="_ _7"> </span>searc<span class="_ _1"></span>h<span class="_ _6"> </span>trees<span class="_ _7"> </span>consist<span class="_ _7"> </span>of<span class="_ _7"> </span>three<span class="_ _7"> </span>la<span class="_ _5"></span>y<span class="_ _1"></span>ers<span class="_ _6"> </span>(see<span class="_ _7"> </span>Figure<span class="_ _7"> </span>1).<span class="_ _4"> </span>The<span class="_ _7"> </span>topmost<span class="_ _7"> </span>la<span class="_ _1"></span>yer<span class="_ _7"> </span>consists</div><div class="t m3 x0 h8 y61 ff8 fs4 fc0 sc0 ls0 ws0">of<span class="_ _6"> </span>a<span class="_ _9"> </span>biased<span class="_ _9"> </span>search<span class="_ _6"> </span>tree<span class="_ _6"> </span>of<span class="_ _9"> </span><span class="ff9">gaps<span class="_ _a"> </span></span>(deﬁned<span class="_ _9"> </span>in<span class="_ _9"> </span>Section<span class="_ _6"> </span>1.2),<span class="_ _9"> </span>weigh<span class="_ _1"></span>ted<span class="_ _9"> </span>by<span class="_ _6"> </span>their<span class="_ _6"> </span>size.<span class="_ _4"> </span>The<span class="_ _9"> </span>second</div><div class="t m10 x0 h8 y62 ff8 fs4 fc0 sc0 ls0 ws0">la<span class="_ _1"></span>yer<span class="_ _6"> </span>consists,<span class="_ _9"> </span>for<span class="_ _9"> </span>each<span class="_ _6"> </span>gap<span class="_ _9"> </span><span class="ffc">∆</span></div><div class="t m0 x59 h10 y63 ff16 fs9 fc0 sc0 ls0 ws0">i</div><div class="t m10 x5a h8 y62 ff8 fs4 fc0 sc0 ls0 ws0">,<span class="_ _9"> </span>of<span class="_ _9"> </span>a<span class="_ _6"> </span>balanced<span class="_ _9"> </span>binary<span class="_ _9"> </span>search<span class="_ _6"> </span>tree<span class="_ _9"> </span>of</div><div class="t m0 x5b h8 y62 ffb fs4 fc0 sc0 ls0 ws0">O<span class="_ _3"></span><span class="ffc">(log<span class="_ _f"> </span></span>|<span class="ffc">∆</span></div><div class="t m0 x5c h10 y63 ff16 fs9 fc0 sc0 ls0 ws0">i</div><div class="t m0 x5d h8 y62 ffb fs4 fc0 sc0 ls0 ws0">|<span class="ffc">)</span></div><div class="t m10 x5e h8 y62 ff9 fs4 fc0 sc0 ls0 ws0">intervals</div><div class="t m0 x5f h8 y62 ffa fs4 fc0 sc0 ls0 ws0">I</div><div class="t m0 x45 h10 y63 ff16 fs9 fc0 sc0 ls0 ws0">i,j</div><div class="t m10 x60 h8 y62 ff8 fs4 fc0 sc0 ls0 ws0">.</div><div class="t m8 x0 h8 y64 ff8 fs4 fc0 sc0 ls0 ws0">In<span class="_ _1"></span>terv<span class="_ _1"></span>als<span class="_ _9"> </span>are<span class="_ _9"> </span>separated<span class="_ _9"> </span>by<span class="_ _6"> </span>splitter<span class="_ _9"> </span>elements<span class="_ _6"> </span>(pivots<span class="_ _6"> </span>as<span class="_ _9"> </span>in<span class="_ _9"> </span>Quic<span class="_ _1"></span>ksort),<span class="_ _9"> </span>but<span class="_ _9"> </span>are<span class="_ _9"> </span>unsorted<span class="_ _9"> </span>within.</div><div class="t m0 x4 h8 y65 ff8 fs4 fc0 sc0 ls0 ws0">The<span class="_ _6"> </span>third<span class="_ _9"> </span>lay<span class="_ _1"></span>er<span class="_ _9"> </span>represents<span class="_ _6"> </span>interv<span class="_ _b"></span>als<span class="_ _9"> </span>as<span class="_ _9"> </span>a<span class="_ _9"> </span>simple<span class="_ _9"> </span>unordered<span class="_ _9"> </span>list.</div><div class="t m18 x3 h8 y66 ff8 fs4 fc0 sc0 ls0 ws0">A<span class="_ _6"> </span>key<span class="_ _6"> </span>obstacle<span class="_ _9"> </span>to<span class="_ _6"> </span>external-memory<span class="_ _9"> </span>v<span class="_ _1"></span>ariants<span class="_ _6"> </span>of<span class="_ _6"> </span>lazy<span class="_ _9"> </span>search<span class="_ _6"> </span>trees<span class="_ _6"> </span>–<span class="_ _9"> </span>b<span class="_ _3"></span>oth<span class="_ _6"> </span>for<span class="_ _9"> </span>the<span class="_ _9"> </span>original</div><div class="t m1 x4 h8 y67 ff8 fs4 fc0 sc0 ls0 ws0">v<span class="_ _1"></span>ersion<span class="_ _a"> </span>[</div><div class="t m0 x61 h8 y67 ff8 fs4 fc0 sc0 ls0 ws0">44</div><div class="t m1 x62 h8 y67 ff8 fs4 fc0 sc0 ls0 ws0">]<span class="_ _9"> </span>and<span class="_ _a"> </span>for<span class="_ _9"> </span>optimal<span class="_ _a"> </span>lazy<span class="_ _a"> </span>searc<span class="_ _1"></span>h<span class="_ _a"> </span>trees<span class="_ _a"> </span>[</div><div class="t m0 x63 h8 y67 ff8 fs4 fc0 sc0 ls0 ws0">46</div><div class="t m1 x21 h8 y67 ff8 fs4 fc0 sc0 ls0 ws0">]<span class="_ _9"> </span>–<span class="_ _a"> </span>is<span class="_ _9"> </span>the<span class="_ _a"> </span>topmost<span class="_ _a"> </span>la<span class="_ _1"></span>yer. As<span class="_ _a"> </span>discussed<span class="_ _9"> </span>in</div><div class="t m6 x0 h8 y68 ff8 fs4 fc0 sc0 ls0 ws0">Section<span class="_ _9"> </span>1.3,<span class="_ _9"> </span>none<span class="_ _9"> </span>of<span class="_ _9"> </span>the<span class="_ _9"> </span>existing<span class="_ _9"> </span>data<span class="_ _9"> </span>structures<span class="_ _9"> </span>fully<span class="_ _9"> </span>solves<span class="_ _6"> </span>the<span class="_ _9"> </span>problem<span class="_ _9"> </span>of<span class="_ _9"> </span>how<span class="_ _6"> </span>to<span class="_ _9"> </span>design<span class="_ _9"> </span>a</div><div class="t m16 x0 h8 y69 ff8 fs4 fc0 sc0 ls0 ws0">general-purp<span class="_ _3"></span>ose<span class="_ _6"> </span><span class="ff9">external-memory<span class="_ _a"> </span>biase<span class="_ _1"></span>d<span class="_ _a"> </span>se<span class="_ _1"></span>ar<span class="_ _1"></span>ch<span class="_ _a"> </span>tr<span class="_ _1"></span>e<span class="_ _1"></span>e<span class="_ _a"> </span><span class="ff8">–<span class="_ _9"> </span>and<span class="_ _6"> </span>we<span class="_ _6"> </span>likewise<span class="_ _6"> </span>leav<span class="_ _1"></span>e<span class="_ _9"> </span>this<span class="_ _9"> </span>as<span class="_ _9"> </span>an<span class="_ _9"> </span>op<span class="_ _3"></span>en</span></span></div><div class="t m19 x0 h8 y6a ff8 fs4 fc0 sc0 ls0 ws0">problem<span class="_ _9"> </span>for<span class="_ _9"> </span>future<span class="_ _9"> </span>w<span class="_ _5"></span>ork.<span class="_ _4"> </span>Ho<span class="_ _1"></span>wev<span class="_ _1"></span>er,<span class="_ _9"> </span>we<span class="_ _6"> </span>show<span class="_ _6"> </span>that<span class="_ _9"> </span>for<span class="_ _9"> </span>a<span class="_ _9"> </span>slightly<span class="_ _6"> </span>restricted<span class="_ _9"> </span>set<span class="_ _9"> </span>of<span class="_ _9"> </span>p<span class="_ _3"></span>erformance</div><div class="t m17 x0 h8 y6b ff8 fs4 fc0 sc0 ls0 ws0">guaran<span class="_ _1"></span>tees<span class="_ _a"> </span>suﬃcien<span class="_ _1"></span>t<span class="_ _9"> </span>for<span class="_ _9"> </span>lazy<span class="_ _a"> </span>searc<span class="_ _1"></span>h<span class="_ _9"> </span>trees,<span class="_ _a"> </span>a<span class="_ _9"> </span>(to<span class="_ _9"> </span>our<span class="_ _9"> </span>knowledge)<span class="_ _6"> </span>nov<span class="_ _1"></span>el<span class="_ _9"> </span>construction<span class="_ _9"> </span>based<span class="_ _9"> </span>on</div><div class="t m5 x0 h8 y6c ff8 fs4 fc0 sc0 ls0 ws0">partitioning<span class="_ _6"> </span>elements<span class="_ _6"> </span>by<span class="_ _6"> </span><span class="ff9">weight<span class="_ _8"> </span></span>with<span class="_ _9"> </span>doubly-exp<span class="_ _3"></span>onen<span class="_ _1"></span>tially<span class="_ _9"> </span>increasing<span class="_ _9"> </span>buck<span class="_ _1"></span>et<span class="_ _9"> </span>sizes<span class="_ _9"> </span>provides</div><div class="t m1 x0 h8 y6d ff8 fs4 fc0 sc0 ls0 ws0">an<span class="_ _6"> </span>I/O-eﬃcient<span class="_ _6"> </span>solution.<span class="_ _4"> </span>This<span class="_ _9"> </span>forms<span class="_ _9"> </span>the<span class="_ _9"> </span>basis<span class="_ _9"> </span>of<span class="_ _9"> </span>our<span class="_ _9"> </span>lazy<span class="_ _9"> </span>B-trees,<span class="_ _9"> </span>whic<span class="_ _1"></span>h<span class="_ _9"> </span>ﬁnally<span class="_ _9"> </span>bring<span class="_ _9"> </span>the</div><div class="t m0 x0 h8 y6e ff8 fs4 fc0 sc0 ls0 ws0">adaptiv<span class="_ _1"></span>e<span class="_ _9"> </span>versatilit<span class="_ _1"></span>y<span class="_ _9"> </span>of<span class="_ _9"> </span>lazy<span class="_ _9"> </span>search<span class="_ _6"> </span>trees<span class="_ _9"> </span>to<span class="_ _9"> </span>external<span class="_ _9"> </span>memory<span class="_ _b"></span>.</div><div class="t m0 x0 h7 y6f ff1 fs1 fc0 sc0 ls0 ws0">1.1<span class="_ _14"> </span>The<span class="_ _4"> </span>External-Memo<span class="_ _1"></span>ry<span class="_ _4"> </span>Mo<span class="_ _3"></span>del</div><div class="t m8 x0 h8 y70 ff8 fs4 fc0 sc0 ls0 ws0">In<span class="_ _6"> </span>this<span class="_ _9"> </span>pap<span class="_ _3"></span>er<span class="_ _9"> </span>we<span class="_ _6"> </span>study<span class="_ _9"> </span>the<span class="_ _9"> </span>sorted<span class="_ _9"> </span>dictionary<span class="_ _9"> </span>problem<span class="_ _6"> </span>in<span class="_ _9"> </span>a<span class="_ _9"> </span>hierarchical-memory<span class="_ _6"> </span>mo<span class="_ _3"></span>del,<span class="_ _9"> </span>where</div><div class="t m18 x4 h8 y71 ff8 fs4 fc0 sc0 ls0 ws0">w<span class="_ _1"></span>e<span class="_ _9"> </span>hav<span class="_ _1"></span>e<span class="_ _9"> </span>an<span class="_ _9"> </span>unbounded<span class="_ _6"> </span>external<span class="_ _9"> </span>memory<span class="_ _9"> </span>and<span class="_ _9"> </span>an<span class="_ _9"> </span>in<span class="_ _5"></span>ternal<span class="_ _6"> </span>memory<span class="_ _9"> </span>of<span class="_ _9"> </span>capacity</div><div class="t m0 x34 h8 y71 ffa fs4 fc0 sc0 ls0 ws0">M</div><div class="t m18 x64 h8 y71 ff8 fs4 fc0 sc0 ls0 ws0">elemen<span class="_ _1"></span>ts,</div><div class="t m1 x0 h8 y72 ff8 fs4 fc0 sc0 ls0 ws0">and<span class="_ _a"> </span>where<span class="_ _8"> </span>data<span class="_ _8"> </span>is<span class="_ _a"> </span>transferred<span class="_ _8"> </span>betw<span class="_ _1"></span>een<span class="_ _8"> </span>the<span class="_ _a"> </span>internal<span class="_ _a"> </span>and<span class="_ _8"> </span>external<span class="_ _a"> </span>memory<span class="_ _8"> </span>in<span class="_ _8"> </span>blocks<span class="_ _a"> </span>of</div><div class="t m0 x35 h8 y72 ffa fs4 fc0 sc0 ls0 ws0">B</div><div class="t mb x0 h8 y73 ff8 fs4 fc0 sc0 ls0 ws0">consecutiv<span class="_ _1"></span>e<span class="_ _9"> </span>elements.<span class="_ _4"> </span>A<span class="_ _6"> </span>blo<span class="_ _3"></span>ck<span class="_ _6"> </span>transfer<span class="_ _9"> </span>is<span class="_ _6"> </span>called<span class="_ _9"> </span>an<span class="_ _9"> </span><span class="ff9">I/O<span class="_ _8"> </span></span>(input/output<span class="_ _9"> </span>op<span class="_ _3"></span>eration).<span class="_ _4"> </span>The<span class="_ _6"> </span>I/O</div><div class="t m1a x0 h8 y74 ff8 fs4 fc0 sc0 ls0 ws0">cost<span class="_ _9"> </span>of<span class="_ _9"> </span>an<span class="_ _6"> </span>algorithm<span class="_ _9"> </span>is<span class="_ _9"> </span>the<span class="_ _9"> </span>num<span class="_ _1"></span>b<span class="_ _3"></span>er<span class="_ _9"> </span>of<span class="_ _9"> </span>I/Os<span class="_ _9"> </span>it<span class="_ _9"> </span>p<span class="_ _3"></span>erforms.<span class="_ _4"> </span>Aggarw<span class="_ _1"></span>al<span class="_ _9"> </span>and<span class="_ _9"> </span>Vitter<span class="_ _9"> </span>[</div><div class="t m0 x65 h8 y74 ff8 fs4 fc0 sc0 ls0 ws0">2</div><div class="t m1a x66 h8 y74 ff8 fs4 fc0 sc0 ls0 ws0">]<span class="_ _9"> </span>in<span class="_ _1"></span>tro<span class="_ _3"></span>duced</div><div class="t m1b x0 h8 y75 ff8 fs4 fc0 sc0 ls0 ws0">this<span class="_ _9"> </span>as<span class="_ _9"> </span>the<span class="_ _9"> </span><span class="ff9">external-memory<span class="_ _a"> </span>mo<span class="_ _1"></span>del<span class="_ _4"> </span><span class="ff8">(and<span class="_ _6"> </span>prov<span class="_ _1"></span>ed,<span class="_ _9"> </span>e.g.,<span class="_ _9"> </span>low<span class="_ _1"></span>er<span class="_ _9"> </span>b<span class="_ _3"></span>ounds<span class="_ _9"> </span>for<span class="_ _9"> </span>sorting<span class="_ _9"> </span>in<span class="_ _9"> </span>the<span class="_ _9"> </span>mo<span class="_ _3"></span>del).</span></span></div><div class="t m0 x0 h7 y76 ff1 fs1 fc0 sc0 ls0 ws0">1.2<span class="_ _14"> </span>Lazy<span class="_ _4"> </span>Sea<span class="_ _1"></span>rch<span class="_ _4"> </span>T<span class="_ _11"></span>rees</div><div class="t m1 x0 h8 y77 ff8 fs4 fc0 sc0 ls0 ws0">In<span class="_ _4"> </span>this<span class="_ _8"> </span>section<span class="_ _4"> </span>we<span class="_ _8"> </span>brieﬂy<span class="_ _4"> </span>describ<span class="_ _3"></span>e<span class="_ _4"> </span>lazy<span class="_ _8"> </span>search<span class="_ _8"> </span>trees<span class="_ _4"> </span>[</div><div class="t m0 xa h8 y77 ff8 fs4 fc0 sc0 ls0 ws0">44</div><div class="t m1 x67 h8 y77 ff8 fs4 fc0 sc0 ls0 ws0">].<span class="_ _15"> </span>Lazy<span class="_ _4"> </span>searc<span class="_ _1"></span>h<span class="_ _4"> </span>trees<span class="_ _4"> </span>support<span class="_ _4"> </span>all</div><div class="t m1 x0 h8 y78 ff8 fs4 fc0 sc0 ls0 ws0">op<span class="_ _3"></span>erations<span class="_ _4"> </span>of<span class="_ _4"> </span>a dynamic<span class="_ _4"> </span>sorted<span class="_ _4"> </span>dictionary<span class="_ _4"> </span>(details<span class="_ _4"> </span>in [</div><div class="t m0 xb h8 y78 ff8 fs4 fc0 sc0 ls0 ws0">44</div><div class="t m1 x68 h8 y78 ff8 fs4 fc0 sc0 ls0 ws0">]).<span class="_ _16"> </span>W<span class="_ _b"></span>e<span class="_ _4"> </span>consider<span class="_ _4"> </span>the follo<span class="_ _1"></span>wing</div><div class="t m0 x0 h8 y79 ff8 fs4 fc0 sc0 ls0 ws0">op<span class="_ _3"></span>erations<span class="_ _6"> </span>(suﬃcient<span class="_ _6"> </span>to<span class="_ _9"> </span>base<span class="_ _9"> </span>a<span class="_ _9"> </span>full<span class="_ _9"> </span>implementation<span class="_ _6"> </span>on):</div><div class="t m0 x0 h8 y7a ff17 fs4 fc1 sc0 ls0 ws0">Constr<span class="_ _1"></span>uct<span class="ff18">(<span class="ff19">S<span class="_ _c"></span></span>)<span class="ff1">:<span class="_ _17"> </span><span class="ff8 fc0">Constructs<span class="_ _6"> </span>the<span class="_ _9"> </span>data<span class="_ _9"> </span>structure<span class="_ _9"> </span>from<span class="_ _9"> </span>the<span class="_ _9"> </span>elements<span class="_ _6"> </span>of<span class="_ _9"> </span>set<span class="_ _9"> </span><span class="ffa">S<span class="_ _c"></span></span>.</span></span></span></div><div class="t m0 x69 h10 y7b ff13 fs9 fc0 sc0 ls0 ws0">3</div><div class="t m0 x0 h8 y7c ff17 fs4 fc1 sc0 ls0 ws0">Inser<span class="_ _11"></span>t<span class="ff18">(<span class="ff19">e</span>)<span class="ff1">:<span class="_ _4"> </span><span class="ff8 fc0">Adds<span class="_ _6"> </span>element<span class="_ _6"> </span><span class="ffa">e<span class="_ _9"> </span></span>to<span class="_ _9"> </span>the<span class="_ _9"> </span>set.</span></span></span></div><div class="t m0 x0 h8 y7d ff17 fs4 fc1 sc0 ls0 ws0">Delete<span class="ff18">(<span class="ff1a">ptr<span class="_ _c"></span></span>)<span class="ff1">:<span class="_ _17"> </span><span class="ff8 fc0">Deletes<span class="_ _9"> </span>the<span class="_ _9"> </span>element<span class="_ _6"> </span>at<span class="_ _9"> </span>p<span class="_ _3"></span>oin<span class="_ _1"></span>ter<span class="_ _9"> </span><span class="ff1b">ptr<span class="_ _4"> </span></span>from<span class="_ _6"> </span>the<span class="_ _9"> </span>set.</span></span></span></div><div class="t m0 x0 h8 y7e ff17 fs4 fc1 sc0 ls0 ws0">ChangeKey<span class="ff18">(<span class="ff1a">ptr<span class="_ _10"> </span><span class="ff19">,<span class="_ _f"> </span>e</span></span></span></div><div class="t m0 x6a h12 y7f ff1c fs9 fc1 sc0 ls0 ws0">′</div><div class="t m0 x6b h8 y7e ff18 fs4 fc1 sc0 ls0 ws0">)<span class="ff1">:<span class="_ _17"> </span><span class="ff8 fc0">Changes<span class="_ _6"> </span>the<span class="_ _9"> </span>element<span class="_ _6"> </span><span class="ffa">e<span class="_ _9"> </span></span>at<span class="_ _9"> </span>p<span class="_ _3"></span>oin<span class="_ _1"></span>ter<span class="_ _9"> </span><span class="ff1b">ptr<span class="_ _4"> </span></span>to<span class="_ _9"> </span><span class="ffa">e</span></span></span></div><div class="t m0 x6c h10 y7f ff1d fs9 fc0 sc0 ls0 ws0">′</div><div class="t m0 x6d h8 y7e ff8 fs4 fc0 sc0 ls0 ws0">.</div><div class="t m0 x0 h8 y80 ff17 fs4 fc1 sc0 ls0 ws0">Quer<span class="_ _11"></span>yElement<span class="ff18">(<span class="ff19">e</span>)<span class="ff1">:</span></span></div><div class="t m4 x6e h8 y80 ff8 fs4 fc0 sc0 ls0 ws0">Lo<span class="_ _3"></span>cates<span class="_ _6"> </span>the<span class="_ _9"> </span>predecessor</div><div class="t m0 x6f h8 y80 ffa fs4 fc0 sc0 ls0 ws0">e</div><div class="t m0 x70 h10 y81 ff1d fs9 fc0 sc0 ls0 ws0">′</div><div class="t m4 x51 h8 y80 ff8 fs4 fc0 sc0 ls0 ws0">to<span class="_ _9"> </span>elemen<span class="_ _5"></span>t</div><div class="t m0 x71 h8 y80 ffa fs4 fc0 sc0 ls0 ws0">e</div><div class="t m4 x72 h8 y80 ff8 fs4 fc0 sc0 ls0 ws0">in<span class="_ _9"> </span>the<span class="_ _9"> </span>set,<span class="_ _9"> </span>and<span class="_ _9"> </span>returns<span class="_ _9"> </span>rank</div><div class="t m0 x3 h8 y82 ffa fs4 fc0 sc0 ls0 ws0">r<span class="_ _a"> </span><span class="ff8">of<span class="_ _6"> </span></span>e</div><div class="t m0 x73 h10 y83 ff1d fs9 fc0 sc0 ls0 ws0">′</div><div class="t m0 x74 h8 y82 ff8 fs4 fc0 sc0 ls0 ws0">,<span class="_ _6"> </span>and<span class="_ _9"> </span>a<span class="_ _9"> </span>p<span class="_ _3"></span>ointer<span class="_ _6"> </span>to<span class="_ _9"> </span><span class="ffa">e</span></div><div class="t m0 x75 h10 y83 ff1d fs9 fc0 sc0 ls0 ws0">′</div><div class="t m0 x4c h8 y82 ff8 fs4 fc0 sc0 ls0 ws0">.</div><div class="t m0 x0 h8 y84 ff17 fs4 fc1 sc0 ls0 ws0">Quer<span class="_ _11"></span>yRank<span class="ff18">(<span class="ff19">r<span class="_ _3"></span></span>)<span class="ff1">:</span></span></div><div class="t m8 x76 h8 y84 ff8 fs4 fc0 sc0 ls0 ws0">Lo<span class="_ _3"></span>cates<span class="_ _6"> </span>the<span class="_ _a"> </span>elemen<span class="_ _1"></span>t</div><div class="t m0 x77 h8 y84 ffa fs4 fc0 sc0 ls0 ws0">e</div><div class="t m8 x78 h8 y84 ff8 fs4 fc0 sc0 ls0 ws0">with<span class="_ _9"> </span>rank</div><div class="t m0 x79 h8 y84 ffa fs4 fc0 sc0 ls0 ws0">r</div><div class="t m8 x7a h8 y84 ff8 fs4 fc0 sc0 ls0 ws0">in<span class="_ _9"> </span>the<span class="_ _9"> </span>set,<span class="_ _9"> </span>and<span class="_ _9"> </span>returns<span class="_ _9"> </span>a<span class="_ _a"> </span>p<span class="_ _3"></span>oin<span class="_ _1"></span>ter<span class="_ _9"> </span>to</div><div class="t m0 x7b h8 y84 ffa fs4 fc0 sc0 ls0 ws0">e</div><div class="t m8 x60 h8 y84 ff8 fs4 fc0 sc0 ls0 ws0">.</div><div class="t m8 x3 h8 y85 ff8 fs4 fc0 sc0 ls0 ws0">Lazy<span class="_ _6"> </span>search<span class="_ _7"> </span>trees<span class="_ _9"> </span>maintain<span class="_ _7"> </span>the<span class="_ _9"> </span>elements<span class="_ _7"> </span>of<span class="_ _9"> </span>the<span class="_ _6"> </span>set<span class="_ _9"> </span>partitioned<span class="_ _6"> </span>into</div><div class="t m0 x12 h8 y85 ffa fs4 fc0 sc0 ls0 ws0">G</div><div class="t m8 x7c h8 y85 ff9 fs4 fc0 sc0 ls0 ws0">“gaps”<span class="ff8">,<span class="_ _6"> </span><span class="ffc">∆</span></span></div><div class="t m0 x7d h10 y86 ff14 fs9 fc0 sc0 ls0 ws0">1</div><div class="t m0 x7e h8 y85 ffa fs4 fc0 sc0 ls0 ws0">,<span class="_ _f"> </span>.<span class="_ _f"> </span>.<span class="_ _f"> </span>.<span class="_ _f"> </span>,</div><div class="t m8 x7f h8 y85 ffc fs4 fc0 sc0 ls0 ws0">∆</div><div class="t m0 x80 h10 y86 ff16 fs9 fc0 sc0 ls0 ws0">G</div><div class="t m8 x60 h8 y85 ff8 fs4 fc0 sc0 ls0 ws0">.</div><div class="t md x4 h8 y87 ff8 fs4 fc0 sc0 ls0 ws0">All<span class="_ _9"> </span>elemen<span class="_ _1"></span>ts<span class="_ _a"> </span>in<span class="_ _6"> </span><span class="ffc">∆</span></div><div class="t m0 x81 h10 y88 ff16 fs9 fc0 sc0 ls0 ws0">i</div><div class="t md x82 h8 y87 ff8 fs4 fc0 sc0 ls0 ws0">are<span class="_ _9"> </span>w<span class="_ _1"></span>eakly<span class="_ _a"> </span>smaller<span class="_ _6"> </span>than<span class="_ _9"> </span>all<span class="_ _a"> </span>elemen<span class="_ _1"></span>ts<span class="_ _9"> </span>in<span class="_ _9"> </span><span class="ffc">∆</span></div><div class="t m0 x83 h10 y88 ff16 fs9 fc0 sc0 ls0 ws0">i<span class="ff14">+1</span></div><div class="t md x84 h8 y87 ff8 fs4 fc0 sc0 ls0 ws0">,<span class="_ _9"> </span>but<span class="_ _9"> </span>the<span class="_ _9"> </span>gaps<span class="_ _9"> </span>are<span class="_ _9"> </span>otherwise</div><div class="t m1 x0 h8 y89 ff8 fs4 fc0 sc0 ls0 ws0">treated<span class="_ _a"> </span>as<span class="_ _8"> </span>unsorted<span class="_ _a"> </span>bags.<span class="_ _18"> </span>Boundaries<span class="_ _a"> </span>b<span class="_ _3"></span>etw<span class="_ _1"></span>een<span class="_ _a"> </span>gaps<span class="_ _8"> </span>(and<span class="_ _a"> </span>new<span class="_ _8"> </span>gaps)<span class="_ _a"> </span>are<span class="_ _a"> </span>introduced<span class="_ _8"> </span>only</div><div class="t m1 x4 h8 y8a ff8 fs4 fc0 sc0 ls0 ws0">via<span class="_ _8"> </span>a<span class="_ _a"> </span>query;<span class="_ _4"> </span>initially<span class="_ _a"> </span>we<span class="_ _a"> </span>hav<span class="_ _1"></span>e<span class="_ _8"> </span>a<span class="_ _8"> </span>single<span class="_ _a"> </span>gap<span class="_ _8"> </span><span class="ffc">∆</span></div><div class="t m0 x85 h10 y8b ff14 fs9 fc0 sc0 ls0 ws0">1</div><div class="t m1 x63 h8 y8a ff8 fs4 fc0 sc0 ls0 ws0">.<span class="_ _2"> </span>Ev<span class="_ _5"></span>ery<span class="_ _8"> </span>query<span class="_ _a"> </span>is<span class="_ _8"> </span>asso<span class="_ _3"></span>ciated<span class="_ _a"> </span>with<span class="_ _8"> </span>its<span class="_ _8"> </span><span class="ff9">query</span></div><div class="t m0 x4 h9 y8c ff15 fs5 fc0 sc0 ls0 ws0">2</div><div class="t m17 x15 ha y8d ff5 fs6 fc0 sc0 ls0 ws0">The<span class="_ _7"> </span>follow-up<span class="_ _7"> </span>w<span class="_ _5"></span>ork<span class="_ _7"> </span>[</div><div class="t m0 x86 ha y8d ff5 fs6 fc0 sc0 ls0 ws0">46</div><div class="t m17 x8 ha y8d ff5 fs6 fc0 sc0 ls0 ws0">]<span class="_ _7"> </span>replaces<span class="_ _7"> </span>the<span class="_ _6"> </span>second<span class="_ _7"> </span>and<span class="_ _6"> </span>third<span class="_ _7"> </span>lay<span class="_ _1"></span>er<span class="_ _6"> </span>using<span class="_ _7"> </span><span class="ff6">sele<span class="_ _1"></span>ctable<span class="_ _9"> </span>priority<span class="_ _6"> </span>queues<span class="_ _3"></span><span class="ff5">;<span class="_ _7"> </span>we<span class="_ _7"> </span>discuss</span></span></div><div class="t m0 x15 ha y8e ff5 fs6 fc0 sc0 ls0 ws0">why<span class="_ _7"> </span>these<span class="_ _7"> </span>are<span class="_ _7"> </span>challenging<span class="_ _7"> </span>to<span class="_ _7"> </span>mak<span class="_ _1"></span>e<span class="_ _6"> </span>external<span class="_ _7"> </span>in<span class="_ _7"> </span>Section<span class="_ _6"> </span>1.4.</div><div class="t m0 x4 h9 y8f ff15 fs5 fc0 sc0 ls0 ws0">3</div><div class="t m1 x15 ha y2e ff1e fs6 fc0 sc0 ls0 ws0">Construct<span class="_ _9"> </span><span class="ff5">and<span class="_ _a"> </span>iterativ<span class="_ _5"></span>e<span class="_ _9"> </span>insertion<span class="_ _a"> </span>hav<span class="_ _1"></span>e<span class="_ _a"> </span>the<span class="_ _a"> </span>same<span class="_ _a"> </span>complexity<span class="_ _9"> </span>in<span class="_ _9"> </span>internal<span class="_ _9"> </span>memory<span class="_ _1"></span>,<span class="_ _a"> </span>but<span class="_ _a"> </span>in<span class="_ _a"> </span>external</span></div><div class="t m0 x16 ha y2f ff5 fs6 fc0 sc0 ls0 ws0">memory<span class="_ _b"></span>,<span class="_ _7"> </span>the<span class="_ _7"> </span>bulk<span class="_ _6"> </span>op<span class="_ _3"></span>eration<span class="_ _7"> </span>can<span class="_ _7"> </span>b<span class="_ _3"></span>e<span class="_ _7"> </span>supp<span class="_ _3"></span>orted<span class="_ _7"> </span>more<span class="_ _7"> </span>eﬃciently<span class="_ _11"></span>.</div><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",99.071,301.861,null]'><div class="d m11" style="border-style:none;position:absolute;left:202.142157px;bottom:1092.189542px;width:11.955000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf3" data-dest-detail='[3,"XYZ",107.593,127.592,null]'><div class="d m11" style="border-style:none;position:absolute;left:227.284314px;bottom:1088.120915px;width:6.462000px;height:12.490000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf2" data-dest-detail='[2,"XYZ",116.079,724.775,null]'><div class="d m11" style="border-style:none;position:absolute;left:549.006536px;bottom:1088.120915px;width:37.203000px;height:12.490000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf3" data-dest-detail='[3,"XYZ",99.071,371.765,null]'><div class="d m11" style="border-style:none;position:absolute;left:463.934641px;bottom:1066.957516px;width:50.119000px;height:11.955000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",99.071,301.861,null]'><div class="d m11" style="border-style:none;position:absolute;left:221.179739px;bottom:965.107843px;width:11.955000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",99.071,252.297,null]'><div class="d m11" style="border-style:none;position:absolute;left:497.854575px;bottom:965.107843px;width:11.955000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4" data-dest-detail='[4,"XYZ",116.079,265.759,null]'><div class="d m11" style="border-style:none;position:absolute;left:160.253268px;bottom:940.779412px;width:49.326000px;height:10.793000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",99.071,409.306,null]'><div class="d m11" style="border-style:none;position:absolute;left:715.011438px;bottom:654.305556px;width:6.974000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",99.071,301.861,null]'><div class="d m11" style="border-style:none;position:absolute;left:553.866013px;bottom:555.127451px;width:11.955000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",99.071,301.861,null]'><div class="d m11" style="border-style:none;position:absolute;left:569.826797px;bottom:533.965686px;width:11.955000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf3" data-dest-detail='[3,"XYZ",107.593,107.937,null]'><div class="d m11" style="border-style:none;position:absolute;left:710.277778px;bottom:470.647059px;width:6.461000px;height:12.490000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",99.071,252.297,null]'><div class="d m11" style="border-style:none;position:absolute;left:302.380719px;bottom:191.390523px;width:10.696000px;height:7.351000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf6" data-dest-detail='[6,"XYZ",116.079,335.629,null]'><div class="d m11" style="border-style:none;position:absolute;left:464.098039px;bottom:171.285948px;width:43.579000px;height:10.666000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.633987,0.000000,0.000000,1.633987,0.000000,0.000000]}'></div></div>
