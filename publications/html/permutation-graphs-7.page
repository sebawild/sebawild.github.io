<div id="pf7" class="pf w0 h0" data-page-no="7"><div class="pc pc7 w0 h0"><img class="bi x0 y13b w2 h1" alt="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA34AAAABCAIAAAAO1+vKAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAHElEQVRIx+3BMQEAAAzDoPq3nGcq9gGrBgAA/w7aJgLyLrSq2gAAAABJRU5ErkJggg=="/><div class="t m0 x0 h7 y2d ffc fs3 fc0 sc0 ls0 ws0">2 Preliminaries<span class="_ _3a"> </span><span class="ff4">7</span></div><div class="t m3 x19 h7 y2e ff4 fs3 fc0 sc0 ls0 ws0">Giv<span class="_ _2"></span>en<span class="_ _b"> </span>an<span class="_ _7"> </span>array</div><div class="t m0 x36 h7 y2e ff5 fs3 fc0 sc0 ls0 ws0">A</div><div class="t m3 xe3 h7 y2e ff6 fs3 fc0 sc0 ls0 ws0">[1</div><div class="t m0 xff h7 y2e ff5 fs3 fc0 sc0 ls0 ws0">..n</div><div class="t m3 xeb h7 y2e ff6 fs3 fc0 sc0 ls0 ws0">]<span class="_ _7"> </span><span class="ff4">of<span class="_ _b"> </span>comparable<span class="_ _7"> </span>elements,<span class="_ _7"> </span>(</span></div><div class="t m0 x38 h7 y2e ff4 fs3 fc0 sc0 ls0 ws0">e.<span class="_ _8"></span>g.</div><div class="t m3 xe5 h7 y2e ff4 fs3 fc0 sc0 ls0 ws0">,<span class="_ _b"> </span>n<span class="_ _1"></span>umbers),<span class="_ _b"> </span>range-minim<span class="_ _2"></span>um<span class="_ _b"> </span>queries</div><div class="t m0 x20 h7 y2f ff4 fs3 fc0 sc0 ls0 ws0">(resp.<span class="_ _7"> </span>range-maximum<span class="_ _6"> </span>queries)<span class="_ _7"> </span>are<span class="_ _7"> </span>deﬁned<span class="_ _7"> </span>by</div><div class="t m0 x154 hc y13c ffd fs3 fc0 sc0 ls0 ws0">rmq</div><div class="t m0 x73 he y13d ff1a fs6 fc0 sc0 ls0 ws0">A</div><div class="t m0 xcb h7 y13c ff6 fs3 fc0 sc0 ls0 ws0">(<span class="ff5">i,<span class="_ _c"> </span>j<span class="_ _10"></span></span>)<span class="_ _42"> </span>=<span class="_ _42"> </span>arg<span class="_ _1b"> </span>min</div><div class="t m0 x155 he y13e ff1a fs6 fc0 sc0 ls0 ws0">i<span class="ff19">≤</span>k<span class="ff19">≤</span>j</div><div class="t m0 x140 h7 y13c ff5 fs3 fc0 sc0 ls0 ws0">A<span class="ff6">[</span>k<span class="_ _5"></span><span class="ff6">]</span>,</div><div class="t m0 x154 hc y13f ffd fs3 fc0 sc0 ls0 ws0">rMq</div><div class="t m0 x73 he y140 ff1a fs6 fc0 sc0 ls0 ws0">A</div><div class="t m0 xcb h7 y13f ff6 fs3 fc0 sc0 ls0 ws0">(<span class="ff5">i,<span class="_ _c"> </span>j<span class="_ _10"></span></span>)<span class="_ _42"> </span>=<span class="_ _42"> </span>arg<span class="_ _1b"> </span>max</div><div class="t m0 x92 he y141 ff1a fs6 fc0 sc0 ls0 ws0">i<span class="ff19">≤</span>k<span class="ff19">≤</span>j</div><div class="t m0 x156 h7 y13f ff5 fs3 fc0 sc0 ls0 ws0">A<span class="ff6">[</span>k<span class="_ _5"></span><span class="ff6">]</span>,</div><div class="t m2 x0 h7 y142 ff4 fs3 fc0 sc0 ls0 ws0">for<span class="_ _7"> </span>all<span class="_ _7"> </span><span class="ff6">1</span></div><div class="t m0 x157 h7 y142 ff11 fs3 fc0 sc0 ls0 ws0">≤<span class="_ _d"> </span><span class="ff5">i<span class="_ _d"> </span></span>≤<span class="_ _d"> </span><span class="ff5">j<span class="_ _7"> </span></span>≤<span class="_ _d"> </span><span class="ff5">n</span></div><div class="t m2 x158 h7 y142 ff4 fs3 fc0 sc0 ls0 ws0">.<span class="_ _f"> </span>In<span class="_ _7"> </span>b<span class="_ _5"></span>oth<span class="_ _7"> </span>cases,<span class="_ _7"> </span>ties<span class="_ _b"> </span>are<span class="_ _6"> </span>broken<span class="_ _6"> </span>by<span class="_ _6"> </span>the<span class="_ _b"> </span>index,</div><div class="t m0 x2e h7 y142 ff4 fs3 fc0 sc0 ls0 ws0">i.<span class="_ _8"></span>e.</div><div class="t m2 x7e h7 y142 ff4 fs3 fc0 sc0 ls0 ws0">,<span class="_ _7"> </span>the<span class="_ _7"> </span>index<span class="_ _7"> </span>of<span class="_ _b"> </span>the<span class="_ _6"> </span>leftmost</div><div class="t m0 x0 h7 y143 ff4 fs3 fc0 sc0 ls0 ws0">minim<span class="_ _2"></span>um<span class="_ _7"> </span>(resp.<span class="_ _7"> </span>maximum)<span class="_ _6"> </span>is<span class="_ _b"> </span>returned.</div><div class="t m0 x0 h7 y144 ff10 fs3 fc0 sc0 ls0 ws0">Lemma<span class="_ _b"> </span>2.5<span class="_ _a"> </span>(RMQ<span class="_ _b"> </span>index,<span class="_ _b"> </span>[10,<span class="_ _a"> </span>Thm.<span class="_ _1b"> </span>3.7]):</div><div class="t m3 xb6 h7 y144 ffc fs3 fc0 sc0 ls0 ws0">Giv<span class="_ _2"></span>en a static<span class="_ _f"> </span>array</div><div class="t m0 x135 h7 y144 ff5 fs3 fc0 sc0 ls0 ws0">A</div><div class="t m3 xed h7 y144 ff6 fs3 fc0 sc0 ls0 ws0">[1</div><div class="t m0 x12b h7 y144 ff5 fs3 fc0 sc0 ls0 ws0">..n</div><div class="t m3 xe1 h7 y144 ff6 fs3 fc0 sc0 ls0 ws0">]<span class="_ _13"> </span><span class="ffc">of<span class="_ _f"> </span>comparable</span></div><div class="t m19 x20 h7 y145 ffc fs3 fc0 sc0 ls0 ws0">elemen<span class="_ _2"></span>ts,<span class="_ _7"> </span>for<span class="_ _7"> </span>any<span class="_ _6"> </span>constant</div><div class="t m0 x159 h7 y145 ff5 fs3 fc0 sc0 ls0 ws0">ε<span class="_ _d"> </span>&gt;</div><div class="t m19 x15a h7 y145 ff6 fs3 fc0 sc0 ls0 ws0">0<span class="ffc">,<span class="_ _7"> </span>there<span class="_ _7"> </span>is<span class="_ _7"> </span>a<span class="_ _7"> </span>data<span class="_ _7"> </span>structure<span class="_ _7"> </span>using</span></div><div class="t m0 x15b h7 y145 ff5 fs3 fc0 sc0 ls0 ws0">εn</div><div class="t m19 x15c h7 y145 ffc fs3 fc0 sc0 ls0 ws0">bits<span class="_ _7"> </span>of<span class="_ _7"> </span>space<span class="_ _7"> </span>on<span class="_ _7"> </span>top<span class="_ _7"> </span>of</div><div class="t m0 x1e h7 y145 ff5 fs3 fc0 sc0 ls0 ws0">A</div><div class="t m0 x20 h7 y146 ffc fs3 fc0 sc0 ls0 ws0">that<span class="_ _7"> </span>answers<span class="_ _6"> </span>range-minima<span class="_ _7"> </span>queries<span class="_ _7"> </span>in<span class="_ _7"> </span><span class="ff5">O<span class="_ _10"></span><span class="ff6">(1</span>/ε<span class="ff6">)<span class="_ _7"> </span></span></span>time<span class="_ _7"> </span>(making<span class="_ _7"> </span>as<span class="_ _7"> </span>many<span class="_ _6"> </span>queries<span class="_ _b"> </span>to<span class="_ _6"> </span><span class="ff5">A</span>).<span class="_ _20"> </span><span class="ff5 fs8"></span></div><div class="t m10 x0 h7 y147 ff4 fs3 fc0 sc0 ls0 ws0">Clearly<span class="_ _14"></span>,<span class="_ _7"> </span>the<span class="_ _7"> </span>same<span class="_ _b"> </span>data<span class="_ _6"> </span>structure<span class="_ _b"> </span>can<span class="_ _6"> </span>also<span class="_ _b"> </span>be<span class="_ _b"> </span>used<span class="_ _6"> </span>to<span class="_ _b"> </span>answ<span class="_ _1"></span>er<span class="_ _b"> </span>range-maxima<span class="_ _6"> </span>queries<span class="_ _b"> </span>b<span class="_ _1"></span>y<span class="_ _b"> </span>building</div><div class="t m0 x0 h7 y148 ff4 fs3 fc0 sc0 ls0 ws0">the<span class="_ _7"> </span>data<span class="_ _7"> </span>structure<span class="_ _7"> </span>w.<span class="_ _8"></span>r.<span class="_ _11"></span>t.<span class="_ _6"> </span>the<span class="_ _7"> </span>reverse<span class="_ _6"> </span>ordering.</div><div class="t m0 x0 h7 y149 ff10 fs3 fc0 sc0 ls0 ws0">Remark<span class="_ _b"> </span>(Sublinear<span class="_ _a"> </span>RMQ):</div><div class="t m3 x13a h7 y149 ff4 fs3 fc0 sc0 ls0 ws0">Indeed,</div><div class="t m0 xaf h7 y149 ff5 fs3 fc0 sc0 ls0 ws0">ε</div><div class="t m3 x56 h7 y149 ff4 fs3 fc0 sc0 ls0 ws0">can<span class="_ _7"> </span>b<span class="_ _5"></span>e<span class="_ _b"> </span>c<span class="_ _2"></span>hosen<span class="_ _7"> </span>smaller<span class="_ _b"> </span>than<span class="_ _7"> </span>constant,<span class="_ _7"> </span>yielding<span class="_ _b"> </span>sub-</div><div class="t m3 x0 h7 y14a ff4 fs3 fc0 sc0 ls0 ws0">linear<span class="_ _b"> </span>extra<span class="_ _b"> </span>space,<span class="_ _a"> </span>at<span class="_ _b"> </span>the<span class="_ _b"> </span>cost<span class="_ _b"> </span>of<span class="_ _b"> </span>increasing<span class="_ _b"> </span>the<span class="_ _b"> </span>query<span class="_ _b"> </span>time<span class="_ _a"> </span>to<span class="_ _b"> </span>superconstant;<span class="_ _b"> </span>we<span class="_ _b"> </span>only<span class="_ _b"> </span>need</div><div class="t m0 x0 h7 y14b ff5 fs3 fc0 sc0 ls0 ws0">ε<span class="_ _d"> </span><span class="ff6">=<span class="_ _d"> </span></span>Ω<span class="_ _10"></span><span class="ff6">(</span>n</div><div class="t m0 x157 he y14c ff19 fs6 fc0 sc0 ls0 ws0">−<span class="ff13">1+<span class="ff1a">δ</span></span></div><div class="t m0 x13f h7 y14b ff6 fs3 fc0 sc0 ls0 ws0">)<span class="_ _7"> </span><span class="ff4">for<span class="_ _7"> </span>some<span class="_ _7"> </span><span class="ff5">δ<span class="_ _7"> </span>&gt;<span class="_ _d"> </span></span></span>0<span class="ff4">.<span class="_ _43"> </span><span class="ff5 fs8"></span></span></div><div class="t m12 x19 h7 y14d ff4 fs3 fc0 sc0 ls0 ws0">Giv<span class="_ _2"></span>en<span class="_ _7"> </span>a<span class="_ _7"> </span>static<span class="_ _7"> </span>set<span class="_ _b"> </span>of<span class="_ _6"> </span>p<span class="_ _5"></span>oints<span class="_ _6"> </span>in<span class="_ _b"> </span>the<span class="_ _6"> </span>plane,<span class="_ _7"> </span><span class="ff8">ortho<span class="_ _2"></span>gonal<span class="_ _b"> </span>r<span class="_ _1"></span>ange<span class="_ _b"> </span>r<span class="_ _14"></span>ep<span class="_ _2"></span>orting<span class="_ _b"> </span><span class="ff4">asks<span class="_ _b"> </span>to<span class="_ _6"> </span>ﬁnd<span class="_ _7"> </span>all<span class="_ _b"> </span>points</span></span></div><div class="t m24 x0 h7 y14e ff4 fs3 fc0 sc0 ls0 ws0">in<span class="_ _7"> </span>the<span class="_ _7"> </span>p<span class="_ _10"></span>oin<span class="_ _2"></span>t<span class="_ _7"> </span>set<span class="_ _b"> </span>that<span class="_ _7"> </span>lie<span class="_ _7"> </span>inside<span class="_ _b"> </span>a<span class="_ _6"> </span>query<span class="_ _b"> </span>rectangle<span class="_ _6"> </span><span class="ff6">[</span></div><div class="t m0 xf5 h7 y14e ff5 fs3 fc0 sc0 ls0 ws0">x</div><div class="t m0 xae he y14f ff13 fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 xe h7 y14e ff5 fs3 fc0 sc0 ls0 ws0">,<span class="_ _c"> </span>x</div><div class="t m0 x10 he y14f ff13 fs6 fc0 sc0 ls0 ws0">2</div><div class="t m24 x150 h7 y14e ff6 fs3 fc0 sc0 ls0 ws0">]</div><div class="t m0 x15d h7 y14e ff11 fs3 fc0 sc0 ls0 ws0">×</div><div class="t m24 x3a h7 y14e ff6 fs3 fc0 sc0 ls0 ws0">[</div><div class="t m0 x10d h7 y14e ff5 fs3 fc0 sc0 ls0 ws0">y</div><div class="t m0 x15e he y14f ff13 fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x6b h7 y14e ff5 fs3 fc0 sc0 ls0 ws0">,<span class="_ _c"> </span>y</div><div class="t m0 x66 he y14f ff13 fs6 fc0 sc0 ls0 ws0">2</div><div class="t m24 x24 h7 y14e ff6 fs3 fc0 sc0 ls0 ws0">]<span class="ff4">.<span class="_ _f"> </span>Range<span class="_ _7"> </span><span class="ff8">c<span class="_ _1"></span>ounting<span class="_ _a"> </span><span class="ff4">queries<span class="_ _7"> </span>only</span></span></span></div><div class="t m0 x0 h7 y150 ff4 fs3 fc0 sc0 ls0 ws0">rep<span class="_ _5"></span>ort<span class="_ _7"> </span>the<span class="_ _7"> </span>num<span class="_ _1"></span>b<span class="_ _5"></span>er<span class="_ _7"> </span>of<span class="_ _b"> </span>suc<span class="_ _1"></span>h<span class="_ _7"> </span>p<span class="_ _10"></span>oin<span class="_ _2"></span>ts.</div><div class="t m0 x0 h7 y151 ff10 fs3 fc0 sc0 ls0 ws0">Lemma<span class="_ _b"> </span>2.6<span class="_ _a"> </span>(Succinct<span class="_ _b"> </span>p<span class="_ _5"></span>oint<span class="_ _b"> </span>grids,<span class="_ _b"> </span>[3,<span class="_ _a"> </span>Thm.<span class="_ _c"> </span>1]):</div><div class="t m25 x15f h7 y151 ffc fs3 fc0 sc0 ls0 ws0">A<span class="_ _7"> </span>set</div><div class="t m0 x6b h7 y151 ff5 fs3 fc0 sc0 ls0 ws0">N</div><div class="t m25 x3c h7 y151 ffc fs3 fc0 sc0 ls0 ws0">of</div><div class="t m0 x151 h7 y151 ff5 fs3 fc0 sc0 ls0 ws0">n</div><div class="t m25 x7e h7 y151 ffc fs3 fc0 sc0 ls0 ws0">p<span class="_ _5"></span>oin<span class="_ _2"></span>ts<span class="_ _7"> </span>in<span class="_ _b"> </span>an</div><div class="t m0 xf7 h7 y151 ff5 fs3 fc0 sc0 ls0 ws0">n<span class="_ _1e"> </span><span class="ff11">×<span class="_ _1e"> </span></span>n</div><div class="t m25 x52 h7 y151 ffc fs3 fc0 sc0 ls0 ws0">in<span class="_ _2"></span>teger</div><div class="t m0 x20 h7 y152 ffc fs3 fc0 sc0 ls0 ws0">grid<span class="_ _7"> </span>can<span class="_ _7"> </span>b<span class="_ _5"></span>e<span class="_ _7"> </span>represented<span class="_ _6"> </span>using<span class="_ _b"> </span><span class="ff5">n<span class="_ _11"> </span><span class="ff6">lg<span class="_ _1b"> </span></span>n<span class="_ _1e"> </span><span class="ff6">+<span class="_ _9"> </span></span>o<span class="ff6">(</span>n<span class="_ _c"> </span><span class="ff6">log<span class="_ _c"> </span></span>n<span class="ff6">)<span class="_ _7"> </span></span></span>bits<span class="_ _7"> </span>of<span class="_ _7"> </span>space<span class="_ _b"> </span>so<span class="_ _6"> </span>that</div><div class="t m0 x35 h7 y153 ffc fs3 fc0 sc0 ls0 ws0">1. orthogonal-range-coun<span class="_ _2"></span>ting<span class="_ _7"> </span>queries<span class="_ _7"> </span>are<span class="_ _7"> </span>answered<span class="_ _7"> </span>in<span class="_ _7"> </span><span class="ff5">O<span class="_ _5"></span><span class="ff6">(log<span class="_ _c"> </span></span>n/<span class="_ _1b"> </span><span class="ff6">log<span class="_ _c"> </span>log<span class="_ _1b"> </span></span>n<span class="ff6">)<span class="_ _7"> </span></span></span>time,<span class="_ _7"> </span>and</div><div class="t m0 x35 h7 y154 ffc fs3 fc0 sc0 ls0 ws0">2.</div><div class="t m2 xd h7 y154 ffc fs3 fc0 sc0 ls0 ws0">orthogonal-range-rep<span class="_ _5"></span>orting<span class="_ _9"> </span>queries<span class="_ _9"> </span>are<span class="_ _9"> </span>answered<span class="_ _9"> </span>in</div><div class="t m0 x160 h7 y154 ff5 fs3 fc0 sc0 ls0 ws0">O</div><div class="t m2 x21 h7 y154 ff6 fs3 fc0 sc0 ls0 ws0">((</div><div class="t m0 x1c h7 y154 ff5 fs3 fc0 sc0 ls0 ws0">k</div><div class="t m2 xce h7 y154 ff6 fs3 fc0 sc0 ls0 ws0">+<span class="_ _10"></span>1)</div><div class="t m0 x5a h7 y154 ff6 fs3 fc0 sc0 ls0 ws0">log<span class="_ _c"> </span><span class="ff5">n/<span class="_ _c"> </span></span>log<span class="_ _1b"> </span>log<span class="_ _c"> </span><span class="ff5">n</span></div><div class="t m2 x42 h7 y154 ff6 fs3 fc0 sc0 ls0 ws0">)<span class="_ _9"> </span><span class="ffc">time,<span class="_ _d"> </span>where</span></div><div class="t m0 xbd h7 y154 ff5 fs3 fc0 sc0 ls0 ws0">k</div><div class="t m0 x161 h7 y155 ffc fs3 fc0 sc0 ls0 ws0">is<span class="_ _7"> </span>the<span class="_ _7"> </span>output<span class="_ _7"> </span>size.<span class="_ _44"> </span><span class="ff5 fs8"></span></div><div class="t m0 x0 h7 y156 ff10 fs3 fc0 sc0 ls0 ws0">Corollary<span class="_ _b"> </span>2.7<span class="_ _a"> </span>(P<span class="_ _1"></span>ermutation<span class="_ _b"> </span>grid):</div><div class="t m3 x12d h7 y156 ffc fs3 fc0 sc0 ls0 ws0">Giv<span class="_ _2"></span>en<span class="_ _b"> </span>a<span class="_ _b"> </span>p<span class="_ _5"></span>ermutation</div><div class="t m0 xb8 h7 y156 ff5 fs3 fc0 sc0 ls0 ws0">π</div><div class="t m3 x162 h7 y156 ff6 fs3 fc0 sc0 ls0 ws0">:<span class="_ _7"> </span>[</div><div class="t m0 x11 h7 y156 ff5 fs3 fc0 sc0 ls0 ws0">n</div><div class="t m3 x163 h7 y156 ff6 fs3 fc0 sc0 ls0 ws0">]</div><div class="t m0 x164 h7 y156 ff11 fs3 fc0 sc0 ls0 ws0">→</div><div class="t m3 x88 h7 y156 ff6 fs3 fc0 sc0 ls0 ws0">[</div><div class="t m0 x67 h7 y156 ff5 fs3 fc0 sc0 ls0 ws0">n</div><div class="t m3 x3e h7 y156 ff6 fs3 fc0 sc0 ls0 ws0">]<span class="ffc">,<span class="_ _b"> </span>we<span class="_ _7"> </span>can<span class="_ _b"> </span>represent</span></div><div class="t m10 x20 h7 y157 ffc fs3 fc0 sc0 ls0 ws0">the<span class="_ _7"> </span>p<span class="_ _5"></span>oint<span class="_ _6"> </span>set</div><div class="t m0 x3f h7 y157 ff5 fs3 fc0 sc0 ls0 ws0">P</div><div class="t m10 x147 h7 y157 ff6 fs3 fc0 sc0 ls0 ws0">=</div><div class="t m0 xe8 h7 y157 ff5 fs3 fc0 sc0 ls0 ws0">P</div><div class="t m10 x14c h7 y157 ff6 fs3 fc0 sc0 ls0 ws0">(</div><div class="t m0 xac h7 y157 ff5 fs3 fc0 sc0 ls0 ws0">π</div><div class="t m10 x165 h7 y157 ff6 fs3 fc0 sc0 ls0 ws0">)<span class="_ _d"> </span>=</div><div class="t m0 x80 h7 y157 ff11 fs3 fc0 sc0 ls0 ws0">{</div><div class="t m10 x81 h7 y157 ff6 fs3 fc0 sc0 ls0 ws0">(</div><div class="t m0 x33 h7 y157 ff5 fs3 fc0 sc0 ls0 ws0">x,<span class="_ _c"> </span>π</div><div class="t m10 x10a h7 y157 ff6 fs3 fc0 sc0 ls0 ws0">(</div><div class="t m0 x154 h7 y157 ff5 fs3 fc0 sc0 ls0 ws0">x</div><div class="t m10 x121 h7 y157 ff6 fs3 fc0 sc0 ls0 ws0">))<span class="_ _d"> </span>:</div><div class="t m0 x166 h7 y157 ff5 fs3 fc0 sc0 ls0 ws0">x<span class="_ _d"> </span><span class="ff11">∈</span></div><div class="t m10 x125 h7 y157 ff6 fs3 fc0 sc0 ls0 ws0">[</div><div class="t m0 x56 h7 y157 ff5 fs3 fc0 sc0 ls0 ws0">n</div><div class="t m10 xc3 h7 y157 ff6 fs3 fc0 sc0 ls0 ws0">]</div><div class="t m0 x153 h7 y157 ff11 fs3 fc0 sc0 ls0 ws0">}</div><div class="t m10 x58 h7 y157 ffc fs3 fc0 sc0 ls0 ws0">using</div><div class="t m0 x90 h7 y157 ff5 fs3 fc0 sc0 ls0 ws0">n<span class="_ _c"> </span><span class="ff6">lg<span class="_ _c"> </span></span>n</div><div class="t m10 x141 h7 y157 ff6 fs3 fc0 sc0 ls0 ws0">+</div><div class="t m0 xe6 h7 y157 ff5 fs3 fc0 sc0 ls0 ws0">o</div><div class="t m10 x23 h7 y157 ff6 fs3 fc0 sc0 ls0 ws0">(</div><div class="t m0 xb8 h7 y157 ff5 fs3 fc0 sc0 ls0 ws0">n<span class="_ _c"> </span><span class="ff6">log<span class="_ _c"> </span></span>n</div><div class="t m10 x15c h7 y157 ff6 fs3 fc0 sc0 ls0 ws0">)<span class="_ _7"> </span><span class="ffc">bits<span class="_ _7"> </span>of<span class="_ _b"> </span>space<span class="_ _6"> </span>so<span class="_ _b"> </span>that<span class="_ _6"> </span>we</span></div><div class="t m0 x20 h7 y158 ffc fs3 fc0 sc0 ls0 ws0">can<span class="_ _7"> </span>answer<span class="_ _6"> </span>the<span class="_ _7"> </span>following<span class="_ _6"> </span>queries:</div><div class="t m0 x35 h7 y159 ffc fs3 fc0 sc0 ls0 ws0">1.</div><div class="t m3 xd h7 y159 ffc fs3 fc0 sc0 ls0 ws0">orthogonal-range-coun<span class="_ _2"></span>ting<span class="_ _a"> </span>queries,</div><div class="t m0 x13b hc y159 ffd fs3 fc0 sc0 ls0 ws0">RCount</div><div class="t m0 x95 he y15a ff1a fs6 fc0 sc0 ls0 ws0">P</div><div class="t m3 xe h7 y159 ff6 fs3 fc0 sc0 ls0 ws0">(</div><div class="t m0 x9b h7 y159 ff5 fs3 fc0 sc0 ls0 ws0">x</div><div class="t m0 xcc he y15b ff13 fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x9c h7 y159 ff5 fs3 fc0 sc0 ls0 ws0">,<span class="_ _c"> </span>x</div><div class="t m0 xb7 he y15b ff13 fs6 fc0 sc0 ls0 ws0">2</div><div class="t m3 x21 h7 y159 ff6 fs3 fc0 sc0 ls0 ws0">;</div><div class="t m0 x10d h7 y159 ff5 fs3 fc0 sc0 ls0 ws0">y</div><div class="t m0 x15e he y15b ff13 fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 xce h7 y159 ff5 fs3 fc0 sc0 ls0 ws0">,<span class="_ _c"> </span>y</div><div class="t m0 x167 he y15b ff13 fs6 fc0 sc0 ls0 ws0">2</div><div class="t m3 x168 h7 y159 ff6 fs3 fc0 sc0 ls0 ws0">)<span class="_ _a"> </span>=</div><div class="t m0 x134 h11 y15c ff1b fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x134 h11 y15d ff1b fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x60 h7 y159 ff5 fs3 fc0 sc0 ls0 ws0">P<span class="_ _a"> </span><span class="ff11">∩</span></div><div class="t m3 x89 h7 y159 ff6 fs3 fc0 sc0 ls0 ws0">[</div><div class="t m0 x3e h7 y159 ff5 fs3 fc0 sc0 ls0 ws0">x</div><div class="t m0 x169 he y15b ff13 fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x5c h7 y159 ff5 fs3 fc0 sc0 ls0 ws0">,<span class="_ _c"> </span>x</div><div class="t m0 x12c he y15b ff13 fs6 fc0 sc0 ls0 ws0">2</div><div class="t m3 x9e h7 y159 ff6 fs3 fc0 sc0 ls0 ws0">]</div><div class="t m0 xbf h7 y159 ff11 fs3 fc0 sc0 ls0 ws0">×</div><div class="t m3 x78 h7 y159 ff6 fs3 fc0 sc0 ls0 ws0">[</div><div class="t m0 x16a h7 y159 ff5 fs3 fc0 sc0 ls0 ws0">y</div><div class="t m0 x137 he y15b ff13 fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 xc1 h7 y159 ff5 fs3 fc0 sc0 ls0 ws0">,<span class="_ _c"> </span>y</div><div class="t m0 xc9 he y15b ff13 fs6 fc0 sc0 ls0 ws0">2</div><div class="t m3 xa0 h7 y159 ff6 fs3 fc0 sc0 ls0 ws0">]</div><div class="t m0 x16b h11 y15c ff1b fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x16b h11 y15d ff1b fs2 fc0 sc0 ls0 ws0"></div><div class="t m3 xf0 h7 y159 ffc fs3 fc0 sc0 ls0 ws0">in</div><div class="t m0 xd h7 y15e ff5 fs3 fc0 sc0 ls0 ws0">O<span class="_ _5"></span><span class="ff6">(log<span class="_ _c"> </span></span>n/<span class="_ _c"> </span><span class="ff6">log<span class="_ _1b"> </span>log<span class="_ _1b"> </span></span>n<span class="ff6">)<span class="_ _7"> </span><span class="ffc">time;</span></span></div><div class="t m0 x35 h7 y15f ffc fs3 fc0 sc0 ls0 ws0">2.</div><div class="t m3 xd h7 y15f ffc fs3 fc0 sc0 ls0 ws0">orthogonal-range-rep<span class="_ _5"></span>orting<span class="_ _b"> </span>queries,</div><div class="t m0 x9 hc y15f ffd fs3 fc0 sc0 ls0 ws0">RPoints</div><div class="t m0 x37 he y160 ff1a fs6 fc0 sc0 ls0 ws0">P</div><div class="t m3 xf h7 y15f ff6 fs3 fc0 sc0 ls0 ws0">(</div><div class="t m0 x38 h7 y15f ff5 fs3 fc0 sc0 ls0 ws0">x</div><div class="t m0 xcd he y161 ff13 fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x140 h7 y15f ff5 fs3 fc0 sc0 ls0 ws0">,<span class="_ _c"> </span>x</div><div class="t m0 x16c he y161 ff13 fs6 fc0 sc0 ls0 ws0">2</div><div class="t m3 x1c h7 y15f ff6 fs3 fc0 sc0 ls0 ws0">;</div><div class="t m0 xe6 h7 y15f ff5 fs3 fc0 sc0 ls0 ws0">y</div><div class="t m0 x23 he y161 ff13 fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x1d h7 y15f ff5 fs3 fc0 sc0 ls0 ws0">,<span class="_ _c"> </span>y</div><div class="t m0 x16d he y161 ff13 fs6 fc0 sc0 ls0 ws0">2</div><div class="t m3 x15b h7 y15f ff6 fs3 fc0 sc0 ls0 ws0">)<span class="_ _b"> </span>=</div><div class="t m0 x86 h7 y15f ff5 fs3 fc0 sc0 ls0 ws0">P<span class="_ _a"> </span><span class="ff11">∩</span></div><div class="t m3 xd2 h7 y15f ff6 fs3 fc0 sc0 ls0 ws0">[</div><div class="t m0 x110 h7 y15f ff5 fs3 fc0 sc0 ls0 ws0">x</div><div class="t m0 x143 he y161 ff13 fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x16e h7 y15f ff5 fs3 fc0 sc0 ls0 ws0">,<span class="_ _c"> </span>x</div><div class="t m0 x16f he y161 ff13 fs6 fc0 sc0 ls0 ws0">2</div><div class="t m3 xf7 h7 y15f ff6 fs3 fc0 sc0 ls0 ws0">]</div><div class="t m0 x113 h7 y15f ff11 fs3 fc0 sc0 ls0 ws0">×</div><div class="t m3 x16a h7 y15f ff6 fs3 fc0 sc0 ls0 ws0">[</div><div class="t m0 x51 h7 y15f ff5 fs3 fc0 sc0 ls0 ws0">y</div><div class="t m0 x170 he y161 ff13 fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 xc8 h7 y15f ff5 fs3 fc0 sc0 ls0 ws0">,<span class="_ _c"> </span>y</div><div class="t m0 xa7 he y161 ff13 fs6 fc0 sc0 ls0 ws0">2</div><div class="t m3 x16b h7 y15f ff6 fs3 fc0 sc0 ls0 ws0">]<span class="_ _b"> </span><span class="ffc">in</span></div><div class="t m0 xd h7 y162 ff5 fs3 fc0 sc0 ls0 ws0">O<span class="_ _5"></span><span class="ff6">((</span>k<span class="_ _9"> </span><span class="ff6">+<span class="_ _1e"> </span>1)<span class="_ _c"> </span>log<span class="_ _1b"> </span></span>n/<span class="_ _c"> </span><span class="ff6">log<span class="_ _c"> </span>log<span class="_ _1b"> </span></span>n<span class="ff6">)<span class="_ _7"> </span><span class="ffc">time,<span class="_ _7"> </span>where<span class="_ _b"> </span></span></span>k<span class="_ _d"> </span><span class="ff6">=<span class="_ _d"> </span><span class="ffd">RCount</span></span></div><div class="t m0 x140 he y163 ff1a fs6 fc0 sc0 ls0 ws0">P</div><div class="t m0 xe5 h7 y162 ff6 fs3 fc0 sc0 ls0 ws0">(<span class="ff5">x</span></div><div class="t m0 x5d he y164 ff13 fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x6b h7 y162 ff5 fs3 fc0 sc0 ls0 ws0">,<span class="_ _c"> </span>x</div><div class="t m0 x167 he y164 ff13 fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 x168 h7 y162 ff6 fs3 fc0 sc0 ls0 ws0">;<span class="_ _c"> </span><span class="ff5">y</span></div><div class="t m0 x151 he y164 ff13 fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x104 h7 y162 ff5 fs3 fc0 sc0 ls0 ws0">,<span class="_ _c"> </span>y</div><div class="t m0 x60 he y164 ff13 fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 x86 h7 y162 ff6 fs3 fc0 sc0 ls0 ws0">)<span class="ffc">;</span></div><div class="t m0 x35 h7 y165 ffc fs3 fc0 sc0 ls0 ws0">3. application<span class="_ _7"> </span>of<span class="_ _7"> </span><span class="ff5">π<span class="_ _5"></span></span>,<span class="_ _b"> </span><span class="ffd">YForX</span></div><div class="t m0 x171 he y166 ff1a fs6 fc0 sc0 ls0 ws0">P</div><div class="t m0 x45 h7 y165 ff6 fs3 fc0 sc0 ls0 ws0">(<span class="ff5">π<span class="_ _5"></span></span>)(<span class="ff5">x</span>)<span class="_ _d"> </span>=<span class="_ _d"> </span><span class="ff5">π<span class="_ _5"></span></span>(<span class="ff5">x</span>)<span class="_ _b"> </span><span class="ffc">for<span class="_ _6"> </span><span class="ff5">x<span class="_ _d"> </span><span class="ff11">∈<span class="_ _d"> </span></span></span></span>[ <span class="ff5">n</span>]<span class="_ _b"> </span><span class="ffc">in<span class="_ _6"> </span><span class="ff5">O<span class="_ _5"></span></span></span>(log<span class="_ _1b"> </span><span class="ff5">n/<span class="_ _c"> </span></span>log<span class="_ _1b"> </span>log<span class="_ _c"> </span><span class="ff5">n</span>)<span class="_ _7"> </span><span class="ffc">time;</span></div><div class="t m0 x35 h7 y167 ffc fs3 fc0 sc0 ls0 ws0">4. in<span class="_ _2"></span>verse<span class="_ _6"> </span>of<span class="_ _7"> </span><span class="ff5">π<span class="_ _10"></span></span>,<span class="_ _7"> </span><span class="ffd">XForY</span></div><div class="t m0 x172 he y168 ff1a fs6 fc0 sc0 ls0 ws0">P<span class="_ _11"> </span><span class="ff13">(</span>π<span class="ff13">)</span></div><div class="t m0 xb h7 y167 ff6 fs3 fc0 sc0 ls0 ws0">(<span class="ff5">y<span class="_ _5"></span></span>)<span class="_ _d"> </span>=<span class="_ _d"> </span><span class="ff5">π</span></div><div class="t m0 x73 he y169 ff19 fs6 fc0 sc0 ls0 ws0">−<span class="ff13">1</span></div><div class="t m0 x173 h7 y167 ff6 fs3 fc0 sc0 ls0 ws0">(<span class="ff5">y<span class="_ _5"></span></span>)<span class="_ _7"> </span><span class="ffc">for<span class="_ _7"> </span><span class="ff5">y<span class="_ _7"> </span><span class="ff11">∈<span class="_ _d"> </span></span></span></span>[<span class="ff5">n</span>]<span class="_ _7"> </span><span class="ffc">in<span class="_ _7"> </span><span class="ff5">O<span class="_ _10"></span></span></span>(log<span class="_ _c"> </span><span class="ff5">n/<span class="_ _c"> </span></span>log<span class="_ _1b"> </span>log<span class="_ _c"> </span><span class="ff5">n</span>)<span class="_ _b"> </span><span class="ffc">time.<span class="_ _45"> </span><span class="ff5 fs8"></span></span></div><div class="t m0 x0 h7 y16a ff10 fs3 fc0 sc0 ls0 ws0">Pro<span class="_ _5"></span>of:</div><div class="t m3 x157 h7 y16a ff4 fs3 fc0 sc0 ls0 ws0">W<span class="_ _14"></span>e use<span class="_ _3d"> </span>the grid data structure<span class="_ _3d"> </span>from Lemma 2.6<span class="_ _3d"> </span>on</div><div class="t m0 x15b h7 y16a ff5 fs3 fc0 sc0 ls0 ws0">P</div><div class="t m3 x7d h7 y16a ff4 fs3 fc0 sc0 ls0 ws0">;<span class="_ _38"> </span>counting and rep<span class="_ _5"></span>orting</div><div class="t m3 x0 h7 y16b ff4 fs3 fc0 sc0 ls0 ws0">queries are<span class="_ _f"> </span>immediate, and for<span class="_ _f"> </span>others w<span class="_ _2"></span>e use<span class="_ _f"> </span>that</div><div class="t m0 x1a hc y16b ffd fs3 fc0 sc0 ls0 ws0">YForX</div><div class="t m0 xce he y16c ff1a fs6 fc0 sc0 ls0 ws0">P<span class="_ _11"> </span><span class="ff13">(</span>π<span class="ff13">)</span></div><div class="t m3 x5a h7 y16b ff6 fs3 fc0 sc0 ls0 ws0">(</div><div class="t m0 x15b h7 y16b ff5 fs3 fc0 sc0 ls0 ws0">x</div><div class="t m3 x104 h7 y16b ff6 fs3 fc0 sc0 ls0 ws0">)<span class="_ _3d"> </span>=</div><div class="t m0 x3d hc y16b ffd fs3 fc0 sc0 ls0 ws0">RPoints</div><div class="t m0 x106 he y16d ff1a fs6 fc0 sc0 ls0 ws0">P</div><div class="t m3 x113 h7 y16b ff6 fs3 fc0 sc0 ls0 ws0">(</div><div class="t m0 x53 h7 y16b ff5 fs3 fc0 sc0 ls0 ws0">x,<span class="_ _c"> </span>x</div><div class="t m3 xc1 h7 y16b ff6 fs3 fc0 sc0 ls0 ws0">;<span class="_ _c"> </span>1</div><div class="t m0 xc9 h7 y16b ff5 fs3 fc0 sc0 ls0 ws0">,<span class="_ _c"> </span>n</div><div class="t m3 x138 h7 y16b ff6 fs3 fc0 sc0 ls0 ws0">)</div><div class="t m0 x1e h7 y16b ff5 fs3 fc0 sc0 ls0 ws0">.<span class="ffd">y</span></div><div class="t m2 x0 h7 y16e ff4 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m0 x63 hc y16e ffd fs3 fc0 sc0 ls0 ws0">XForY</div><div class="t m0 x47 he y16f ff1a fs6 fc0 sc0 ls0 ws0">P<span class="_ _11"> </span><span class="ff13">(</span>π<span class="ff13">)</span></div><div class="t m2 x14a h7 y16e ff6 fs3 fc0 sc0 ls0 ws0">(</div><div class="t m0 x4d h7 y16e ff5 fs3 fc0 sc0 ls0 ws0">y</div><div class="t m2 xfe h7 y16e ff6 fs3 fc0 sc0 ls0 ws0">)<span class="_ _d"> </span>=</div><div class="t m0 x174 hc y16e ffd fs3 fc0 sc0 ls0 ws0">RPoints</div><div class="t m0 xd8 he y170 ff1a fs6 fc0 sc0 ls0 ws0">P</div><div class="t m2 x70 h7 y16e ff6 fs3 fc0 sc0 ls0 ws0">(1</div><div class="t m0 x13a h7 y16e ff5 fs3 fc0 sc0 ls0 ws0">,<span class="_ _c"> </span>n</div><div class="t m2 x100 h7 y16e ff6 fs3 fc0 sc0 ls0 ws0">;</div><div class="t m0 x10b h7 y16e ff5 fs3 fc0 sc0 ls0 ws0">y<span class="_ _5"></span>,<span class="_ _c"> </span>y</div><div class="t m2 x61 h7 y16e ff6 fs3 fc0 sc0 ls0 ws0">)</div><div class="t m0 x12d h7 y16e ff5 fs3 fc0 sc0 ls0 ws0">.<span class="ffd">x</span></div><div class="t m2 x125 h7 y16e ff4 fs3 fc0 sc0 ls0 ws0">.<span class="_ _3"> </span>Here<span class="_ _7"> </span>w<span class="_ _2"></span>e<span class="_ _6"> </span>write</div><div class="t m0 x21 h7 y16e ff5 fs3 fc0 sc0 ls0 ws0">Q.<span class="ffd">x</span></div><div class="t m2 x5e h7 y16e ff4 fs3 fc0 sc0 ls0 ws0">to<span class="_ _6"> </span>denote<span class="_ _6"> </span>the<span class="_ _7"> </span>pro<span class="_ _5"></span>jection<span class="_ _6"> </span>of<span class="_ _7"> </span>p<span class="_ _5"></span>oint</div><div class="t m0 x0 h7 y171 ff4 fs3 fc0 sc0 ls0 ws0">set<span class="_ _7"> </span><span class="ff5">Q<span class="_ _7"> </span></span>to<span class="_ _7"> </span>the<span class="_ _7"> </span><span class="ff5">x</span>-co<span class="_ _5"></span>ordinates<span class="_ _b"> </span>of<span class="_ _6"> </span>the<span class="_ _7"> </span>p<span class="_ _10"></span>oin<span class="_ _2"></span>ts.</div><div class="t m0 x1e h19 y172 ff20 fs3 fc0 sc0 ls0 ws0"></div><a class="l" href="#pf1a" data-dest-detail='[26,"XYZ",74.409,719.69,null]'><div class="d mf" style="border-style:none;position:absolute;left:367.663067px;bottom:1022.495447px;width:14.537000px;height:9.200000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf19" data-dest-detail='[25,"XYZ",74.409,374.917,null]'><div class="d mf" style="border-style:none;position:absolute;left:443.359047px;bottom:711.871468px;width:8.266000px;height:9.201000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf7" data-dest-detail='[7,"XYZ",74.409,445.151,null]'><div class="d mf" style="border-style:none;position:absolute;left:514.991365px;bottom:239.026939px;width:57.913000px;height:11.739000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.679893,0.000000,0.000000,1.679893,0.000000,0.000000]}'></div></div>
