<div id="pf3" class="pf w0 h0" data-page-no="3"><div class="pc pc3 w0 h0"><img class="bi x0 y5c w3 h10" alt="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABAIAAADICAIAAAD9ftQjAAAACXBIWXMAABYlAAAWJQFJUiTwAAADoklEQVR42u3ZwQ2AIBBEUTF0YIkk9ERiQTRlliL0sIb3Spjbz5Qx7gPS670ZAQDgK6cJAABgNyUirAAAAFvxBgAAgAwAAABkAAAAIAMAAAAZAAAAyAAAAEAGAAAAMgAAAJABAACADAAAAGQAAAAgAwAAABkAAADIAAAAQAYAAAAyAAAAZAAAACADAAAAGQAAAMgAAABABgAAADIAAACQAQAAgAwAAABkAAAAIAMAAAAZAAAAyAAAAEAGAAAAMgAAAJABAAAgAwAAABkAAADIAAAAQAYAAAAyAAAAkAEAAIAMAAAAZAAAACADAAAAGQAAAMgAAABABgAAADIAAACQAQAAgAwAAAAZAAAAyAAAAEAGAAAAMgAAAJABAACADAAAAGQAAAAgAwAAABkAAADIAAAAQAYAAAAyAAAAkAEAAIAMAAAAZAAAAMgAAABABgAAADIAAACQAQAAgAwAAABkAAAAIAMAAAAZAAAAyAAAAEAGAAAAMgAAAJABAACADAAAAGQAAAAgAwAAQAYAAAAyAAAAkAEAAIAMAAAAZAAAACADAAAAGQAAAMgAAABABgAAADIAAACQAQAAgAwAAABkAAAAIAMAAAAZAAAAyAAAAJABAACADAAAAGQAAAAgAwAAABkAAADIAAAAQAYAAAAyAAAAkAEAAIAMAAAAZAAAACADAAAAGQAAAMgAAABABgAAgAwAAABkAAAAIAMAAAAZAAAAyAAAAEAGAAAAMgAAAJABAACADAAAAGQAAAAgAwAAABkAAADIAAAAQAYAAAAyAAAAZAAAACADAAAAGQAAAMgAAABABgAAADIAAACQAQAAgAwAAABkAAAAIAMAAAAZAAAAyAAAAEAGAAAAMgAAAJABAAAgAwAAABkAAADIAAAAQAYAAAAyAAAAkAEAAIAMAAAAZAAAACADAAAAGQAAAMgAAABABgAAADIAAACQAQAAgAwAAAAZAAAAyAAAAEAGAAAAMgAAAJABAACADAAAAGQAAACQRDUBAMAbz7yMwO94AwAAQAYAAAAyAAAAkAEAAIAMAAAAZAAAACADAAAAGQAAAMgAAABABgAAADIAAACQAQAAgAwAAABkAAAAIAMAAAAZAAAAMgAAAJABAACADAAAAGQAAAAgAwAAABkAAADIAAAAQAYAAAAyAAAAkAEAAIAMAAAAZAAAACADAAAAGQAAAMgAAACQAQAAgAwAAABkAAAAIAMAAAAZAAAAyAAAACCdBa/2CWOFv+YHAAAAAElFTkSuQmCC"/><div class="t m0 x0 h5 y2e ff1 fs3 fc0 sc0 ls0 ws0">C.<span class="_ _a"> </span>M.<span class="_ _8"> </span>Rysgaa<span class="_ _4"></span>rd,<span class="_ _8"> </span>S.<span class="_ _a"> </span>Wild.<span class="_ _11"> </span>3</div><div class="t m18 x2 h7 y5d ff7 fs4 fc0 sc0 ls0 ws0">In<span class="_ _5"> </span>this<span class="_ _a"> </span>paper,<span class="_ _a"> </span>w<span class="_ _4"></span>e<span class="_ _5"> </span>present<span class="_ _5"> </span><span class="ff8">lazy<span class="_ _a"> </span>B-tr<span class="_ _9"></span>e<span class="_ _4"></span>es<span class="ff7">,<span class="_ _5"> </span>an<span class="_ _a"> </span>I/O-eﬃcien<span class="_ _9"></span>t<span class="_ _a"> </span>v<span class="_ _9"></span>ariant<span class="_ _7"> </span>of<span class="_ _a"> </span>the<span class="_ _5"> </span>original<span class="_ _5"> </span>lazy<span class="_ _a"> </span>searc<span class="_ _4"></span>h</span></span></div><div class="t ma x0 h7 y5e ff7 fs4 fc0 sc0 ls0 ws0">trees<span class="_ _7"> </span>[</div><div class="t m0 x51 h7 y5e ff7 fs4 fc0 sc0 ls0 ws0">44</div><div class="t ma x54 h7 y5e ff7 fs4 fc0 sc0 ls0 ws0">].</div><div class="t m0 x55 hd y5f ff10 fs7 fc0 sc0 ls0 ws0">2</div><div class="t ma x36 h7 y5e ff7 fs4 fc0 sc0 ls0 ws0">Lazy<span class="_ _7"> </span>searc<span class="_ _4"></span>h<span class="_ _7"> </span>trees<span class="_ _7"> </span>consist<span class="_ _d"> </span>of<span class="_ _7"> </span>three<span class="_ _7"> </span>la<span class="_ _4"></span>yers<span class="_ _d"> </span>(see<span class="_ _7"> </span>Figure<span class="_ _7"> </span>1).<span class="_ _8"> </span>The<span class="_ _7"> </span>topmost<span class="_ _7"> </span>lay<span class="_ _9"></span>er<span class="_ _7"> </span>consists</div><div class="t m3 x0 h7 y60 ff7 fs4 fc0 sc0 ls0 ws0">of<span class="_ _5"> </span>a<span class="_ _5"> </span>biased<span class="_ _a"> </span>searc<span class="_ _9"></span>h<span class="_ _a"> </span>tree<span class="_ _7"> </span>of<span class="_ _a"> </span><span class="ff8">gaps<span class="_ _a"> </span></span>(deﬁned<span class="_ _5"> </span>in<span class="_ _5"> </span>Section<span class="_ _5"> </span>1.2),<span class="_ _a"> </span>w<span class="_ _4"></span>eigh<span class="_ _4"></span>ted<span class="_ _5"> </span>by<span class="_ _7"> </span>their<span class="_ _a"> </span>size.<span class="_ _3"> </span>The<span class="_ _7"> </span>second</div><div class="t m19 x0 h7 y61 ff7 fs4 fc0 sc0 ls0 ws0">la<span class="_ _4"></span>yer<span class="_ _7"> </span>consists,<span class="_ _a"> </span>for<span class="_ _5"> </span>each<span class="_ _7"> </span>gap<span class="_ _a"> </span><span class="ffb">∆</span></div><div class="t m0 x56 hd y62 ff13 fs7 fc0 sc0 ls0 ws0">i</div><div class="t m19 x57 h7 y61 ff7 fs4 fc0 sc0 ls0 ws0">,<span class="_ _5"> </span>of<span class="_ _a"> </span>a<span class="_ _5"> </span>balanced<span class="_ _5"> </span>binary<span class="_ _a"> </span>searc<span class="_ _9"></span>h<span class="_ _a"> </span>tree<span class="_ _5"> </span>of</div><div class="t m0 x58 h7 y61 ffa fs4 fc0 sc0 ls0 ws0">O<span class="_ _2"></span><span class="ffb">(log<span class="_ _e"> </span></span>|<span class="ffb">∆</span></div><div class="t m0 x59 hd y62 ff13 fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x5a h7 y61 ffa fs4 fc0 sc0 ls0 ws0">|<span class="ffb">)</span></div><div class="t m19 x5b h7 y61 ff8 fs4 fc0 sc0 ls0 ws0">intervals</div><div class="t m0 x5c h7 y61 ff9 fs4 fc0 sc0 ls0 ws0">I</div><div class="t m0 x42 hd y62 ff13 fs7 fc0 sc0 ls0 ws0">i,j</div><div class="t m19 x5d h7 y61 ff7 fs4 fc0 sc0 ls0 ws0">.</div><div class="t ma x0 h7 y63 ff7 fs4 fc0 sc0 ls0 ws0">In<span class="_ _4"></span>terv<span class="_ _9"></span>als<span class="_ _a"> </span>are<span class="_ _5"> </span>separated<span class="_ _5"> </span>by<span class="_ _5"> </span>splitter<span class="_ _5"> </span>elements<span class="_ _5"> </span>(piv<span class="_ _4"></span>ots<span class="_ _5"> </span>as<span class="_ _a"> </span>in<span class="_ _5"> </span>Quicksort),<span class="_ _7"> </span>but<span class="_ _a"> </span>are<span class="_ _5"> </span>unsorted<span class="_ _5"> </span>within.</div><div class="t m0 x3 h7 y64 ff7 fs4 fc0 sc0 ls0 ws0">The<span class="_ _5"> </span>third<span class="_ _a"> </span>la<span class="_ _9"></span>yer<span class="_ _5"> </span>represents<span class="_ _7"> </span>interv<span class="_ _9"></span>als<span class="_ _5"> </span>as<span class="_ _a"> </span>a<span class="_ _5"> </span>simple<span class="_ _5"> </span>unordered<span class="_ _a"> </span>list.</div><div class="t m1a x2 h7 y65 ff7 fs4 fc0 sc0 ls0 ws0">A<span class="_ _5"> </span>key<span class="_ _7"> </span>obstacle<span class="_ _5"> </span>to<span class="_ _a"> </span>external-memory<span class="_ _7"> </span>v<span class="_ _4"></span>arian<span class="_ _4"></span>ts<span class="_ _5"> </span>of<span class="_ _a"> </span>lazy<span class="_ _7"> </span>search<span class="_ _5"> </span>trees<span class="_ _5"> </span>–<span class="_ _5"> </span>b<span class="_ _2"></span>oth<span class="_ _5"> </span>for<span class="_ _5"> </span>the<span class="_ _a"> </span>original</div><div class="t m1 x3 h7 y66 ff7 fs4 fc0 sc0 ls0 ws0">v<span class="_ _4"></span>ersion<span class="_ _a"> </span>[</div><div class="t m0 x5e h7 y66 ff7 fs4 fc0 sc0 ls0 ws0">44</div><div class="t m1 x5f h7 y66 ff7 fs4 fc0 sc0 ls0 ws0">]<span class="_ _a"> </span>and<span class="_ _5"> </span>for<span class="_ _a"> </span>optimal<span class="_ _a"> </span>lazy<span class="_ _a"> </span>searc<span class="_ _4"></span>h<span class="_ _a"> </span>trees<span class="_ _a"> </span>[</div><div class="t m0 x60 h7 y66 ff7 fs4 fc0 sc0 ls0 ws0">46</div><div class="t m1 x1e h7 y66 ff7 fs4 fc0 sc0 ls0 ws0">]<span class="_ _a"> </span>–<span class="_ _5"> </span>is<span class="_ _a"> </span>the<span class="_ _a"> </span>topmost<span class="_ _a"> </span>la<span class="_ _4"></span>yer. As<span class="_ _5"> </span>discussed<span class="_ _a"> </span>in</div><div class="t m6 x0 h7 y67 ff7 fs4 fc0 sc0 ls0 ws0">Section<span class="_ _5"> </span>1.3,<span class="_ _a"> </span>none<span class="_ _5"> </span>of<span class="_ _5"> </span>the<span class="_ _a"> </span>existing<span class="_ _5"> </span>data<span class="_ _5"> </span>structures<span class="_ _a"> </span>fully<span class="_ _5"> </span>solves<span class="_ _7"> </span>t<span class="_ _2"></span>he<span class="_ _5"> </span>problem<span class="_ _5"> </span>of<span class="_ _a"> </span>ho<span class="_ _4"></span>w<span class="_ _5"> </span>to<span class="_ _a"> </span>design<span class="_ _5"> </span>a</div><div class="t m17 x0 h7 y68 ff7 fs4 fc0 sc0 ls0 ws0">general-purp<span class="_ _2"></span>ose<span class="_ _5"> </span><span class="ff8">external-memory<span class="_ _a"> </span>biase<span class="_ _9"></span>d<span class="_ _a"> </span>se<span class="_ _9"></span>ar<span class="_ _4"></span>ch<span class="_ _a"> </span>tr<span class="_ _9"></span>e<span class="_ _4"></span>e<span class="_ _a"> </span><span class="ff7">–<span class="_ _5"> </span>and<span class="_ _a"> </span>w<span class="_ _4"></span>e<span class="_ _5"> </span>likewise<span class="_ _5"> </span>lea<span class="_ _4"></span>ve<span class="_ _7"> </span>this<span class="_ _a"> </span>as<span class="_ _5"> </span>an<span class="_ _5"> </span>op<span class="_ _2"></span>en</span></span></div><div class="t m1b x0 h7 y69 ff7 fs4 fc0 sc0 ls0 ws0">problem<span class="_ _5"> </span>for<span class="_ _a"> </span>future<span class="_ _5"> </span>work.<span class="_ _8"> </span>How<span class="_ _4"></span>ever,<span class="_ _7"> </span>we<span class="_ _5"> </span>show<span class="_ _7"> </span>that<span class="_ _a"> </span>for<span class="_ _5"> </span>a<span class="_ _5"> </span>slightly<span class="_ _5"> </span>restricted<span class="_ _a"> </span>set<span class="_ _5"> </span>of<span class="_ _5"> </span>p<span class="_ _2"></span>erformance</div><div class="t m18 x0 h7 y6a ff7 fs4 fc0 sc0 ls0 ws0">guaran<span class="_ _4"></span>tees<span class="_ _a"> </span>suﬃcien<span class="_ _9"></span>t<span class="_ _a"> </span>for<span class="_ _5"> </span>lazy<span class="_ _a"> </span>searc<span class="_ _4"></span>h<span class="_ _5"> </span>trees,<span class="_ _a"> </span>a<span class="_ _5"> </span>(to<span class="_ _5"> </span>our<span class="_ _a"> </span>kno<span class="_ _4"></span>wledge)<span class="_ _a"> </span>no<span class="_ _9"></span>vel<span class="_ _5"> </span>construction<span class="_ _a"> </span>based<span class="_ _5"> </span>on</div><div class="t m5 x0 h7 y6b ff7 fs4 fc0 sc0 ls0 ws0">partitioning<span class="_ _5"> </span>elements<span class="_ _7"> </span>by<span class="_ _5"> </span><span class="ff8">weight<span class="_ _8"> </span></span>with<span class="_ _5"> </span>doubly-exp<span class="_ _2"></span>onentially<span class="_ _7"> </span>increasing<span class="_ _a"> </span>buc<span class="_ _9"></span>ket<span class="_ _5"> </span>sizes<span class="_ _5"> </span>provides</div><div class="t m1 x0 h7 y6c ff7 fs4 fc0 sc0 ls0 ws0">an<span class="_ _5"> </span>I/O-eﬃcient<span class="_ _7"> </span>solution.<span class="_ _3"> </span>This<span class="_ _a"> </span>forms<span class="_ _5"> </span>the<span class="_ _5"> </span>basis<span class="_ _a"> </span>of<span class="_ _5"> </span>our<span class="_ _5"> </span>lazy<span class="_ _a"> </span>B-trees,<span class="_ _7"> </span>which<span class="_ _5"> </span>ﬁnally<span class="_ _5"> </span>bring<span class="_ _a"> </span>the</div><div class="t m0 x0 h7 y6d ff7 fs4 fc0 sc0 ls0 ws0">adaptiv<span class="_ _4"></span>e<span class="_ _5"> </span>versatilit<span class="_ _4"></span>y<span class="_ _5"> </span>of<span class="_ _a"> </span>lazy<span class="_ _5"> </span>searc<span class="_ _4"></span>h<span class="_ _5"> </span>trees<span class="_ _a"> </span>to<span class="_ _5"> </span>external<span class="_ _5"> </span>memory<span class="_ _9"></span>.</div><div class="t m0 x0 h6 y6e ff1 fs1 fc0 sc0 ls0 ws0">1.1<span class="_ _12"> </span>The<span class="_ _3"> </span>External-Memo<span class="_ _9"></span>ry<span class="_ _3"> </span>Mo<span class="_ _2"></span>del</div><div class="t ma x0 h7 y6f ff7 fs4 fc0 sc0 ls0 ws0">In<span class="_ _5"> </span>this<span class="_ _a"> </span>paper<span class="_ _5"> </span>we<span class="_ _5"> </span>study<span class="_ _5"> </span>the<span class="_ _a"> </span>sorted<span class="_ _5"> </span>dictionary<span class="_ _5"> </span>problem<span class="_ _a"> </span>in<span class="_ _5"> </span>a<span class="_ _5"> </span>hierarchical-memory<span class="_ _5"> </span>mo<span class="_ _2"></span>del,<span class="_ _5"> </span>where</div><div class="t m1a x3 h7 y70 ff7 fs4 fc0 sc0 ls0 ws0">w<span class="_ _4"></span>e<span class="_ _5"> </span>hav<span class="_ _4"></span>e<span class="_ _5"> </span>an<span class="_ _5"> </span>unbounded<span class="_ _a"> </span>external<span class="_ _7"> </span>memory<span class="_ _a"> </span>and<span class="_ _7"> </span>an<span class="_ _a"> </span>in<span class="_ _4"></span>ternal<span class="_ _5"> </span>memory<span class="_ _5"> </span>of<span class="_ _a"> </span>capacit<span class="_ _9"></span>y</div><div class="t m0 x31 h7 y70 ff9 fs4 fc0 sc0 ls0 ws0">M</div><div class="t m1a x61 h7 y70 ff7 fs4 fc0 sc0 ls0 ws0">elemen<span class="_ _4"></span>ts,</div><div class="t m1 x0 h7 y71 ff7 fs4 fc0 sc0 ls0 ws0">and<span class="_ _a"> </span>where<span class="_ _8"> </span>data<span class="_ _8"> </span>is<span class="_ _a"> </span>transferred<span class="_ _8"> </span>betw<span class="_ _4"></span>een<span class="_ _8"> </span>the<span class="_ _a"> </span>internal<span class="_ _a"> </span>and<span class="_ _8"> </span>external<span class="_ _a"> </span>memory<span class="_ _8"> </span>in<span class="_ _8"> </span>blocks<span class="_ _a"> </span>of</div><div class="t m0 x32 h7 y71 ff9 fs4 fc0 sc0 ls0 ws0">B</div><div class="t md x0 h7 y72 ff7 fs4 fc0 sc0 ls0 ws0">consecutiv<span class="_ _4"></span>e<span class="_ _5"> </span>elements.<span class="_ _3"> </span>A<span class="_ _5"> </span>blo<span class="_ _2"></span>c<span class="_ _4"></span>k<span class="_ _5"> </span>transfer<span class="_ _a"> </span>is<span class="_ _5"> </span>called<span class="_ _5"> </span>an<span class="_ _a"> </span><span class="ff8">I/O<span class="_ _a"> </span></span>(input/output<span class="_ _5"> </span>op<span class="_ _2"></span>eration).<span class="_ _3"> </span>The<span class="_ _5"> </span>I/O</div><div class="t m1c x0 h7 y73 ff7 fs4 fc0 sc0 ls0 ws0">cost<span class="_ _5"> </span>of<span class="_ _a"> </span>an<span class="_ _5"> </span>algorithm<span class="_ _5"> </span>is<span class="_ _a"> </span>the<span class="_ _5"> </span>n<span class="_ _4"></span>umber<span class="_ _a"> </span>of<span class="_ _7"> </span>I/Os<span class="_ _a"> </span>it<span class="_ _5"> </span>p<span class="_ _2"></span>erforms.<span class="_ _3"> </span>Aggarw<span class="_ _4"></span>al<span class="_ _5"> </span>and<span class="_ _a"> </span>Vitter<span class="_ _5"> </span>[</div><div class="t m0 x62 h7 y73 ff7 fs4 fc0 sc0 ls0 ws0">2</div><div class="t m1c x63 h7 y73 ff7 fs4 fc0 sc0 ls0 ws0">]<span class="_ _5"> </span>introduced</div><div class="t m1d x0 h7 y74 ff7 fs4 fc0 sc0 ls0 ws0">this<span class="_ _5"> </span>as<span class="_ _a"> </span>the<span class="_ _5"> </span><span class="ff8">external-memory<span class="_ _a"> </span>mo<span class="_ _4"></span>del<span class="_ _8"> </span><span class="ff7">(and<span class="_ _a"> </span>pro<span class="_ _4"></span>v<span class="_ _4"></span>ed,<span class="_ _a"> </span>e.g.,<span class="_ _5"> </span>low<span class="_ _9"></span>er<span class="_ _a"> </span>bounds<span class="_ _a"> </span>for<span class="_ _5"> </span>sorting<span class="_ _a"> </span>in<span class="_ _5"> </span>the<span class="_ _a"> </span>model).</span></span></div><div class="t m0 x0 h6 y75 ff1 fs1 fc0 sc0 ls0 ws0">1.2<span class="_ _12"> </span>Lazy<span class="_ _3"> </span>Sea<span class="_ _9"></span>rch<span class="_ _3"> </span>T<span class="_ _6"></span>rees</div><div class="t m1 x0 h7 y76 ff7 fs4 fc0 sc0 ls0 ws0">In<span class="_ _3"> </span>this<span class="_ _8"> </span>section<span class="_ _3"> </span>we<span class="_ _8"> </span>brieﬂy<span class="_ _3"> </span>describ<span class="_ _2"></span>e<span class="_ _3"> </span>lazy<span class="_ _8"> </span>search<span class="_ _8"> </span>trees<span class="_ _3"> </span>[</div><div class="t m0 x9 h7 y76 ff7 fs4 fc0 sc0 ls0 ws0">44</div><div class="t m1 x64 h7 y76 ff7 fs4 fc0 sc0 ls0 ws0">].<span class="_ _13"> </span>Lazy<span class="_ _3"> </span>searc<span class="_ _4"></span>h<span class="_ _3"> </span>trees<span class="_ _8"> </span>supp<span class="_ _2"></span>ort<span class="_ _3"> </span>all</div><div class="t m1 x0 h7 y77 ff7 fs4 fc0 sc0 ls0 ws0">op<span class="_ _2"></span>erations<span class="_ _3"> </span>of<span class="_ _3"> </span>a dynamic<span class="_ _3"> </span>sorted<span class="_ _3"> </span>dictionary<span class="_ _3"> </span>(details<span class="_ _3"> </span>in [</div><div class="t m0 xa h7 y77 ff7 fs4 fc0 sc0 ls0 ws0">44</div><div class="t m1 x65 h7 y77 ff7 fs4 fc0 sc0 ls0 ws0">]).<span class="_ _14"> </span>W<span class="_ _6"></span>e<span class="_ _3"> </span>consider the<span class="_ _3"> </span>follo<span class="_ _4"></span>wing</div><div class="t m0 x0 h7 y78 ff7 fs4 fc0 sc0 ls0 ws0">op<span class="_ _2"></span>erations<span class="_ _5"> </span>(suﬃcient<span class="_ _7"> </span>to<span class="_ _a"> </span>base<span class="_ _5"> </span>a<span class="_ _5"> </span>full<span class="_ _a"> </span>implemen<span class="_ _9"></span>tation<span class="_ _a"> </span>on):</div><div class="t m0 x0 h7 y79 ff14 fs4 fc1 sc0 ls0 ws0">Constr<span class="_ _4"></span>uct<span class="ff15">(<span class="ff16">S<span class="_ _2"></span></span>)<span class="ff1">:<span class="_ _15"> </span><span class="ff7 fc0">Constructs<span class="_ _5"> </span>the<span class="_ _a"> </span>data<span class="_ _7"> </span>structure<span class="_ _a"> </span>from<span class="_ _5"> </span>the<span class="_ _5"> </span>elements<span class="_ _5"> </span>of<span class="_ _5"> </span>set<span class="_ _a"> </span><span class="ff9">S<span class="_ _2"></span></span>.</span></span></span></div><div class="t m0 x66 hd y7a ff10 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m0 x0 h7 y7b ff14 fs4 fc1 sc0 ls0 ws0">Inser<span class="_ _6"></span>t<span class="ff15">(<span class="ff16">e</span>)<span class="ff1">:<span class="_ _3"> </span><span class="ff7 fc0">Adds<span class="_ _7"> </span>element<span class="_ _5"> </span><span class="ff9">e<span class="_ _5"> </span></span>to<span class="_ _a"> </span>the<span class="_ _5"> </span>set.</span></span></span></div><div class="t m0 x0 h7 y7c ff14 fs4 fc1 sc0 ls0 ws0">Delete<span class="ff15">(<span class="ff17">ptr<span class="_ _b"></span></span>)<span class="ff1">:<span class="_ _15"> </span><span class="ff7 fc0">Deletes<span class="_ _5"> </span>the<span class="_ _5"> </span>element<span class="_ _5"> </span>at<span class="_ _5"> </span>p<span class="_ _2"></span>ointer<span class="_ _7"> </span><span class="ff18">ptr<span class="_ _3"> </span></span>from<span class="_ _5"> </span>the<span class="_ _5"> </span>set.</span></span></span></div><div class="t m0 x0 h7 y7d ff14 fs4 fc1 sc0 ls0 ws0">ChangeKey<span class="ff15">(<span class="ff17">ptr<span class="_ _f"> </span><span class="ff16">,<span class="_ _e"> </span>e</span></span></span></div><div class="t m0 x67 h11 y7e ff19 fs7 fc1 sc0 ls0 ws0">′</div><div class="t m0 x68 h7 y7d ff15 fs4 fc1 sc0 ls0 ws0">)<span class="ff1">:<span class="_ _15"> </span><span class="ff7 fc0">Changes<span class="_ _7"> </span>the<span class="_ _a"> </span>elemen<span class="_ _4"></span>t<span class="_ _5"> </span><span class="ff9">e<span class="_ _a"> </span></span>at<span class="_ _7"> </span>p<span class="_ _2"></span>ointer<span class="_ _5"> </span><span class="ff18">ptr<span class="_ _8"> </span></span>to<span class="_ _a"> </span><span class="ff9">e</span></span></span></div><div class="t m0 x69 hd y7e ff1a fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x6a h7 y7d ff7 fs4 fc0 sc0 ls0 ws0">.</div><div class="t m0 x0 h7 y7f ff14 fs4 fc1 sc0 ls0 ws0">Quer<span class="_ _6"></span>yElement<span class="ff15">(<span class="ff16">e</span>)<span class="ff1">:</span></span></div><div class="t m4 x6b h7 y7f ff7 fs4 fc0 sc0 ls0 ws0">Lo<span class="_ _2"></span>cates<span class="_ _5"> </span>the<span class="_ _a"> </span>predecessor</div><div class="t m0 x6c h7 y7f ff9 fs4 fc0 sc0 ls0 ws0">e</div><div class="t m0 x6d hd y80 ff1a fs7 fc0 sc0 ls0 ws0">′</div><div class="t m4 x4e h7 y7f ff7 fs4 fc0 sc0 ls0 ws0">to<span class="_ _5"> </span>element</div><div class="t m0 x6e h7 y7f ff9 fs4 fc0 sc0 ls0 ws0">e</div><div class="t m4 x6f h7 y7f ff7 fs4 fc0 sc0 ls0 ws0">in<span class="_ _5"> </span>the<span class="_ _a"> </span>set,<span class="_ _5"> </span>and<span class="_ _a"> </span>returns<span class="_ _5"> </span>rank</div><div class="t m0 x2 h7 y81 ff9 fs4 fc0 sc0 ls0 ws0">r<span class="_ _a"> </span><span class="ff7">of<span class="_ _5"> </span></span>e</div><div class="t m0 x70 hd y82 ff1a fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x71 h7 y81 ff7 fs4 fc0 sc0 ls0 ws0">,<span class="_ _5"> </span>and<span class="_ _a"> </span>a<span class="_ _7"> </span>p<span class="_ _2"></span>ointer<span class="_ _5"> </span>to<span class="_ _5"> </span><span class="ff9">e</span></div><div class="t m0 x72 hd y82 ff1a fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x49 h7 y81 ff7 fs4 fc0 sc0 ls0 ws0">.</div><div class="t m0 x0 h7 y83 ff14 fs4 fc1 sc0 ls0 ws0">Quer<span class="_ _6"></span>yRank<span class="ff15">(<span class="ff16">r</span>)<span class="ff1">:</span></span></div><div class="t ma x73 h7 y83 ff7 fs4 fc0 sc0 ls0 ws0">Lo<span class="_ _2"></span>cates<span class="_ _5"> </span>the<span class="_ _a"> </span>elemen<span class="_ _9"></span>t</div><div class="t m0 x74 h7 y83 ff9 fs4 fc0 sc0 ls0 ws0">e</div><div class="t ma x75 h7 y83 ff7 fs4 fc0 sc0 ls0 ws0">with<span class="_ _5"> </span>rank</div><div class="t m0 x76 h7 y83 ff9 fs4 fc0 sc0 ls0 ws0">r</div><div class="t ma x77 h7 y83 ff7 fs4 fc0 sc0 ls0 ws0">in<span class="_ _5"> </span>the<span class="_ _a"> </span>set,<span class="_ _5"> </span>and<span class="_ _a"> </span>returns<span class="_ _5"> </span>a<span class="_ _a"> </span>pointer<span class="_ _5"> </span>to</div><div class="t m0 x78 h7 y83 ff9 fs4 fc0 sc0 ls0 ws0">e</div><div class="t ma x5d h7 y83 ff7 fs4 fc0 sc0 ls0 ws0">.</div><div class="t ma x2 h7 y84 ff7 fs4 fc0 sc0 ls0 ws0">Lazy<span class="_ _5"> </span>searc<span class="_ _4"></span>h<span class="_ _5"> </span>trees<span class="_ _5"> </span>maintain<span class="_ _7"> </span>the<span class="_ _5"> </span>elements<span class="_ _7"> </span>of<span class="_ _5"> </span>the<span class="_ _5"> </span>set<span class="_ _5"> </span>partitioned<span class="_ _5"> </span>into</div><div class="t m0 x11 h7 y84 ff9 fs4 fc0 sc0 ls0 ws0">G</div><div class="t ma x79 h7 y84 ff8 fs4 fc0 sc0 ls0 ws0">“gaps”<span class="ff7">,<span class="_ _5"> </span><span class="ffb">∆</span></span></div><div class="t m0 x7a hd y85 ff11 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x7b h7 y84 ff9 fs4 fc0 sc0 ls0 ws0">,<span class="_ _e"> </span>.<span class="_ _e"> </span>.<span class="_ _e"> </span>.<span class="_ _e"> </span>,</div><div class="t ma x7c h7 y84 ffb fs4 fc0 sc0 ls0 ws0">∆</div><div class="t m0 x7d hd y85 ff13 fs7 fc0 sc0 ls0 ws0">G</div><div class="t ma x5d h7 y84 ff7 fs4 fc0 sc0 ls0 ws0">.</div><div class="t mf x3 h7 y86 ff7 fs4 fc0 sc0 ls0 ws0">All<span class="_ _5"> </span>elements<span class="_ _5"> </span>in<span class="_ _5"> </span><span class="ffb">∆</span></div><div class="t m0 x7e hd y87 ff13 fs7 fc0 sc0 ls0 ws0">i</div><div class="t mf x7f h7 y86 ff7 fs4 fc0 sc0 ls0 ws0">are<span class="_ _5"> </span>weakly<span class="_ _5"> </span>smaller<span class="_ _5"> </span>than<span class="_ _a"> </span>all<span class="_ _5"> </span>elements<span class="_ _7"> </span>in<span class="_ _a"> </span><span class="ffb">∆</span></div><div class="t m0 x80 hd y87 ff13 fs7 fc0 sc0 ls0 ws0">i<span class="ff11">+1</span></div><div class="t mf x81 h7 y86 ff7 fs4 fc0 sc0 ls0 ws0">,<span class="_ _5"> </span>but<span class="_ _a"> </span>the<span class="_ _5"> </span>gaps<span class="_ _5"> </span>are<span class="_ _a"> </span>otherwise</div><div class="t m1 x0 h7 y88 ff7 fs4 fc0 sc0 ls0 ws0">treated<span class="_ _a"> </span>as<span class="_ _8"> </span>unsorted<span class="_ _a"> </span>bags.<span class="_ _16"> </span>Boundaries<span class="_ _a"> </span>b<span class="_ _2"></span>etw<span class="_ _9"></span>een<span class="_ _8"> </span>gaps<span class="_ _a"> </span>(and<span class="_ _8"> </span>new<span class="_ _a"> </span>gaps)<span class="_ _a"> </span>are<span class="_ _8"> </span>in<span class="_ _4"></span>tro<span class="_ _2"></span>duced<span class="_ _a"> </span>only</div><div class="t m1 x3 h7 y89 ff7 fs4 fc0 sc0 ls0 ws0">via<span class="_ _8"> </span>a<span class="_ _a"> </span>query;<span class="_ _3"> </span>initially<span class="_ _a"> </span>we<span class="_ _a"> </span>hav<span class="_ _4"></span>e<span class="_ _8"> </span>a<span class="_ _8"> </span>single<span class="_ _a"> </span>gap<span class="_ _8"> </span><span class="ffb">∆</span></div><div class="t m0 x82 hd y8a ff11 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m1 x60 h7 y89 ff7 fs4 fc0 sc0 ls0 ws0">.<span class="_ _16"> </span>Every<span class="_ _8"> </span>query<span class="_ _a"> </span>is<span class="_ _8"> </span>asso<span class="_ _2"></span>ciated<span class="_ _a"> </span>with<span class="_ _8"> </span>its<span class="_ _8"> </span><span class="ff8">query</span></div><div class="t m1 x3 h7 y8b ff8 fs4 fc0 sc0 ls0 ws0">r<span class="_ _9"></span>ank</div><div class="t m0 x83 h7 y8b ff9 fs4 fc0 sc0 ls0 ws0">r</div><div class="t m1 x43 h7 y8b ff7 fs4 fc0 sc0 ls0 ws0">[</div><div class="t m0 x84 h7 y8b ff7 fs4 fc0 sc0 ls0 ws0">45</div><div class="t m1 x85 h7 y8b ff7 fs4 fc0 sc0 ls0 ws0">,<span class="_ _8"> </span>§4],<span class="_ _8"> </span>i.e.,<span class="_ _8"> </span>the<span class="_ _8"> </span>rank<span class="_ _8"> </span>of<span class="_ _a"> </span>its<span class="_ _8"> </span>result,<span class="_ _8"> </span>and<span class="_ _8"> </span>splits<span class="_ _8"> </span>an<span class="_ _8"> </span>existing<span class="_ _a"> </span>gap<span class="_ _8"> </span>into<span class="_ _a"> </span>tw<span class="_ _9"></span>o<span class="_ _8"> </span>new<span class="_ _8"> </span>gaps,</div><div class="t m1e x0 h7 y8c ff7 fs4 fc0 sc0 ls0 ws0">suc<span class="_ _4"></span>h<span class="_ _5"> </span>that<span class="_ _a"> </span>its<span class="_ _5"> </span>query<span class="_ _5"> </span>rank<span class="_ _a"> </span>is<span class="_ _5"> </span>the<span class="_ _5"> </span>largest<span class="_ _a"> </span>rank<span class="_ _5"> </span>in<span class="_ _5"> </span>the<span class="_ _a"> </span>left<span class="_ _5"> </span>one<span class="_ _5"> </span>of<span class="_ _a"> </span>these<span class="_ _5"> </span>gaps.<span class="_ _3"> </span>After<span class="_ _5"> </span>queries<span class="_ _a"> </span>with</div><div class="t m0 x3 he y8d ff12 fs8 fc0 sc0 ls0 ws0">2</div><div class="t m18 x86 hf y8e ff4 fs9 fc0 sc0 ls0 ws0">The<span class="_ _7"> </span>follow-up<span class="_ _d"> </span>work<span class="_ _7"> </span>[</div><div class="t m0 x87 hf y8e ff4 fs9 fc0 sc0 ls0 ws0">46</div><div class="t m18 x7 hf y8e ff4 fs9 fc0 sc0 ls0 ws0">]<span class="_ _7"> </span>replaces<span class="_ _7"> </span>the<span class="_ _7"> </span>second<span class="_ _7"> </span>and<span class="_ _7"> </span>third<span class="_ _7"> </span>lay<span class="_ _9"></span>er<span class="_ _7"> </span>using<span class="_ _7"> </span><span class="ff5">selectable<span class="_ _7"> </span>priority<span class="_ _7"> </span>queues<span class="_ _2"></span></span>;<span class="_ _7"> </span>we<span class="_ _7"> </span>discuss</div><div class="t m0 x86 hf y8f ff4 fs9 fc0 sc0 ls0 ws0">why<span class="_ _d"> </span>these<span class="_ _7"> </span>are<span class="_ _7"> </span>challenging<span class="_ _7"> </span>to<span class="_ _7"> </span>mak<span class="_ _4"></span>e<span class="_ _7"> </span>external<span class="_ _7"> </span>in<span class="_ _7"> </span>Section<span class="_ _7"> </span>1.4.</div><div class="t m0 x3 he y90 ff12 fs8 fc0 sc0 ls0 ws0">3</div><div class="t m1 x86 hf y5b ff1b fs9 fc0 sc0 ls0 ws0">Construct<span class="_ _5"> </span><span class="ff4">and<span class="_ _a"> </span>iterative<span class="_ _a"> </span>insertion<span class="_ _5"> </span>have<span class="_ _5"> </span>the<span class="_ _a"> </span>same<span class="_ _a"> </span>complexity<span class="_ _5"> </span>in<span class="_ _a"> </span>internal<span class="_ _a"> </span>memory<span class="_ _6"></span>,<span class="_ _a"> </span>but<span class="_ _a"> </span>in<span class="_ _a"> </span>external</span></div><div class="t m0 x86 hf y2c ff4 fs9 fc0 sc0 ls0 ws0">memory<span class="_ _6"></span>,<span class="_ _7"> </span>the<span class="_ _7"> </span>bulk<span class="_ _7"> </span>op<span class="_ _2"></span>eration<span class="_ _7"> </span>can<span class="_ _7"> </span>be<span class="_ _7"> </span>supp<span class="_ _2"></span>orted<span class="_ _7"> </span>more<span class="_ _7"> </span>eﬃcien<span class="_ _4"></span>tly<span class="_ _9"></span>.</div><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",99.071,576.83,null]'><div class="d m13" style="border-style:none;position:absolute;left:202.142157px;bottom:1134.622549px;width:11.955000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf3" data-dest-detail='[3,"XYZ",107.593,127.592,null]'><div class="d m13" style="border-style:none;position:absolute;left:227.284314px;bottom:1130.552288px;width:6.462000px;height:12.490000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf2" data-dest-detail='[2,"XYZ",116.079,724.775,null]'><div class="d m13" style="border-style:none;position:absolute;left:549.006536px;bottom:1130.552288px;width:37.203000px;height:12.490000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf3" data-dest-detail='[3,"XYZ",99.071,397.712,null]'><div class="d m13" style="border-style:none;position:absolute;left:463.934641px;bottom:1109.390523px;width:50.119000px;height:11.955000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",99.071,576.83,null]'><div class="d m13" style="border-style:none;position:absolute;left:221.179739px;bottom:1007.537582px;width:11.955000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",99.071,527.266,null]'><div class="d m13" style="border-style:none;position:absolute;left:497.854575px;bottom:1007.537582px;width:11.955000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4" data-dest-detail='[4,"XYZ",116.079,291.662,null]'><div class="d m13" style="border-style:none;position:absolute;left:160.253268px;bottom:983.209150px;width:49.326000px;height:10.793000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",99.071,675.447,null]'><div class="d m13" style="border-style:none;position:absolute;left:715.011438px;bottom:696.714052px;width:6.974000px;height:8.267000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",99.071,576.83,null]'><div class="d m13" style="border-style:none;position:absolute;left:553.866013px;bottom:597.516340px;width:11.955000px;height:8.267000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",99.071,576.83,null]'><div class="d m13" style="border-style:none;position:absolute;left:569.826797px;bottom:576.354575px;width:11.955000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf3" data-dest-detail='[3,"XYZ",107.593,107.937,null]'><div class="d m13" style="border-style:none;position:absolute;left:710.277778px;bottom:513.019608px;width:6.461000px;height:12.490000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",99.071,539.221,null]'><div class="d m13" style="border-style:none;position:absolute;left:217.415033px;bottom:269.844771px;width:11.955000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",99.071,527.266,null]'><div class="d m13" style="border-style:none;position:absolute;left:302.380719px;bottom:191.390523px;width:10.696000px;height:7.351000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf6" data-dest-detail='[6,"XYZ",116.079,333.207,null]'><div class="d m13" style="border-style:none;position:absolute;left:464.098039px;bottom:171.285948px;width:43.579000px;height:10.666000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.633987,0.000000,0.000000,1.633987,0.000000,0.000000]}'></div></div>
