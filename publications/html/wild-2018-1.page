<div id="pf1" class="pf w0 h0" data-page-no="1"><div class="pc pc1 w0 h0"><img class="bi x0 y0 w1 h1" alt="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkgAAAAvCAIAAACXEqIzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAyElEQVR42u3VoQ6AMBBEQY7Q///gE1uBIcHUQWDG1W56edXdY4wNYEESI/By5ZsC8CW7CQAQNgAQNgAQNgAQNgCEDQCEDQCEDQCEDQCEDQBhAwBhAwBhAwBhAwBhA0DYAEDYAEDYAEDYAEDYABA2ABA2ABA2ABA2ABA2AIQNAIQNAIQNAIQNAIQNAGEDAGEDAGEDAGEDAGEDQNgAQNgAQNgAQNgAEDYAEDYAEDYAEDYAEDYAfuowAaequj6T2GR9rjsD4vqeur4JO5cSXMjrJlcAAAAASUVORK5CYII="/><div class="t m0 x1 h2 y1 ff1 fs0 fc0 sc0 ls0 ws0">Quickso<span class="_ _0"></span>rt<span class="_ _1"> </span>Is<span class="_ _1"> </span>Optimal<span class="_ _1"> </span>F<span class="_ _0"></span>o<span class="_ _0"></span>r<span class="_ _1"> </span>Many<span class="_ _1"> </span>Equal<span class="_ _1"> </span>Keys</div><div class="t m0 x2 h3 y2 ff2 fs1 fc0 sc0 ls0 ws0">Sebastian<span class="_ _2"> </span>Wild</div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">∗</div><div class="t m0 x4 h4 y4 ff4 fs2 fc0 sc0 ls0 ws0">No<span class="_ _3"></span>v<span class="_ _3"></span>em<span class="_ _3"></span>b<span class="_ _4"></span>er<span class="_ _5"> </span>1,<span class="_ _5"> </span>2017</div><div class="t m1 x5 h5 y5 ff4 fs3 fc0 sc0 ls0 ws0">I<span class="_ _5"> </span>pro<span class="_ _3"></span>v<span class="_ _3"></span>e<span class="_ _5"> </span>that<span class="_ _5"> </span>the<span class="_ _5"> </span>a<span class="_ _3"></span>v<span class="_ _3"></span>erage<span class="_ _5"> </span>n<span class="_ _3"></span>um<span class="_ _3"></span>ber<span class="_ _5"> </span>of<span class="_ _6"> </span>comparisons<span class="_ _5"> </span>for<span class="_ _5"> </span>median-of-</div><div class="t m0 x6 h5 y5 ff5 fs3 fc0 sc0 ls0 ws0">k</div><div class="t m1 x7 h5 y5 ff4 fs3 fc0 sc0 ls0 ws0">Quic<span class="_ _3"></span>ksort<span class="_ _5"> </span>(with<span class="_ _5"> </span>fat-</div><div class="t m1 x5 h5 y6 ff4 fs3 fc0 sc0 ls0 ws0">piv<span class="_ _3"></span>ot</div><div class="t m0 x8 h5 y6 ff4 fs3 fc0 sc0 ls0 ws0">a.<span class="_ _7"></span>k.<span class="_ _7"></span>a.</div><div class="t m1 x9 h5 y6 ff4 fs3 fc0 sc0 ls0 ws0">three-w<span class="_ _3"></span>a<span class="_ _3"></span>y<span class="_ _8"> </span>partitioning)<span class="_ _8"> </span>is<span class="_ _8"> </span>asymptotically<span class="_ _8"> </span>only<span class="_ _8"> </span>a<span class="_ _5"> </span>constan<span class="_ _0"></span>t</div><div class="t m0 xa h5 y6 ff5 fs3 fc0 sc0 ls0 ws0">α</div><div class="t m0 xb h6 y7 ff6 fs4 fc0 sc0 ls0 ws0">k</div><div class="t m1 xc h5 y6 ff4 fs3 fc0 sc0 ls0 ws0">times<span class="_ _8"> </span>w<span class="_ _3"></span>orse</div><div class="t m2 x5 h5 y8 ff4 fs3 fc0 sc0 ls0 ws0">than<span class="_ _6"> </span>the<span class="_ _6"> </span>low<span class="_ _0"></span>er<span class="_ _9"> </span>b<span class="_ _4"></span>ound<span class="_ _6"> </span>for<span class="_ _6"> </span>sorting<span class="_ _9"> </span>random<span class="_ _6"> </span>multisets<span class="_ _5"> </span>of</div><div class="t m0 xd h5 y8 ff5 fs3 fc0 sc0 ls0 ws0">n</div><div class="t m2 xe h5 y8 ff4 fs3 fc0 sc0 ls0 ws0">elemen<span class="_ _3"></span>ts<span class="_ _6"> </span>with</div><div class="t m0 xf h5 y8 ff5 fs3 fc0 sc0 ls0 ws0">Ω</div><div class="t m2 x10 h5 y8 ff7 fs3 fc0 sc0 ls0 ws0">(</div><div class="t m0 x11 h5 y8 ff5 fs3 fc0 sc0 ls0 ws0">n</div><div class="t m0 x12 h6 y9 ff6 fs4 fc0 sc0 ls0 ws0">ε</div><div class="t m2 x13 h5 y8 ff7 fs3 fc0 sc0 ls0 ws0">)<span class="_ _6"> </span><span class="ff4">dupli-</span></div><div class="t m3 x5 h5 ya ff4 fs3 fc0 sc0 ls0 ws0">cates<span class="_ _6"> </span>of<span class="_ _6"> </span>each<span class="_ _5"> </span>v<span class="_ _0"></span>alue<span class="_ _9"> </span>(for<span class="_ _6"> </span>any</div><div class="t m0 x14 h5 ya ff5 fs3 fc0 sc0 ls0 ws0">ε<span class="_ _8"> </span>&gt;</div><div class="t m3 x15 h5 ya ff7 fs3 fc0 sc0 ls0 ws0">0<span class="ff4">).<span class="_ _2"> </span>The<span class="_ _9"> </span>constan<span class="_ _3"></span>t<span class="_ _6"> </span>is</span></div><div class="t m0 x16 h5 ya ff5 fs3 fc0 sc0 ls0 ws0">α</div><div class="t m0 x17 h6 yb ff6 fs4 fc0 sc0 ls0 ws0">k</div><div class="t m3 x18 h5 ya ff7 fs3 fc0 sc0 ls0 ws0">=</div><div class="t m0 x19 h5 ya ff7 fs3 fc0 sc0 ls0 ws0">ln</div><div class="t m3 x1a h5 ya ff7 fs3 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x1b h5 ya ff5 fs3 fc0 sc0 ls0 ws0">/</div><div class="t m0 x1c h7 yc ff8 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x1d h5 ya ff5 fs3 fc0 sc0 ls0 ws0">H</div><div class="t m0 x1e h6 yb ff6 fs4 fc0 sc0 ls0 ws0">k<span class="ff9">+1</span></div><div class="t m0 xf h5 ya ffa fs3 fc0 sc0 ls0 ws0">−<span class="_ _a"> </span><span class="ff5">H</span></div><div class="t m0 x1f h6 yd ff9 fs4 fc0 sc0 ls0 ws0">(<span class="ff6">k</span>+1)<span class="ff6">/</span>2</div><div class="t m0 x20 h7 yc ff8 fs2 fc0 sc0 ls0 ws0"></div><div class="t m3 x21 h5 ya ff4 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m1 x5 h5 ye ff4 fs3 fc0 sc0 ls0 ws0">whic<span class="_ _3"></span>h<span class="_ _5"> </span>conv<span class="_ _0"></span>erges<span class="_ _6"> </span>to<span class="_ _6"> </span><span class="ff7">1<span class="_ _6"> </span></span>as</div><div class="t m0 x22 h5 ye ff5 fs3 fc0 sc0 ls0 ws0">k<span class="_ _5"> </span><span class="ffa">→<span class="_ _8"> </span>∞</span></div><div class="t m1 x23 h5 ye ff4 fs3 fc0 sc0 ls0 ws0">,<span class="_ _5"> </span>so<span class="_ _6"> </span>median-of-</div><div class="t m0 x24 h5 ye ff5 fs3 fc0 sc0 ls0 ws0">k</div><div class="t m1 x25 h5 ye ff4 fs3 fc0 sc0 ls0 ws0">Quic<span class="_ _3"></span>ksort<span class="_ _5"> </span>is<span class="_ _6"> </span>asymptotically<span class="_ _6"> </span>optimal</div><div class="t m4 x5 h5 yf ff4 fs3 fc0 sc0 ls0 ws0">for<span class="_ _6"> </span>inputs<span class="_ _6"> </span>with<span class="_ _9"> </span>man<span class="_ _3"></span>y<span class="_ _5"> </span>duplicates.<span class="_ _b"> </span>This<span class="_ _6"> </span>partially<span class="_ _6"> </span>resolves<span class="_ _5"> </span>a<span class="_ _9"> </span>conjecture<span class="_ _6"> </span>b<span class="_ _3"></span>y<span class="_ _6"> </span>Sedgewick</div><div class="t m5 x5 h5 y10 ff4 fs3 fc0 sc0 ls0 ws0">and<span class="_ _b"> </span>Ben<span class="_ _0"></span>tley<span class="_ _b"> </span>(1999, 2002)<span class="_ _b"> </span>and<span class="_ _2"> </span>constitutes<span class="_ _b"> </span>the<span class="_ _b"> </span>ﬁrst<span class="_ _2"> </span>progress<span class="_ _b"> </span>on<span class="_ _b"> </span>the<span class="_ _2"> </span>analysis<span class="_ _b"> </span>of</div><div class="t m0 x5 h5 y11 ff4 fs3 fc0 sc0 ls0 ws0">Quic<span class="_ _3"></span>ksort<span class="_ _6"> </span>with<span class="_ _6"> </span>equal<span class="_ _6"> </span>elements<span class="_ _5"> </span>since<span class="_ _6"> </span>Sedgewick’s<span class="_ _5"> </span>1977<span class="_ _9"> </span>article.</div><div class="t m0 x0 h8 y12 ff1 fs1 fc0 sc0 ls0 ws0">1. Intro<span class="_ _4"></span>duction</div><div class="t m6 x0 h5 y13 ff4 fs3 fc0 sc0 ls0 ws0">Sorting<span class="_ _6"> </span>is<span class="_ _6"> </span>one<span class="_ _9"> </span>of<span class="_ _6"> </span>the<span class="_ _6"> </span>basic<span class="_ _9"> </span>algorithmic<span class="_ _6"> </span>tasks<span class="_ _6"> </span>that<span class="_ _9"> </span>is<span class="_ _6"> </span>used<span class="_ _6"> </span>as<span class="_ _9"> </span>a<span class="_ _6"> </span>fundamental<span class="_ _5"> </span>stepping<span class="_ _6"> </span>stone<span class="_ _9"> </span>for<span class="_ _6"> </span>a</div><div class="t m7 x0 h5 y14 ff4 fs3 fc0 sc0 ls0 ws0">m<span class="_ _3"></span>ultitude<span class="_ _6"> </span>of<span class="_ _6"> </span>other,<span class="_ _6"> </span>more<span class="_ _6"> </span>complex<span class="_ _6"> </span>challenges.<span class="_ _2"> </span>Quic<span class="_ _3"></span>ksort<span class="_ _6"> </span>is<span class="_ _6"> </span>the<span class="_ _6"> </span>metho<span class="_ _4"></span>d<span class="_ _6"> </span>of<span class="_ _6"> </span>choice<span class="_ _5"> </span>for<span class="_ _6"> </span>sorting<span class="_ _6"> </span>in</div><div class="t m8 x0 h5 y15 ff4 fs3 fc0 sc0 ls0 ws0">practice.<span class="_ _2"> </span>Any<span class="_ _5"> </span>undergraduate<span class="_ _6"> </span>studen<span class="_ _3"></span>t<span class="_ _6"> </span>learns<span class="_ _6"> </span>as<span class="_ _6"> </span>a<span class="_ _5"> </span>justiﬁcation<span class="_ _6"> </span>for<span class="_ _6"> </span>its<span class="_ _6"> </span>quality<span class="_ _5"> </span>that<span class="_ _6"> </span>the<span class="_ _6"> </span>av<span class="_ _0"></span>erage</div><div class="t m9 x0 h5 y16 ff4 fs3 fc0 sc0 ls0 ws0">n<span class="_ _3"></span>um<span class="_ _3"></span>b<span class="_ _4"></span>er<span class="_ _6"> </span>of<span class="_ _6"> </span>comparisons<span class="_ _6"> </span>is</div><div class="t m0 x26 h5 y16 ff5 fs3 fc0 sc0 ls0 ws0">Θ</div><div class="t m9 x27 h5 y16 ff7 fs3 fc0 sc0 ls0 ws0">(</div><div class="t m0 x28 h5 y16 ff5 fs3 fc0 sc0 ls0 ws0">n<span class="_ _c"> </span><span class="ff7">log<span class="_ _c"> </span></span>n</div><div class="t m9 x29 h5 y16 ff7 fs3 fc0 sc0 ls0 ws0">)<span class="_ _6"> </span><span class="ff4">for<span class="_ _6"> </span>a<span class="_ _6"> </span>random<span class="_ _9"> </span>p<span class="_ _4"></span>erm<span class="_ _3"></span>utation<span class="_ _6"> </span>of</span></div><div class="t m0 x2a h5 y16 ff5 fs3 fc0 sc0 ls0 ws0">n</div><div class="t m9 x1b h5 y16 ff4 fs3 fc0 sc0 ls0 ws0">distinct<span class="_ _6"> </span>elements,<span class="_ _5"> </span>putting</div><div class="t ma x0 h5 y17 ff4 fs3 fc0 sc0 ls0 ws0">it<span class="_ _6"> </span>into<span class="_ _5"> </span>the<span class="_ _6"> </span>same<span class="_ _9"> </span>complexit<span class="_ _3"></span>y<span class="_ _6"> </span>class<span class="_ _6"> </span>as,</div><div class="t m0 x2b h5 y17 ff4 fs3 fc0 sc0 ls0 ws0">e.<span class="_ _7"></span>g.</div><div class="t ma x2c h5 y17 ff4 fs3 fc0 sc0 ls0 ws0">,<span class="_ _6"> </span>Mergesort.<span class="_ _b"> </span>By<span class="_ _5"> </span>choosing<span class="_ _9"> </span>random<span class="_ _6"> </span>pivots<span class="_ _5"> </span>we<span class="_ _5"> </span>can<span class="_ _6"> </span>make</div><div class="t mb x0 h5 y18 ff4 fs3 fc0 sc0 ls0 ws0">this<span class="_ _6"> </span>a<span class="_ _3"></span>v<span class="_ _3"></span>erage<span class="_ _5"> </span>the<span class="_ _6"> </span><span class="ffb">exp<span class="_ _3"></span>e<span class="_ _0"></span>cte<span class="_ _0"></span>d<span class="_ _2"> </span><span class="ff4">behavior<span class="_ _5"> </span>regardless<span class="_ _6"> </span>of<span class="_ _6"> </span>the<span class="_ _6"> </span>order<span class="_ _6"> </span>of<span class="_ _6"> </span>the<span class="_ _6"> </span>input.<span class="_ _b"> </span>Moreo<span class="_ _0"></span>ver,<span class="_ _5"> </span>the<span class="_ _6"> </span>hidden</span></span></div><div class="t m1 x0 h5 y19 ff4 fs3 fc0 sc0 ls0 ws0">constan<span class="_ _3"></span>ts<span class="_ _5"> </span>in</div><div class="t m0 x2d h5 y19 ff5 fs3 fc0 sc0 ls0 ws0">Θ</div><div class="t m1 x2e h5 y19 ff7 fs3 fc0 sc0 ls0 ws0">(</div><div class="t m0 x2f h5 y19 ff5 fs3 fc0 sc0 ls0 ws0">n<span class="_ _c"> </span><span class="ff7">log<span class="_ _c"> </span></span>n</div><div class="t m1 x30 h5 y19 ff7 fs3 fc0 sc0 ls0 ws0">)<span class="_ _5"> </span><span class="ff4">are<span class="_ _8"> </span>actually<span class="_ _5"> </span>small:<span class="_ _2"> </span>Quicksort<span class="_ _8"> </span>needs<span class="_ _5"> </span></span>2</div><div class="t m0 x31 h5 y19 ff7 fs3 fc0 sc0 ls0 ws0">ln</div><div class="t m1 xe h5 y19 ff7 fs3 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x32 h5 y19 ff5 fs3 fc0 sc0 ls0 ws0">n<span class="_ _c"> </span><span class="ff7">ld</span></div><div class="t m1 x1b h5 y19 ff7 fs3 fc0 sc0 ls0 ws0">(</div><div class="t m0 x7 h5 y19 ff5 fs3 fc0 sc0 ls0 ws0">n</div><div class="t m1 x1d h5 y19 ff7 fs3 fc0 sc0 ls0 ws0">)</div><div class="t m0 x33 h5 y19 ffa fs3 fc0 sc0 ls0 ws0">±<span class="_ _d"></span><span class="ff5">O</span></div><div class="t m1 x34 h5 y19 ff7 fs3 fc0 sc0 ls0 ws0">(</div><div class="t m0 x35 h5 y19 ff5 fs3 fc0 sc0 ls0 ws0">n</div><div class="t m1 x36 h5 y19 ff7 fs3 fc0 sc0 ls0 ws0">)<span class="_ _5"> </span><span class="ff4">comparisons<span class="_ _8"> </span>in</span></div><div class="t m1 x0 h5 y1a ff4 fs3 fc0 sc0 ls0 ws0">exp<span class="_ _4"></span>ectation,</div><div class="t m0 x37 h5 y1a ff4 fs3 fc0 sc0 ls0 ws0">i.<span class="_ _7"></span>e.</div><div class="t m1 x38 h5 y1a ff4 fs3 fc0 sc0 ls0 ws0">,<span class="_ _8"> </span>asymptotically<span class="_ _8"> </span>only<span class="_ _8"> </span>a<span class="_ _8"> </span>factor<span class="_ _8"> </span><span class="ff7">2</span></div><div class="t m0 x39 h5 y1a ff7 fs3 fc0 sc0 ls0 ws0">ln</div><div class="t m1 x3a h5 y1a ff7 fs3 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x3b h5 y1a ffa fs3 fc0 sc0 ls0 ws0">≈</div><div class="t m1 x3c h5 y1a ff7 fs3 fc0 sc0 ls0 ws0">1</div><div class="t m0 x3d h5 y1a ff5 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m1 x3e h5 y1a ff7 fs3 fc0 sc0 ls0 ws0">39<span class="_ _8"> </span><span class="ff4">more<span class="_ _8"> </span>than<span class="_ _8"> </span>the<span class="_ _8"> </span>information-theoretic</span></div><div class="t m5 x0 h5 y1b ff4 fs3 fc0 sc0 ls0 ws0">lo<span class="_ _3"></span>w<span class="_ _3"></span>er<span class="_ _e"> </span>b<span class="_ _4"></span>ound<span class="_ _e"> </span>for<span class="_ _e"> </span>any<span class="_ _9"> </span>comparison-based<span class="_ _e"> </span>sorting<span class="_ _e"> </span>metho<span class="_ _f"></span>d.</div><div class="t m0 x3f h6 y1c ffc fs4 fc0 sc0 ls0 ws0">1</div><div class="t m5 x31 h5 y1b ff4 fs3 fc0 sc0 ls0 ws0">By<span class="_ _e"> </span>c<span class="_ _3"></span>ho<span class="_ _4"></span>osing<span class="_ _e"> </span>the<span class="_ _e"> </span>pivot<span class="_ _9"> </span>as<span class="_ _e"> </span>median</div><div class="t m5 x0 h5 y1d ff4 fs3 fc0 sc0 ls0 ws0">of</div><div class="t m0 x40 h5 y1d ff5 fs3 fc0 sc0 ls0 ws0">k</div><div class="t m5 x41 h5 y1d ff4 fs3 fc0 sc0 ls0 ws0">sample<span class="_ _9"> </span>elements<span class="_ _9"> </span>in<span class="_ _e"> </span>each<span class="_ _9"> </span>step,<span class="_ _e"> </span>for</div><div class="t m0 x42 h5 y1d ff5 fs3 fc0 sc0 ls0 ws0">k</div><div class="t m5 x43 h5 y1d ff4 fs3 fc0 sc0 ls0 ws0">a<span class="_ _9"> </span>ﬁxed,<span class="_ _2"> </span>odd<span class="_ _e"> </span>in<span class="_ _3"></span>teger,<span class="_ _e"> </span>this<span class="_ _e"> </span>constan<span class="_ _3"></span>t<span class="_ _9"> </span>can<span class="_ _e"> </span>b<span class="_ _4"></span>e<span class="_ _e"> </span>reduced</div><div class="t m5 x0 h5 y1e ff4 fs3 fc0 sc0 ls0 ws0">to</div><div class="t m0 x40 h5 y1e ff5 fs3 fc0 sc0 ls0 ws0">α</div><div class="t m0 x44 h6 y1f ff6 fs4 fc0 sc0 ls0 ws0">k</div><div class="t m5 x45 h5 y1e ff7 fs3 fc0 sc0 ls0 ws0">=</div><div class="t m0 x46 h5 y1e ff7 fs3 fc0 sc0 ls0 ws0">ln</div><div class="t m5 x47 h5 y1e ff7 fs3 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x48 h5 y1e ff5 fs3 fc0 sc0 ls0 ws0">/</div><div class="t m0 x49 h7 y20 ff8 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x38 h5 y1e ff5 fs3 fc0 sc0 ls0 ws0">H</div><div class="t m0 x4a h6 y1f ff6 fs4 fc0 sc0 ls0 ws0">k<span class="ff9">+1</span></div><div class="t m0 x4b h5 y1e ffa fs3 fc0 sc0 ls0 ws0">−<span class="_ _a"> </span><span class="ff5">H</span></div><div class="t m0 x4c h6 y21 ff9 fs4 fc0 sc0 ls0 ws0">(<span class="ff6">k</span>+1)<span class="ff6">/</span>2</div><div class="t m0 x4d h7 y20 ff8 fs2 fc0 sc0 ls0 ws0"></div><div class="t m5 x14 h5 y1e ff4 fs3 fc0 sc0 ls0 ws0">[</div><div class="t m0 x4e h5 y1e ff4 fs3 fc0 sc0 ls0 ws0">37</div><div class="t m5 x2b h5 y1e ff4 fs3 fc0 sc0 ls0 ws0">],<span class="_ _6"> </span>where</div><div class="t m0 x4f h5 y1e ff5 fs3 fc0 sc0 ls0 ws0">H</div><div class="t m0 x50 h6 y1f ff6 fs4 fc0 sc0 ls0 ws0">k</div><div class="t m5 x51 h5 y1e ff7 fs3 fc0 sc0 ls0 ws0">=</div><div class="t m0 x52 h7 y22 ff8 fs2 fc0 sc0 ls0 ws0">P</div><div class="t m0 x3c h6 y23 ff6 fs4 fc0 sc0 ls0 ws0">k</div><div class="t m0 x3c h6 y24 ff6 fs4 fc0 sc0 ls0 ws0">i<span class="ff9">=1</span></div><div class="t m5 x53 h5 y1e ff7 fs3 fc0 sc0 ls0 ws0">1</div><div class="t m0 x54 h5 y1e ff5 fs3 fc0 sc0 ls0 ws0">/i</div><div class="t m5 x55 h5 y1e ff4 fs3 fc0 sc0 ls0 ws0">.<span class="_ _b"> </span>Note<span class="_ _6"> </span>that</div><div class="t m0 x56 h5 y1e ff5 fs3 fc0 sc0 ls0 ws0">α</div><div class="t m0 x57 h6 y1f ff6 fs4 fc0 sc0 ls0 ws0">k</div><div class="t m5 x35 h5 y1e ff4 fs3 fc0 sc0 ls0 ws0">con<span class="_ _3"></span>v<span class="_ _3"></span>erges<span class="_ _6"> </span>to<span class="_ _6"> </span><span class="ff7">1<span class="_ _9"> </span></span>as</div><div class="t m0 x0 h5 y25 ff5 fs3 fc0 sc0 ls0 ws0">k<span class="_ _5"> </span><span class="ffa">→<span class="_ _8"> </span>∞<span class="ff4">,<span class="_ _6"> </span>so<span class="_ _9"> </span>Quic<span class="_ _3"></span>ksort’s<span class="_ _5"> </span>exp<span class="_ _4"></span>ected<span class="_ _9"> </span>b<span class="_ _4"></span>eha<span class="_ _3"></span>vior<span class="_ _6"> </span>is<span class="_ _6"> </span>asymptotically<span class="_ _6"> </span>optimal<span class="_ _6"> </span>on<span class="_ _9"> </span>random<span class="_ _6"> </span>p<span class="_ _4"></span>erm<span class="_ _3"></span>utations.</span></span></div><div class="t m5 x58 h5 y26 ff4 fs3 fc0 sc0 ls0 ws0">It<span class="_ _e"> </span>is<span class="_ _2"> </span>also<span class="_ _2"> </span>w<span class="_ _0"></span>ell-known<span class="_ _e"> </span>that<span class="_ _2"> </span>Quic<span class="_ _0"></span>ksort<span class="_ _2"> </span>rarely<span class="_ _e"> </span>deviates<span class="_ _2"> </span>m<span class="_ _3"></span>uc<span class="_ _3"></span>h<span class="_ _e"> </span>from<span class="_ _2"> </span>this<span class="_ _e"> </span>exp<span class="_ _f"></span>ected<span class="_ _e"> </span>b<span class="_ _4"></span>ehavior.</div><div class="t m5 x0 h5 y27 ff4 fs3 fc0 sc0 ls0 ws0">F<span class="_ _10"></span>olklore<span class="_ _6"> </span>calculations<span class="_ _9"> </span>sho<span class="_ _3"></span>w<span class="_ _6"> </span>that<span class="_ _6"> </span>Quicksort<span class="_ _6"> </span>needs,</div><div class="t m0 x59 h5 y27 ff4 fs3 fc0 sc0 ls0 ws0">e.<span class="_ _7"></span>g.</div><div class="t m5 x3c h5 y27 ff4 fs3 fc0 sc0 ls0 ws0">,<span class="_ _6"> </span>at<span class="_ _9"> </span>most<span class="_ _6"> </span><span class="ff7">7<span class="_ _9"> </span></span>times<span class="_ _6"> </span>the<span class="_ _9"> </span>expected<span class="_ _9"> </span>num<span class="_ _0"></span>b<span class="_ _4"></span>er</div><div class="t m5 x0 h5 y28 ff4 fs3 fc0 sc0 ls0 ws0">of<span class="_ _e"> </span>comparisons<span class="_ _e"> </span>with<span class="_ _e"> </span>probabilit<span class="_ _3"></span>y<span class="_ _e"> </span>at<span class="_ _e"> </span>least<span class="_ _e"> </span><span class="ff7">1</span></div><div class="t m0 x5a h5 y28 ffa fs3 fc0 sc0 ls0 ws0">−</div><div class="t m5 x5b h5 y28 ff7 fs3 fc0 sc0 ls0 ws0">1</div><div class="t m0 x50 h5 y28 ff5 fs3 fc0 sc0 ls0 ws0">/n</div><div class="t m0 x5c h6 y29 ff9 fs4 fc0 sc0 ls0 ws0">2</div><div class="t m5 x5d h5 y28 ff4 fs3 fc0 sc0 ls0 ws0">.<span class="_ _11"> </span>This<span class="_ _e"> </span>result<span class="_ _e"> </span>can<span class="_ _e"> </span>b<span class="_ _4"></span>e<span class="_ _e"> </span>strengthened<span class="_ _e"> </span>[</div><div class="t m0 x21 h5 y28 ff4 fs3 fc0 sc0 ls0 ws0">32</div><div class="t m5 x5e h5 y28 ff4 fs3 fc0 sc0 ls0 ws0">]<span class="_ _e"> </span>to</div><div class="t m1 x0 h5 y2a ff4 fs3 fc0 sc0 ls0 ws0">guaran<span class="_ _3"></span>tee<span class="_ _6"> </span>at<span class="_ _6"> </span>most</div><div class="t m0 x5f h5 y2a ff5 fs3 fc0 sc0 ls0 ws0">α</div><div class="t m1 x60 h5 y2a ff4 fs3 fc0 sc0 ls0 ws0">times<span class="_ _6"> </span>the<span class="_ _6"> </span>exp<span class="_ _4"></span>ected<span class="_ _6"> </span>costs<span class="_ _6"> </span>for<span class="_ _9"> </span>an<span class="_ _3"></span>y</div><div class="t m0 x61 h5 y2a ff5 fs3 fc0 sc0 ls0 ws0">α<span class="_ _8"> </span>&gt;</div><div class="t m1 x16 h5 y2a ff7 fs3 fc0 sc0 ls0 ws0">1<span class="_ _6"> </span><span class="ff4">with<span class="_ _6"> </span>probability<span class="_ _5"> </span></span>1</div><div class="t m0 x36 h5 y2a ffa fs3 fc0 sc0 ls0 ws0">−<span class="_ _a"></span><span class="ff5">O</span></div><div class="t m1 x62 h5 y2a ff7 fs3 fc0 sc0 ls0 ws0">(</div><div class="t m0 x63 h5 y2a ff5 fs3 fc0 sc0 ls0 ws0">n</div><div class="t m0 x64 h6 y2b ffd fs4 fc0 sc0 ls0 ws0">−<span class="ff6">c</span></div><div class="t m1 x65 h5 y2a ff7 fs3 fc0 sc0 ls0 ws0">)<span class="_ _6"> </span><span class="ff4">for<span class="_ _6"> </span>all</span></div><div class="t m1 x0 h5 y2c ff4 fs3 fc0 sc0 ls0 ws0">constan<span class="_ _3"></span>ts</div><div class="t m0 x66 h5 y2c ff5 fs3 fc0 sc0 ls0 ws0">c</div><div class="t m1 x67 h5 y2c ff4 fs3 fc0 sc0 ls0 ws0">(indep<span class="_ _4"></span>enden<span class="_ _3"></span>t<span class="_ _5"> </span>of</div><div class="t m0 x68 h5 y2c ff5 fs3 fc0 sc0 ls0 ws0">α</div><div class="t m1 x69 h5 y2c ff4 fs3 fc0 sc0 ls0 ws0">).<span class="_ _2"> </span>Median-of-</div><div class="t m0 x43 h5 y2c ff5 fs3 fc0 sc0 ls0 ws0">k</div><div class="t m1 x5a h5 y2c ff4 fs3 fc0 sc0 ls0 ws0">Quic<span class="_ _3"></span>ksort<span class="_ _5"> </span>is<span class="_ _5"> </span>hence<span class="_ _5"> </span>optimal<span class="_ _5"> </span>not<span class="_ _5"> </span>only<span class="_ _8"> </span>in<span class="_ _5"> </span>exp<span class="_ _4"></span>ectation,</div><div class="t m0 x0 h5 y2d ff4 fs3 fc0 sc0 ls0 ws0">but<span class="_ _6"> </span>almost<span class="_ _6"> </span>alwa<span class="_ _0"></span>ys!</div><div class="t m6 x58 h5 y2e ff4 fs3 fc0 sc0 ls0 ws0">These<span class="_ _6"> </span>guarantees<span class="_ _5"> </span>certainly<span class="_ _9"> </span>justify<span class="_ _6"> </span>the<span class="_ _6"> </span>wide-spread<span class="_ _9"> </span>use<span class="_ _6"> </span>of<span class="_ _9"> </span>Quic<span class="_ _3"></span>ksort,<span class="_ _6"> </span>but<span class="_ _6"> </span>they<span class="_ _9"> </span>only<span class="_ _6"> </span>apply<span class="_ _6"> </span>to</div><div class="t mc x0 h5 y2f ff4 fs3 fc0 sc0 ls0 ws0">inputs<span class="_ _6"> </span>with</div><div class="t m0 x6a h5 y2f ff5 fs3 fc0 sc0 ls0 ws0">n</div><div class="t mc x2e h5 y2f ffb fs3 fc0 sc0 ls0 ws0">distinct<span class="_ _e"> </span><span class="ff4">elements.<span class="_ _2"> </span>In<span class="_ _9"> </span>man<span class="_ _3"></span>y<span class="_ _6"> </span>applications,<span class="_ _9"> </span>duplicates<span class="_ _6"> </span>(</span></div><div class="t m0 x2a h5 y2f ff4 fs3 fc0 sc0 ls0 ws0">i.<span class="_ _7"></span>e.</div><div class="t mc x1c h5 y2f ff4 fs3 fc0 sc0 ls0 ws0">,<span class="_ _6"> </span>elements<span class="_ _5"> </span>that<span class="_ _9"> </span>are<span class="_ _6"> </span>equal</div><div class="t m0 x0 h5 y30 ff4 fs3 fc0 sc0 ls0 ws0">w.<span class="_ _7"></span>r.<span class="_ _7"></span>t.</div><div class="t m7 x6b h5 y30 ff4 fs3 fc0 sc0 ls0 ws0">the<span class="_ _6"> </span>order<span class="_ _6"> </span>relation)<span class="_ _6"> </span>app<span class="_ _4"></span>ear<span class="_ _6"> </span>naturally<span class="_ _10"></span>.<span class="_ _b"> </span>The<span class="_ _5"> </span>SQL<span class="_ _9"> </span>clause</div><div class="t m0 x55 h9 y30 ffe fs3 fc0 sc0 ls0 ws0">GROUP<span class="_ _12"> </span>BY<span class="_ _12"> </span>C</div><div class="t m7 x6c h5 y30 ff4 fs3 fc0 sc0 ls0 ws0">,<span class="_ _6"> </span>for<span class="_ _6"> </span>example,<span class="_ _6"> </span>can<span class="_ _6"> </span>b<span class="_ _4"></span>e</div><div class="t md x0 h5 y31 ff4 fs3 fc0 sc0 ls0 ws0">implemen<span class="_ _3"></span>ted<span class="_ _6"> </span>by<span class="_ _5"> </span>ﬁrst<span class="_ _6"> </span>sorting<span class="_ _9"> </span>ro<span class="_ _3"></span>ws</div><div class="t m0 x6d h5 y31 ff4 fs3 fc0 sc0 ls0 ws0">w.<span class="_ _7"></span>r.<span class="_ _7"></span>t.</div><div class="t md x6e h5 y31 ff4 fs3 fc0 sc0 ls0 ws0">column</div><div class="t m0 x6f h9 y31 ffe fs3 fc0 sc0 ls0 ws0">C</div><div class="t md x59 h5 y31 ff4 fs3 fc0 sc0 ls0 ws0">to<span class="_ _6"> </span>sp<span class="_ _4"></span>eed<span class="_ _6"> </span>up<span class="_ _9"> </span>the<span class="_ _6"> </span>computation<span class="_ _6"> </span>of<span class="_ _9"> </span>aggregating</div><div class="t me x0 h5 y32 ff4 fs3 fc0 sc0 ls0 ws0">functions<span class="_ _6"> </span>like</div><div class="t m0 x70 h9 y32 ffe fs3 fc0 sc0 ls0 ws0">COUNT</div><div class="t me x60 h5 y32 ff4 fs3 fc0 sc0 ls0 ws0">or</div><div class="t m0 x71 h9 y32 ffe fs3 fc0 sc0 ls0 ws0">SUM</div><div class="t me x72 h5 y32 ff4 fs3 fc0 sc0 ls0 ws0">.<span class="_ _6"> </span>Many<span class="_ _5"> </span>rows<span class="_ _5"> </span>with<span class="_ _6"> </span>equal</div><div class="t m0 x73 h9 y32 ffe fs3 fc0 sc0 ls0 ws0">C</div><div class="t me x74 h5 y32 ff4 fs3 fc0 sc0 ls0 ws0">-en<span class="_ _3"></span>tries<span class="_ _6"> </span>are<span class="_ _6"> </span>exp<span class="_ _4"></span>ected<span class="_ _6"> </span>in<span class="_ _9"> </span>suc<span class="_ _3"></span>h<span class="_ _6"> </span>applications.</div><div class="t m0 x75 ha y33 fff fs5 fc0 sc0 ls0 ws0">∗</div><div class="t m0 x76 hb y34 ff10 fs6 fc0 sc0 ls0 ws0">Da<span class="_ _3"></span>vid<span class="_ _8"> </span>R.<span class="_ _5"> </span>Cheriton<span class="_ _8"> </span>School<span class="_ _8"> </span>of<span class="_ _5"> </span>Computer<span class="_ _8"> </span>Science,<span class="_ _8"> </span>Universit<span class="_ _3"></span>y<span class="_ _8"> </span>of<span class="_ _8"> </span>W<span class="_ _0"></span>aterlo<span class="_ _4"></span>o,<span class="_ _8"> </span>Email:<span class="_ _e"> </span><span class="ff11">wild@uwaterloo.ca</span></div><div class="t m0 x75 ha y35 ff12 fs5 fc0 sc0 ls0 ws0">1</div><div class="t m0 x76 hb y36 ff10 fs6 fc0 sc0 ls0 ws0">I<span class="_ _8"> </span>write<span class="_ _5"> </span><span class="ff13">ld<span class="_ _8"> </span></span>for<span class="_ _8"> </span><span class="ff13">log</span></div><div class="t m0 x77 ha y37 ff14 fs5 fc0 sc0 ls0 ws0">2</div><div class="t m0 x4a hb y36 ff10 fs6 fc0 sc0 ls0 ws0">(<span class="ff15">logarithm<span class="_ _3"></span>us<span class="_ _8"> </span>dualis<span class="_ _4"></span><span class="ff10">),<span class="_ _5"> </span>and<span class="_ _8"> </span><span class="ff13">ln<span class="_ _5"> </span></span>for<span class="_ _8"> </span><span class="ff13">log</span></span></span></div><div class="t m0 x78 hc y37 ff16 fs5 fc0 sc0 ls0 ws0">e</div><div class="t m0 x79 hb y36 ff10 fs6 fc0 sc0 ls0 ws0">(<span class="ff15">logarithm<span class="_ _3"></span>us<span class="_ _8"> </span>naturalis<span class="_ _4"></span><span class="ff10">).</span></span></div><a class="l" href="#pf1" data-dest-detail='[1,"XYZ",83.625,101.055,null]'><div class="d mf" style="border-style:none;position:absolute;left:580.661743px;bottom:522.317379px;width:6.725000px;height:13.209000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf27" data-dest-detail='[39,"XYZ",74.409,280.176,null]'><div class="d mf" style="border-style:none;position:absolute;left:399.460082px;bottom:480.358691px;width:12.902000px;height:8.862000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf27" data-dest-detail='[39,"XYZ",74.409,456.514,null]'><div class="d mf" style="border-style:none;position:absolute;left:825.894207px;bottom:389.313529px;width:12.902000px;height:8.862000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.679893,0.000000,0.000000,1.679893,0.000000,0.000000]}'></div></div>
