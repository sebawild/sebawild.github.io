<div id="pf44" class="pf w0 h0" data-page-no="44"><div class="pc pc44 w0 h0"><img class="bi xc y10 w2 ha" alt="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA4wAAAABCAIAAAAabrduAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAHUlEQVRIx+3BMQEAAAzDoPrXGwGzsQNYNQAA+OQAdnsC3T923LwAAAAASUVORK5CYII="/><div class="t m0 xc he y30 ff8 fs4 fc0 sc0 ls0 ws0">4<span class="_ _4c"> </span>Average<span class="_ _9"> </span>Case<span class="_ _a"> </span>Analysis<span class="_ _9"> </span>of<span class="_ _9"> </span>Dual-Pivot<span class="_ _9"> </span>Quicksort</div><div class="t m2a xc hd y31 ff5 fs4 fc0 sc0 ls0 ws0">such<span class="_ _a"> </span>sw<span class="_ _20"></span>aps<span class="_ _a"> </span>an<span class="_ _a"> </span>algorithm<span class="_ _a"> </span>does<span class="_ _a"> </span>in<span class="_ _9"> </span>order<span class="_ _a"> </span>to<span class="_ _a"> </span>sort<span class="_ _a"> </span>a<span class="_ _9"> </span>list<span class="_ _a"> </span>is<span class="_ _a"> </span>a<span class="_ _a"> </span>second<span class="_ _a"> </span>measure<span class="_ _9"> </span>of<span class="_ _a"> </span>its</div><div class="t m0 xc hd y32 ff5 fs4 fc0 sc0 ls0 ws0">efﬁciency<span class="_ _33"></span>.</div><div class="t m4 x26 hd y33 ff5 fs4 fc0 sc0 ls0 ws0">Note<span class="_ _a"> </span>that<span class="_ _a"> </span>in<span class="_ _a"> </span>Algorithm<span class="_ _4"> </span><span class="ff6">7</span>,<span class="_ _a"> </span>the<span class="_ _a"> </span>elements<span class="_ _a"> </span>are<span class="_ _a"> </span>not<span class="_ _4"> </span>really<span class="_ _9"> </span>exchanged,<span class="_ _4"> </span>but<span class="_ _a"> </span>written</div><div class="t m2 xc hd y34 ff5 fs4 fc0 sc0 ls0 ws0">back<span class="_ _0"> </span>one<span class="_ _0"> </span>position<span class="_ _17"> </span>apart<span class="_ _0"> </span>from<span class="_ _0"> </span>the<span class="_ _0"> </span>old<span class="_ _17"> </span>position<span class="_ _0"> </span>of<span class="_ _0"> </span>their<span class="_ _0"> </span>swap<span class="_ _4"> </span>partner<span class="_ _3"></span>.<span class="_ _1e"> </span>As<span class="_ _0"> </span>the</div><div class="t m1a xc hd y35 ff5 fs4 fc0 sc0 ls0 ws0">runtime<span class="_ _a"> </span>contributions<span class="_ _a"> </span>will<span class="_ _a"> </span>be<span class="_ _4"> </span>roughly<span class="_ _9"> </span>the<span class="_ _4"> </span>same<span class="_ _a"> </span>as<span class="_ _a"> </span>for<span class="_ _a"> </span>a<span class="_ _a"> </span>real<span class="_ _a"> </span>exchange,<span class="_ _4"> </span>w<span class="_ _20"></span>e<span class="_ _a"> </span>allo<span class="_ _b"></span>w</div><div class="t m0 xc hd y36 ff5 fs4 fc0 sc0 ls0 ws0">this<span class="_ _a"> </span>slightly<span class="_ _a"> </span>slopp<span class="_ _20"></span>y<span class="_ _a"> </span>deﬁnition<span class="_ _a"> </span>of<span class="_ _a"> </span>a<span class="_ _a"> </span>sw<span class="_ _b"></span>ap.</div><div class="t m2 xc hd y83e ff5 fs4 fc0 sc0 ls0 ws0">In<span class="_ _0"> </span>Chapter<span class="_ _0"> </span><span class="ff6">7</span>,<span class="_ _0"> </span>w<span class="_ _b"></span>e<span class="_ _0"> </span>will<span class="_ _0"> </span>use<span class="_ _0"> </span>a<span class="_ _0"> </span>more<span class="_ _0"> </span>detailed<span class="_ _0"> </span>measure<span class="_ _0"> </span>of<span class="_ _0"> </span>efﬁciency<span class="_ _33"></span>,<span class="_ _0"> </span>namely<span class="_ _0"> </span>the</div><div class="t m2 xc h9 y83f ff5 fs4 fc0 sc0 ls0 ws0">number<span class="_ _a"> </span>of<span class="_ _a"> </span>executed<span class="_ _a"> </span><span class="ff7">machine<span class="_ _a"> </span>instructions<span class="_ _a"> </span></span>for<span class="_ _a"> </span>tw<span class="_ _b"></span>o<span class="_ _a"> </span>speciﬁc<span class="_ _a"> </span>machines.<span class="_ _17"> </span>There,<span class="_ _a"> </span>w<span class="_ _b"></span>e</div><div class="t m1c xc hd y840 ff5 fs4 fc0 sc0 ls0 ws0">will<span class="_ _a"> </span>sho<span class="_ _b"></span>w<span class="_ _a"> </span>that<span class="_ _a"> </span>the<span class="_ _a"> </span>leading<span class="_ _4"> </span>term<span class="_ _a"> </span>is<span class="_ _a"> </span>a<span class="_ _4"> </span>linear<span class="_ _a"> </span>combination<span class="_ _a"> </span>of<span class="_ _a"> </span>the<span class="_ _a"> </span>number<span class="_ _a"> </span>of<span class="_ _4"> </span>sw<span class="_ _20"></span>aps</div><div class="t m2 xc hd ye8 ff5 fs4 fc0 sc0 ls0 ws0">and<span class="_ _17"> </span>the<span class="_ _17"> </span>number<span class="_ _8"> </span>of<span class="_ _17"> </span>comparisons.<span class="_ _27"> </span>Hence,<span class="_ _8"> </span>e<span class="_ _20"></span>v<span class="_ _b"></span>en<span class="_ _17"> </span>for<span class="_ _17"> </span>this<span class="_ _8"> </span>much<span class="_ _17"> </span>more<span class="_ _17"> </span>detailed</div><div class="t m22 xc hd ye9 ff5 fs4 fc0 sc0 ls0 ws0">measure,<span class="_ _9"> </span>swaps<span class="_ _9"> </span>and<span class="_ _a"> </span>comparisons<span class="_ _a"> </span>are<span class="_ _a"> </span>the<span class="_ _9"> </span>only<span class="_ _a"> </span>elementar<span class="_ _6"></span>y<span class="_ _a"> </span>operations<span class="_ _a"> </span>yielding</div><div class="t m0 xc hd yea ff5 fs4 fc0 sc0 ls0 ws0">an<span class="_ _a"> </span>asymptotically<span class="_ _a"> </span>dominant<span class="_ _a"> </span>contribution<span class="_ _a"> </span>to<span class="_ _a"> </span>the<span class="_ _a"> </span>costs.</div><div class="t m0 xc h1a y841 ff1 fs5 fc0 sc0 ls0 ws0">4.2<span class="_ _15"> </span>Recurrence Relation</div><div class="t m0 xc hd y842 ff5 fs4 fc0 sc0 ls0 ws0">Note<span class="_ _a"> </span>that<span class="_ _a"> </span>all<span class="_ _a"> </span>Quicksort<span class="_ _a"> </span>v<span class="_ _20"></span>ariants<span class="_ _a"> </span>in<span class="_ _a"> </span>this<span class="_ _a"> </span>thesis<span class="_ _a"> </span>fulﬁll<span class="_ _a"> </span>the<span class="_ _a"> </span>following<span class="_ _9"> </span>property:</div><div class="t m0 xc h3 y843 ff1 fs1 fc0 sc0 ls0 ws0">Property<span class="_ _19"> </span>1:</div><div class="t m2 x41 he y843 ff8 fs4 fc0 sc0 ls0 ws0">Every<span class="_ _21"> </span>key<span class="_ _8"> </span>comparison<span class="_ _21"> </span>involves<span class="_ _8"> </span>a<span class="_ _21"> </span>pivot<span class="_ _21"> </span>element<span class="_ _8"> </span>of<span class="_ _21"> </span>the<span class="_ _8"> </span>current</div><div class="t m0 xc he y844 ff8 fs4 fc0 sc0 ls0 ws0">partitioning<span class="_ _9"> </span>step.</div><div class="t m2 xc hd y845 ff5 fs4 fc0 sc0 ls0 ws0">In<span class="_ _a"> </span>[</div><div class="t m0 x26 hd y845 ff5 fs4 fc0 sc0 ls0 ws0">Hen<span class="ff6">89</span></div><div class="t m2 x14e h9 y845 ff5 fs4 fc0 sc0 ls0 ws0">],<span class="_ _a"> </span>H<span class="ff6">ennequin<span class="_ _4"> </span></span>sho<span class="_ _20"></span>ws<span class="_ _4"> </span>that<span class="_ _a"> </span>Property<span class="_ _a"> </span><span class="ff6">1<span class="_ _4"> </span></span>is<span class="_ _a"> </span>a<span class="_ _a"> </span>sufﬁcient<span class="_ _a"> </span>criterion<span class="_ _4"> </span>for<span class="_ _a"> </span><span class="ff7">pre-</span></div><div class="t m4 xc h9 y846 ff7 fs4 fc0 sc0 ls0 ws0">serving randomness<span class="_ _9"> </span><span class="ff5">in<span class="_ _a"> </span>subﬁles:<span class="_ _0"> </span>If<span class="_ _9"> </span>the<span class="_ _a"> </span>whole<span class="_ _9"> </span>arra<span class="_ _20"></span>y<span class="_ _a"> </span>is<span class="_ _9"> </span>a<span class="_ _9"> </span>(unifor<span class="_ _6"></span>mly<span class="_ _9"> </span>chosen)<span class="_ _9"> </span>random</span></div><div class="t m2 xc hd y847 ff5 fs4 fc0 sc0 ls0 ws0">permutation<span class="_ _0"> </span>of<span class="_ _4"> </span>its<span class="_ _0"> </span>elements,<span class="_ _4"> </span>so<span class="_ _0"> </span>are<span class="_ _4"> </span>the<span class="_ _4"> </span>subproblems<span class="_ _4"> </span>Quicksort<span class="_ _0"> </span>is<span class="_ _4"> </span>recursiv<span class="_ _20"></span>ely</div><div class="t m4 xc hd y848 ff5 fs4 fc0 sc0 ls0 ws0">inv<span class="_ _20"></span>oked<span class="_ _a"> </span>on.<span class="_ _17"> </span>This<span class="_ _a"> </span>allo<span class="_ _20"></span>ws<span class="_ _4"> </span>us<span class="_ _9"> </span>to<span class="_ _4"> </span>set<span class="_ _a"> </span>up<span class="_ _a"> </span>a<span class="_ _a"> </span>recurrence<span class="_ _a"> </span>relation<span class="_ _a"> </span>for<span class="_ _a"> </span>the<span class="_ _a"> </span>expected<span class="_ _a"> </span>costs,</div><div class="t m2 xc hd y849 ff5 fs4 fc0 sc0 ls0 ws0">as<span class="_ _4"> </span>it<span class="_ _0"> </span>ensures<span class="_ _4"> </span>that<span class="_ _4"> </span>all<span class="_ _0"> </span>partitioning<span class="_ _4"> </span>steps<span class="_ _4"> </span>of<span class="_ _0"> </span>a<span class="_ _4"> </span>subarra<span class="_ _20"></span>y<span class="_ _0"> </span>of<span class="_ _4"> </span>size</div><div class="t m0 x92 h6 y849 ffa fs4 fc0 sc0 ls0 ws0">k</div><div class="t m2 x89 hd y849 ff5 fs4 fc0 sc0 ls0 ws0">ha<span class="_ _20"></span>v<span class="_ _20"></span>e<span class="_ _0"> </span>the<span class="_ _4"> </span>same</div><div class="t m4 xc hd y84a ff5 fs4 fc0 sc0 ls0 ws0">expected<span class="_ _9"> </span>costs<span class="_ _a"> </span>as<span class="_ _9"> </span>the<span class="_ _9"> </span>initial<span class="_ _a"> </span>partitioning<span class="_ _9"> </span>step<span class="_ _a"> </span>for<span class="_ _9"> </span>a<span class="_ _9"> </span>random<span class="_ _a"> </span>permutation<span class="_ _a"> </span>of<span class="_ _9"> </span>size</div><div class="t m0 x70 h6 y84a ffa fs4 fc0 sc0 ls0 ws0">k</div><div class="t m4 xce hd y84a ff5 fs4 fc0 sc0 ls0 ws0">.</div><div class="t m6 x26 hd y84b ff5 fs4 fc0 sc0 ls0 ws0">The<span class="_ _a"> </span>expected<span class="_ _a"> </span>costs</div><div class="t m0 x1df h6 y84b ffa fs4 fc0 sc0 ls0 ws0">C</div><div class="t m0 x81 hf y84c ffa fs6 fc0 sc0 ls0 ws0">n</div><div class="t m6 x75 hd y84b ff5 fs4 fc0 sc0 ls0 ws0">for<span class="_ _a"> </span>sorting<span class="_ _a"> </span>a<span class="_ _a"> </span>random<span class="_ _a"> </span>per<span class="_ _6"></span>mutation<span class="_ _a"> </span>of<span class="_ _a"> </span>length</div><div class="t m0 x1c5 h6 y84b ffa fs4 fc0 sc0 ls0 ws0">n</div><div class="t m6 xc6 hd y84b ff5 fs4 fc0 sc0 ls0 ws0">b<span class="_ _20"></span>y<span class="_ _a"> </span>any</div><div class="t m0 xc hd y84d ff5 fs4 fc0 sc0 ls0 ws0">dual-piv<span class="_ _20"></span>ot<span class="_ _a"> </span>Quicksort<span class="_ _a"> </span>with<span class="_ _a"> </span>Property<span class="_ _a"> </span><span class="ff6">1<span class="_ _a"> </span></span>satisfy<span class="_ _a"> </span>the<span class="_ _a"> </span>follo<span class="_ _20"></span>wing<span class="_ _a"> </span>recurrence<span class="_ _a"> </span>relation:</div><div class="t m0 x1d3 h6 y84e ffa fs4 fc0 sc0 ls0 ws0">C</div><div class="t m0 x1da hf y84f ffa fs6 fc0 sc0 ls0 ws0">0</div><div class="t m0 x4f h10 y84e ffb fs4 fc0 sc0 ls0 ws0">=<span class="_ _9"> </span><span class="ffa">0</span></div><div class="t m0 x1d3 h6 y850 ffa fs4 fc0 sc0 ls0 ws0">C</div><div class="t m0 x1da hf y851 ffa fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x4f h10 y850 ffb fs4 fc0 sc0 ls0 ws0">=<span class="_ _9"> </span><span class="ffa">0</span></div><div class="t m0 x26 h6 y852 ffa fs4 fc0 sc0 ls0 ws0">C</div><div class="t m0 x5e hf y853 ffa fs6 fc0 sc0 ls0 ws0">n</div><div class="t m0 x4f h10 y852 ffb fs4 fc0 sc0 ls0 ws0">=</div><div class="t m0 x57 h1c y854 ff14 fs4 fc0 sc0 ls0 ws0">X</div><div class="t m0 x1c7 hf y855 ffa fs6 fc0 sc0 ls0 ws0">1<span class="fff">6</span>p&lt;q<span class="fff">6</span>n</div><div class="t m0 x1ab h1b y852 ff5 fs4 fc0 sc0 ls0 ws0">Pr<span class="ffb">[</span>piv<span class="_ _20"></span>ots<span class="_ _5"> </span><span class="ffb">(<span class="ffa">p</span></span>,<span class="_ _5"> </span><span class="ffa">q<span class="ffb">)]<span class="_ _31"> </span><span class="ff12">·</span></span></span></div><div class="t m0 x4a h10 y856 ffb fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x16d h10 y852 ff5 fs4 fc0 sc0 ls0 ws0">partitioning<span class="_ _a"> </span>costs<span class="_ _31"> </span><span class="ffb">+<span class="_ _31"> </span></span>recursiv<span class="_ _20"></span>e<span class="_ _a"> </span>costs</div><div class="t m0 x1c5 h10 y856 ffb fs4 fc0 sc0 ls0 ws0">)</div><div class="t m0 x19a hd y852 ff5 fs4 fc0 sc0 ls0 ws0">(<span class="ff6">4</span>.<span class="ff6">1</span>)</div><div class="t m0 x4f h10 y857 ffb fs4 fc0 sc0 ls0 ws0">=</div><div class="t m0 x57 h1c y858 ff14 fs4 fc0 sc0 ls0 ws0">X</div><div class="t m0 x1c7 hf y859 ffa fs6 fc0 sc0 ls0 ws0">1<span class="fff">6</span>p&lt;q<span class="fff">6</span>n</div><div class="t m0 x1ab h6 y857 ffa fs4 fc0 sc0 ls0 ws0">1</div><div class="t m0 xee h21 y85a ff15 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x15b hf y85b ffa fs6 fc0 sc0 ls0 ws0">n</div><div class="t m0 x73 hf y72e ffa fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 x97 h21 y85a ff15 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x177 h1b y857 ff12 fs4 fc0 sc0 ls0 ws0">·</div><div class="t m0 x116 h21 y85a ff15 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 xa5 h10 y857 ff5 fs4 fc0 sc0 ls0 ws0">partitioning<span class="_ _a"> </span>costs<span class="_ _31"> </span><span class="ffb">+<span class="_ _31"> </span><span class="ffa">C</span></span></div><div class="t m0 x1b5 h1d y85c ffa fs6 fc0 sc0 ls0 ws0">p<span class="ffb">−</span>1</div><div class="t m0 x191 h10 y857 ffb fs4 fc0 sc0 ls0 ws0">+<span class="_ _31"> </span><span class="ffa">C</span></div><div class="t m0 x121 h1d y85c ffa fs6 fc0 sc0 ls0 ws0">q<span class="ffb">−</span>p<span class="ffb">−</span>1</div><div class="t m0 x1e4 h10 y857 ffb fs4 fc0 sc0 ls0 ws0">+<span class="_ _31"> </span><span class="ffa">C</span></div><div class="t m0 x19d h1d y85d ffa fs6 fc0 sc0 ls0 ws0">n<span class="ffb">−</span>q</div><div class="t m0 x2a h21 y85a ff15 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x4f h10 y85e ffb fs4 fc0 sc0 ls0 ws0">=<span class="_ _9"> </span><span class="ff7">pc</span></div><div class="t m0 x4c hf y85f ffa fs6 fc0 sc0 ls0 ws0">n</div><div class="t m0 x1dd h10 y85e ffb fs4 fc0 sc0 ls0 ws0">+<span class="_ _58"> </span><span class="ffa">1</span></div><div class="t m0 x159 h21 y860 ff15 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 xab hf y861 ffa fs6 fc0 sc0 ls0 ws0">n</div><div class="t m0 xab hf y862 ffa fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 x1ce h21 y860 ff15 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x5d h1c y863 ff14 fs4 fc0 sc0 ls0 ws0">X</div><div class="t m0 x9d hf y864 ffa fs6 fc0 sc0 ls0 ws0">1<span class="fff">6</span>p&lt;q<span class="fff">6</span>n</div><div class="t m0 x120 h21 y860 ff15 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x60 h6 y85e ffa fs4 fc0 sc0 ls0 ws0">C</div><div class="t m0 x19c h1d y865 ffa fs6 fc0 sc0 ls0 ws0">p<span class="ffb">−</span>1</div><div class="t m0 x147 h10 y85e ffb fs4 fc0 sc0 ls0 ws0">+<span class="_ _31"> </span><span class="ffa">C</span></div><div class="t m0 xba h1d y865 ffa fs6 fc0 sc0 ls0 ws0">q<span class="ffb">−</span>p<span class="ffb">−</span>1</div><div class="t m0 x19f h10 y85e ffb fs4 fc0 sc0 ls0 ws0">+<span class="_ _31"> </span><span class="ffa">C</span></div><div class="t m0 x173 h1d y866 ffa fs6 fc0 sc0 ls0 ws0">n<span class="ffb">−</span>q</div><div class="t m0 x1eb h21 y860 ff15 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x84 h10 y85e ff5 fs4 fc0 sc0 ls0 ws0">,<span class="_ _62"> </span><span class="ffb">(<span class="ffa">n<span class="_ _9"> </span><span class="fff">&gt;<span class="_ _a"> </span></span>2</span>)</span></div><div class="t m0 xc hb y11 ff6 fs4 fc0 sc0 ls0 ws0">66</div><a class="l" href="#pf40" data-dest-detail='[64,"XYZ",70.866,764.85,null]'><div class="d m1" style="border-style:none;position:absolute;left:272.866704px;bottom:1184.032281px;width:71.097000px;height:15.028000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf7d" data-dest-detail='[125,"XYZ",70.866,756.63,null]'><div class="d m1" style="border-style:none;position:absolute;left:145.480416px;bottom:1054.092555px;width:60.641000px;height:15.028000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc7" data-dest-detail='[199,"XYZ",70.866,760.775,null]'><div class="d m1" style="border-style:none;position:absolute;left:151.853930px;bottom:688.601590px;width:39.461000px;height:13.902000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf44" data-dest-detail='[68,"XYZ",70.866,470.107,null]'><div class="d m1" style="border-style:none;position:absolute;left:474.433708px;bottom:687.373588px;width:64.014000px;height:15.028000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf44" data-dest-detail='[68,"XYZ",70.866,470.107,null]'><div class="d m1" style="border-style:none;position:absolute;left:376.369953px;bottom:486.337430px;width:62.657000px;height:15.028000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.679893,0.000000,0.000000,1.679893,0.000000,0.000000]}'></div></div>
