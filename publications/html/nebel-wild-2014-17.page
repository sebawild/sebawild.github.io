<div id="pf11" class="pf w0 h0" data-page-no="11"><div class="pc pc11 w0 h0"><div class="t m0 x0 hc y1 ff1 fs0 fc0 sc0 ls0 ws0">Pivot Sampling in Dual-Pivot Quicksort<span class="_ _3f"> </span><span class="ff2">17</span></div><div class="t m0 x0 h13 y27 ff4 fs9 fc0 sc0 ls0 ws0">B.2<span class="_ _46"> </span>Randomness Preser<span class="_ _21"></span>vation</div><div class="t m0 x0 hc y3f9 ff2 fs0 fc0 sc0 ls0 ws0">For<span class="_ _2"> </span>analysis,<span class="_ _2"> </span>it<span class="_ _2"> </span>is<span class="_ _2"> </span>vital<span class="_ _2"> </span>to<span class="_ _2"> </span>preserv<span class="_ _3"></span>e<span class="_ _2"> </span>the<span class="_ _2"> </span>input<span class="_ _2"> </span>distribution<span class="_ _2"> </span>for<span class="_ _2"> </span>recursi<span class="_ _3"></span>ve<span class="_ _2"> </span>calls,<span class="_ _2"> </span>as<span class="_ _2"> </span>this<span class="_ _2"> </span>allo<span class="_ _d"></span>ws<span class="_ _2"> </span>us<span class="_ _2"> </span>to<span class="_ _2"> </span>set<span class="_ _2"> </span>up<span class="_ _2"> </span>a</div><div class="t m0 x0 hc y3fa ff2 fs0 fc0 sc0 ls0 ws0">recurrence<span class="_ _c"> </span>equation<span class="_ _c"> </span>for<span class="_ _c"> </span>costs,<span class="_ _c"> </span>which<span class="_ _c"> </span>in<span class="_ _c"> </span>turn<span class="_ _c"> </span>underlies<span class="_ _c"> </span>the<span class="_ _c"> </span>precise<span class="_ _c"> </span>analysis<span class="_ _c"> </span>of<span class="_ _c"> </span>Quicksort.<span class="_ _1b"> </span>While<span class="_ _c"> </span>Y<span class="_ _0"></span>aros-</div><div class="t m0 x0 hc y3fb ff2 fs0 fc0 sc0 ls0 ws0">lavskiy’<span class="_ _0"></span>s<span class="_ _2"> </span>method<span class="_ _2"> </span>(as<span class="_ _2"> </span>gi<span class="_ _3"></span>ven<span class="_ _2"> </span>in<span class="_ _2"> </span>Algorithm<span class="_ _2"> </span>2)<span class="_ _8"> </span>preserves<span class="_ _2"> </span>randomness,<span class="_ _2"> </span>piv<span class="_ _3"></span>ot<span class="_ _2"> </span>sampling<span class="_ _2"> </span>requires<span class="_ _2"> </span>special<span class="_ _2"> </span>care.</div><div class="t m0 x0 hc y3fc ff2 fs0 fc0 sc0 ls0 ws0">For<span class="_ _2"> </span>ef<span class="_ _3"></span>ﬁciently<span class="_ _2"> </span>selecting<span class="_ _2"> </span>the<span class="_ _2"> </span>piv<span class="_ _3"></span>ots,<span class="_ _c"> </span>we<span class="_ _2"> </span><span class="ff1">sort<span class="_ _2"> </span></span>the<span class="_ _2"> </span>entire<span class="_ _2"> </span>sample,<span class="_ _2"> </span>so<span class="_ _2"> </span>the<span class="_ _2"> </span>sampled-out<span class="_ _2"> </span>elements<span class="_ _2"> </span>are<span class="_ _2"> </span>far<span class="_ _2"> </span>from</div><div class="t m0 x0 hc y3fd ff2 fs0 fc0 sc0 ls0 ws0">randomly<span class="_ _2"> </span>ordered;<span class="_ _f"> </span>including<span class="_ _2"> </span>them<span class="_ _c"> </span>in<span class="_ _2"> </span>partitioning<span class="_ _2"> </span>would<span class="_ _2"> </span>not<span class="_ _c"> </span>produce<span class="_ _2"> </span>randomly<span class="_ _c"> </span>ordered<span class="_ _2"> </span>subarrays!<span class="_ _2f"> </span>But</div><div class="t m0 x0 hc y3fe ff2 fs0 fc0 sc0 ls0 ws0">there is also no need to include them<span class="_ _8"> </span>in partitioning, as<span class="_ _8"> </span>we already<span class="_ _8"> </span>have the sample di<span class="_ _3"></span>vided into the<span class="_ _8"> </span>three</div><div class="t m0 x0 h6 y3ff ff2 fs0 fc0 sc0 ls0 ws0">groups of <span class="ff6">t</span></div><div class="t m0 x196 hf y400 ffb fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x163 h6 y3ff ff2 fs0 fc0 sc0 ls0 ws0">small, <span class="ff6">t</span></div><div class="t m0 x153 hf y400 ffb fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 x83 h6 y3ff ff2 fs0 fc0 sc0 ls0 ws0">medium and <span class="ff6">t</span></div><div class="t m0 xf7 hf y400 ffb fs6 fc0 sc0 ls0 ws0">3</div><div class="t m0 x144 hc y3ff ff2 fs0 fc0 sc0 ls0 ws0">large elements.<span class="_ _2"> </span>All<span class="_ _8"> </span>ordinary<span class="_ _8"> </span>elements<span class="_ _8"> </span>are<span class="_ _8"> </span>still<span class="_ _8"> </span>in<span class="_ _8"> </span>random<span class="_ _8"> </span>order<span class="_ _8"> </span>and</div><div class="t m0 x0 hc y2e2 ff2 fs0 fc0 sc0 ls0 ws0">Y<span class="_ _13"></span>aroslavskiy’<span class="_ _3"></span>s partitioning divides them into three randomly ordered subarrays.</div><div class="t m0 x5 hc y401 ff2 fs0 fc0 sc0 ls0 ws0">What<span class="_ _2"> </span>remains<span class="_ _c"> </span>problematic<span class="_ _2"> </span>is<span class="_ _2"> </span>the<span class="_ _c"> </span>order<span class="_ _2"> </span>of<span class="_ _2"> </span>elements<span class="_ _c"> </span>for<span class="_ _2"> </span>recursive<span class="_ _2"> </span>calls.<span class="_ _12"> </span>The<span class="_ _2"> </span>second<span class="_ _c"> </span>row<span class="_ _2"> </span>in<span class="_ _2"> </span>Figure<span class="_ _2"> </span>6</div><div class="t m0 x0 hc y402 ff2 fs0 fc0 sc0 ls0 ws0">shows<span class="_ _8"> </span>the<span class="_ _2"> </span>situation<span class="_ _2"> </span>after<span class="_ _2"> </span>all<span class="_ _2"> </span>sample<span class="_ _2"> </span>elements<span class="_ _2"> </span>(shaded<span class="_ _2"> </span>gray)<span class="_ _2"> </span>hav<span class="_ _3"></span>e<span class="_ _2"> </span>been<span class="_ _2"> </span>put<span class="_ _2"> </span>into<span class="_ _2"> </span>the<span class="_ _2"> </span>correct<span class="_ _2"> </span>subarray<span class="_ _3"></span>.<span class="_ _b"> </span>As</div><div class="t m0 x0 h6 y403 ff2 fs0 fc0 sc0 ls0 ws0">the<span class="_ _2"> </span>sample<span class="_ _2"> </span>was<span class="_ _2"> </span>sorted,<span class="_ _2"> </span>the<span class="_ _2"> </span>left<span class="_ _2"> </span>and<span class="_ _2"> </span>middle<span class="_ _2"> </span>subarrays<span class="_ _2"> </span>ha<span class="_ _3"></span>ve<span class="_ _2"> </span>sorted<span class="_ _2"> </span>preﬁxes<span class="_ _2"> </span>of<span class="_ _2"> </span>length<span class="_ _2"> </span><span class="ff6">t</span></div><div class="t m0 x1a4 hf y404 ffb fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x161 h6 y403 ff2 fs0 fc0 sc0 ls0 ws0">resp.<span class="_ _2"> </span><span class="ff6">t</span></div><div class="t m0 x19 hf y404 ffb fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 xee hc y403 ff2 fs0 fc0 sc0 ls0 ws0">followed</div><div class="t m0 x0 h6 y405 ff2 fs0 fc0 sc0 ls0 ws0">by a random permutation<span class="_ _11"> </span>of the remaining elements.<span class="_ _8"> </span>Similarly<span class="_ _3"></span>, the right subarray has<span class="_ _11"> </span>a sorted suf<span class="_ _3"></span>ﬁx of <span class="ff6">t</span></div><div class="t m0 x96 hf y406 ffb fs6 fc0 sc0 ls0 ws0">3</div><div class="t m0 x0 h6 y407 ff2 fs0 fc0 sc0 ls0 ws0">elements.<span class="_ _14"> </span>So<span class="_ _2"> </span>the<span class="_ _2"> </span>subarrays are<span class="_ _2"> </span><span class="ff1">not<span class="_ _2"> </span></span>randomly<span class="_ _2"> </span>ordered,<span class="_ _8"> </span>(except<span class="_ _2"> </span>for<span class="_ _8"> </span>the<span class="_ _2"> </span>trivial case<span class="_ _2"> </span><span class="ffd">t<span class="_ _c"> </span><span class="ff5">=<span class="_ _c"> </span>0</span></span>)!<span class="_ _27"> </span>How<span class="_ _8"> </span>shall<span class="_ _2"> </span>we</div><div class="t m0 x0 hc y408 ff2 fs0 fc0 sc0 ls0 ws0">deal with this non-randomness?</div><div class="t m0 x5 hc y409 ff2 fs0 fc0 sc0 ls0 ws0">The maybe surprising answer<span class="_ _8"> </span>is<span class="_ _8"> </span>that we<span class="_ _8"> </span>can<span class="_ _8"> </span>indeed <span class="ff1">exploit<span class="_ _8"> </span></span>this<span class="_ _8"> </span>non-randomness;<span class="_ _8"> </span>not only<span class="_ _8"> </span>in<span class="_ _8"> </span>terms<span class="_ _8"> </span>of</div><div class="t m0 x0 hc y40a ff2 fs0 fc0 sc0 ls0 ws0">a precise<span class="_ _2"> </span>analysis, but also<span class="_ _2"> </span>for efﬁcienc<span class="_ _3"></span>y:<span class="_ _f"> </span>the sorted<span class="_ _2"> </span>part <span class="ff1">always<span class="_ _8"> </span></span>lies<span class="_ _2"> </span>completely inside<span class="_ _8"> </span>the<span class="_ _2"> </span><span class="ff1">sample range</span></div><div class="t m0 x0 hc y40b ff2 fs0 fc0 sc0 ls0 ws0">for<span class="_ _2"> </span>the<span class="_ _2"> </span>next<span class="_ _2"> </span>partitioning<span class="_ _2"> </span>phase.<span class="_ _27"> </span>So<span class="_ _2"> </span>our<span class="_ _2"> </span>speciﬁc<span class="_ _2"> </span>kind<span class="_ _2"> </span>of<span class="_ _2"> </span>non-randomness<span class="_ _2"> </span>only<span class="_ _2"> </span>affects<span class="_ _8"> </span>sorting<span class="_ _2"> </span>the<span class="_ _2"> </span>sample</div><div class="t m0 x0 hc y40c ff2 fs0 fc0 sc0 ls0 ws0">(in subsequent recursiv<span class="_ _3"></span>e calls), but it ne<span class="_ _3"></span>ver affects the partitioning process itself!</div><div class="t m0 x5 hc y40d ff2 fs0 fc0 sc0 ls0 ws0">It seems natural that<span class="_ _8"> </span>sorting should<span class="_ _8"> </span>somehow be able to<span class="_ _8"> </span>proﬁt from<span class="_ _8"> </span>partially<span class="_ _8"> </span>sorted input,<span class="_ _8"> </span>and<span class="_ _8"> </span>in<span class="_ _8"> </span>fact,</div><div class="t m0 x0 hc y40e ff2 fs0 fc0 sc0 ls0 ws0">many sorting<span class="_ _2"> </span>methods are<span class="_ _2"> </span>kno<span class="_ _3"></span>wn<span class="_ _2"> </span>to<span class="_ _8"> </span>be<span class="_ _2"> </span><span class="ffa">adapti<span class="_ _3"></span>ve<span class="_ _c"> </span><span class="ff2">to<span class="_ _2"> </span>e<span class="_ _d"></span>xisting<span class="_ _8"> </span>order<span class="_ _2"> </span>(Esti<span class="_ _3"></span>vill-Castro<span class="_ _2"> </span>and<span class="_ _8"> </span>W<span class="_ _0"></span>ood,<span class="_ _2"> </span>1992).<span class="_ _14"> </span>F<span class="_ _3"></span>or</span></span></div><div class="t m0 x0 h6 y40f ff2 fs0 fc0 sc0 ls0 ws0">our<span class="_ _8"> </span>special<span class="_ _2"> </span>case of<span class="_ _2"> </span>a fully<span class="_ _2"> </span>sorted preﬁx<span class="_ _2"> </span>or sufﬁx of<span class="_ _2"> </span>length <span class="ff6">s<span class="_ _c"> </span><span class="ffc">≥<span class="_ _c"> </span><span class="ff5">1 </span></span></span>and a<span class="_ _2"> </span>fully random<span class="_ _2"> </span>rest,<span class="_ _8"> </span>we<span class="_ _2"> </span>can simply</div><div class="t m0 x0 h6 y410 ff2 fs0 fc0 sc0 ls0 ws0">use<span class="_ _2"> </span>Insertionsort<span class="_ _2"> </span>where<span class="_ _2"> </span>the<span class="_ _2"> </span>ﬁrst<span class="_ _2"> </span><span class="ff6">s<span class="_ _2"> </span></span>iterations<span class="_ _2"> </span>of<span class="_ _2"> </span>the<span class="_ _2"> </span>outer<span class="_ _8"> </span>loop<span class="_ _2"> </span>are<span class="_ _2"> </span>skipped.<span class="_ _12"> </span>Our<span class="_ _2"> </span>Insertionsort<span class="_ _2"> </span>implemen-</div><div class="t m0 x0 h6 y411 ff2 fs0 fc0 sc0 ls0 ws0">tations<span class="_ _c"> </span>accept<span class="_ _c"> </span><span class="ff6">s<span class="_ _f"> </span></span>as<span class="_ _c"> </span>an<span class="_ _c"> </span>additional<span class="_ _f"> </span>parameter<span class="_ _0"></span>.<span class="_ _29"> </span>What<span class="_ _f"> </span>is<span class="_ _c"> </span>more,<span class="_ _f"> </span>we<span class="_ _f"> </span>can<span class="_ _c"> </span>also<span class="_ _c"> </span>precisely<span class="_ _f"> </span><span class="ff1">quantify<span class="_ _c"> </span></span>the<span class="_ _c"> </span>savings</div><div class="t m0 x0 h6 y412 ff2 fs0 fc0 sc0 ls0 ws0">resulting from skipping the<span class="_ _11"> </span>ﬁrst <span class="ff6">s<span class="_ _8"> </span></span>iterations:<span class="_ _2"> </span>Apart<span class="_ _11"> </span>from per-call<span class="_ _11"> </span>overhead,<span class="_ _11"> </span>we sav<span class="_ _3"></span>e exactly what it<span class="_ _11"> </span>would</div><div class="t m0 x0 hc y413 ff2 fs0 fc0 sc0 ls0 ws0">hav<span class="_ _3"></span>e<span class="_ _8"> </span>costed to<span class="_ _8"> </span>sort<span class="_ _8"> </span>a<span class="_ _8"> </span>random<span class="_ _8"> </span>permutation<span class="_ _8"> </span>of<span class="_ _8"> </span>the<span class="_ _8"> </span>length<span class="_ _8"> </span>of this<span class="_ _8"> </span>preﬁx/sufﬁx with Insertionsort.<span class="_ _c"> </span>As all<span class="_ _8"> </span>pre-</div><div class="t m0 x0 hc y414 ff2 fs0 fc0 sc0 ls0 ws0">ﬁxes/suf<span class="_ _3"></span>ﬁxes<span class="_ _2"> </span>ha<span class="_ _3"></span>ve<span class="_ _2"> </span>constant<span class="_ _2"> </span>lengths<span class="_ _2"> </span>(independent<span class="_ _2"> </span>of<span class="_ _8"> </span>the<span class="_ _2"> </span>length<span class="_ _2"> </span>of<span class="_ _2"> </span>the<span class="_ _2"> </span>current<span class="_ _2"> </span>subarray),<span class="_ _2"> </span>precise<span class="_ _2"> </span>analysis</div><div class="t m0 x0 hc y415 ff2 fs0 fc0 sc0 ls0 ws0">remains<span class="_ _2"> </span>feasible.<span class="_ _14"> </span>Thereby<span class="_ _0"></span>,<span class="_ _2"> </span>we<span class="_ _2"> </span>need<span class="_ _8"> </span>not<span class="_ _2"> </span>be<span class="_ _2"> </span>afraid of<span class="_ _2"> </span>non-randomness<span class="_ _2"> </span><span class="ff1">per<span class="_ _8"> </span>se</span>,<span class="_ _2"> </span>as<span class="_ _2"> </span>long<span class="_ _8"> </span>as<span class="_ _2"> </span>we<span class="_ _2"> </span>can<span class="_ _8"> </span>preserve</div><div class="t m0 x0 hc y416 ff2 fs0 fc0 sc0 ls0 ws0">the <span class="ff1">same kind<span class="_ _8"> </span></span>of non-randomness for recursive calls and precisely analyze resulting costs.</div><div class="t m0 x0 h13 y417 ff4 fs9 fc0 sc0 ls0 ws0">B.3<span class="_ _46"> </span>Generalized Y<span class="_ _5"></span>arosla<span class="_ _3"></span>vskiy Quicksor<span class="_ _21"></span>t</div><div class="t m0 x0 hc y418 ff2 fs0 fc0 sc0 ls0 ws0">Combining<span class="_ _c"> </span>the<span class="_ _f"> </span>implementation<span class="_ _f"> </span>of<span class="_ _f"> </span>generalized<span class="_ _f"> </span>piv<span class="_ _3"></span>ot<span class="_ _f"> </span>sampling<span class="_ _a"> </span>—<span class="_ _9"> </span>paying<span class="_ _f"> </span>attention<span class="_ _f"> </span>to<span class="_ _f"> </span>the<span class="_ _f"> </span>subtleties<span class="_ _f"> </span>dis-</div><div class="t m0 x0 hc y419 ff2 fs0 fc0 sc0 ls0 ws0">cussed<span class="_ _b"> </span>in<span class="_ _b"> </span>the<span class="_ _b"> </span>previous<span class="_ _27"> </span>sections<span class="_ _a"> </span>—<span class="_ _a"> </span>with<span class="_ _b"> </span>Y<span class="_ _0"></span>arosla<span class="_ _3"></span>vskiy’<span class="_ _3"></span>s<span class="_ _12"> </span>partitioning<span class="_ _27"> </span>method,<span class="_ _2f"> </span>we<span class="_ _b"> </span>ﬁnally<span class="_ _b"> </span>obtain<span class="_ _12"> </span>Algo-</div><div class="t m0 x0 hc y2fd ff2 fs0 fc0 sc0 ls0 ws0">rithm<span class="_ _f"> </span>1.<span class="_ _22"> </span>W<span class="_ _0"></span>e<span class="_ _f"> </span>refer<span class="_ _f"> </span>to<span class="_ _f"> </span>this<span class="_ _f"> </span>sorting<span class="_ _f"> </span>method<span class="_ _f"> </span>as<span class="_ _f"> </span><span class="ffa">Generalized<span class="_ _f"> </span>Y<span class="_ _0"></span>aroslavskiy<span class="_ _c"> </span>Quicksort<span class="_ _b"> </span><span class="ff2">with<span class="_ _f"> </span>piv<span class="_ _3"></span>ot<span class="_ _f"> </span>sampling</span></span></div><div class="t m0 x0 h6 y41a ff2 fs0 fc0 sc0 ls0 ws0">parameter<span class="_ _b"> </span><span class="ffd">t<span class="_ _22"> </span><span class="ff5">=<span class="_ _18"> </span>(<span class="ff6">t</span></span></span></div><div class="t m0 x1a5 hf y41b ffb fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x11e h6 y41a ff6 fs0 fc0 sc0 ls0 ws0">,<span class="_ _9"> </span>t</div><div class="t m0 xd6 hf y41b ffb fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 x82 h6 y41a ff6 fs0 fc0 sc0 ls0 ws0">,<span class="_ _9"> </span>t</div><div class="t m0 x189 hf y41b ffb fs6 fc0 sc0 ls0 ws0">3</div><div class="t m0 xf5 h6 y41a ff5 fs0 fc0 sc0 ls0 ws0">)<span class="_ _b"> </span><span class="ff2">and<span class="_ _27"> </span>Insertionsort<span class="_ _b"> </span>threshold<span class="_ _b"> </span><span class="ff6">w<span class="_ _21"></span></span>,<span class="_ _2f"> </span>shortly<span class="_ _b"> </span>written<span class="_ _b"> </span>as<span class="_ _b"> </span><span class="ff6">Y</span></span></div><div class="t m0 x7f hf y41c fff fs6 fc0 sc0 ls0 ws0">w</div><div class="t m0 x168 h19 y41d ff15 fs6 fc0 sc0 ls0 ws0">t</div><div class="t m0 xfc hc y41a ff2 fs0 fc0 sc0 ls0 ws0">.<span class="_ _16"> </span>W<span class="_ _13"></span>e<span class="_ _b"> </span>assume<span class="_ _b"> </span>that</div><div class="t m0 x0 h6 y41e ff6 fs0 fc0 sc0 ls0 ws0">w<span class="_ _1b"> </span><span class="ffc">≥<span class="_ _2f"> </span></span>k<span class="_ _c"> </span><span class="ffc">−<span class="_ _c"> </span><span class="ff5">1<span class="_ _12"> </span>=<span class="_ _2f"> </span></span></span>t</div><div class="t m0 x9a hf y41f ffb fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x9b h6 y41e ff5 fs0 fc0 sc0 ls0 ws0">+<span class="_ _2"> </span><span class="ff6">t</span></div><div class="t m0 x82 hf y41f ffb fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 x189 h6 y41e ff5 fs0 fc0 sc0 ls0 ws0">+<span class="_ _2"> </span><span class="ff6">t</span></div><div class="t m0 x10b hf y41f ffb fs6 fc0 sc0 ls0 ws0">3</div><div class="t m0 x104 h6 y41e ff5 fs0 fc0 sc0 ls0 ws0">+<span class="_ _2"> </span>1<span class="_ _14"> </span><span class="ff2">to<span class="_ _f"> </span>make<span class="_ _f"> </span>sure<span class="_ _14"> </span>that<span class="_ _f"> </span>ev<span class="_ _3"></span>ery<span class="_ _14"> </span>partitioning<span class="_ _f"> </span>step<span class="_ _14"> </span>has<span class="_ _f"> </span>enough<span class="_ _f"> </span>elements<span class="_ _14"> </span>for</span></div><div class="t m0 x0 hc y420 ff2 fs0 fc0 sc0 ls0 ws0">piv<span class="_ _3"></span>ot sampling.</div><div class="t m0 x5 hc y421 ff2 fs0 fc0 sc0 ls0 ws0">The<span class="_ _f"> </span>last<span class="_ _14"> </span>parameter<span class="_ _f"> </span>of<span class="_ _f"> </span>Algorithm<span class="_ _14"> </span>1<span class="_ _f"> </span>tells<span class="_ _f"> </span>the<span class="_ _14"> </span>current<span class="_ _f"> </span>call<span class="_ _14"> </span>whether<span class="_ _f"> </span>it<span class="_ _f"> </span>is<span class="_ _14"> </span>a<span class="_ _f"> </span>topmost<span class="_ _f"> </span>call<span class="_ _14"> </span>(<span class="ff2b">root</span>)<span class="_ _f"> </span>or<span class="_ _14"> </span>a</div><div class="t m0 x0 hc y422 ff2 fs0 fc0 sc0 ls0 ws0">recursiv<span class="_ _3"></span>e<span class="_ _11"> </span>call<span class="_ _11"> </span>on<span class="_ _a"> </span>a<span class="_ _11"> </span>left,<span class="_ _11"> </span>middle<span class="_ _a"> </span>or<span class="_ _11"> </span>right<span class="_ _11"> </span>subarray<span class="_ _a"> </span>of<span class="_ _11"> </span>some<span class="_ _11"> </span>earlier<span class="_ _a"> </span>inv<span class="_ _3"></span>ocation.<span class="_ _2"> </span>By<span class="_ _11"> </span>that,<span class="_ _a"> </span>we<span class="_ _11"> </span>know<span class="_ _a"> </span>which<span class="_ _11"> </span>part<span class="_ _11"> </span>of</div><div class="t m0 x0 hc y423 ff2 fs0 fc0 sc0 ls0 ws0">the<span class="_ _11"> </span>array<span class="_ _a"> </span>is<span class="_ _11"> </span>already<span class="_ _11"> </span>sorted: for<span class="_ _11"> </span><span class="ff2b">root<span class="_ _11"> </span></span>calls,<span class="_ _11"> </span>we<span class="_ _a"> </span>cannot<span class="_ _11"> </span>rely<span class="_ _11"> </span>on<span class="_ _a"> </span>anything<span class="_ _11"> </span>being<span class="_ _a"> </span>sorted, in<span class="_ _a"> </span><span class="ff2b">left<span class="_ _11"> </span></span>and<span class="_ _11"> </span><span class="ff2b">middle</span></div><div class="t m0 x0 h6 y424 ff2 fs0 fc0 sc0 ls0 ws0">calls,<span class="_ _2"> </span>we<span class="_ _2"> </span>hav<span class="_ _3"></span>e<span class="_ _2"> </span>a<span class="_ _2"> </span>sorted<span class="_ _2"> </span>preﬁx<span class="_ _2"> </span>of<span class="_ _2"> </span>length<span class="_ _2"> </span><span class="ff6">t</span></div><div class="t m0 xf2 hf y425 ffb fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x15a h6 y424 ff2 fs0 fc0 sc0 ls0 ws0">resp.<span class="_ _2"> </span><span class="ff6">t</span></div><div class="t m0 x56 hf y425 ffb fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 x19e h6 y424 ff2 fs0 fc0 sc0 ls0 ws0">,<span class="_ _2"> </span>and<span class="_ _2"> </span>for<span class="_ _2"> </span>a<span class="_ _2"> </span><span class="ff2b">right<span class="_ _2"> </span></span>call,<span class="_ _2"> </span>the<span class="_ _2"> </span><span class="ff6">t</span></div><div class="t m0 x135 hf y425 ffb fs6 fc0 sc0 ls0 ws0">3</div><div class="t m0 x179 hc y424 ff2 fs0 fc0 sc0 ls0 ws0">rightmost<span class="_ _2"> </span>elements<span class="_ _2"> </span>are</div><div class="t m0 x0 h6 y426 ff2 fs0 fc0 sc0 ls0 ws0">known<span class="_ _a"> </span>to be<span class="_ _a"> </span>in order<span class="_ _0"></span>.<span class="_ _2"> </span>The<span class="_ _11"> </span>initial<span class="_ _11"> </span>call<span class="_ _11"> </span>then<span class="_ _11"> </span>takes<span class="_ _a"> </span>the form<span class="_ _11"> </span>G<span class="_ _6"></span><span class="fs5">E<span class="_ _21"></span>N<span class="_ _6"></span>E<span class="_ _6"></span>R<span class="_ _6"></span>A<span class="_ _6"></span>L<span class="_ _21"></span>I<span class="_ _6"></span>Z<span class="_ _6"></span>E<span class="_ _6"></span>D</span>Y<span class="_ _3"></span><span class="fs5">A<span class="_ _21"></span>R<span class="_ _21"></span>O<span class="_ _6"></span>S<span class="_ _6"></span>L<span class="_ _21"></span>A<span class="_ _3"></span>V<span class="_ _6"></span>S<span class="_ _6"></span>K<span class="_ _6"></span>I<span class="_ _21"></span>Y <span class="ff5 fs0">(</span></span></div><div class="t m2 x1a2 h12 y427 ff12 fs8 fc0 sc0 ls0 ws0">A</div><div class="t m0 x1a6 h6 y426 ff6 fs0 fc0 sc0 ls0 ws0">,<span class="_ _9"> </span><span class="ff5">1</span>,<span class="_ _a"> </span>n,<span class="_ _a"> </span><span class="ff2b">root<span class="ff5">)<span class="ff2">.</span></span></span></div><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",81.963,294.128,null]'><div class="d m1" style="border-style:none;position:absolute;left:339.854118px;bottom:1134.062183px;width:51.512000px;height:10.904000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",500.394,293.41,null]'><div class="d m1" style="border-style:none;position:absolute;left:781.457677px;bottom:1013.561776px;width:36.207000px;height:10.904000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",57.056,629.416,null]'><div class="d m1" style="border-style:none;position:absolute;left:586.554808px;bottom:792.645764px;width:103.434000px;height:10.903000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",57.056,629.416,null]'><div class="d m1" style="border-style:none;position:absolute;left:765.880029px;bottom:792.645764px;width:21.918000px;height:10.903000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",81.963,265.263,null]'><div class="d m1" style="border-style:none;position:absolute;left:799.889463px;bottom:546.623751px;width:25.235000px;height:10.904000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",81.963,265.263,null]'><div class="d m1" style="border-style:none;position:absolute;left:136.014219px;bottom:526.540630px;width:32.305000px;height:10.903000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",81.963,265.263,null]'><div class="d m1" style="border-style:none;position:absolute;left:317.252837px;bottom:446.206466px;width:52.360000px;height:10.904000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.679893,0.000000,0.000000,1.679893,0.000000,0.000000]}'></div></div>
