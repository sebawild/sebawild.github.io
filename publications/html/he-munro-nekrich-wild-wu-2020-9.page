<div id="pf9" class="pf w0 h0" data-page-no="9"><div class="pc pc9 w0 h0"><img class="bi xc9 y61 w7 h1f" alt="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANgAAAAlCAIAAACvTrB9AAAACXBIWXMAABYlAAAWJQFJUiTwAAAAYklEQVR42u3SMREAMAgAsVIJ+PeDKQZkwJBI+PvoygfbvgQYEYyIEcGIGBGMiBHBiBgRjIgRwYgYEYyIEcGIGBGMiBHBiBgRjIgRwYgYEYyIEcGIGBGMiBHBiGBEjAhG5JgBzRYCH+LPYHQAAAAASUVORK5CYII="/><div class="t m0 x0 h5 y2d ff1 fs3 fc0 sc0 ls0 ws0">M.<span class="_ _e"> </span>He,<span class="_ _a"> </span>J.<span class="_ _11"> </span>I.<span class="_ _a"> </span>Munro,<span class="_ _e"> </span>Y.<span class="_ _a"> </span>Nekrich,<span class="_ _e"> </span>S.<span class="_ _e"> </span>Wild,<span class="_ _a"> </span>K.<span class="_ _e"> </span>Wu<span class="_ _22"> </span>9</div><div class="t m3 xa h8 y62 ff7 fs4 fc0 sc0 ls0 ws0">W<span class="_ _14"></span>e<span class="_ _b"> </span>will<span class="_ _4"> </span>additionally<span class="_ _4"> </span>store<span class="_ _4"> </span>a<span class="_ _b"> </span>compressed<span class="_ _4"> </span>bitvector<span class="_ _b"> </span>indicating<span class="_ _4"> </span>preorder<span class="_ _4"> </span>c<span class="_ _5"></span>hangers<span class="_ _b"> </span>by</div><div class="t m0 x5e h8 y62 ff9 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m3 x19 h8 y62 ff7 fs4 fc0 sc0 ls0 ws0">-name,</div><div class="t m0 x0 h8 y2f ff7 fs4 fc0 sc0 ls0 ws0">i.<span class="_ _9"></span>e.</div><div class="t m1a x187 h8 y2f ff7 fs4 fc0 sc0 ls0 ws0">,<span class="_ _4"> </span>we<span class="_ _4"> </span>trav<span class="_ _1"></span>erse<span class="_ _8"> </span>all<span class="_ _8"> </span>no<span class="_ _7"></span>des<span class="_ _4"> </span>in</div><div class="t m0 x4f h8 y2f ff9 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m1a x11e h8 y2f ff7 fs4 fc0 sc0 ls0 ws0">-order<span class="_ _4"> </span>and<span class="_ _8"> </span>add<span class="_ _8"> </span>a<span class="_ _8"> </span><span class="ffa">1<span class="_ _4"> </span></span>if<span class="_ _8"> </span>the<span class="_ _8"> </span>current<span class="_ _4"> </span>no<span class="_ _7"></span>de<span class="_ _8"> </span>is<span class="_ _4"> </span>a<span class="_ _8"> </span>preorder<span class="_ _8"> </span>changer,</div><div class="t m9 x0 h8 y30 ff7 fs4 fc0 sc0 ls0 ws0">and<span class="_ _8"> </span>a<span class="_ _e"> </span><span class="ffa">0<span class="_ _8"> </span></span>if<span class="_ _e"> </span>not.<span class="_ _28"> </span>W<span class="_ _14"></span>e<span class="_ _8"> </span>can<span class="_ _e"> </span>aﬀord<span class="_ _8"> </span>to<span class="_ _e"> </span>do<span class="_ _e"> </span>this<span class="_ _8"> </span>using<span class="_ _e"> </span>Lemma<span class="_ _8"> </span>1<span class="_ _e"> </span>for<span class="_ _8"> </span>tier-1<span class="_ _e"> </span>and<span class="_ _e"> </span>tier-2<span class="_ _8"> </span>in</div><div class="t m0 x164 h8 y30 ff9 fs4 fc0 sc0 ls0 ws0">o</div><div class="t m9 x142 h8 y30 ffa fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x188 h8 y30 ff9 fs4 fc0 sc0 ls0 ws0">n</div><div class="t m9 xb0 h8 y30 ffa fs4 fc0 sc0 ls0 ws0">)<span class="_ _8"> </span><span class="ff7">bits.</span></div><div class="t m9 x4 h8 y31 ff7 fs4 fc0 sc0 ls0 ws0">(The<span class="_ _8"> </span>universe<span class="_ _8"> </span>grows<span class="_ _8"> </span>to</div><div class="t m0 x17e h8 y31 ff9 fs4 fc0 sc0 ls0 ws0">n<span class="_ _11"> </span><span class="ffa">p<span class="_ _7"></span>olylog</span></div><div class="t m9 x16c h8 y31 ffa fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 xf1 h8 y31 ff9 fs4 fc0 sc0 ls0 ws0">n</div><div class="t m9 x161 h8 y31 ffa fs4 fc0 sc0 ls0 ws0">)<span class="ff7">,<span class="_ _e"> </span>but<span class="_ _8"> </span>with<span class="_ _e"> </span>suﬃciently<span class="_ _4"> </span>large</span></div><div class="t m0 x103 h8 y31 ff9 fs4 fc0 sc0 ls0 ws0">c</div><div class="t m9 x26 h8 y31 ff7 fs4 fc0 sc0 ls0 ws0">that<span class="_ _8"> </span>do<span class="_ _7"></span>es<span class="_ _e"> </span>not<span class="_ _e"> </span>aﬀect<span class="_ _8"> </span>the</div><div class="t m3 x0 h8 y32 ff7 fs4 fc0 sc0 ls0 ws0">space<span class="_ _b"> </span>by<span class="_ _b"> </span>more<span class="_ _4"> </span>than<span class="_ _4"> </span>a<span class="_ _b"> </span>constant<span class="_ _b"> </span>factor).<span class="_ _3"> </span>W<span class="_ _14"></span>e<span class="_ _b"> </span>can<span class="_ _4"> </span>store</div><div class="t m0 xbc h8 y32 ff9 fs4 fc0 sc0 ls0 ws0">O</div><div class="t m3 xfa h8 y32 ffa fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x6 h8 y32 ffa fs4 fc0 sc0 ls0 ws0">log<span class="_ _11"> </span><span class="ff9">n</span></div><div class="t m3 x82 h8 y32 ffa fs4 fc0 sc0 ls0 ws0">) <span class="ff7">bits<span class="_ _4"> </span>for<span class="_ _4"> </span>each<span class="_ _b"> </span>tier-1<span class="_ _b"> </span>changer<span class="_ _b"> </span>and</span></div><div class="t m0 x0 h8 y33 ff9 fs4 fc0 sc0 ls0 ws0">O</div><div class="t m24 x189 h8 y33 ffa fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x18a h8 y33 ffa fs4 fc0 sc0 ls0 ws0">log<span class="_ _11"> </span>log<span class="_ _1a"> </span><span class="ff9">n</span></div><div class="t m24 xe5 h8 y33 ffa fs4 fc0 sc0 ls0 ws0">)<span class="_ _8"> </span><span class="ff7">bits<span class="_ _8"> </span>for<span class="_ _8"> </span>eac<span class="_ _1"></span>h<span class="_ _8"> </span>tier-2<span class="_ _8"> </span>changer<span class="_ _4"> </span>in<span class="_ _8"> </span>an<span class="_ _8"> </span>array<span class="_ _6"></span>,<span class="_ _8"> </span>and<span class="_ _8"> </span>using<span class="_ _8"> </span>rank<span class="_ _8"> </span>on<span class="_ _8"> </span>the<span class="_ _8"> </span>ab<span class="_ _7"></span>ov<span class="_ _1"></span>e<span class="_ _8"> </span>bitvectors,</span></div><div class="t m0 x0 h8 y34 ff7 fs4 fc0 sc0 ls0 ws0">w<span class="_ _5"></span>e<span class="_ _4"> </span>can<span class="_ _8"> </span>access<span class="_ _8"> </span>that<span class="_ _8"> </span>information<span class="_ _8"> </span>given<span class="_ _4"> </span>the<span class="_ _8"> </span>no<span class="_ _7"></span>de’s<span class="_ _8"> </span>global<span class="_ _4"> </span>preorder<span class="_ _8"> </span>or<span class="_ _8"> </span><span class="ff9">τ<span class="_ _c"> </span></span>-names.</div><div class="t m0 x0 h8 y1a7 ff1 fs4 fc0 sc0 ls0 ws0">Select</div><div class="t m9 xa5 h8 y1a7 ff7 fs4 fc0 sc0 ls0 ws0">Giv<span class="_ _5"></span>en<span class="_ _e"> </span>the<span class="_ _a"> </span>preorder<span class="_ _e"> </span>num<span class="_ _1"></span>b<span class="_ _7"></span>er<span class="_ _a"> </span>of<span class="_ _e"> </span>a<span class="_ _a"> </span>node</div><div class="t m0 x1c h8 y1a7 ff9 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m9 x7d h8 y1a7 ff7 fs4 fc0 sc0 ls0 ws0">,<span class="_ _a"> </span>w<span class="_ _1"></span>e<span class="_ _a"> </span>w<span class="_ _1"></span>ant<span class="_ _e"> </span>to<span class="_ _a"> </span>ﬁnd</div><div class="t m0 x27 h8 y1a7 ff9 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m9 x18b h8 y1a7 ffa fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x28 h8 y1a7 ff9 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m9 x135 h8 y1a7 ffa fs4 fc0 sc0 ls0 ws0">)<span class="ff7">.<span class="_ _0"> </span>Let</span></div><div class="t m0 x3b h8 y1a7 ff9 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m9 x9d h8 y1a7 ff7 fs4 fc0 sc0 ls0 ws0">and</div><div class="t m0 xd7 h8 y1a7 ff9 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m0 xc2 h19 y1a8 ff1a fs7 fc0 sc0 ls0 ws0">0</div><div class="t m9 xc8 h8 y1a7 ff7 fs4 fc0 sc0 ls0 ws0">b<span class="_ _7"></span>e</div><div class="t m9 x0 h8 y1a9 ff7 fs4 fc0 sc0 ls0 ws0">the<span class="_ _e"> </span>tier-1<span class="_ _a"> </span>resp.<span class="_ _a"> </span>tier-2<span class="_ _e"> </span>preorder<span class="_ _a"> </span>changers<span class="_ _e"> </span>asso<span class="_ _7"></span>ciated<span class="_ _a"> </span>with</div><div class="t m0 xbd h8 y1a9 ff9 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m9 xf5 h8 y1a9 ff7 fs4 fc0 sc0 ls0 ws0">.<span class="_ _0"> </span>The<span class="_ _a"> </span>core<span class="_ _e"> </span>observ<span class="_ _1"></span>ation<span class="_ _a"> </span>is<span class="_ _e"> </span>that</div><div class="t m0 x0 h8 y1aa ff9 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x18c h14 y1ab ff13 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m28 x16d h8 y1aa ffa fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x18d h8 y1aa ff9 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m28 x18e h8 y1aa ffa fs4 fc0 sc0 ls0 ws0">) =</div><div class="t m0 x139 h8 y1aa ff9 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x2 h14 y1ab ff13 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m28 xbe h8 y1aa ffa fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x84 h8 y1aa ff9 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m28 x91 h8 y1aa ffa fs4 fc0 sc0 ls0 ws0">)<span class="_ _8"> </span><span class="ff7">and</span></div><div class="t m0 x16b h8 y1aa ff9 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x151 h14 y1ab ff13 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m28 xc h8 y1aa ffa fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x6e h8 y1aa ff9 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m0 x41 h19 y1ac ff1a fs7 fc0 sc0 ls0 ws0">0</div><div class="t m28 x57 h8 y1aa ffa fs4 fc0 sc0 ls0 ws0">) =</div><div class="t m0 xc3 h8 y1aa ff9 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x18f h14 y1ab ff13 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m28 x4f h8 y1aa ffa fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x94 h8 y1aa ff9 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m28 x10 h8 y1aa ffa fs4 fc0 sc0 ls0 ws0">)<span class="ff7">,<span class="_ _8"> </span>since<span class="_ _8"> </span>a<span class="_ _8"> </span>no<span class="_ _7"></span>de’s<span class="_ _8"> </span>tier-1<span class="_ _8"> </span>(tier-2)<span class="_ _8"> </span>preorder<span class="_ _8"> </span>changer<span class="_ _4"> </span>by<span class="_ _4"> </span>deﬁnition</span></div><div class="t m27 x0 h8 y1ad ff7 fs4 fc0 sc0 ls0 ws0">lies<span class="_ _8"> </span>in<span class="_ _4"> </span>the<span class="_ _8"> </span>same<span class="_ _8"> </span>mini-<span class="_ _8"> </span>(micro-)<span class="_ _8"> </span>tree<span class="_ _8"> </span>as</div><div class="t m0 xf2 h8 y1ad ff9 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m27 xd2 h8 y1ad ff7 fs4 fc0 sc0 ls0 ws0">.<span class="_ _3"> </span>W<span class="_ _6"></span>e<span class="_ _8"> </span>thus<span class="_ _4"> </span>store<span class="_ _8"> </span>the<span class="_ _8"> </span>array<span class="_ _4"> </span>of</div><div class="t m0 x27 h8 y1ad ff9 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x134 h14 y1ae ff13 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m27 x190 h8 y1ad ff7 fs4 fc0 sc0 ls0 ws0">-n<span class="_ _5"></span>um<span class="_ _1"></span>b<span class="_ _12"></span>ers<span class="_ _8"> </span>of<span class="_ _4"> </span>all<span class="_ _8"> </span>tier-1</div><div class="t m9 x0 h8 y1af ff7 fs4 fc0 sc0 ls0 ws0">preorder<span class="_ _8"> </span>changers<span class="_ _4"> </span>as<span class="_ _e"> </span>they<span class="_ _8"> </span>are<span class="_ _e"> </span>visited<span class="_ _8"> </span>by<span class="_ _4"> </span>a<span class="_ _e"> </span>preorder<span class="_ _8"> </span>trav<span class="_ _1"></span>ersal<span class="_ _8"> </span>of</div><div class="t m0 x118 h8 y1af ff9 fs4 fc0 sc0 ls0 ws0">T</div><div class="t m9 x104 h8 y1af ff7 fs4 fc0 sc0 ls0 ws0">. Using<span class="_ _8"> </span>rank<span class="_ _8"> </span>and<span class="_ _e"> </span>select</div><div class="t m9 x0 h8 y1b0 ff7 fs4 fc0 sc0 ls0 ws0">on<span class="_ _8"> </span>the<span class="_ _8"> </span>bitvectors<span class="_ _8"> </span>from<span class="_ _8"> </span>ab<span class="_ _7"></span>ov<span class="_ _1"></span>e,<span class="_ _e"> </span>w<span class="_ _5"></span>e<span class="_ _8"> </span>ﬁnd</div><div class="t m0 x143 h8 y1b0 ff9 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m9 x191 h8 y1b0 ff7 fs4 fc0 sc0 ls0 ws0">,<span class="_ _8"> </span>for<span class="_ _e"> </span>whic<span class="_ _1"></span>h<span class="_ _e"> </span>w<span class="_ _5"></span>e<span class="_ _8"> </span>lo<span class="_ _7"></span>ok<span class="_ _8"> </span>up</div><div class="t m0 x65 h8 y1b0 ff9 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x80 h14 y1b1 ff13 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m9 x16f h8 y1b0 ff7 fs4 fc0 sc0 ls0 ws0">. The<span class="_ _8"> </span>pro<span class="_ _7"></span>cedure<span class="_ _8"> </span>applies,</div><div class="t m23 x4 h8 y1b2 ff8 fs4 fc0 sc0 ls0 ws0">mutatis<span class="_ _e"> </span>mutandis<span class="ff7">,<span class="_ _4"> </span>to</span></div><div class="t m0 x6e h8 y1b2 ff9 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 xa6 h14 y1b3 ff13 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m23 x144 h8 y1b2 ff7 fs4 fc0 sc0 ls0 ws0">using<span class="_ _8"> </span>the<span class="_ _8"> </span>tier-2<span class="_ _8"> </span>preorder<span class="_ _8"> </span>c<span class="_ _5"></span>hanger</div><div class="t m0 x7 h8 y1b2 ff9 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m0 xbd h19 y1b4 ff1a fs7 fc0 sc0 ls0 ws0">0</div><div class="t m23 x82 h8 y1b2 ff7 fs4 fc0 sc0 ls0 ws0">.<span class="_ _3"> </span>Since</div><div class="t m0 x26 h8 y1b2 ff9 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x180 h14 y1b3 ff13 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m23 x18b h8 y1b2 ff7 fs4 fc0 sc0 ls0 ws0">is<span class="_ _8"> </span>lo<span class="_ _7"></span>cal<span class="_ _8"> </span>to<span class="_ _8"> </span>a<span class="_ _8"> </span>mini<span class="_ _8"> </span>tree,</div><div class="t m0 x0 h8 y1b5 ffa fs4 fc0 sc0 ls0 ws0">lg<span class="_ _11"> </span><span class="ff9">M</span></div><div class="t m3 x149 h8 y1b5 ffa fs4 fc0 sc0 ls0 ws0">=</div><div class="t m0 x3f h8 y1b5 ff9 fs4 fc0 sc0 ls0 ws0">O</div><div class="t m3 x13a h8 y1b5 ffa fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x90 h8 y1b5 ffa fs4 fc0 sc0 ls0 ws0">log<span class="_ _11"> </span>log<span class="_ _1a"> </span><span class="ff9">n</span></div><div class="t m3 x192 h8 y1b5 ffa fs4 fc0 sc0 ls0 ws0">)<span class="_ _4"> </span><span class="ff7">bits<span class="_ _8"> </span>suﬃce,<span class="_ _4"> </span>so<span class="_ _8"> </span>we<span class="_ _b"> </span>can<span class="_ _8"> </span>aﬀord<span class="_ _4"> </span>to<span class="_ _8"> </span>store</span></div><div class="t m0 x184 h8 y1b5 ff9 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x7 h14 y1b6 ff13 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m3 x82 h8 y1b5 ff7 fs4 fc0 sc0 ls0 ws0">for<span class="_ _4"> </span>every<span class="_ _4"> </span>tier-2<span class="_ _4"> </span>changer.<span class="_ _3"> </span>W<span class="_ _6"></span>e<span class="_ _8"> </span>also</div><div class="t m19 x0 h8 y1b7 ff7 fs4 fc0 sc0 ls0 ws0">store<span class="_ _8"> </span>the</div><div class="t m0 x11d h8 y1b7 ff9 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x15c h14 y1b8 ff13 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m19 x150 h8 y1b7 ff7 fs4 fc0 sc0 ls0 ws0">-n<span class="_ _5"></span>um<span class="_ _1"></span>b<span class="_ _12"></span>er<span class="_ _8"> </span>for<span class="_ _4"> </span>each<span class="_ _4"> </span>tier-2<span class="_ _8"> </span>changer<span class="_ _4"> </span>in<span class="_ _8"> </span>the<span class="_ _8"> </span>same<span class="_ _8"> </span>space.<span class="_ _3"> </span>W<span class="_ _14"></span>e<span class="_ _8"> </span>can<span class="_ _8"> </span>then<span class="_ _8"> </span>obtain</div><div class="t m0 x14a h8 y1b7 ff9 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x8c h14 y1b8 ff13 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m19 xb0 h8 y1b7 ffa fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x147 h8 y1b7 ff9 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m19 xc7 h8 y1b7 ffa fs4 fc0 sc0 ls0 ws0">)<span class="_ _8"> </span><span class="ff7">as</span></div><div class="t m3 x0 h8 y1b9 ff7 fs4 fc0 sc0 ls0 ws0">the<span class="_ _4"> </span>sum<span class="_ _8"> </span>of</div><div class="t m0 x84 h8 y1b9 ff9 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x3 h14 y1ba ff13 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m3 x9a h8 y1b9 ffa fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x50 h8 y1b9 ff9 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m0 x193 h19 y1bb ff1a fs7 fc0 sc0 ls0 ws0">0</div><div class="t m3 xf0 h8 y1b9 ffa fs4 fc0 sc0 ls0 ws0">)<span class="_ _4"> </span><span class="ff7">and<span class="_ _8"> </span>the<span class="_ _4"> </span>distance<span class="_ _4"> </span>from<span class="_ _8"> </span>the<span class="_ _4"> </span>last<span class="_ _8"> </span>1<span class="_ _4"> </span>in<span class="_ _8"> </span>the<span class="_ _4"> </span>bit<span class="_ _4"> </span>vector<span class="_ _4"> </span>indicating<span class="_ _4"> </span>tier-2<span class="_ _8"> </span>changers.</span></div><div class="t m0 x0 h8 y1bc ff1 fs4 fc0 sc0 ls0 ws0">Rank</div><div class="t m9 x3f h8 y1bc ff7 fs4 fc0 sc0 ls0 ws0">Giv<span class="_ _5"></span>en</div><div class="t m0 x157 h8 y1bc ff9 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m9 x51 h8 y1bc ffa fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x93 h8 y1bc ff9 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m9 x113 h8 y1bc ffa fs4 fc0 sc0 ls0 ws0">)<span class="_ _4"> </span>=</div><div class="t m0 x8 h8 y1bc ff12 fs4 fc0 sc0 ls0 ws0">h<span class="ff9">τ</span></div><div class="t m0 x13b h14 y1bd ff13 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x156 h8 y1bc ff9 fs4 fc0 sc0 ls0 ws0">,<span class="_ _11"> </span>τ</div><div class="t m0 xc3 h14 y1bd ff13 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xa7 h8 y1bc ff9 fs4 fc0 sc0 ls0 ws0">,<span class="_ _11"> </span>τ</div><div class="t m0 x94 h14 y1bd ff13 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m0 x194 h8 y1bc ff12 fs4 fc0 sc0 ls0 ws0">i</div><div class="t m9 x12b h8 y1bc ff7 fs4 fc0 sc0 ls0 ws0">,<span class="_ _8"> </span>ﬁnd<span class="_ _e"> </span>the<span class="_ _8"> </span>global<span class="_ _8"> </span>preorder<span class="_ _e"> </span>rank. Let<span class="_ _8"> </span>again</div><div class="t m0 x173 h8 y1bc ff9 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m9 x106 h8 y1bc ff7 fs4 fc0 sc0 ls0 ws0">and</div><div class="t m0 x2f h8 y1bc ff9 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m0 x142 h19 y1be ff1a fs7 fc0 sc0 ls0 ws0">0</div><div class="t m9 x167 h8 y1bc ff7 fs4 fc0 sc0 ls0 ws0">b<span class="_ _7"></span>e<span class="_ _8"> </span>the</div><div class="t ma x0 h8 y1bf ff7 fs4 fc0 sc0 ls0 ws0">tier-1<span class="_ _8"> </span>resp.<span class="_ _4"> </span>tier-2<span class="_ _8"> </span>preorder<span class="_ _8"> </span>changers<span class="_ _4"> </span>asso<span class="_ _7"></span>ciated<span class="_ _8"> </span>with</div><div class="t m0 x195 h8 y1bf ff9 fs4 fc0 sc0 ls0 ws0">v</div><div class="t ma x1f h8 y1bf ff7 fs4 fc0 sc0 ls0 ws0">.<span class="_ _3"> </span>The<span class="_ _4"> </span>idea<span class="_ _8"> </span>is<span class="_ _8"> </span>to<span class="_ _8"> </span>compute<span class="_ _8"> </span>the<span class="_ _8"> </span>preorder</div><div class="t m9 x0 h8 y1c0 ff7 fs4 fc0 sc0 ls0 ws0">rank<span class="_ _8"> </span>as</div><div class="t m0 x11c h8 y1c0 ff9 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m9 xbe h8 y1c0 ffa fs4 fc0 sc0 ls0 ws0">+<span class="_ _24"> </span>(</div><div class="t m0 x105 h8 y1c0 ff9 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m0 x92 h19 y1c1 ff1a fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x51 h8 y1c0 ff12 fs4 fc0 sc0 ls0 ws0">−<span class="_ _24"> </span><span class="ff9">u</span></div><div class="t m9 x67 h8 y1c0 ffa fs4 fc0 sc0 ls0 ws0">)<span class="_ _24"> </span>+<span class="_ _24"> </span>(</div><div class="t m0 x17e h8 y1c0 ff9 fs4 fc0 sc0 ls0 ws0">v<span class="_ _13"> </span><span class="ff12">−<span class="_ _13"> </span></span>u</div><div class="t m0 x12c h19 y1c1 ff1a fs7 fc0 sc0 ls0 ws0">0</div><div class="t m9 x11e h8 y1c0 ffa fs4 fc0 sc0 ls0 ws0">)<span class="ff7">,</span></div><div class="t m0 x17b h8 y1c0 ff7 fs4 fc0 sc0 ls0 ws0">i.<span class="_ _9"></span>e.</div><div class="t m9 x16e h8 y1c0 ff7 fs4 fc0 sc0 ls0 ws0">,<span class="_ _8"> </span>the<span class="_ _8"> </span>global<span class="_ _8"> </span>preorder<span class="_ _8"> </span>of</div><div class="t m0 xea h8 y1c0 ff9 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m9 x122 h8 y1c0 ff7 fs4 fc0 sc0 ls0 ws0">and<span class="_ _8"> </span>the<span class="_ _8"> </span>distances<span class="_ _8"> </span>b<span class="_ _7"></span>etw<span class="_ _1"></span>een</div><div class="t m0 x126 h8 y1c0 ff9 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m3 x0 h8 y1c2 ff7 fs4 fc0 sc0 ls0 ws0">and</div><div class="t m0 x196 h8 y1c2 ff9 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m0 x1 h19 y1c3 ff1a fs7 fc0 sc0 ls0 ws0">0</div><div class="t m3 x44 h8 y1c2 ff7 fs4 fc0 sc0 ls0 ws0">resp.</div><div class="t m0 xbf h8 y1c2 ff9 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m0 xb3 h19 y1c3 ff1a fs7 fc0 sc0 ls0 ws0">0</div><div class="t m3 x63 h8 y1c2 ff7 fs4 fc0 sc0 ls0 ws0">and</div><div class="t m0 x151 h8 y1c2 ff9 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m3 x68 h8 y1c2 ff7 fs4 fc0 sc0 ls0 ws0">.<span class="_ _3"> </span>Of<span class="_ _4"> </span>course,<span class="_ _8"> </span>we<span class="_ _4"> </span>do<span class="_ _8"> </span>not<span class="_ _4"> </span>know</div><div class="t m0 x4a h8 y1c2 ff9 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m3 x176 h8 y1c2 ff7 fs4 fc0 sc0 ls0 ws0">and</div><div class="t m0 x197 h8 y1c2 ff9 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m0 x11f h19 y1c3 ff1a fs7 fc0 sc0 ls0 ws0">0</div><div class="t m3 x198 h8 y1c2 ff7 fs4 fc0 sc0 ls0 ws0">or<span class="_ _4"> </span>their<span class="_ _8"> </span>distances<span class="_ _8"> </span>directly<span class="_ _14"></span>,<span class="_ _4"> </span>but<span class="_ _8"> </span>we</div><div class="t m3 x0 h8 y1c4 ff7 fs4 fc0 sc0 ls0 ws0">can<span class="_ _8"> </span>store<span class="_ _4"> </span>them<span class="_ _8"> </span>as<span class="_ _8"> </span>follows.<span class="_ _3"> </span>W<span class="_ _6"></span>e<span class="_ _8"> </span>use<span class="_ _8"> </span>the</div><div class="t m0 x7a h8 y1c4 ff9 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m3 x143 h8 y1c4 ff7 fs4 fc0 sc0 ls0 ws0">-order<span class="_ _8"> </span>of<span class="_ _4"> </span>no<span class="_ _12"></span>des<span class="_ _8"> </span>to<span class="_ _8"> </span>store<span class="_ _4"> </span>the<span class="_ _8"> </span>mapping<span class="_ _8"> </span>from</div><div class="t m0 x9d h8 y1c4 ff9 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m3 x199 h8 y1c4 ff7 fs4 fc0 sc0 ls0 ws0">-name<span class="_ _8"> </span>of</div><div class="t m1b x0 h8 y1c5 ff7 fs4 fc0 sc0 ls0 ws0">tier-1<span class="_ _8"> </span>preorder<span class="_ _8"> </span>changers<span class="_ _4"> </span>to<span class="_ _8"> </span>their<span class="_ _8"> </span>global<span class="_ _8"> </span>preorder<span class="_ _8"> </span>ranks.<span class="_ _3"> </span>F<span class="_ _14"></span>or<span class="_ _8"> </span>each<span class="_ _4"> </span>tier-2<span class="_ _8"> </span>changer,<span class="_ _8"> </span>w<span class="_ _1"></span>e<span class="_ _e"> </span>store<span class="_ _8"> </span>the</div><div class="t m0 x0 h8 y1c6 ff7 fs4 fc0 sc0 ls0 ws0">mapping<span class="_ _8"> </span>of<span class="_ _4"> </span><span class="ff9">τ<span class="_ _1e"> </span></span>-names<span class="_ _4"> </span>to<span class="_ _8"> </span>distances<span class="_ _8"> </span>to<span class="_ _8"> </span>asso<span class="_ _7"></span>ciated<span class="_ _8"> </span>tier-1<span class="_ _8"> </span>c<span class="_ _5"></span>hangers<span class="_ _4"> </span>(<span class="ff9">O<span class="_ _12"></span><span class="ffa">(log<span class="_ _11"> </span>log<span class="_ _1a"> </span></span>n<span class="ffa">)<span class="_ _4"> </span></span></span>bits<span class="_ _8"> </span>each).</div><div class="t m9 xa h8 y1c7 ff7 fs4 fc0 sc0 ls0 ws0">It<span class="_ _8"> </span>remains<span class="_ _4"> </span>to<span class="_ _8"> </span>compute</div><div class="t m0 xc3 h8 y1c7 ff9 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m9 x76 h8 y1c7 ffa fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x4f h8 y1c7 ff9 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m9 x136 h8 y1c7 ffa fs4 fc0 sc0 ls0 ws0">)<span class="_ _8"> </span><span class="ff7">and</span></div><div class="t m0 xa9 h8 y1c7 ff9 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m9 x7a h8 y1c7 ffa fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 xf9 h8 y1c7 ff9 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m0 x96 h19 y1c8 ff1a fs7 fc0 sc0 ls0 ws0">0</div><div class="t m9 x5b h8 y1c7 ffa fs4 fc0 sc0 ls0 ws0">)<span class="_ _8"> </span><span class="ff7">from</span></div><div class="t m0 x5d h8 y1c7 ff9 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m9 x19a h8 y1c7 ffa fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 xd8 h8 y1c7 ff9 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m9 x60 h8 y1c7 ffa fs4 fc0 sc0 ls0 ws0">)<span class="ff7">.</span></div><div class="t m0 x114 h8 y1c7 ff9 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m9 xc6 h8 y1c7 ff7 fs4 fc0 sc0 ls0 ws0">and</div><div class="t m0 xdc h8 y1c7 ff9 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m0 xdd h19 y1c8 ff1a fs7 fc0 sc0 ls0 ws0">0</div><div class="t m9 x24 h8 y1c7 ff7 fs4 fc0 sc0 ls0 ws0">only<span class="_ _8"> </span>diﬀer<span class="_ _4"> </span>in</div><div class="t m0 x3a h8 y1c7 ff9 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x2d h14 y1c9 ff13 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m9 xa0 h8 y1c7 ff7 fs4 fc0 sc0 ls0 ws0">and<span class="_ _8"> </span>w<span class="_ _1"></span>e<span class="_ _8"> </span>use</div><div class="t m3 x0 h8 y1ca ff7 fs4 fc0 sc0 ls0 ws0">the<span class="_ _4"> </span>micro-tree<span class="_ _8"> </span>lo<span class="_ _7"></span>okup<span class="_ _8"> </span>table<span class="_ _8"> </span>to<span class="_ _4"> </span>store</div><div class="t m0 x95 h8 y1ca ff9 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 xa9 h14 y1cb ff13 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m3 xf2 h8 y1ca ff7 fs4 fc0 sc0 ls0 ws0">of<span class="_ _4"> </span>each<span class="_ _4"> </span>no<span class="_ _7"></span>de’s<span class="_ _8"> </span>tier-2<span class="_ _8"> </span>changer.<span class="_ _a"> </span>Then,<span class="_ _8"> </span>we<span class="_ _4"> </span>store<span class="_ _8"> </span>for<span class="_ _4"> </span>each</div><div class="t m3 x0 h8 y1cc ff7 fs4 fc0 sc0 ls0 ws0">tier-2<span class="_ _4"> </span>changer</div><div class="t m0 x157 h8 y1cc ff9 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m0 x59 h19 y1cd ff1a fs7 fc0 sc0 ls0 ws0">0</div><div class="t m3 xb h8 y1cc ff7 fs4 fc0 sc0 ls0 ws0">the<span class="_ _4"> </span>pair</div><div class="t m0 x178 h8 y1cc ff12 fs4 fc0 sc0 ls0 ws0">h<span class="ff9">τ</span></div><div class="t m0 x6f h14 y1ce ff13 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x15a h8 y1cc ff9 fs4 fc0 sc0 ls0 ws0">,<span class="_ _11"> </span>τ</div><div class="t m0 x136 h14 y1ce ff13 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m0 xaa h8 y1cc ff12 fs4 fc0 sc0 ls0 ws0">i</div><div class="t m3 x11 h8 y1cc ff7 fs4 fc0 sc0 ls0 ws0">of<span class="_ _4"> </span>its<span class="_ _8"> </span>tier-1<span class="_ _8"> </span>changer<span class="_ _4"> </span>(another</div><div class="t m0 x122 h8 y1cc ff9 fs4 fc0 sc0 ls0 ws0">O</div><div class="t m3 x10d h8 y1cc ffa fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 xe1 h8 y1cc ffa fs4 fc0 sc0 ls0 ws0">log<span class="_ _11"> </span>log<span class="_ _1a"> </span><span class="ff9">n</span></div><div class="t m3 x38 h8 y1cc ffa fs4 fc0 sc0 ls0 ws0">)<span class="_ _4"> </span><span class="ff7">bits<span class="_ _8"> </span>each).<span class="_ _3"> </span>Using</span></div><div class="t m0 x0 h8 y1cf ff7 fs4 fc0 sc0 ls0 ws0">the<span class="_ _8"> </span><span class="ff9">τ<span class="_ _c"></span></span>-names<span class="_ _8"> </span>of<span class="_ _4"> </span><span class="ff9">u<span class="_ _8"> </span></span>and<span class="_ _8"> </span><span class="ff9">u</span></div><div class="t m0 x10a h19 y1d0 ff1a fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x144 h8 y1cf ff7 fs4 fc0 sc0 ls0 ws0">,<span class="_ _8"> </span>w<span class="_ _1"></span>e<span class="_ _8"> </span>obtain<span class="_ _8"> </span>the<span class="_ _8"> </span>preorder<span class="_ _8"> </span>rank<span class="_ _8"> </span>of<span class="_ _8"> </span><span class="ff9">v<span class="_ _7"></span></span>.</div><div class="t m0 x0 h7 y1d1 ff1 fs1 fc0 sc0 ls0 ws0">5.2<span class="_ _1d"> </span>Level-o<span class="_ _1"></span>rder<span class="_ _3"> </span>rank/select</div><div class="t m1 x0 h8 y1d2 ff7 fs4 fc0 sc0 ls0 ws0">Let</div><div class="t m0 xd h8 y1d2 ff9 fs4 fc0 sc0 ls0 ws0">w</div><div class="t m0 xee h14 y1d3 ff13 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xef h8 y1d2 ff9 fs4 fc0 sc0 ls0 ws0">,<span class="_ _11"> </span>.<span class="_ _11"> </span>.<span class="_ _11"> </span>.<span class="_ _11"> </span>,<span class="_ _11"> </span>w</div><div class="t m0 x105 h14 y1d3 ff17 fs7 fc0 sc0 ls0 ws0">n</div><div class="t m1 x59 h8 y1d2 ff7 fs4 fc0 sc0 ls0 ws0">b<span class="_ _7"></span>e<span class="_ _8"> </span>the<span class="_ _8"> </span>no<span class="_ _7"></span>des<span class="_ _8"> </span>of</div><div class="t m0 xaa h8 y1d2 ff9 fs4 fc0 sc0 ls0 ws0">T</div><div class="t m1 x133 h8 y1d2 ff7 fs4 fc0 sc0 ls0 ws0">in<span class="_ _8"> </span>lev<span class="_ _5"></span>el<span class="_ _8"> </span>order,</div><div class="t m0 x5d h8 y1d2 ff7 fs4 fc0 sc0 ls0 ws0">i.<span class="_ _9"></span>e.</div><div class="t m1 x60 h8 y1d2 ff7 fs4 fc0 sc0 ls0 ws0">,</div><div class="t m0 x19b h8 y1d2 ff9 fs4 fc0 sc0 ls0 ws0">w</div><div class="t m0 xc0 h14 y1d3 ff17 fs7 fc0 sc0 ls0 ws0">i</div><div class="t m1 x20 h8 y1d2 ff7 fs4 fc0 sc0 ls0 ws0">is<span class="_ _8"> </span>the</div><div class="t m0 x19c h8 y1d2 ff9 fs4 fc0 sc0 ls0 ws0">i</div><div class="t m1 x19d h8 y1d2 ff7 fs4 fc0 sc0 ls0 ws0">th<span class="_ _8"> </span>no<span class="_ _7"></span>de<span class="_ _8"> </span>visited<span class="_ _8"> </span>in<span class="_ _8"> </span>the<span class="_ _8"> </span>left-to-</div><div class="t m20 x0 h8 y1d4 ff7 fs4 fc0 sc0 ls0 ws0">righ<span class="_ _5"></span>t<span class="_ _8"> </span>breadth-ﬁrst<span class="_ _8"> </span>tra<span class="_ _1"></span>versal<span class="_ _4"> </span>of</div><div class="t m0 x136 h8 y1d4 ff9 fs4 fc0 sc0 ls0 ws0">T</div><div class="t m20 x7c h8 y1d4 ff7 fs4 fc0 sc0 ls0 ws0">.<span class="_ _3"> </span>Similar<span class="_ _8"> </span>to<span class="_ _8"> </span>the<span class="_ _8"> </span>preorder,<span class="_ _8"> </span>w<span class="_ _5"></span>e<span class="_ _8"> </span>call<span class="_ _8"> </span>a<span class="_ _8"> </span>no<span class="_ _7"></span>de</div><div class="t m0 x170 h8 y1d4 ff9 fs4 fc0 sc0 ls0 ws0">w</div><div class="t m0 x2a h14 y1d5 ff17 fs7 fc0 sc0 ls0 ws0">i</div><div class="t m20 x19e h8 y1d4 ff7 fs4 fc0 sc0 ls0 ws0">a<span class="_ _8"> </span><span class="ff8">tier-1<span class="_ _e"> </span>(tier-2)</span></div><div class="t m3 x4 h8 y1d6 ff8 fs4 fc0 sc0 ls0 ws0">level-or<span class="_ _1"></span>der<span class="_ _e"> </span>changer<span class="_ _a"> </span><span class="ff7">if</span></div><div class="t m0 x56 h8 y1d6 ff9 fs4 fc0 sc0 ls0 ws0">w</div><div class="t m0 x57 h14 y1d7 ff17 fs7 fc0 sc0 ls0 ws0">i<span class="ff1a">−<span class="ff13">1</span></span></div><div class="t m3 xc3 h8 y1d6 ff7 fs4 fc0 sc0 ls0 ws0">and</div><div class="t m0 xaa h8 y1d6 ff9 fs4 fc0 sc0 ls0 ws0">w</div><div class="t m0 x11 h14 y1d7 ff17 fs7 fc0 sc0 ls0 ws0">i</div><div class="t m3 xa8 h8 y1d6 ff7 fs4 fc0 sc0 ls0 ws0">are<span class="_ _8"> </span>in<span class="_ _8"> </span>diﬀeren<span class="_ _1"></span>t<span class="_ _8"> </span>mini-<span class="_ _8"> </span>(micro-)<span class="_ _8"> </span>trees. The<span class="_ _4"> </span>following<span class="_ _4"> </span>lemma</div><div class="t m0 x0 h8 y1d8 ff7 fs4 fc0 sc0 ls0 ws0">b<span class="_ _7"></span>ounds<span class="_ _8"> </span>the<span class="_ _4"> </span>num<span class="_ _1"></span>b<span class="_ _7"></span>er<span class="_ _8"> </span>of<span class="_ _8"> </span>tier-1<span class="_ _8"> </span>(tier-2)<span class="_ _8"> </span>level-order<span class="_ _4"> </span>changers.</div><div class="t m0 x0 h8 y1d9 ff14 fs4 fc1 sc0 ls0 ws0">I<span class="_ _3"> </span><span class="ff1 fc0">Lemma<span class="_ _3"> </span>4.</span></div><div class="t m9 x152 h8 y1d9 ff8 fs4 fc0 sc0 ls0 ws0">The<span class="_ _3"> </span>numb<span class="_ _1"></span>er<span class="_ _3"> </span>of<span class="_ _3"> </span>tier-1<span class="_ _a"> </span>(tier-2)<span class="_ _3"> </span>level-or<span class="_ _1"></span>der<span class="_ _3"> </span>changers<span class="_ _3"> </span>is</div><div class="t m0 x28 h8 y1d9 ff9 fs4 fc0 sc0 ls0 ws0">O</div><div class="t m9 x132 h8 y1d9 ffa fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x89 h8 y1d9 ff9 fs4 fc0 sc0 ls0 ws0">n/H</div><div class="t m9 x9f h8 y1d9 ffa fs4 fc0 sc0 ls0 ws0">+</div><div class="t m0 x19f h8 y1d9 ff9 fs4 fc0 sc0 ls0 ws0">nH<span class="_ _7"></span>/B</div><div class="t m9 xc7 h8 y1d9 ffa fs4 fc0 sc0 ls0 ws0">)<span class="_ _3"> </span>=</div><div class="t m0 x0 h8 y1da ff9 fs4 fc0 sc0 ls0 ws0">O<span class="_ _7"></span><span class="ffa">(</span>n/<span class="_ _11"> </span><span class="ffa">log</span></div><div class="t m0 xa5 h14 y1db ff13 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x1a0 h8 y1da ff9 fs4 fc0 sc0 ls0 ws0">n<span class="ffa">)<span class="_ _8"> </span><span class="ff8">(</span></span>O<span class="_ _7"></span><span class="ffa">(</span>n/H</div><div class="t m0 x46 h19 y1dc ff1a fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x41 h8 y1da ffa fs4 fc0 sc0 ls0 ws0">+<span class="_ _1a"> </span><span class="ff9">nH</span></div><div class="t m0 x76 h19 y1dc ff1a fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x13d h8 y1da ff9 fs4 fc0 sc0 ls0 ws0">/B</div><div class="t m0 x12b h19 y1dc ff1a fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x12d h8 y1da ffa fs4 fc0 sc0 ls0 ws0">) = <span class="ff9">O<span class="_ _7"></span></span>(<span class="ff9">n/</span>(log<span class="_ _11"> </span>log<span class="_ _1a"> </span><span class="ff9">n</span>)</div><div class="t m0 x15f h14 y1dc ff13 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xd9 h8 y1da ffa fs4 fc0 sc0 ls0 ws0">)<span class="ff8">).</span></div><div class="t m0 x0 h8 y1dd ff1 fs4 fc1 sc0 ls0 ws0">Pro<span class="_ _7"></span>of.</div><div class="t m9 x3f h8 y1dd ff7 fs4 fc0 sc0 ls0 ws0">W<span class="_ _14"></span>e<span class="_ _8"> </span>fo<span class="_ _7"></span>cus<span class="_ _e"> </span>on<span class="_ _8"> </span>tier<span class="_ _e"> </span>1;<span class="_ _8"> </span>tier<span class="_ _e"> </span>2<span class="_ _8"> </span>is<span class="_ _e"> </span>similar. Lemma<span class="_ _e"> </span>3<span class="_ _8"> </span>already<span class="_ _8"> </span>contains<span class="_ _8"> </span>all<span class="_ _8"> </span>ingredients: A</div><div class="t m29 x0 h8 y1de ff7 fs4 fc0 sc0 ls0 ws0">skinn<span class="_ _5"></span>y-slab<span class="_ _4"> </span>subtree<span class="_ _8"> </span>consists<span class="_ _8"> </span>of<span class="_ _8"> </span>an<span class="_ _4"> </span>entire<span class="_ _4"> </span>slab,<span class="_ _8"> </span>so<span class="_ _8"> </span>its<span class="_ _4"> </span>no<span class="_ _7"></span>des<span class="_ _8"> </span>app<span class="_ _7"></span>ear<span class="_ _8"> </span>contiguous<span class="_ _4"> </span>in<span class="_ _4"> </span>level<span class="_ _4"> </span>order.</div><div class="t m21 x0 h8 y1df ff7 fs4 fc0 sc0 ls0 ws0">Eac<span class="_ _5"></span>h<span class="_ _8"> </span>skinn<span class="_ _1"></span>y<span class="_ _e"> </span>mini<span class="_ _8"> </span>tree<span class="_ _8"> </span>th<span class="_ _1"></span>us<span class="_ _e"> </span>con<span class="_ _1"></span>tributes<span class="_ _8"> </span>only<span class="_ _8"> </span>1<span class="_ _e"> </span>lev<span class="_ _1"></span>el-order<span class="_ _8"> </span>changer,<span class="_ _8"> </span>for<span class="_ _8"> </span>a<span class="_ _8"> </span>total<span class="_ _8"> </span>of</div><div class="t m0 x3b h8 y1df ff9 fs4 fc0 sc0 ls0 ws0">O</div><div class="t m21 x108 h8 y1df ffa fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x175 h8 y1df ff9 fs4 fc0 sc0 ls0 ws0">n/H</div><div class="t m21 x11b h8 y1df ffa fs4 fc0 sc0 ls0 ws0">)<span class="_ _8"> </span><span class="ff7">F<span class="_ _14"></span>or</span></div><div class="t m1b x0 h8 y1e0 ff7 fs4 fc0 sc0 ls0 ws0">the<span class="_ _8"> </span>fat<span class="_ _8"> </span>subtrees,<span class="_ _8"> </span>each<span class="_ _4"> </span>level<span class="_ _4"> </span>app<span class="_ _7"></span>ears<span class="_ _8"> </span>contiguously<span class="_ _4"> </span>in<span class="_ _8"> </span>level<span class="_ _8"> </span>order,<span class="_ _8"> </span>and<span class="_ _8"> </span>within<span class="_ _8"> </span>a<span class="_ _8"> </span>level,<span class="_ _4"> </span>the<span class="_ _8"> </span>no<span class="_ _7"></span>des</div><div class="t m9 x0 h8 y1e1 ff7 fs4 fc0 sc0 ls0 ws0">from<span class="_ _e"> </span>one<span class="_ _e"> </span>mini<span class="_ _e"> </span>tree<span class="_ _e"> </span>form<span class="_ _e"> </span>at<span class="_ _e"> </span>most<span class="_ _e"> </span>3<span class="_ _e"> </span>interv<span class="_ _14"></span>als:<span class="_ _28"> </span>one<span class="_ _e"> </span>gap<span class="_ _e"> </span>can<span class="_ _e"> </span>result<span class="_ _e"> </span>from<span class="_ _e"> </span>a<span class="_ _e"> </span>child<span class="_ _8"> </span>of<span class="_ _e"> </span>the<span class="_ _e"> </span>ro<span class="_ _7"></span>ot</div><div class="t m8 x0 h8 y1e2 ff7 fs4 fc0 sc0 ls0 ws0">that<span class="_ _8"> </span>is<span class="_ _8"> </span>in<span class="_ _8"> </span>another<span class="_ _8"> </span>subtree,<span class="_ _4"> </span>splitting<span class="_ _8"> </span>the<span class="_ _8"> </span>list<span class="_ _8"> </span>of<span class="_ _8"> </span>ro<span class="_ _7"></span>ot<span class="_ _8"> </span>children<span class="_ _4"> </span>into<span class="_ _4"> </span>tw<span class="_ _1"></span>o<span class="_ _8"> </span>interv<span class="_ _14"></span>als,<span class="_ _8"> </span>and<span class="_ _8"> </span>a<span class="_ _8"> </span>second</div><div class="t m0 x0 h8 y8a ff7 fs4 fc0 sc0 ls0 ws0">gap<span class="_ _8"> </span>can<span class="_ _4"> </span>result<span class="_ _8"> </span>from<span class="_ _8"> </span>the<span class="_ _8"> </span>single<span class="_ _8"> </span>external<span class="_ _8"> </span>edge.<span class="_ _3"> </span>The<span class="_ _8"> </span>other<span class="_ _4"> </span>connections<span class="_ _8"> </span>to<span class="_ _8"> </span>other<span class="_ _8"> </span>mini<span class="_ _8"> </span>trees<span class="_ _8"> </span>are</div><div class="t m9 x0 h8 y8b ff7 fs4 fc0 sc0 ls0 ws0">through<span class="_ _8"> </span>s-no<span class="_ _7"></span>des,<span class="_ _8"> </span>and<span class="_ _e"> </span>hence<span class="_ _8"> </span>all<span class="_ _8"> </span>lie<span class="_ _8"> </span>on<span class="_ _8"> </span>the<span class="_ _e"> </span>same<span class="_ _8"> </span>level.<span class="_ _3"> </span>So<span class="_ _8"> </span>each<span class="_ _8"> </span>fat<span class="_ _8"> </span>mini<span class="_ _8"> </span>tree<span class="_ _8"> </span>contributes<span class="_ _8"> </span>at</div><div class="t m0 x0 h8 y8c ff7 fs4 fc0 sc0 ls0 ws0">most<span class="_ _8"> </span>3<span class="_ _4"> </span>changers<span class="_ _4"> </span>p<span class="_ _7"></span>er<span class="_ _8"> </span>level<span class="_ _4"> </span>it<span class="_ _8"> </span>spans,<span class="_ _8"> </span>for<span class="_ _8"> </span>a<span class="_ _8"> </span>total<span class="_ _4"> </span>of<span class="_ _8"> </span><span class="ff9">O<span class="_ _7"></span><span class="ffa">(</span>H<span class="_ _4"> </span><span class="ff12">·<span class="_ _24"> </span></span>n/B<span class="_ _12"></span><span class="ffa">)<span class="_ _8"> </span></span></span>level-order<span class="_ _4"> </span>changers.<span class="_ _2a"> </span><span class="ff14 fc1">J</span></div><a class="l" href="#pf5" data-dest-detail='[5,"XYZ",90.709,746.233,null]'><div class="d md" style="border-style:none;position:absolute;left:502.600474px;bottom:1182.463261px;width:43.570000px;height:11.955000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf6" data-dest-detail='[6,"XYZ",107.717,341.3,null]'><div class="d md" style="border-style:none;position:absolute;left:544.493647px;bottom:360.557120px;width:7.073000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.679893,0.000000,0.000000,1.679893,0.000000,0.000000]}'></div></div>
