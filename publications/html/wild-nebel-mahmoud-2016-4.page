<div id="pf4" class="pf w0 h0" data-page-no="4"><div class="pc pc4 w0 h0"><img class="bi x0 y6c w3 he" alt="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA2IAAAIICAIAAACD1cpNAAAACXBIWXMAABYlAAAWJQFJUiTwAAAIDElEQVR42u3ZoQ0AMAwDwaT77+zyoKKo4G4Eo5dcBQAAAADwopNYAQCA4ZgAAACZCACATAQAQCYCACATAQCQiQAAyEQAAGQiAAAyEQAAmQgAgEwEAEAmAgAgEwEAkIkAACATAQCQiQAAyEQAAGQiAAAyEQAAmQgAgEwEAEAmAgAgEwEAkIkAAMhEAABkIgAAMhEAAJkIAAAyEQAAmQgAgEwEAEAmAgAgEwEAkIkAAAAAwI86iRUAABiczgAAyEQAAGQiAAAyEQAAmQgAgEwEAEAmAgAgEwEAkIkAAMhEAABkIgAAMhEAAJkIAIBMBAAAmQgAgEwEAEAmAgAgEwEAkIkAAMhEAABkIgAAMhEAAJkIAIBMBABAJgIAIBMBAJCJAADIRAAAkIkAAMhEAABkIgAAMhEAAJkIAIBMBABAJgIAIBMBAJCJAADIRAAAZCIAADIRAACZCAAAMhEAAJkIAIBMBABAJgIAIBMBAJCJAADIRAAAZCIAADIRAACZCACATAQAQCYCACATAQCQiQAAIBMBAJCJAADIRAAAZCIAADIRAACZCACATAQAQCYCACATAQCQiQAAyEQAAGQiAAAyEQAAZCIAADIRAACZCACATAQAQCYCACATAQCQiQAAyEQAAGQiAAAyEQAAmQgAgEwEAEAmAgAgEwEAQCYCACATAQCQiQAAyEQAAGQiAAAyEQAAmQgAgEwEAEAmAgAgEwEAkIkAAMhEAABkIgAAMtEEAADIRAAAZCIAADIRAACZCACATAQAQCYCACATAQCQiQAAyEQAAGQiAAAyEQAAmQgAgEwEAACZCACATAQAQCYCACATAQCQiQAAyEQAAGQiAAAyEQAAmQgAgEwEAEAmAgAgEwEAkIkAAMhEAACQiQAAyEQAAGQiAAAyEQAAmQgAgEwEAEAmAgAgEwEAkIkAAMhEAABkIgAAMhEAAJkIAAAyEQAAmQgAgEwEAEAmAgAgEwEAkIkAAMhEAABkIgAAMhEAAJkIAIBMBABAJgIAIBMBAJCJAAAgEwEAkIkAAMhEAABkIgAAMhEAAJkIAIBMBABAJgIAIBMBAJCJAADIRAAAZCIAADIRAABkIgAAMhEAAJkIAIBMBABAJgIAIBMBAJCJAADIRAAAZCIAADIRAACZCACATAQAQCYCACATAQBAJgIAIBMBAJCJAADIRAAAZCIAADIRAACZCACATAQAQCYCACATAQCQiQAAyEQAAGQiAAAyEQAAZCIAADIRAACZCACATAQAQCYCACATAQCQiQAAyEQAAGQiAAAyEQAAmQgAgEwEAEAmAgCATAQAQCYCACATAQCQiQAAyEQAAGQiAAAyEQAAmQgAgEwEAEAmAgAgEwEAkIkAAMhEAABkIgAAyEQAAGQiAAAyEQAAmQgAgEwEAEAmAgAgEwEAkIkAAMhEAABkIgAAMhEAAJkIAIBMBAAAmQgAgEwEAEAmAgAgEwEAkIkAAMhEAABkIgAAMhEAAJkIAIBMBABAJgIAIBMBAJCJAADIRAAAkIkAAMhEAABkIgAAMhEAAJkIAIBMBABAJgIAIBMBAJCJAADIRAAAZCIAADIRAACZCAAAMhEAAJkIAIBMBABAJgIAIBMBAJCJAADIRAAAZCIAADIRAACZCACATAQAQCYCACATAQCQiQAAIBMBAJCJAADIRAAAZCIAADIRAACZCACATAQAQCYCACATAQCQiQAAyEQAAGQiAAAyEQAAmQgAADIRAACZCACATAQAQCYCACATAQCQiQAAyEQAAGQiAAAyEQAAmQgAgEwEAEAmAgAgEwEAQCYCACATAQCQiQAAyEQAAGQiAAAyEQAAmQgAgEwEAEAmAgAgEwEAkIkAAMhEAABkIgAAMhEAAGQiAAAyEQAAmQgAgEwEAEAmAgAgEwEAkIkAAMhEAABkIgAAMhEAAJkIAIBMBABAJgIAgEwEAEAmAgAgEwEAkIkAAMhEAABkIgAAMhEAAJkIAIBMBABAJgIAIBMBAJCJAADIRAAAZCIAAMhEAABkIgAAMhEAAJkIAIBMBABAJgIAIBMBAJCJAADIRAAAZCIAADIRAACZCACATAQAQCaaAAAAmQgAgEwEAEAmAgAgEwEAkIkAAMhEAABkIgAAMhEAAJkIAIBMBABAJgIAIBMBAJCJAAAgEwEAkIkAAMhEAABkIgAAMhEAAJkIAIBMBABAJgIAIBMBAJCJAADIRAAAZCIAADIRAACZCAAAMhEAAJkIAIBMBABAJgIAIBMBAJCJAADIRAAAZCIAADIRAACZCACATAQAQCYCACATAQBAJgIAIBMBAJCJAADIRAAAZCIAADIRAACZCACATAQAQCYCACATAQCQiQAAyEQAAGQiAAAyEQAAZCIAADIRAACZCACATAQAQCYCACATAQCQiQAAyEQAAGQiAAAyEQAAmQgAgEwEAEAmAgCATAQAQCYCACATAQCQiQAAyEQAAGQiAAAyEQAAmQgAgEwEAEAmAgAgEwEAkIkAAMhEAABkIgAAyEQAAGQiAAAyEQAAmQgAgEwEAEAmAgAgEwEAkIkAAMhEAABkIgAAMhEAAJkIAIBMBABAJgIAgEwEAEAmAgAgEwEAkIkAAMhEAABkIgAAMhEAAJkIAIBMBABAJgIAIBMBAJCJAADIRAAAkIkAAMhEAABkIgAAMhEAAJkIAIBMBABAJgIAIBMBAJCJAADIRAAAZCIAADIRAACZCACATAQAAJkIAIBMBABAJgIAIBMBAAAAgFUXlksKAXy/WV4AAAAASUVORK5CYII="/><div class="t m0 x0 h5 y6d ff7 fs3 fc0 sc0 ls0 ws0">Algorithm<span class="_ _b"> </span>1<span class="_ _7"> </span><span class="ff4">Dual-pivot<span class="_ _7"> </span>Quic<span class="_ _6"></span>kselect<span class="_ _7"> </span>algorithm<span class="_ _8"> </span>for<span class="_ _7"> </span>ﬁnding<span class="_ _8"> </span>the<span class="_ _7"> </span><span class="ffb">r<span class="_ _4"></span></span>th<span class="_ _8"> </span>order<span class="_ _7"> </span>statistic.</span></div><div class="t m0 x0 h5 y6e ff14 fs3 fc0 sc0 ls0 ws0">Quickselect<span class="_ _10"> </span><span class="ffc">(<span class="ffb">A,<span class="_ _10"> </span><span class="ff15">left<span class="_ _12"></span></span>,<span class="_ _10"> </span><span class="ff15">right<span class="_ _12"></span></span>,<span class="_ _10"> </span>r<span class="_ _4"></span></span>)</span></div><div class="t m0 x59 hf y6f ff16 fs3 fc0 sc0 ls0 ws0">/<span class="_ _1"></span>/<span class="_ _8"> </span><span class="ff6 fs2">Assumes<span class="_ _7"> </span><span class="ff15">left<span class="_ _5"> </span><span class="ff3">≤<span class="_ _c"> </span><span class="ffb">r<span class="_ _5"> </span></span>≤<span class="_ _c"> </span></span>right<span class="_ _12"></span></span>.</span></div><div class="t m0 x59 hf y70 ff16 fs3 fc0 sc0 ls0 ws0">/<span class="_ _1"></span>/<span class="_ _8"> </span><span class="ff6 fs2">Returns<span class="_ _7"> </span>the<span class="_ _5"> </span>element<span class="_ _5"> </span>that<span class="_ _5"> </span>would<span class="_ _5"> </span>reside<span class="_ _7"> </span>in<span class="_ _5"> </span><span class="ffb">A<span class="ffc">[<span class="_ _4"></span></span>r<span class="ffc">]<span class="_ _7"> </span></span></span>after<span class="_ _5"> </span>sorting<span class="_ _7"> </span><span class="ffb">A<span class="ffc">[<span class="ff15">left<span class="_ _13"> </span></span></span>..<span class="_ _10"> </span><span class="ff15">right<span class="_ _4"></span><span class="ffc">]</span></span></span>.</span></div><div class="t m0 x5a h5 y71 ffe fs6 fc0 sc0 ls0 ws0">1<span class="_ _14"> </span><span class="ff7 fs3">if<span class="_ _3"> </span><span class="ff15">right<span class="_ _8"> </span><span class="ff3">≤<span class="_ _5"> </span></span>left</span></span></div><div class="t m0 x5a h5 y72 ffe fs6 fc0 sc0 ls0 ws0">2<span class="_ _15"> </span><span class="ff7 fs3">return<span class="_ _7"> </span><span class="ffb">A<span class="ffc">[<span class="_ _4"></span><span class="ff15">left<span class="_ _4"></span></span>]</span></span></span></div><div class="t m0 x5a h6 y73 ffe fs6 fc0 sc0 ls0 ws0">3<span class="_ _14"> </span><span class="ff7 fs3">else</span></div><div class="t m0 x5a h5 y74 ffe fs6 fc0 sc0 ls0 ws0">4<span class="_ _15"> </span><span class="ffc fs3">(<span class="ff15">i</span></span></div><div class="t m0 x5b h10 y75 ff17 fs6 fc0 sc0 ls0 ws0">p</div><div class="t m0 x5c h5 y74 ffb fs3 fc0 sc0 ls0 ws0">,<span class="_ _10"> </span><span class="ff15">i</span></div><div class="t m0 x30 h10 y75 ff17 fs6 fc0 sc0 ls0 ws0">q</div><div class="t m0 x5d h5 y74 ffc fs3 fc0 sc0 ls0 ws0">)<span class="_ _8"> </span>:=<span class="_ _b"> </span><span class="ff14">P<span class="_ _a"></span>ar<span class="_ _a"></span>titionY<span class="_ _a"></span>arosla<span class="_ _a"></span>vskiy<span class="ffc">(<span class="ffb">A,<span class="_ _10"> </span><span class="ff15">left<span class="_ _4"></span></span>,<span class="_ _16"> </span><span class="ff15">right<span class="_ _12"></span></span></span>)</span></span></div><div class="t m0 x5a h5 y76 ffe fs6 fc0 sc0 ls0 ws0">5<span class="_ _15"> </span><span class="ffb fs3">c<span class="_ _8"> </span><span class="ffc">:=<span class="_ _b"> </span>sgn(</span>r<span class="_ _c"> </span><span class="ff3">−<span class="_ _13"> </span><span class="ff15">i</span></span></span></div><div class="t m0 x5e h10 y77 ff17 fs6 fc0 sc0 ls0 ws0">p</div><div class="t m0 x5f h5 y76 ffc fs3 fc0 sc0 ls0 ws0">)<span class="_ _3"> </span>+<span class="_ _9"> </span>sgn(<span class="ffb">r<span class="_ _c"> </span><span class="ff3">−<span class="_ _13"> </span><span class="ff15">i</span></span></span></div><div class="t m0 x39 h10 y77 ff17 fs6 fc0 sc0 ls0 ws0">q</div><div class="t m0 x60 h5 y76 ffc fs3 fc0 sc0 ls0 ws0">)<span class="_ _17"> </span><span class="ff16">/<span class="_ _1"></span>/<span class="_ _8"> </span><span class="ff6 fs2">Here<span class="_ _7"> </span><span class="ffc">sgn<span class="_ _5"> </span></span>denotes<span class="_ _7"> </span>the<span class="_ _5"> </span>signum<span class="_ _5"> </span>function.</span></span></div><div class="t m0 x5a h5 y78 ffe fs6 fc0 sc0 ls0 ws0">6<span class="_ _15"> </span><span class="ff7 fs3">case<span class="_ _b"> </span>distinction<span class="_ _7"> </span><span class="ff4">on<span class="_ _8"> </span>the<span class="_ _7"> </span>v<span class="_ _2"></span>alue<span class="_ _8"> </span>of<span class="_ _7"> </span><span class="ffb">c</span></span></span></div><div class="t m0 x5a h5 y79 ffe fs6 fc0 sc0 ls0 ws0">7<span class="_ _18"> </span><span class="ff7 fs3">in<span class="_ _b"> </span>case<span class="_ _19"> </span><span class="ff3">−<span class="ffc">2 </span></span>do<span class="_ _1a"> </span>return<span class="_ _7"> </span><span class="ff14">Quickselect<span class="_ _16"> </span><span class="ffc">(<span class="ffb">A,<span class="_ _0"> </span><span class="ff15">left<span class="_ _1a"> </span></span>,<span class="_ _10"> </span><span class="ff15">i</span></span></span></span></span></div><div class="t m0 x61 h10 y7a ff17 fs6 fc0 sc0 ls0 ws0">p</div><div class="t m0 x62 h5 y79 ff3 fs3 fc0 sc0 ls0 ws0">−<span class="_ _13"> </span><span class="ffc">1<span class="ffb">,<span class="_ _10"> </span>r</span>)</span></div><div class="t m0 x5a h5 y7b ffe fs6 fc0 sc0 ls0 ws0">8<span class="_ _18"> </span><span class="ff7 fs3">in<span class="_ _b"> </span>case<span class="_ _19"> </span><span class="ff3">−<span class="ffc">1 </span></span>do<span class="_ _1a"> </span>return<span class="_ _7"> </span><span class="ffb">A<span class="ffc">[<span class="_ _4"></span><span class="ff15">i</span></span></span></span></div><div class="t m0 x63 h10 y7c ff17 fs6 fc0 sc0 ls0 ws0">p</div><div class="t m0 x64 h5 y7b ffc fs3 fc0 sc0 ls0 ws0">]</div><div class="t m0 x5a h5 y7d ffe fs6 fc0 sc0 ls0 ws0">9<span class="_ _18"> </span><span class="ff7 fs3">in<span class="_ _b"> </span>case<span class="_ _1b"> </span><span class="ffc">0 </span>do<span class="_ _1a"> </span>return<span class="_ _7"> </span><span class="ff14">Quickselect<span class="_ _16"> </span><span class="ffc">(<span class="ffb">A,<span class="_ _10"> </span><span class="ff15">i</span></span></span></span></span></div><div class="t m0 x65 h10 y7e ff17 fs6 fc0 sc0 ls0 ws0">p</div><div class="t m0 x66 h5 y7d ffc fs3 fc0 sc0 ls0 ws0">+<span class="_ _13"> </span>1<span class="ffb">,<span class="_ _10"> </span><span class="ff15">i</span></span></div><div class="t m0 x61 h10 y7e ff17 fs6 fc0 sc0 ls0 ws0">q</div><div class="t m0 x62 h5 y7d ff3 fs3 fc0 sc0 ls0 ws0">−<span class="_ _13"> </span><span class="ffc">1<span class="ffb">,<span class="_ _10"> </span>r<span class="_ _4"></span></span>)</span></div><div class="t m0 x47 h5 y7f ffe fs6 fc0 sc0 ls0 ws0">10<span class="_ _18"> </span><span class="ff7 fs3">in<span class="_ _b"> </span>case<span class="_ _19"> </span><span class="ffc">+1 </span>do<span class="_ _1a"> </span>return<span class="_ _7"> </span><span class="ffb">A<span class="ffc">[<span class="_ _4"></span><span class="ff15">i</span></span></span></span></div><div class="t m0 x63 h10 y80 ff17 fs6 fc0 sc0 ls0 ws0">q</div><div class="t m0 x64 h5 y7f ffc fs3 fc0 sc0 ls0 ws0">]</div><div class="t m0 x47 h5 y81 ffe fs6 fc0 sc0 ls0 ws0">11<span class="_ _18"> </span><span class="ff7 fs3">in<span class="_ _b"> </span>case<span class="_ _19"> </span><span class="ffc">+2 </span>do<span class="_ _1a"> </span>return<span class="_ _7"> </span><span class="ff14">Quickselect<span class="_ _16"> </span><span class="ffc">(<span class="ffb">A,<span class="_ _10"> </span><span class="ff15">i</span></span></span></span></span></div><div class="t m0 x65 h10 y82 ff17 fs6 fc0 sc0 ls0 ws0">q</div><div class="t m0 x66 h5 y81 ffc fs3 fc0 sc0 ls0 ws0">+<span class="_ _13"> </span>1<span class="ffb">,<span class="_ _8"> </span><span class="ff15">right<span class="_ _c"> </span></span>,<span class="_ _10"> </span>r<span class="_ _4"></span></span>)</div><div class="t m0 x47 h6 y83 ffe fs6 fc0 sc0 ls0 ws0">12<span class="_ _15"> </span><span class="ff7 fs3">end<span class="_ _b"> </span>cases</span></div><div class="t m0 x47 h6 y84 ffe fs6 fc0 sc0 ls0 ws0">13<span class="_ _14"> </span><span class="ff7 fs3">end<span class="_ _b"> </span>if</span></div><div class="t m1a x18 h5 y85 ff4 fs3 fc0 sc0 ls0 ws0">These<span class="_ _7"> </span>discov<span class="_ _2"></span>eries<span class="_ _8"> </span>were<span class="_ _7"> </span>p<span class="_ _4"></span>erhaps<span class="_ _7"> </span>a<span class="_ _8"> </span>reason<span class="_ _8"> </span>to<span class="_ _8"> </span>discourage<span class="_ _7"> </span>research<span class="_ _7"> </span>on<span class="_ _8"> </span>sorting<span class="_ _7"> </span>with<span class="_ _8"> </span>multiple-</div><div class="t m5 x0 h5 y86 ff4 fs3 fc0 sc0 ls0 ws0">piv<span class="_ _6"></span>ot<span class="_ _3"> </span>partitioning, till<span class="_ _3"> </span>Y<span class="_ _a"></span>aroslavskiy<span class="_ _3"> </span>carefully<span class="_ _9"> </span>heeded<span class="_ _9"> </span>implemen<span class="_ _6"></span>tation<span class="_ _9"> </span>details.<span class="_ _d"> </span>His<span class="_ _3"> </span>dual-</div><div class="t m1 x0 h5 y87 ff4 fs3 fc0 sc0 ls0 ws0">partitioning<span class="_ _5"> </span>algorithm<span class="_ _5"> </span>improv<span class="_ _2"></span>ement<span class="_ _c"> </span>broke<span class="_ _c"> </span>a<span class="_ _7"> </span>psyc<span class="_ _2"></span>hological<span class="_ _7"> </span>barrier.<span class="_ _3"> </span>W<span class="_ _a"></span>ould<span class="_ _5"> </span>such<span class="_ _c"> </span>improv<span class="_ _2"></span>ements</div><div class="t m1 x0 h5 y88 ff4 fs3 fc0 sc0 ls0 ws0">b<span class="_ _4"></span>e<span class="_ _7"> </span>sustained<span class="_ _7"> </span>in<span class="_ _8"> </span>Quic<span class="_ _6"></span>kselect?<span class="_ _3"> </span>It<span class="_ _8"> </span>is<span class="_ _7"> </span>our<span class="_ _8"> </span>aim<span class="_ _7"> </span>in<span class="_ _8"> </span>this<span class="_ _7"> </span>pap<span class="_ _4"></span>er<span class="_ _7"> </span>to<span class="_ _8"> </span>answ<span class="_ _6"></span>er<span class="_ _7"> </span>this<span class="_ _8"> </span>question.<span class="_ _3"> </span>W<span class="_ _a"></span>e<span class="_ _8"> </span>ﬁnd<span class="_ _7"> </span>out</div><div class="t m1 x0 h5 y89 ff4 fs3 fc0 sc0 ls0 ws0">that<span class="_ _c"> </span>there<span class="_ _5"> </span>is<span class="_ _5"> </span>no<span class="_ _5"> </span>impro<span class="_ _6"></span>v<span class="_ _6"></span>emen<span class="_ _6"></span>t<span class="_ _5"> </span>in<span class="_ _c"> </span>the<span class="_ _5"> </span>num<span class="_ _2"></span>b<span class="_ _4"></span>er<span class="_ _5"> </span>of<span class="_ _c"> </span>comparisons:<span class="_ _3"> </span>Quickselect<span class="_ _c"> </span>under<span class="_ _5"> </span>Y<span class="_ _a"></span>arosla<span class="_ _6"></span>vskiy’s</div><div class="t m13 x0 h5 y8a ff4 fs3 fc0 sc0 ls0 ws0">dual-piv<span class="_ _6"></span>ot<span class="_ _7"> </span>partitioning<span class="_ _7"> </span>algorithm<span class="_ _8"> </span>(simply<span class="_ _7"> </span>Y<span class="_ _a"></span>aroslavskiy’s<span class="_ _7"> </span>algorithm,<span class="_ _7"> </span>henceforth)<span class="_ _7"> </span>is<span class="_ _8"> </span>sligh<span class="_ _6"></span>tly</div><div class="t m0 x19 h5 y8b ff5 fs3 fc0 sc0 ls0 ws0">worse<span class="_ _b"> </span><span class="ff4">than<span class="_ _7"> </span>classic<span class="_ _7"> </span>single-pivot<span class="_ _7"> </span>Quic<span class="_ _6"></span>kselect.</span></div><div class="t m1c x18 h5 y8c ff4 fs3 fc0 sc0 ls0 ws0">Supp<span class="_ _4"></span>ose<span class="_ _7"> </span>we<span class="_ _7"> </span>in<span class="_ _6"></span>tend<span class="_ _7"> </span>to<span class="_ _8"> </span>sort</div><div class="t m0 x67 h5 y8c ffb fs3 fc0 sc0 ls0 ws0">n</div><div class="t m1c x68 h5 y8c ff4 fs3 fc0 sc0 ls0 ws0">distinct<span class="_ _7"> </span>keys<span class="_ _7"> </span>stored<span class="_ _8"> </span>in<span class="_ _8"> </span>the<span class="_ _7"> </span>array</div><div class="t m0 x69 h5 y8c ffb fs3 fc0 sc0 ls0 ws0">A</div><div class="t m1c x6a h5 y8c ffc fs3 fc0 sc0 ls0 ws0">[1</div><div class="t m0 x1e h5 y8c ffb fs3 fc0 sc0 ls0 ws0">..<span class="_ _10"> </span>n</div><div class="t m1c x6b h5 y8c ffc fs3 fc0 sc0 ls0 ws0">]<span class="ff4">.<span class="_ _3"> </span>Dual<span class="_ _8"> </span>partitioning</span></div><div class="t m5 x0 h5 y8d ff4 fs3 fc0 sc0 ls0 ws0">uses<span class="_ _b"> </span><span class="ff5">two<span class="_ _b"> </span></span>piv<span class="_ _2"></span>ots,<span class="_ _b"> </span>as<span class="_ _b"> </span>opposed<span class="_ _b"> </span>to<span class="_ _b"> </span>the<span class="_ _8"> </span>single<span class="_ _b"> </span>piv<span class="_ _2"></span>ot<span class="_ _b"> </span>used<span class="_ _b"> </span>in<span class="_ _8"> </span>classic<span class="_ _b"> </span>Quic<span class="_ _2"></span>ksort.<span class="_ _1c"> </span>Let<span class="_ _8"> </span>u<span class="_ _4"></span>s<span class="_ _8"> </span>assume</div><div class="t m5 x0 h5 y8e ff4 fs3 fc0 sc0 ls0 ws0">the<span class="_ _8"> </span>tw<span class="_ _2"></span>o<span class="_ _b"> </span>piv<span class="_ _2"></span>ots<span class="_ _8"> </span>are<span class="_ _b"> </span>initially</div><div class="t m0 x6c h5 y8e ffb fs3 fc0 sc0 ls0 ws0">A</div><div class="t m5 x67 h5 y8e ffc fs3 fc0 sc0 ls0 ws0">[1]<span class="_ _8"> </span><span class="ff4">and</span></div><div class="t m0 x6d h5 y8e ffb fs3 fc0 sc0 ls0 ws0">A</div><div class="t m5 x4a h5 y8e ffc fs3 fc0 sc0 ls0 ws0">[</div><div class="t m0 x6e h5 y8e ffb fs3 fc0 sc0 ls0 ws0">n</div><div class="t m5 x6f h5 y8e ffc fs3 fc0 sc0 ls0 ws0">]<span class="ff4">,<span class="_ _8"> </span>and<span class="_ _b"> </span>suppose<span class="_ _b"> </span>their<span class="_ _7"> </span>ranks<span class="_ _b"> </span>are</span></div><div class="t m0 x43 h5 y8e ffb fs3 fc0 sc0 ls0 ws0">p</div><div class="t m5 x70 h5 y8e ff4 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m0 x71 h5 y8e ffb fs3 fc0 sc0 ls0 ws0">q</div><div class="t m5 x72 h5 y8e ff4 fs3 fc0 sc0 ls0 ws0">.<span class="_ _1d"> </span>If</div><div class="t m0 x73 h5 y8e ffb fs3 fc0 sc0 ls0 ws0">p<span class="_ _7"> </span>&gt;<span class="_ _7"> </span>q</div><div class="t m5 x74 h5 y8e ff4 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m11 x0 h5 y8f ff4 fs3 fc0 sc0 ls0 ws0">w<span class="_ _6"></span>e<span class="_ _7"> </span>swap<span class="_ _7"> </span>the<span class="_ _7"> </span>pivots.<span class="_ _3"> </span>While<span class="_ _7"> </span>seeking<span class="_ _7"> </span>tw<span class="_ _2"></span>o<span class="_ _8"> </span>p<span class="_ _4"></span>ositions<span class="_ _7"> </span>for<span class="_ _7"> </span>the<span class="_ _7"> </span>tw<span class="_ _6"></span>o<span class="_ _7"> </span>pivots,<span class="_ _5"> </span>the<span class="_ _8"> </span>rest<span class="_ _7"> </span>of<span class="_ _8"> </span>the<span class="_ _7"> </span>data<span class="_ _7"> </span>is</div><div class="t m1d x0 h5 y90 ff4 fs3 fc0 sc0 ls0 ws0">categorized<span class="_ _7"> </span>in<span class="_ _8"> </span>three<span class="_ _7"> </span>groups:<span class="_ _9"> </span>small,<span class="_ _8"> </span>medium<span class="_ _7"> </span>and<span class="_ _8"> </span>large.<span class="_ _3"> </span>Small<span class="_ _8"> </span>keys<span class="_ _7"> </span>are<span class="_ _7"> </span>those<span class="_ _8"> </span>with<span class="_ _7"> </span>ranks<span class="_ _8"> </span>less</div><div class="t m5 x0 h5 y91 ff4 fs3 fc0 sc0 ls0 ws0">than</div><div class="t m0 xd h5 y91 ffb fs3 fc0 sc0 ls0 ws0">p</div><div class="t m5 x49 h5 y91 ff4 fs3 fc0 sc0 ls0 ws0">,<span class="_ _7"> </span>medium<span class="_ _8"> </span>keys<span class="_ _7"> </span>ha<span class="_ _2"></span>ve<span class="_ _7"> </span>ranks<span class="_ _8"> </span>at<span class="_ _7"> </span>least</div><div class="t m0 x75 h5 y91 ffb fs3 fc0 sc0 ls0 ws0">p</div><div class="t m5 x76 h5 y91 ff4 fs3 fc0 sc0 ls0 ws0">and<span class="_ _7"> </span>less<span class="_ _8"> </span>than</div><div class="t m0 x77 h5 y91 ffb fs3 fc0 sc0 ls0 ws0">q</div><div class="t m5 x78 h5 y91 ff4 fs3 fc0 sc0 ls0 ws0">,<span class="_ _7"> </span>and<span class="_ _8"> </span>large<span class="_ _7"> </span>keys<span class="_ _7"> </span>are<span class="_ _8"> </span>those<span class="_ _7"> </span>with</div><div class="t m1e x0 h5 y92 ff4 fs3 fc0 sc0 ls0 ws0">ranks<span class="_ _7"> </span>at<span class="_ _7"> </span>least</div><div class="t m0 x79 h5 y92 ffb fs3 fc0 sc0 ls0 ws0">q</div><div class="t m1e x7a h5 y92 ff4 fs3 fc0 sc0 ls0 ws0">.<span class="_ _3"> </span>Small<span class="_ _7"> </span>keys<span class="_ _7"> </span>are<span class="_ _7"> </span>mov<span class="_ _2"></span>ed<span class="_ _8"> </span>to<span class="_ _7"> </span>p<span class="_ _4"></span>ositions<span class="_ _7"> </span>low<span class="_ _2"></span>er<span class="_ _7"> </span>than</div><div class="t m0 x7b h5 y92 ffb fs3 fc0 sc0 ls0 ws0">p</div><div class="t m1e x7c h5 y92 ff4 fs3 fc0 sc0 ls0 ws0">,<span class="_ _7"> </span>large<span class="_ _7"> </span>keys<span class="_ _7"> </span>are<span class="_ _7"> </span>mov<span class="_ _2"></span>ed<span class="_ _8"> </span>to</div><div class="t m1 x0 h5 y93 ff4 fs3 fc0 sc0 ls0 ws0">p<span class="_ _4"></span>ositions<span class="_ _7"> </span>higher<span class="_ _8"> </span>than</div><div class="t m0 x7d h5 y93 ffb fs3 fc0 sc0 ls0 ws0">q</div><div class="t m1 x7e h5 y93 ff4 fs3 fc0 sc0 ls0 ws0">,<span class="_ _7"> </span>medium<span class="_ _8"> </span>keys<span class="_ _7"> </span>are<span class="_ _8"> </span>k<span class="_ _6"></span>ept<span class="_ _8"> </span>in<span class="_ _7"> </span>p<span class="_ _4"></span>ositions<span class="_ _8"> </span>b<span class="_ _4"></span>et<span class="_ _2"></span>ween</div><div class="t m0 x7f h5 y93 ffb fs3 fc0 sc0 ls0 ws0">p</div><div class="t m1 x53 h5 y93 ffc fs3 fc0 sc0 ls0 ws0">+<span class="_ _13"> </span>1<span class="_ _7"> </span><span class="ff4">and</span></div><div class="t m0 x80 h5 y93 ffb fs3 fc0 sc0 ls0 ws0">q<span class="_ _13"> </span><span class="ff3">−</span></div><div class="t m1 x81 h5 y93 ffc fs3 fc0 sc0 ls0 ws0">1<span class="ff4">.<span class="_ _9"> </span>So,<span class="_ _7"> </span>the</span></div><div class="t m0 x0 h5 y94 ff4 fs3 fc0 sc0 ls0 ws0">t<span class="_ _6"></span>w<span class="_ _6"></span>o<span class="_ _7"> </span>keys<span class="_ _7"> </span>with<span class="_ _7"> </span>ranks<span class="_ _8"> </span><span class="ffb">p<span class="_ _7"> </span></span>and<span class="_ _8"> </span><span class="ffb">q<span class="_ _b"> </span></span>can<span class="_ _7"> </span>b<span class="_ _4"></span>e<span class="_ _7"> </span>mov<span class="_ _2"></span>ed<span class="_ _8"> </span>to<span class="_ _7"> </span>their<span class="_ _8"> </span>correct<span class="_ _7"> </span>and<span class="_ _8"> </span>ﬁnal<span class="_ _7"> </span>p<span class="_ _4"></span>ositions.</div><div class="t ma x18 h5 y95 ff4 fs3 fc0 sc0 ls0 ws0">After<span class="_ _7"> </span>this<span class="_ _8"> </span>partitioning<span class="_ _8"> </span>stage,<span class="_ _8"> </span>dual-piv<span class="_ _6"></span>ot<span class="_ _7"> </span>Quicksort<span class="_ _7"> </span>then<span class="_ _8"> </span>in<span class="_ _6"></span>v<span class="_ _6"></span>ok<span class="_ _6"></span>es<span class="_ _7"> </span>itself<span class="_ _8"> </span>recursively<span class="_ _7"> </span>(thrice)</div><div class="t m1 x0 h5 y96 ff4 fs3 fc0 sc0 ls0 ws0">on</div><div class="t m0 x82 h5 y96 ffb fs3 fc0 sc0 ls0 ws0">A</div><div class="t m1 x1a h5 y96 ffc fs3 fc0 sc0 ls0 ws0">[1</div><div class="t m0 x2 h5 y96 ffb fs3 fc0 sc0 ls0 ws0">..<span class="_ _10"> </span>p<span class="_ _10"> </span><span class="ff3">−</span></div><div class="t m1 x83 h5 y96 ffc fs3 fc0 sc0 ls0 ws0">1]<span class="ff4">,</span></div><div class="t m0 x84 h5 y96 ffb fs3 fc0 sc0 ls0 ws0">A</div><div class="t m1 x85 h5 y96 ffc fs3 fc0 sc0 ls0 ws0">[</div><div class="t m0 x86 h5 y96 ffb fs3 fc0 sc0 ls0 ws0">p</div><div class="t m1 x87 h5 y96 ffc fs3 fc0 sc0 ls0 ws0">+<span class="_ _10"> </span>1</div><div class="t m0 x88 h5 y96 ffb fs3 fc0 sc0 ls0 ws0">..<span class="_ _10"> </span>q<span class="_ _13"> </span><span class="ff3">−</span></div><div class="t m1 x89 h5 y96 ffc fs3 fc0 sc0 ls0 ws0">1]<span class="_ _7"> </span><span class="ff4">and</span></div><div class="t m0 x8a h5 y96 ffb fs3 fc0 sc0 ls0 ws0">A</div><div class="t m1 x8b h5 y96 ffc fs3 fc0 sc0 ls0 ws0">[</div><div class="t m0 x8c h5 y96 ffb fs3 fc0 sc0 ls0 ws0">q</div><div class="t m1 x60 h5 y96 ffc fs3 fc0 sc0 ls0 ws0">+<span class="_ _10"> </span>1</div><div class="t m0 x8d h5 y96 ffb fs3 fc0 sc0 ls0 ws0">..<span class="_ _10"> </span>n</div><div class="t m1 x8e h5 y96 ffc fs3 fc0 sc0 ls0 ws0">]<span class="ff4">.<span class="_ _3"> </span>The<span class="_ _7"> </span>b<span class="_ _4"></span>oundary<span class="_ _7"> </span>conditions<span class="_ _7"> </span>are<span class="_ _7"> </span>the<span class="_ _7"> </span>very<span class="_ _5"> </span>small</span></div><div class="t m5 x0 h5 y97 ff4 fs3 fc0 sc0 ls0 ws0">arra<span class="_ _6"></span>ys<span class="_ _b"> </span>of<span class="_ _8"> </span>size<span class="_ _b"> </span>0<span class="_ _b"> </span>(no<span class="_ _b"> </span>k<span class="_ _2"></span>eys<span class="_ _b"> </span>to<span class="_ _b"> </span>sort),<span class="_ _b"> </span>arra<span class="_ _2"></span>ys<span class="_ _b"> </span>of<span class="_ _b"> </span>size<span class="_ _b"> </span>1<span class="_ _8"> </span>(such<span class="_ _8"> </span>an<span class="_ _b"> </span>array<span class="_ _8"> </span>is<span class="_ _b"> </span>already<span class="_ _b"> </span>sorted),<span class="_ _b"> </span>and</div><div class="t m9 x0 h5 y98 ff4 fs3 fc0 sc0 ls0 ws0">arra<span class="_ _6"></span>ys<span class="_ _7"> </span>of<span class="_ _8"> </span>size<span class="_ _7"> </span>2<span class="_ _7"> </span>(these<span class="_ _8"> </span>arra<span class="_ _6"></span>ys<span class="_ _7"> </span>need<span class="_ _8"> </span>only<span class="_ _7"> </span>one<span class="_ _8"> </span>comparison<span class="_ _7"> </span>b<span class="_ _4"></span>et<span class="_ _6"></span>w<span class="_ _6"></span>een<span class="_ _7"> </span>the<span class="_ _8"> </span>t<span class="_ _6"></span>w<span class="_ _6"></span>o<span class="_ _7"> </span>keys<span class="_ _7"> </span>in<span class="_ _7"> </span>them);<span class="_ _7"> </span>in</div><div class="t m0 x0 h5 y99 ff4 fs3 fc0 sc0 ls0 ws0">these<span class="_ _7"> </span>cases<span class="_ _8"> </span>no<span class="_ _7"> </span>further<span class="_ _8"> </span>recursion<span class="_ _7"> </span>is<span class="_ _8"> </span>inv<span class="_ _2"></span>oked.</div><div class="t m1 x18 h5 y9a ff4 fs3 fc0 sc0 ls0 ws0">This<span class="_ _7"> </span>is<span class="_ _8"> </span>the<span class="_ _8"> </span>general<span class="_ _8"> </span>paradigm<span class="_ _8"> </span>for<span class="_ _7"> </span>dual<span class="_ _8"> </span>pivoting.<span class="_ _3"> </span>How<span class="_ _2"></span>ever,<span class="_ _7"> </span>it<span class="_ _8"> </span>can<span class="_ _8"> </span>b<span class="_ _4"></span>e<span class="_ _7"> </span>implemented<span class="_ _7"> </span>in<span class="_ _8"> </span>man<span class="_ _6"></span>y</div><div class="t m0 x0 h5 y9b ff4 fs3 fc0 sc0 ls0 ws0">diﬀeren<span class="_ _6"></span>t<span class="_ _7"> </span>wa<span class="_ _2"></span>ys.<span class="_ _9"> </span>Y<span class="_ _a"></span>aroslavskiy’s<span class="_ _7"> </span>algorithm<span class="_ _7"> </span>keeps<span class="_ _7"> </span>trac<span class="_ _6"></span>k<span class="_ _7"> </span>of<span class="_ _8"> </span>three<span class="_ _7"> </span>p<span class="_ _4"></span>oin<span class="_ _6"></span>ters:</div><div class="t m0 x14 h5 y25 ff4 fs3 fc0 sc0 ls0 ws0">4</div></div><div class="pi" data-data='{"ctm":[1.679893,0.000000,0.000000,1.679893,0.000000,0.000000]}'></div></div>
