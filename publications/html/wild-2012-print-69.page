<div id="pf45" class="pf w0 h0" data-page-no="45"><div class="pc pc45 w0 h0"><img class="bi xc y10 w2 ha" alt="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA4wAAAABCAIAAAAabrduAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAHUlEQVRIx+3BMQEAAAzDoPrXGwGzsQNYNQAA+OQAdnsC3T923LwAAAAASUVORK5CYII="/><div class="t m0 x174 he y30 ff8 fs4 fc0 sc0 ls0 ws0">4.2.1<span class="_ _4c"> </span>Elementary<span class="_ _9"> </span>Solution</div><div class="t m2 xc hd y31 ff5 fs4 fc0 sc0 ls0 ws0">where</div><div class="t m0 x4f h9 y31 ff7 fs4 fc0 sc0 ls0 ws0">pc</div><div class="t m0 x5b hf y3d3 ffa fs6 fc0 sc0 ls0 ws0">n</div><div class="t m2 x1b hd y31 ff5 fs4 fc0 sc0 ls0 ws0">is<span class="_ _a"> </span>the<span class="_ _4"> </span>expected<span class="_ _a"> </span>partitioning<span class="_ _a"> </span>cost<span class="_ _4"> </span>for<span class="_ _a"> </span>a<span class="_ _4"> </span>list<span class="_ _a"> </span>of<span class="_ _a"> </span>length</div><div class="t m0 xe3 h6 y31 ffa fs4 fc0 sc0 ls0 ws0">n</div><div class="t m2 x1c8 hd y31 ff5 fs4 fc0 sc0 ls0 ws0">.<span class="_ _8"> </span>By<span class="_ _a"> </span>inserting</div><div class="t m3 xc hd y32 ff5 fs4 fc0 sc0 ls0 ws0">appropriate<span class="_ _9"> </span>toll<span class="_ _a"> </span>functions</div><div class="t m0 x75 h9 y32 ff7 fs4 fc0 sc0 ls0 ws0">pc</div><div class="t m0 x11b hf y867 ffa fs6 fc0 sc0 ls0 ws0">n</div><div class="t m3 x186 hd y32 ff5 fs4 fc0 sc0 ls0 ws0">,<span class="_ _a"> </span>w<span class="_ _20"></span>e<span class="_ _a"> </span>will<span class="_ _a"> </span>later<span class="_ _a"> </span>use<span class="_ _a"> </span>this<span class="_ _a"> </span>recurrence<span class="_ _9"> </span>to<span class="_ _a"> </span>compute<span class="_ _a"> </span>the</div><div class="t m0 xc hd y33 ff5 fs4 fc0 sc0 ls0 ws0">expected<span class="_ _a"> </span>number<span class="_ _a"> </span>of<span class="_ _a"> </span>sw<span class="_ _20"></span>aps<span class="_ _a"> </span>and<span class="_ _a"> </span>comparisons.</div><div class="t mc x26 hd y34 ff5 fs4 fc0 sc0 ls0 ws0">In<span class="_ _a"> </span>the<span class="_ _a"> </span>follo<span class="_ _20"></span>wing<span class="_ _a"> </span>tw<span class="_ _b"></span>o<span class="_ _a"> </span>subsections,<span class="_ _a"> </span>I<span class="_ _a"> </span>giv<span class="_ _20"></span>e<span class="_ _a"> </span>tw<span class="_ _20"></span>o<span class="_ _a"> </span>independent<span class="_ _a"> </span>deriv<span class="_ _b"></span>ations<span class="_ _a"> </span>of<span class="_ _a"> </span>the</div><div class="t m4 xc hd y35 ff5 fs4 fc0 sc0 ls0 ws0">closed<span class="_ _a"> </span>for<span class="_ _6"></span>m<span class="_ _a"> </span>of</div><div class="t m0 xd8 h6 y35 ffa fs4 fc0 sc0 ls0 ws0">C</div><div class="t m0 x25 hf y868 ffa fs6 fc0 sc0 ls0 ws0">n</div><div class="t m4 x44 hd y35 ff5 fs4 fc0 sc0 ls0 ws0">.<span class="_ _17"> </span>Section<span class="_ _a"> </span><span class="ff6">4</span>.<span class="ff6">2</span>.<span class="ff6">1<span class="_ _a"> </span></span>uses<span class="_ _a"> </span>elementar<span class="_ _6"></span>y<span class="_ _a"> </span>rearrangements<span class="_ _5"> </span>—<span class="_ _5"> </span>in<span class="_ _a"> </span>particular</div><div class="t m2 xc hd y36 ff5 fs4 fc0 sc0 ls0 ws0">clev<span class="_ _3"></span>er<span class="_ _0"> </span>forwar<span class="_ _20"></span>d<span class="_ _0"> </span>differ<span class="_ _b"></span>ences<span class="_ _4"> </span>of<span class="_ _0"> </span>the<span class="_ _4"> </span>sequence</div><div class="t m0 x32 h6 y36 ffa fs4 fc0 sc0 ls0 ws0">C</div><div class="t m0 x10f hf y869 ffa fs6 fc0 sc0 ls0 ws0">n</div><div class="t m2 x5a hd y36 ff5 fs4 fc0 sc0 ls0 ws0">—<span class="_ _5"> </span>to<span class="_ _4"> </span>ﬁnd<span class="_ _0"> </span>a<span class="_ _4"> </span>different<span class="_ _4"> </span>recursiv<span class="_ _3"></span>e,</div><div class="t m4 xc h9 y37 ff5 fs4 fc0 sc0 ls0 ws0">but<span class="_ _a"> </span><span class="ff7">telescoping<span class="_ _a"> </span></span>characterization<span class="_ _a"> </span>of</div><div class="t m0 x7 h6 y37 ffa fs4 fc0 sc0 ls0 ws0">C</div><div class="t m0 x21 hf y264 ffa fs6 fc0 sc0 ls0 ws0">n</div><div class="t m4 x118 hd y37 ff5 fs4 fc0 sc0 ls0 ws0">.<span class="_ _17"> </span>Such<span class="_ _9"> </span>a<span class="_ _a"> </span>representation<span class="_ _a"> </span>is<span class="_ _a"> </span>then<span class="_ _a"> </span>immediately</div><div class="t m5 xc hd y38 ff5 fs4 fc0 sc0 ls0 ws0">written<span class="_ _a"> </span>as<span class="_ _9"> </span>an<span class="_ _a"> </span>explicit<span class="_ _a"> </span>sum.<span class="_ _0"> </span>In<span class="_ _a"> </span>the<span class="_ _a"> </span>end,<span class="_ _a"> </span>this<span class="_ _9"> </span>allows<span class="_ _9"> </span>us<span class="_ _a"> </span>to<span class="_ _a"> </span>express</div><div class="t m0 x1c8 h6 y38 ffa fs4 fc0 sc0 ls0 ws0">C</div><div class="t m0 xcf hf y267 ffa fs6 fc0 sc0 ls0 ws0">n</div><div class="t m5 x1cb hd y38 ff5 fs4 fc0 sc0 ls0 ws0">directly<span class="_ _9"> </span>in</div><div class="t m0 xc h9 ye7 ff5 fs4 fc0 sc0 ls0 ws0">terms<span class="_ _a"> </span>of<span class="_ _a"> </span><span class="ff7">pc</span></div><div class="t m0 x1b hf y86a ffa fs6 fc0 sc0 ls0 ws0">n</div><div class="t m0 x58 hd ye7 ff5 fs4 fc0 sc0 ls0 ws0">.</div><div class="t m2 x26 hd y104 ff5 fs4 fc0 sc0 ls0 ws0">The<span class="_ _a"> </span>second<span class="_ _a"> </span>deriv<span class="_ _20"></span>ation<span class="_ _4"> </span>presented<span class="_ _9"> </span>in<span class="_ _a"> </span>S<span class="_ _6"></span>ection<span class="_ _a"> </span><span class="ff6">4</span>.<span class="ff6">2</span>.<span class="ff6">2<span class="_ _4"> </span></span>is<span class="_ _9"> </span>based<span class="_ _4"> </span>on<span class="_ _9"> </span>the<span class="_ _4"> </span>symbolic</div><div class="t m13 xc hd y3b ff5 fs4 fc0 sc0 ls0 ws0">method<span class="_ _a"> </span>(see<span class="_ _a"> </span>[</div><div class="t m0 x1b4 hd y3b ff5 fs4 fc0 sc0 ls0 ws0">FS<span class="ff6">09</span></div><div class="t m13 x64 h9 y3b ff5 fs4 fc0 sc0 ls0 ws0">,<span class="_ _a"> </span>Part<span class="_ _a"> </span>A]):<span class="_ _a"> </span>W<span class="_ _33"></span>e<span class="_ _a"> </span>set<span class="_ _a"> </span>up<span class="_ _a"> </span>a<span class="_ _a"> </span>functional<span class="_ _a"> </span>equation<span class="_ _a"> </span>for<span class="_ _a"> </span>the<span class="_ _a"> </span><span class="ff7">generating</span></div><div class="t m2 xc h9 y3c ff7 fs4 fc0 sc0 ls0 ws0">function</div><div class="t m0 x127 h10 y3c ffa fs4 fc0 sc0 ls0 ws0">C<span class="ffb">(</span>z<span class="ffb">)</span></div><div class="t m2 x197 hd y3c ff5 fs4 fc0 sc0 ls0 ws0">of</div><div class="t m0 x72 h6 y3c ffa fs4 fc0 sc0 ls0 ws0">C</div><div class="t m0 x64 hf y86b ffa fs6 fc0 sc0 ls0 ws0">n</div><div class="t m2 x1ca hd y3c ff5 fs4 fc0 sc0 ls0 ws0">,<span class="_ _17"> </span>solv<span class="_ _20"></span>e<span class="_ _0"> </span>this<span class="_ _17"> </span>equation<span class="_ _0"> </span>to<span class="_ _0"> </span>obtain<span class="_ _17"> </span>a<span class="_ _0"> </span>closed<span class="_ _0"> </span>for</div><div class="t m0 x153 h10 y3c ffa fs4 fc0 sc0 ls0 ws0">C<span class="ffb">(</span>z<span class="ffb">)</span></div><div class="t m2 x1af hd y3c ff5 fs4 fc0 sc0 ls0 ws0">and<span class="_ _0"> </span>then</div><div class="t m0 xc hd y3d ff5 fs4 fc0 sc0 ls0 ws0">determine<span class="_ _a"> </span><span class="ffa">C</span></div><div class="t m0 x17f hf y86c ffa fs6 fc0 sc0 ls0 ws0">n</div><div class="t m0 x1bf h10 y3d ff5 fs4 fc0 sc0 ls0 ws0">as<span class="_ _a"> </span>the<span class="_ _a"> </span>coefﬁcients<span class="_ _9"> </span>of<span class="_ _a"> </span><span class="ffa">C<span class="ffb">(</span>z<span class="ffb">)</span></span>.</div><div class="t m2 x26 hd y3e ff5 fs4 fc0 sc0 ls0 ws0">Whereas<span class="_ _a"> </span>the<span class="_ _4"> </span>elementary<span class="_ _4"> </span>deriv<span class="_ _b"></span>ation<span class="_ _a"> </span>is<span class="_ _4"> </span>more<span class="_ _4"> </span>self-contained<span class="_ _a"> </span>and<span class="_ _4"> </span>essentially</div><div class="t m2 xc hd y3f ff5 fs4 fc0 sc0 ls0 ws0">doable<span class="_ _4"> </span>with<span class="_ _4"> </span>high-school<span class="_ _0"> </span>math,<span class="_ _4"> </span>the<span class="_ _0"> </span>generating<span class="_ _4"> </span>function<span class="_ _4"> </span>approach<span class="_ _4"> </span>requires<span class="_ _4"> </span>us</div><div class="t m2 xc hd y40 ff5 fs4 fc0 sc0 ls0 ws0">to<span class="_ _21"> </span>deal<span class="_ _21"> </span>with<span class="_ _21"> </span>tractable,<span class="_ _21"> </span>yet<span class="_ _8"> </span>non-trivial<span class="_ _21"> </span>differential<span class="_ _8"> </span>equations.<span class="_ _1f"> </span>On<span class="_ _21"> </span>the<span class="_ _21"> </span>other</div><div class="t m19 xc hd y41 ff5 fs4 fc0 sc0 ls0 ws0">hand,<span class="_ _a"> </span>S<span class="_ _6"></span>ection<span class="_ _9"> </span><span class="ff6">4</span>.<span class="ff6">2</span>.<span class="ff6">1<span class="_ _a"> </span></span>contains<span class="_ _a"> </span>some<span class="_ _a"> </span>“guess-and-pro<span class="_ _20"></span>v<span class="_ _20"></span>e”<span class="_ _a"> </span>parts,<span class="_ _a"> </span>which<span class="_ _a"> </span>are<span class="_ _a"> </span>hard<span class="_ _9"> </span>to</div><div class="t m7 xc hd y43 ff5 fs4 fc0 sc0 ls0 ws0">generalize.<span class="_ _0"> </span>Here,<span class="_ _a"> </span>H<span class="ff6">ennequin</span>’s<span class="_ _9"> </span>approach<span class="_ _a"> </span>shines:<span class="_ _0"> </span>The<span class="_ _a"> </span>symbolic<span class="_ _a"> </span>description<span class="_ _a"> </span>of</div><div class="t m19 xc hd y45 ff5 fs4 fc0 sc0 ls0 ws0">the<span class="_ _a"> </span>corresponding<span class="_ _9"> </span>generating<span class="_ _a"> </span>functions<span class="_ _a"> </span>already<span class="_ _9"> </span>includes<span class="_ _a"> </span>an<span class="_ _a"> </span>arbitrar<span class="_ _6"></span>y<span class="_ _9"> </span>number</div><div class="t m2 xc hd y47 ff5 fs4 fc0 sc0 ls0 ws0">of<span class="_ _4"> </span>piv<span class="_ _20"></span>ots<span class="_ _4"> </span>as<span class="_ _4"> </span>w<span class="_ _20"></span>ell<span class="_ _4"> </span>as<span class="_ _4"> </span>choosing<span class="_ _4"> </span>these<span class="_ _4"> </span>from<span class="_ _a"> </span>a<span class="_ _4"> </span>larger<span class="_ _4"> </span>sample.<span class="_ _21"> </span>(These<span class="_ _4"> </span>v<span class="_ _20"></span>ariants<span class="_ _4"> </span>are</div><div class="t mf xc hd y49 ff5 fs4 fc0 sc0 ls0 ws0">introduced<span class="_ _a"> </span>in<span class="_ _a"> </span>S<span class="_ _6"></span>ection<span class="_ _a"> </span><span class="ff6">3</span>.<span class="ff6">4</span>.<span class="ff6">1<span class="_ _a"> </span></span>“Choice<span class="_ _a"> </span>of<span class="_ _a"> </span>the<span class="_ _a"> </span>Piv<span class="_ _20"></span>ot”<span class="_ _4"> </span>and<span class="_ _a"> </span>S<span class="_ _6"></span>ection<span class="_ _a"> </span><span class="ff6">3</span>.<span class="ff6">4</span>.<span class="ff6">4<span class="_ _a"> </span></span>“Multi-Piv<span class="_ _20"></span>ot</div><div class="t m0 xc hd y4b ff5 fs4 fc0 sc0 ls0 ws0">Quicksort”)</div><div class="t m0 xc h3 y86d ff1 fs1 fc0 sc0 ls0 ws0">4.2.1<span class="_ _22"> </span>Elementary Solution</div><div class="t m2 xc hd y3b8 ff5 fs4 fc0 sc0 ls0 ws0">The<span class="_ _4"> </span>solution<span class="_ _a"> </span>presented<span class="_ _4"> </span>in<span class="_ _4"> </span>this<span class="_ _4"> </span>section<span class="_ _4"> </span>is<span class="_ _a"> </span>a<span class="_ _4"> </span>generalization<span class="_ _4"> </span>of<span class="_ _4"> </span>S<span class="ff6">edgewick</span>’s<span class="_ _4"> </span>der<span class="_ _b"></span>-</div><div class="t m2 xc hd y3b9 ff5 fs4 fc0 sc0 ls0 ws0">iv<span class="_ _20"></span>ation<span class="_ _4"> </span>of<span class="_ _0"> </span>the<span class="_ _4"> </span>expected<span class="_ _4"> </span>number<span class="_ _4"> </span>of<span class="_ _4"> </span>swaps<span class="_ _a"> </span>for<span class="_ _0"> </span>Algorithm<span class="_ _4"> </span><span class="ff6">7<span class="_ _4"> </span></span>in<span class="_ _4"> </span>[</div><div class="t m0 xe3 hd y3b9 ff5 fs4 fc0 sc0 ls0 ws0">S<span class="_ _6"></span>ed<span class="ff6">75</span></div><div class="t m2 x9c hd y3b9 ff5 fs4 fc0 sc0 ls0 ws0">,<span class="_ _4"> </span>p.<span class="_ _5"> </span><span class="ff6">156</span>ff].</div><div class="t m2 xc hd y3bb ff5 fs4 fc0 sc0 ls0 ws0">Although<span class="_ _a"> </span>the<span class="_ _a"> </span>computations<span class="_ _4"> </span>in<span class="_ _a"> </span>this<span class="_ _a"> </span>section<span class="_ _4"> </span>allo<span class="_ _20"></span>w<span class="_ _4"> </span>to<span class="_ _a"> </span>actually</div><div class="t m0 x1b2 h23 y3bb ffd fs4 fc0 sc0 ls0 ws0">derive</div><div class="t m2 x54 hd y3bb ff5 fs4 fc0 sc0 ls0 ws0">the<span class="_ _a"> </span>closed</div><div class="t m2 xc hd y591 ff5 fs4 fc0 sc0 ls0 ws0">form<span class="_ _5"> </span>—<span class="_ _5"> </span>in<span class="_ _a"> </span>contrast<span class="_ _4"> </span>to<span class="_ _a"> </span>only</div><div class="t m0 x8 h23 y591 ffd fs4 fc0 sc0 ls0 ws0">verifying</div><div class="t m2 x141 hd y591 ff5 fs4 fc0 sc0 ls0 ws0">a<span class="_ _a"> </span>‘guessed’<span class="_ _a"> </span>solution<span class="_ _5"> </span>—<span class="_ _5"> </span>some<span class="_ _a"> </span>steps<span class="_ _4"> </span>follo<span class="_ _20"></span>w</div><div class="t me xc hd y592 ff5 fs4 fc0 sc0 ls0 ws0">from<span class="_ _9"> </span>‘magic’<span class="_ _a"> </span>insight.<span class="_ _17"> </span>The<span class="_ _a"> </span>deriv<span class="_ _20"></span>ation<span class="_ _a"> </span>in<span class="_ _a"> </span>S<span class="_ _6"></span>ection<span class="_ _a"> </span><span class="ff6">4</span>.<span class="ff6">2</span>.<span class="ff6">2<span class="_ _a"> </span></span>will<span class="_ _a"> </span>appear<span class="_ _a"> </span>more<span class="_ _a"> </span>directed</div><div class="t m1e xc hd y593 ff5 fs4 fc0 sc0 ls0 ws0">to<span class="_ _a"> </span>the<span class="_ _a"> </span>exercised<span class="_ _a"> </span>generatingfunctionologist.<span class="_ _17"> </span>On<span class="_ _a"> </span>the<span class="_ _a"> </span>other<span class="_ _4"> </span>hand,<span class="_ _a"> </span>the<span class="_ _a"> </span>math<span class="_ _a"> </span>is<span class="_ _4"> </span>more</div><div class="t m0 xc hd y594 ff5 fs4 fc0 sc0 ls0 ws0">inv<span class="_ _20"></span>olv<span class="_ _20"></span>ed.</div><div class="t m0 x3d hb y11 ff6 fs4 fc0 sc0 ls0 ws0">67</div><a class="l" href="#pf45" data-dest-detail='[69,"XYZ",70.866,365.002,null]'><div class="d m1" style="border-style:none;position:absolute;left:301.324092px;bottom:1126.593379px;width:71.943000px;height:15.028000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4a" data-dest-detail='[74,"XYZ",70.866,269.059,null]'><div class="d m1" style="border-style:none;position:absolute;left:507.359611px;bottom:982.996123px;width:74.786000px;height:15.028000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc6" data-dest-detail='[198,"XYZ",70.866,289.194,null]'><div class="d m1" style="border-style:none;position:absolute;left:250.015119px;bottom:955.506353px;width:28.944000px;height:13.901000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf45" data-dest-detail='[69,"XYZ",70.866,365.002,null]'><div class="d m1" style="border-style:none;position:absolute;left:179.405855px;bottom:781.961645px;width:74.280000px;height:15.028000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf27" data-dest-detail='[39,"XYZ",70.866,420.662,null]'><div class="d m1" style="border-style:none;position:absolute;left:254.191333px;bottom:668.313522px;width:72.807000px;height:14.296000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf27" data-dest-detail='[39,"XYZ",70.866,420.662,null]'><div class="d m1" style="border-style:none;position:absolute;left:390.279467px;bottom:668.313522px;width:111.064000px;height:14.296000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf31" data-dest-detail='[49,"XYZ",70.866,756.63,null]'><div class="d m1" style="border-style:none;position:absolute;left:633.511178px;bottom:668.313522px;width:72.807000px;height:14.296000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf31" data-dest-detail='[49,"XYZ",70.866,756.63,null]'><div class="d m1" style="border-style:none;position:absolute;left:769.600992px;bottom:668.313522px;width:67.281000px;height:14.296000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf31" data-dest-detail='[49,"XYZ",70.866,756.63,null]'><div class="d m1" style="border-style:none;position:absolute;left:117.374126px;bottom:639.594071px;width:58.603000px;height:14.296000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf40" data-dest-detail='[64,"XYZ",70.866,764.85,null]'><div class="d m1" style="border-style:none;position:absolute;left:567.009253px;bottom:505.389097px;width:74.278000px;height:15.028000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfca" data-dest-detail='[202,"XYZ",70.866,760.775,null]'><div class="d m1" style="border-style:none;position:absolute;left:729.579220px;bottom:506.618779px;width:36.184000px;height:14.296000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4a" data-dest-detail='[74,"XYZ",70.866,269.059,null]'><div class="d m1" style="border-style:none;position:absolute;left:500.643399px;bottom:419.230743px;width:73.415000px;height:15.028000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.679893,0.000000,0.000000,1.679893,0.000000,0.000000]}'></div></div>
