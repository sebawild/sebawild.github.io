<div id="pf13" class="pf w0 h0" data-page-no="13"><div class="pc pc13 w0 h0"><img class="bi xc9 y387 w7 h2f" alt="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANgAAAAqCAIAAABeGAKoAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAa0lEQVR42u3SMREAMAgAsVIJ+PeDKQYkMLIkEv4+uvLBtS8BRgQjYkQwIkYEI2JEMCJGBCNiRDAiRgQjYkQwIkYEI2JEMCJGBCNiRDAiRgQjYkQwIkYEI2JEMCIYESOCETEiGBEjghExIuwG/awCKRjkYT8AAAAASUVORK5CYII="/><div class="t m0 x0 h5 y2d ff1 fs3 fc0 sc0 ls0 ws0">M.<span class="_ _e"> </span>He,<span class="_ _a"> </span>J.<span class="_ _11"> </span>I.<span class="_ _a"> </span>Munro,<span class="_ _e"> </span>Y.<span class="_ _a"> </span>Nekrich,<span class="_ _e"> </span>S.<span class="_ _e"> </span>Wild,<span class="_ _a"> </span>K.<span class="_ _e"> </span>Wu<span class="_ _2c"> </span>19</div><div class="t m3 x0 h8 y62 ff7 fs4 fc0 sc0 ls0 ws0">this<span class="_ _4"> </span>micro-tree<span class="_ _4"> </span>has<span class="_ _8"> </span>a<span class="_ _4"> </span>tier-1<span class="_ _8"> </span>promoted</div><div class="t m0 xe9 h8 y62 ff9 fs4 fc0 sc0 ls0 ws0">s</div><div class="t m3 x1a9 h8 y62 ff7 fs4 fc0 sc0 ls0 ws0">-no<span class="_ _7"></span>de,<span class="_ _4"> </span>we<span class="_ _4"> </span>store<span class="_ _4"> </span>the<span class="_ _8"> </span>promoted</div><div class="t m0 x158 h8 y62 ff9 fs4 fc0 sc0 ls0 ws0">s</div><div class="t m3 xac h8 y62 ff7 fs4 fc0 sc0 ls0 ws0">-no<span class="_ _7"></span>de<span class="_ _4"> </span>with<span class="_ _8"> </span>the<span class="_ _4"> </span>greatest</div><div class="t m3 x0 h8 y2f ff7 fs4 fc0 sc0 ls0 ws0">heigh<span class="_ _1"></span>t. The<span class="_ _4"> </span>heigh<span class="_ _1"></span>t<span class="_ _8"> </span>of<span class="_ _8"> </span>the<span class="_ _8"> </span>micro-tree<span class="_ _8"> </span>root<span class="_ _8"> </span>can<span class="_ _8"> </span>b<span class="_ _7"></span>e<span class="_ _8"> </span>found<span class="_ _8"> </span>b<span class="_ _5"></span>y<span class="_ _4"> </span>the<span class="_ _8"> </span>diﬀerence<span class="_ _8"> </span>in<span class="_ _8"> </span>depths<span class="_ _4"> </span>of<span class="_ _8"> </span>the<span class="_ _8"> </span>tw<span class="_ _1"></span>o</div><div class="t m9 x0 h8 y30 ff7 fs4 fc0 sc0 ls0 ws0">micro-tree<span class="_ _8"> </span>ro<span class="_ _7"></span>ots,<span class="_ _8"> </span>plus<span class="_ _8"> </span>the<span class="_ _e"> </span>heigh<span class="_ _1"></span>t<span class="_ _8"> </span>of<span class="_ _e"> </span>the<span class="_ _8"> </span>tier-1</div><div class="t m0 x49 h8 y30 ff9 fs4 fc0 sc0 ls0 ws0">s</div><div class="t m9 x1dd h8 y30 ff7 fs4 fc0 sc0 ls0 ws0">-no<span class="_ _7"></span>de. F<span class="_ _6"></span>or<span class="_ _8"> </span>a<span class="_ _e"> </span>node<span class="_ _e"> </span>that<span class="_ _8"> </span>is<span class="_ _8"> </span>not<span class="_ _8"> </span>a<span class="_ _8"> </span>micro-tree</div><div class="t m9 x0 h8 y31 ff7 fs4 fc0 sc0 ls0 ws0">ro<span class="_ _7"></span>ot,<span class="_ _a"> </span>we<span class="_ _e"> </span>consider<span class="_ _a"> </span>the<span class="_ _a"> </span>micro-tree</div><div class="t m0 xf1 h8 y31 ff9 fs4 fc0 sc0 ls0 ws0">µ</div><div class="t m0 x16e h14 y173 ff17 fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x16e h14 y388 ff17 fs7 fc0 sc0 ls0 ws0">j</div><div class="t m9 x137 h8 y31 ff7 fs4 fc0 sc0 ls0 ws0">that<span class="_ _a"> </span>it<span class="_ _e"> </span>is<span class="_ _a"> </span>in.<span class="_ _0"> </span>Supp<span class="_ _7"></span>ose<span class="_ _a"> </span>that</div><div class="t m0 x16f h8 y31 ff9 fs4 fc0 sc0 ls0 ws0">µ</div><div class="t m0 x4d h14 y173 ff17 fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x4d h14 y388 ff17 fs7 fc0 sc0 ls0 ws0">j</div><div class="t m9 x87 h8 y31 ff7 fs4 fc0 sc0 ls0 ws0">do<span class="_ _7"></span>es<span class="_ _a"> </span>not<span class="_ _e"> </span>contain<span class="_ _e"> </span>any</div><div class="t m25 x0 h8 y32 ff7 fs4 fc0 sc0 ls0 ws0">tier-2<span class="_ _8"> </span>promoted</div><div class="t m0 xe8 h8 y32 ff9 fs4 fc0 sc0 ls0 ws0">s</div><div class="t m25 x61 h8 y32 ff7 fs4 fc0 sc0 ls0 ws0">-no<span class="_ _7"></span>des.<span class="_ _3"> </span>Then<span class="_ _8"> </span>w<span class="_ _1"></span>e<span class="_ _8"> </span>pro<span class="_ _12"></span>ceed<span class="_ _8"> </span>in<span class="_ _8"> </span>the<span class="_ _4"> </span>same<span class="_ _8"> </span>wa<span class="_ _1"></span>y<span class="_ _8"> </span>as<span class="_ _8"> </span>in<span class="_ _8"> </span>[</div><div class="t m0 x16f h8 y32 ff7 fs4 fc0 sc0 ls0 ws0">15</div><div class="t m25 xac h8 y32 ff7 fs4 fc0 sc0 ls0 ws0">].<span class="_ _3"> </span>Otherwise,<span class="_ _8"> </span>using<span class="_ _4"> </span>the</div><div class="t m3 x0 h8 y33 ff7 fs4 fc0 sc0 ls0 ws0">lo<span class="_ _7"></span>okup<span class="_ _8"> </span>table,<span class="_ _8"> </span>w<span class="_ _1"></span>e<span class="_ _8"> </span>ﬁnd<span class="_ _8"> </span>the<span class="_ _8"> </span>range<span class="_ _8"> </span>of<span class="_ _8"> </span>tier-2<span class="_ _8"> </span>promoted</div><div class="t m0 x1b9 h8 y33 ff9 fs4 fc0 sc0 ls0 ws0">s</div><div class="t m3 x176 h8 y33 ff7 fs4 fc0 sc0 ls0 ws0">-no<span class="_ _7"></span>des<span class="_ _8"> </span>that<span class="_ _8"> </span>are<span class="_ _4"> </span>descendants,<span class="_ _4"> </span>and<span class="_ _8"> </span>using<span class="_ _8"> </span>a</div><div class="t m20 x0 h8 y34 ff7 fs4 fc0 sc0 ls0 ws0">range-maxim<span class="_ _5"></span>um<span class="_ _8"> </span>query<span class="_ _14"></span>,<span class="_ _4"> </span>ﬁnd<span class="_ _8"> </span>the<span class="_ _8"> </span>tier-2<span class="_ _8"> </span>promoted</div><div class="t m0 x1dd h8 y34 ff9 fs4 fc0 sc0 ls0 ws0">s</div><div class="t m20 x4a h8 y34 ff7 fs4 fc0 sc0 ls0 ws0">-no<span class="_ _7"></span>de<span class="_ _8"> </span>that<span class="_ _8"> </span>has<span class="_ _8"> </span>the<span class="_ _8"> </span>greatest<span class="_ _8"> </span>depth.<span class="_ _3"> </span>T<span class="_ _14"></span>o<span class="_ _8"> </span>ﬁnd</div><div class="t m21 x0 h8 y35 ff7 fs4 fc0 sc0 ls0 ws0">the<span class="_ _8"> </span>depth<span class="_ _8"> </span>of<span class="_ _8"> </span>a<span class="_ _8"> </span>tier-2</div><div class="t m0 x68 h8 y35 ff9 fs4 fc0 sc0 ls0 ws0">s</div><div class="t m21 x17f h8 y35 ff7 fs4 fc0 sc0 ls0 ws0">-no<span class="_ _7"></span>de,<span class="_ _8"> </span>we<span class="_ _4"> </span>store<span class="_ _8"> </span>the<span class="_ _8"> </span>micro-tree<span class="_ _8"> </span>containing<span class="_ _4"> </span>the<span class="_ _8"> </span>deep<span class="_ _7"></span>est<span class="_ _8"> </span>descendant<span class="_ _8"> </span>as<span class="_ _8"> </span>in</div><div class="t m3 x0 h8 y36 ff7 fs4 fc0 sc0 ls0 ws0">the<span class="_ _4"> </span>ro<span class="_ _7"></span>ot<span class="_ _8"> </span>case.<span class="_ _3"> </span>W<span class="_ _14"></span>e<span class="_ _8"> </span>then<span class="_ _4"> </span>pro<span class="_ _7"></span>ceed<span class="_ _8"> </span>in<span class="_ _8"> </span>the<span class="_ _4"> </span>same<span class="_ _8"> </span>manner.<span class="_ _3"> </span>The<span class="_ _8"> </span>space<span class="_ _4"> </span>required<span class="_ _8"> </span>for<span class="_ _8"> </span>range-maxim<span class="_ _5"></span>um</div><div class="t m0 x0 h8 y37 ff7 fs4 fc0 sc0 ls0 ws0">queries<span class="_ _8"> </span>on<span class="_ _4"> </span>all<span class="_ _8"> </span>tier-2<span class="_ _8"> </span><span class="ff9">s</span>-no<span class="_ _7"></span>des<span class="_ _8"> </span>is<span class="_ _8"> </span>linear<span class="_ _8"> </span>in<span class="_ _8"> </span>the<span class="_ _4"> </span>num<span class="_ _1"></span>b<span class="_ _7"></span>er<span class="_ _8"> </span>which<span class="_ _4"> </span>is<span class="_ _8"> </span><span class="ff9">O<span class="_ _7"></span><span class="ffa">(</span>n/H</span></div><div class="t m0 xc4 h19 y389 ff1a fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x1db h8 y37 ffa fs4 fc0 sc0 ls0 ws0">)<span class="ff7">.</span></div><div class="t m0 x0 h8 y178 ff24 fs4 fc0 sc0 ls0 ws0">leftmost_leaf<span class="ff1">,<span class="_ _e"> </span></span>rightmost_leaf<span class="ff1">:</span></div><div class="t mf x13e h8 y178 ff7 fs4 fc0 sc0 ls0 ws0">This<span class="_ _4"> </span>is<span class="_ _8"> </span>done<span class="_ _8"> </span>in<span class="_ _4"> </span>the<span class="_ _8"> </span>same<span class="_ _8"> </span>w<span class="_ _1"></span>ay<span class="_ _4"> </span>as<span class="_ _8"> </span>previously<span class="_ _14"></span>.<span class="_ _3"> </span>The<span class="_ _4"> </span>only</div><div class="t m15 x0 h8 y179 ff7 fs4 fc0 sc0 ls0 ws0">diﬀerence<span class="_ _4"> </span>is<span class="_ _8"> </span>that<span class="_ _8"> </span>we<span class="_ _4"> </span>need<span class="_ _4"> </span>to<span class="_ _8"> </span>store<span class="_ _8"> </span>the<span class="_ _4"> </span>left<span class="_ _8"> </span>most/right<span class="_ _4"> </span>most<span class="_ _8"> </span>leaf<span class="_ _4"> </span>at<span class="_ _8"> </span>every<span class="_ _4"> </span>tier-1</div><div class="t m0 x141 h8 y179 ff9 fs4 fc0 sc0 ls0 ws0">s</div><div class="t m15 x78 h8 y179 ff7 fs4 fc0 sc0 ls0 ws0">-no<span class="_ _7"></span>de.<span class="_ _3"> </span>W<span class="_ _6"></span>e</div><div class="t m3 x0 h8 y17a ff7 fs4 fc0 sc0 ls0 ws0">also<span class="_ _b"> </span>need<span class="_ _4"> </span>to<span class="_ _4"> </span>store<span class="_ _4"> </span>the<span class="_ _4"> </span>micro-tree<span class="_ _b"> </span>that<span class="_ _4"> </span>contains<span class="_ _b"> </span>the<span class="_ _4"> </span>left<span class="_ _4"> </span>most/right<span class="_ _b"> </span>most<span class="_ _b"> </span>leaf,<span class="_ _4"> </span>or<span class="_ _4"> </span>the<span class="_ _4"> </span>micro-tree</div><div class="t m0 x0 h8 y17b ff7 fs4 fc0 sc0 ls0 ws0">con<span class="_ _5"></span>taining<span class="_ _4"> </span>the<span class="_ _8"> </span>relev<span class="_ _1"></span>ant<span class="_ _4"> </span>tier-1<span class="_ _8"> </span><span class="ff9">s</span>-no<span class="_ _7"></span>de<span class="_ _8"> </span>at<span class="_ _8"> </span>every<span class="_ _4"> </span>tier-2<span class="_ _8"> </span><span class="ff9">s</span>-node.</div><div class="t m0 x0 h8 y1fe ff24 fs4 fc0 sc0 ls0 ws0">leaf_size<span class="ff1">:</span></div><div class="t mf xb3 h8 y1fe ff7 fs4 fc0 sc0 ls0 ws0">A<span class="_ _5"></span>t<span class="_ _4"> </span>each<span class="_ _4"> </span>tier-1</div><div class="t m0 x179 h8 y1fe ff9 fs4 fc0 sc0 ls0 ws0">s</div><div class="t mf xdf h8 y1fe ff7 fs4 fc0 sc0 ls0 ws0">-no<span class="_ _7"></span>de<span class="_ _4"> </span>we<span class="_ _4"> </span>store<span class="_ _8"> </span>the<span class="_ _4"> </span>num<span class="_ _1"></span>b<span class="_ _7"></span>er<span class="_ _8"> </span>of<span class="_ _8"> </span>lea<span class="_ _1"></span>ves<span class="_ _4"> </span>in<span class="_ _8"> </span>the<span class="_ _4"> </span>subtree<span class="_ _8"> </span>ro<span class="_ _7"></span>oted<span class="_ _8"> </span>at</div><div class="t m4 x0 h8 y38a ff7 fs4 fc0 sc0 ls0 ws0">the</div><div class="t m0 xd h8 y38a ff9 fs4 fc0 sc0 ls0 ws0">s</div><div class="t m4 xa4 h8 y38a ff7 fs4 fc0 sc0 ls0 ws0">-no<span class="_ _7"></span>de.<span class="_ _3"> </span>W<span class="_ _6"></span>e<span class="_ _8"> </span>also<span class="_ _8"> </span>store<span class="_ _4"> </span>the<span class="_ _8"> </span>preﬁx<span class="_ _8"> </span>sum<span class="_ _4"> </span>of<span class="_ _8"> </span>these<span class="_ _8"> </span>v<span class="_ _14"></span>alues<span class="_ _8"> </span>(the<span class="_ _8"> </span>sum<span class="_ _4"> </span>of<span class="_ _8"> </span>the<span class="_ _8"> </span>n<span class="_ _5"></span>um<span class="_ _1"></span>b<span class="_ _12"></span>er<span class="_ _4"> </span>of<span class="_ _8"> </span>leav<span class="_ _1"></span>es</div><div class="t m3 x0 h8 y38b ff7 fs4 fc0 sc0 ls0 ws0">from<span class="_ _b"> </span>the<span class="_ _4"> </span>ﬁrst</div><div class="t m0 xce h8 y38b ff9 fs4 fc0 sc0 ls0 ws0">s</div><div class="t m3 x92 h8 y38b ff7 fs4 fc0 sc0 ls0 ws0">-no<span class="_ _7"></span>de<span class="_ _b"> </span>to<span class="_ _4"> </span>the<span class="_ _4"> </span>current</div><div class="t m0 xda h8 y38b ff9 fs4 fc0 sc0 ls0 ws0">s</div><div class="t m3 xd1 h8 y38b ff7 fs4 fc0 sc0 ls0 ws0">-no<span class="_ _7"></span>de).<span class="_ _3"> </span>F<span class="_ _6"></span>or<span class="_ _4"> </span>tier-2</div><div class="t m0 xfa h8 y38b ff9 fs4 fc0 sc0 ls0 ws0">s</div><div class="t m3 xfb h8 y38b ff7 fs4 fc0 sc0 ls0 ws0">-no<span class="_ _7"></span>des,<span class="_ _4"> </span>we<span class="_ _b"> </span>store<span class="_ _b"> </span>the<span class="_ _4"> </span>num<span class="_ _1"></span>b<span class="_ _7"></span>er<span class="_ _4"> </span>of<span class="_ _4"> </span>lea<span class="_ _1"></span>ves</div><div class="t m3 x0 h8 y38c ff7 fs4 fc0 sc0 ls0 ws0">in<span class="_ _4"> </span>the<span class="_ _8"> </span>subtree<span class="_ _4"> </span>of<span class="_ _8"> </span>the<span class="_ _4"> </span>mini-tree<span class="_ _8"> </span>ro<span class="_ _7"></span>oted<span class="_ _8"> </span>at<span class="_ _4"> </span>the</div><div class="t m0 x71 h8 y38c ff9 fs4 fc0 sc0 ls0 ws0">s</div><div class="t m3 x1ad h8 y38c ff7 fs4 fc0 sc0 ls0 ws0">-no<span class="_ _7"></span>de.<span class="_ _3"> </span>W<span class="_ _14"></span>e<span class="_ _4"> </span>do<span class="_ _8"> </span>not<span class="_ _4"> </span>include<span class="_ _8"> </span>tier-1</div><div class="t m0 x14f h8 y38c ff9 fs4 fc0 sc0 ls0 ws0">s</div><div class="t m3 x8a h8 y38c ff7 fs4 fc0 sc0 ls0 ws0">-no<span class="_ _7"></span>des<span class="_ _4"> </span>(which</div><div class="t m9 x0 h8 y38d ff7 fs4 fc0 sc0 ls0 ws0">are<span class="_ _8"> </span>leav<span class="_ _1"></span>es<span class="_ _e"> </span>of<span class="_ _8"> </span>the<span class="_ _8"> </span>mini-tree)<span class="_ _e"> </span>in<span class="_ _8"> </span>this<span class="_ _e"> </span>coun<span class="_ _5"></span>t. F<span class="_ _14"></span>or<span class="_ _8"> </span>the</div><div class="t m0 x15f h8 y38d ff9 fs4 fc0 sc0 ls0 ws0">s</div><div class="t m9 x19b h8 y38d ff7 fs4 fc0 sc0 ls0 ws0">-no<span class="_ _7"></span>des<span class="_ _8"> </span>of<span class="_ _e"> </span>eac<span class="_ _1"></span>h<span class="_ _e"> </span>mini-tree,<span class="_ _e"> </span>w<span class="_ _1"></span>e<span class="_ _e"> </span>store<span class="_ _8"> </span>the</div><div class="t m10 x0 h8 y38e ff7 fs4 fc0 sc0 ls0 ws0">preﬁx-sum<span class="_ _4"> </span>of<span class="_ _8"> </span>the<span class="_ _8"> </span>num<span class="_ _1"></span>b<span class="_ _7"></span>er<span class="_ _8"> </span>of<span class="_ _8"> </span>lea<span class="_ _5"></span>v<span class="_ _1"></span>es<span class="_ _8"> </span>(starting<span class="_ _8"> </span>from<span class="_ _8"> </span>the<span class="_ _8"> </span>ﬁrst<span class="_ _8"> </span>tier-2</div><div class="t m0 x1d5 h8 y38e ff9 fs4 fc0 sc0 ls0 ws0">s</div><div class="t m10 x1b1 h8 y38e ff7 fs4 fc0 sc0 ls0 ws0">-no<span class="_ _7"></span>de<span class="_ _8"> </span>of<span class="_ _4"> </span>the<span class="_ _8"> </span>mini-tree<span class="_ _8"> </span>to</div><div class="t m0 x0 h8 y38f ff7 fs4 fc0 sc0 ls0 ws0">the<span class="_ _8"> </span>curren<span class="_ _1"></span>t<span class="_ _8"> </span><span class="ff9">s</span>-no<span class="_ _7"></span>de).</div><div class="t m3 xa h8 y390 ff7 fs4 fc0 sc0 ls0 ws0">T<span class="_ _14"></span>o<span class="_ _4"> </span>ﬁnd<span class="_ _4"> </span>the<span class="_ _4"> </span>num<span class="_ _1"></span>b<span class="_ _7"></span>er<span class="_ _8"> </span>of<span class="_ _4"> </span>leav<span class="_ _1"></span>es<span class="_ _4"> </span>b<span class="_ _7"></span>elow<span class="_ _4"> </span>a<span class="_ _4"> </span>no<span class="_ _7"></span>de,<span class="_ _8"> </span>w<span class="_ _5"></span>e<span class="_ _4"> </span>ﬁnd<span class="_ _4"> </span>the<span class="_ _8"> </span>n<span class="_ _1"></span>umber<span class="_ _8"> </span>of<span class="_ _4"> </span>leav<span class="_ _1"></span>es<span class="_ _4"> </span>in<span class="_ _8"> </span>the<span class="_ _4"> </span>micro-tree</div><div class="t m9 x0 h8 y391 ff7 fs4 fc0 sc0 ls0 ws0">using<span class="_ _8"> </span>the<span class="_ _8"> </span>lo<span class="_ _7"></span>okup<span class="_ _e"> </span>table. W<span class="_ _6"></span>e<span class="_ _e"> </span>ﬁnd<span class="_ _8"> </span>the<span class="_ _8"> </span>range<span class="_ _8"> </span>of<span class="_ _e"> </span>the<span class="_ _8"> </span>tier-2</div><div class="t m0 x11f h8 y391 ff9 fs4 fc0 sc0 ls0 ws0">s</div><div class="t m9 x81 h8 y391 ff7 fs4 fc0 sc0 ls0 ws0">-no<span class="_ _7"></span>des<span class="_ _8"> </span>b<span class="_ _7"></span>elow<span class="_ _4"> </span>it,<span class="_ _e"> </span>if<span class="_ _8"> </span>the<span class="_ _8"> </span>micro<span class="_ _e"> </span>has</div><div class="t m3 x0 h8 y392 ff7 fs4 fc0 sc0 ls0 ws0">an<span class="_ _5"></span>y<span class="_ _8"> </span>tier-2<span class="_ _8"> </span>promoted</div><div class="t m0 xfe h8 y392 ff9 fs4 fc0 sc0 ls0 ws0">s</div><div class="t m3 x46 h8 y392 ff7 fs4 fc0 sc0 ls0 ws0">-no<span class="_ _7"></span>des.<span class="_ _3"> </span>If<span class="_ _8"> </span>not<span class="_ _8"> </span>we<span class="_ _4"> </span>chec<span class="_ _1"></span>k<span class="_ _8"> </span>the<span class="_ _8"> </span>unique<span class="_ _8"> </span>outgoing<span class="_ _8"> </span>edge<span class="_ _8"> </span>if<span class="_ _8"> </span>necessary<span class="_ _8"> </span>for<span class="_ _8"> </span>tier-2</div><div class="t m9 x0 h8 y393 ff7 fs4 fc0 sc0 ls0 ws0">promoted</div><div class="t m0 x15c h8 y393 ff9 fs4 fc0 sc0 ls0 ws0">s</div><div class="t m9 x150 h8 y393 ff7 fs4 fc0 sc0 ls0 ws0">-no<span class="_ _7"></span>des. F<span class="_ _14"></span>rom<span class="_ _e"> </span>the<span class="_ _8"> </span>range<span class="_ _e"> </span>of<span class="_ _8"> </span>the<span class="_ _e"> </span>promoted</div><div class="t m0 x114 h8 y393 ff9 fs4 fc0 sc0 ls0 ws0">s</div><div class="t m9 x17 h8 y393 ff7 fs4 fc0 sc0 ls0 ws0">-no<span class="_ _7"></span>des,<span class="_ _8"> </span>we<span class="_ _8"> </span>sum<span class="_ _e"> </span>of<span class="_ _8"> </span>the<span class="_ _e"> </span>lea<span class="_ _1"></span>ves<span class="_ _8"> </span>in<span class="_ _e"> </span>the</div><div class="t m3 x0 h8 y98 ff7 fs4 fc0 sc0 ls0 ws0">mini-tree<span class="_ _4"> </span>from<span class="_ _4"> </span>the<span class="_ _4"> </span>preﬁx<span class="_ _8"> </span>sum<span class="_ _4"> </span>data<span class="_ _4"> </span>structure.<span class="_ _3"> </span>W<span class="_ _14"></span>e<span class="_ _4"> </span>also<span class="_ _4"> </span>ﬁnd<span class="_ _4"> </span>the<span class="_ _8"> </span>tier-1</div><div class="t m0 x180 h8 y98 ff9 fs4 fc0 sc0 ls0 ws0">s</div><div class="t m3 x87 h8 y98 ff7 fs4 fc0 sc0 ls0 ws0">no<span class="_ _7"></span>des<span class="_ _4"> </span>b<span class="_ _7"></span>elow<span class="_ _b"> </span>in<span class="_ _8"> </span>similar</div><div class="t m7 x0 h8 y99 ff7 fs4 fc0 sc0 ls0 ws0">fashion.<span class="_ _3"> </span>W<span class="_ _6"></span>e<span class="_ _8"> </span>then<span class="_ _8"> </span>take<span class="_ _4"> </span>the<span class="_ _4"> </span>sum<span class="_ _8"> </span>of<span class="_ _8"> </span>the<span class="_ _4"> </span>sizes<span class="_ _8"> </span>of<span class="_ _8"> </span>the<span class="_ _8"> </span>tier-1</div><div class="t m0 x1aa h8 y99 ff9 fs4 fc0 sc0 ls0 ws0">s</div><div class="t m7 x1a5 h8 y99 ff7 fs4 fc0 sc0 ls0 ws0">-no<span class="_ _7"></span>des<span class="_ _4"> </span>using<span class="_ _8"> </span>the<span class="_ _8"> </span>preﬁx-sum<span class="_ _8"> </span>data</div><div class="t m9 x0 h8 y9b ff7 fs4 fc0 sc0 ls0 ws0">structure.</div><div class="t m0 x1c7 h30 y9b ff24 fs4 fc0 sc0 ls0 ws0">leaf_rank<span class="_ _e"> </span><span class="ff25">and<span class="_ _a"> </span></span>leaf_select</div><div class="t m9 x120 h8 y9b ff7 fs4 fc0 sc0 ls0 ws0">:</div><div class="t m0 x15e ha y9b ffc fs4 fc0 sc0 ls0 ws0">leaf_select</div><div class="t m9 x85 h8 y9b ff7 fs4 fc0 sc0 ls0 ws0">is<span class="_ _4"> </span>done<span class="_ _8"> </span>in<span class="_ _8"> </span>the<span class="_ _4"> </span>same<span class="_ _8"> </span>wa<span class="_ _1"></span>y<span class="_ _8"> </span>as<span class="_ _4"> </span>b<span class="_ _12"></span>efore,</div><div class="t m9 x0 h8 y9c ff7 fs4 fc0 sc0 ls0 ws0">using<span class="_ _4"> </span>the<span class="_ _8"> </span>compressed<span class="_ _8"> </span>bit<span class="_ _8"> </span>vector<span class="_ _4"> </span>approac<span class="_ _5"></span>h.<span class="_ _3"> </span>F<span class="_ _14"></span>or</div><div class="t m0 x1c ha y9c ffc fs4 fc0 sc0 ls0 ws0">leaf_rank</div><div class="t m9 x82 h8 y9c ff7 fs4 fc0 sc0 ls0 ws0">,<span class="_ _4"> </span>in<span class="_ _8"> </span>addition<span class="_ _8"> </span>to<span class="_ _8"> </span>the<span class="_ _8"> </span>information</div><div class="t m3 x0 h8 y9d ff7 fs4 fc0 sc0 ls0 ws0">stored,<span class="_ _b"> </span>we<span class="_ _b"> </span>also<span class="_ _b"> </span>need<span class="_ _4"> </span>to<span class="_ _b"> </span>store<span class="_ _4"> </span>the<span class="_ _b"> </span>num<span class="_ _1"></span>b<span class="_ _7"></span>er<span class="_ _4"> </span>of<span class="_ _b"> </span>leav<span class="_ _1"></span>es<span class="_ _4"> </span>preceding<span class="_ _b"> </span>tier-1</div><div class="t m0 x25 h8 y9d ff9 fs4 fc0 sc0 ls0 ws0">s</div><div class="t m3 x43 h8 y9d ff7 fs4 fc0 sc0 ls0 ws0">-no<span class="_ _7"></span>des.<span class="_ _3"> </span>F<span class="_ _6"></span>or<span class="_ _4"> </span>tier-2</div><div class="t m0 x14a h8 y9d ff9 fs4 fc0 sc0 ls0 ws0">s</div><div class="t m3 x31 h8 y9d ff7 fs4 fc0 sc0 ls0 ws0">-no<span class="_ _7"></span>des,</div><div class="t m0 x0 h8 y9e ff7 fs4 fc0 sc0 ls0 ws0">w<span class="_ _5"></span>e<span class="_ _4"> </span>store<span class="_ _8"> </span>the<span class="_ _8"> </span>preceding<span class="_ _8"> </span>tier-1<span class="_ _8"> </span><span class="ff9">s</span>-no<span class="_ _7"></span>de,<span class="_ _8"> </span>and<span class="_ _8"> </span>the<span class="_ _4"> </span>num<span class="_ _1"></span>b<span class="_ _12"></span>er<span class="_ _4"> </span>of<span class="_ _8"> </span>leav<span class="_ _1"></span>es<span class="_ _8"> </span>b<span class="_ _7"></span>etw<span class="_ _1"></span>een<span class="_ _8"> </span>them.</div><div class="t m0 x0 h8 y394 ff24 fs4 fc0 sc0 ls0 ws0">level_leftmost<span class="ff1">,<span class="_ _e"> </span></span>level_rightmost<span class="ff1">:<span class="_ _2e"> </span><span class="ff7">No<span class="_ _4"> </span>changes<span class="_ _4"> </span>needed<span class="_ _8"> </span>w.<span class="_ _9"></span>r.<span class="_ _9"></span>t.<span class="_ _8"> </span>previous<span class="_ _8"> </span>work.</span></span></div><div class="t m0 x0 h8 y395 ff24 fs4 fc0 sc0 ls0 ws0">level_succ<span class="ff1">,<span class="_ _e"> </span></span>level_pred<span class="ff1">:</span></div><div class="t m9 x179 h8 y395 ff7 fs4 fc0 sc0 ls0 ws0">Using</div><div class="t m0 x10b ha y395 ffc fs4 fc0 sc0 ls0 ws0">node_rank</div><div class="t m0 x14 h12 y396 ff11 fs7 fc0 sc0 ls0 ws0">LEVEL</div><div class="t m9 x176 h8 y395 ff7 fs4 fc0 sc0 ls0 ws0">and</div><div class="t m0 x197 ha y395 ffc fs4 fc0 sc0 ls0 ws0">node_select</div><div class="t m0 x1db h12 y396 ff11 fs7 fc0 sc0 ls0 ws0">LEVEL</div><div class="t m9 x128 h8 y395 ff7 fs4 fc0 sc0 ls0 ws0">,<span class="_ _4"> </span>these<span class="_ _8"> </span>op<span class="_ _7"></span>erations</div><div class="t m0 x0 h8 y397 ff7 fs4 fc0 sc0 ls0 ws0">are<span class="_ _8"> </span>no<span class="_ _1"></span>w<span class="_ _8"> </span>straight-forw<span class="_ _1"></span>ard<span class="_ _8"> </span>and<span class="_ _8"> </span>do<span class="_ _8"> </span>not<span class="_ _8"> </span>need<span class="_ _4"> </span>a<span class="_ _8"> </span>tailored<span class="_ _8"> </span>implementation.</div><div class="t m0 x0 h8 y398 ff24 fs4 fc0 sc0 ls0 ws0">LCA<span class="ff1">:</span></div><div class="t m26 xef h8 y398 ff7 fs4 fc0 sc0 ls0 ws0">The<span class="_ _8"> </span>tec<span class="_ _5"></span>hnique<span class="_ _8"> </span>of<span class="_ _8"> </span>He<span class="_ _8"> </span>et<span class="_ _8"> </span>al.<span class="_ _8"> </span>[</div><div class="t m0 x12 h8 y398 ff7 fs4 fc0 sc0 ls0 ws0">20</div><div class="t m26 xd1 h8 y398 ff7 fs4 fc0 sc0 ls0 ws0">]<span class="_ _8"> </span>w<span class="_ _5"></span>orks<span class="_ _8"> </span>for<span class="_ _8"> </span>tree<span class="_ _8"> </span>slabbing,<span class="_ _8"> </span>to<span class="_ _7"></span>o.<span class="_ _3"> </span>The<span class="_ _8"> </span>only<span class="_ _8"> </span>change<span class="_ _4"> </span>we<span class="_ _4"> </span>need</div><div class="t m13 x0 h8 y399 ff7 fs4 fc0 sc0 ls0 ws0">to<span class="_ _8"> </span>mak<span class="_ _5"></span>e<span class="_ _8"> </span>is<span class="_ _8"> </span>to<span class="_ _8"> </span>include<span class="_ _8"> </span>tier-1</div><div class="t m0 x4c h8 y399 ff9 fs4 fc0 sc0 ls0 ws0">s</div><div class="t m13 x179 h8 y399 ff7 fs4 fc0 sc0 ls0 ws0">-no<span class="_ _7"></span>des<span class="_ _8"> </span>in<span class="_ _8"> </span>the<span class="_ _8"> </span>tier-1<span class="_ _8"> </span>macro<span class="_ _8"> </span>tree<span class="_ _8"> </span>and<span class="_ _8"> </span>tier-2</div><div class="t m0 xfc h8 y399 ff9 fs4 fc0 sc0 ls0 ws0">s</div><div class="t m13 x15b h8 y399 ff7 fs4 fc0 sc0 ls0 ws0">-no<span class="_ _7"></span>des<span class="_ _8"> </span>in<span class="_ _8"> </span>each<span class="_ _4"> </span>tier-2</div><div class="t m0 x0 h8 y39a ff7 fs4 fc0 sc0 ls0 ws0">macro<span class="_ _8"> </span>tree.<span class="_ _3"> </span>These<span class="_ _4"> </span>will<span class="_ _8"> </span>b<span class="_ _7"></span>e<span class="_ _8"> </span>included<span class="_ _8"> </span>instead<span class="_ _8"> </span>of<span class="_ _8"> </span>the<span class="_ _4"> </span>dummy<span class="_ _4"> </span>ro<span class="_ _7"></span>ot<span class="_ _8"> </span>added.</div><div class="t m0 x0 ha y39b ff24 fs4 fc0 sc0 ls0 ws0">node_rank</div><div class="t m0 xe5 h14 y39c ff24 fs7 fc0 sc0 ls0 ws0">PRE<span class="ff17">/</span>POST<span class="ff17">/</span>IN<span class="ff17">/</span>DFUDS<span class="ff17">/</span>LEVEL</div><div class="t m0 x1d2 h8 y39b ff1 fs4 fc0 sc0 ls0 ws0">,<span class="_ _e"> </span><span class="ff24">node_select</span></div><div class="t m0 x97 h14 y39c ff24 fs7 fc0 sc0 ls0 ws0">PRE<span class="ff17">/</span>POST<span class="ff17">/</span>INDFUDS<span class="ff17">/</span>LEVEL</div><div class="t m0 x1b2 h8 y39b ff1 fs4 fc0 sc0 ls0 ws0">:</div><div class="t m11 x158 h8 y39b ff7 fs4 fc0 sc0 ls0 ws0">F<span class="_ _14"></span>or<span class="_ _4"> </span>other<span class="_ _8"> </span>trav<span class="_ _1"></span>ersals<span class="_ _8"> </span>can</div><div class="t m0 x0 h8 y39d ff7 fs4 fc0 sc0 ls0 ws0">b<span class="_ _7"></span>e<span class="_ _8"> </span>handled<span class="_ _4"> </span>similarly<span class="_ _8"> </span>to<span class="_ _8"> </span>preorder<span class="_ _8"> </span>/<span class="_ _8"> </span>level<span class="_ _4"> </span>order.</div><a class="l" href="#pf14" data-dest-detail='[20,"XYZ",107.717,247.806,null]'><div class="d md" style="border-style:none;position:absolute;left:634.065543px;bottom:1143.131925px;width:11.955000px;height:8.267000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf15" data-dest-detail='[21,"XYZ",90.709,719.085,null]'><div class="d md" style="border-style:none;position:absolute;left:398.059052px;bottom:373.329346px;width:11.956000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.679893,0.000000,0.000000,1.679893,0.000000,0.000000]}'></div></div>
