<div id="pf2" class="pf w0 h0" data-page-no="2"><div class="pc pc2 w0 h0"><img class="bi x18 y2b w2 ha" alt="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAmsAAANKCAIAAABaqZ6UAAAACXBIWXMAABYlAAAWJQFJUiTwAAAKdUlEQVR42u3YQQqDMBBA0aYku9yy4KGEHjO7wPQCFcpQJMp7SyGLGcSPKRHxAAAOlFK+P1dQAEh4WgEAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKAAgIICgIICgIICgIICgIICAAoKAAoKAAoKAAoKAAoKACgoACgoACgoACgoACgoAKCgAKCgAKCgAKCgAKCgAICCAoCCAoCCAoCCAoCCAgAKCgAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKACgoACgoACgoACgoACgoACAggKAggKAggKAggKAggIACgoACgoACgoACgoACgoAKCgAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKAAgIICgIICgIICgIICgIICAAoKAAoKAAoKAAoKAAoKACgoACgoACgoACgoACgoAKCgAKCgAKCgAKCgAKCgAICCAoCCAoCCAoCCAoCCAgAKCgAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKACgoACgoACgoACgoACgoACAggKAggKAggKAggKAggIACgoACgoACgoACgoACgoAKCgAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKBWAAAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKACgoACgoACgoACgoACgoACAggKAggKAggKAggKAggIACgoACgoACgoACgoACgoAKCgAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKAAgIICgIICgIICgIICgIICAAoKAAoKAAoKAAoKAAoKACgoACgoACgoACgoACgoAKCgAKCgAKCgAKCgAKCgAICCAoCCAoCCAoCCAoCCAgAKCgAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKACgoACgoACgoACgoACgoACAggKAggKAggKAggKAggIACgoACgoACgoACgoACgoAKCgAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKAAgIICgIICgIICgIICgIICAAoKAAoKAAoKAAoKAAoKAPysWkHCnLO1ljsbEUvNMsbovd9jFoAzFR9BAEhwiwsACgoACgoACgoACgoAKCgAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKAAgIICgIICgIICgIICgIICAAoKAAoKAAoKAFdQrQDONOdsreXORsRSs4wxeu/3mAUSivcYABLc4gKAggKAggKAggKAggIACgoACgoACgoACgoACgoAKCgAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKAAgIICgIICgIICgIICgIICAAoKAAoKAAoKAAoKAAoKACgoACgoACgoACgoACgoAKCgAKCgAKCgAKCgAKCgAICCAoCCAoCCAoCCAoCCAgAKCgAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKACgoACgoACgoACgoACgoACAggKAggKAggKAggKAggIACgoACgoACgoACgoACgoAKCgAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKAAgIICgIICgIICgIICgIICAAoKAAoKAAoKAAoKAAoKACgoACgoACgoACgoACgoAKCgAKCgAKCgAKCgAKCgAICCAoCCAoCCAoCCAoCCAgAKCgAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKACgoACgoACgoACgoACgoACAggKAggKAggKAggKAggIACgoACgoACgoACgoAKCgAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKAAgIICgIICgIICgIICgIICAAoKAAoKAAoKAAoKAAoKACgoACgoACgoACgoACgoAKCgAKCgAKCgAKCgAKCgAICCAoCCAoCCAoCCAoCCAgAKCgAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKACgoACgoACgoACgoACgoACAggKAggKAggKAggKAggIACgoACgoACgoACgoACgoAKCgAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKAAgIICgIICgIICgIICgIICAAoKAAoKAAoKAAoKAAoKACgoACgoACgoACgoACgoAKCgAKCgAKCgAKCgAKCgAICCAoCCAoCCAoCCAoCCAgAKCgAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKACgoACgoACgoACgoACgoACAggKAggKAggKAggKAggIACgoACgoACgoACgoACgoAKCgAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAgIICgIICgIICgIICgIICAAoKAAoKAAoKAAoKAAoKACgoACgoACgoACgoACgoAKCgAKCgAKCgAKCgAKCgAICCAoCCAoCCAoCCAoCCAgAKCgAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKACgoACgoACgoACgoACgoACAggKAggKAggKAggKAggIACgoACgoACgoACgoACgoAKCgAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKAAgIICgIICgIICgIICgIICAAoKAAoKAAoKAAoKAAoKACgoACgoACgoACgoACgoAKCgAKCgAKCgAKCgAKCgAICCAoCCAoCCAoCCAoCCAgAKCgAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKACgoACgoACgoACgoACgoACAggKAggKAggKAggKAggIACgoACgoACgoACgoACgoAKCgAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKAAgIICgIICgIICgIICgIICAAoKAAoKAAoKAAoKACgoACgoACgoACgoACgoAKCgAKCgAKCgAKCgAKCgAICCAoCCAoCCAoCCAoCCAgAKCgAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKACgoACgoACgoACgoACgoACAggKAggKAggKAggKAggIACgoACgoACgoACgoACgoAKCgAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKAAgIICgIICgIICgIICgIICAAoKAAoKAAoKAAoKAAoKACgoACgoACgoACgoACgoAKCgAKCgAKCgAKCgAKCgAICCAoCCAoCCAoCCAoCCAgAKCgAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKACgoACgoACgoACgoACgoACAggKAggKAggKAggKAggIACgoACgoACgoACgoACgoAKCgAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKAAgIICgIICgIICgIICgIICAAoKAAoKAAoKAAoKAAoKACgoACgoACgoACgoACgoAKCgAKCgAKCgAKCgAICCAoCCAoCCAoCCAoCCAgAKCgAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKACgoACgoACgoACgoACgoACAggKAggKAggKAggKAggIACgoACgoACgoACgoACgoAKCgAKCgAKCgAKCgAKCgAoKAAoKAAoKAAoKAAoKAAgIICgIICgIICgIICgIICAAoKAAoKAAoKAAoKAAoKACgoACgoACgoACgoACgoAKCgAKCgAKCgAKCgAKCgAICCAsA/1X1/2wLr27aXJQD+QQHg8j4XpC2OI3bGYQAAAABJRU5ErkJggg=="/><div class="t m0 x19 h5 y2c ff1 fs3 fc0 sc0 ls0 ws0">0:2<span class="_ _11"> </span>Nea<span class="_ _0"></span>rly-Optimal<span class="_ _a"> </span>Mergesort</div><div class="t m5 x1a h7 y2d ff3 fs4 fc0 sc0 ls0 ws0">While<span class="_ _8"> </span>fat-pivot<span class="_ _8"> </span>quicksort<span class="_ _8"> </span>prov<span class="_ _6"></span>ably<span class="_ _5"> </span>adapts<span class="_ _8"> </span>to<span class="_ _5"> </span>the<span class="_ _8"> </span><span class="ff5">entr<span class="_ _0"></span>opy<span class="_ _d"> </span>of<span class="_ _5"> </span>the<span class="_ _5"> </span>multiplicities<span class="_ _d"> </span><span class="ff3">of<span class="_ _5"> </span>k<span class="_ _0"></span>eys<span class="_ _5"> </span>[</span></span></div><div class="t m0 x12 h7 y2d ff3 fs4 fc0 sc0 ls0 ws0">32</div><div class="t m5 x1b h7 y2d ff3 fs4 fc0 sc0 ls0 ws0">]<span class="_ _8"> </span>–</div><div class="t m9 x18 h7 y2e ff3 fs4 fc0 sc0 ls0 ws0">it<span class="_ _5"> </span>is<span class="_ _d"> </span>optimal<span class="_ _d"> </span>up<span class="_ _d"> </span>to<span class="_ _5"> </span>a<span class="_ _d"> </span>factor<span class="_ _d"> </span>of<span class="_ _5"> </span><span class="ff8">1</span></div><div class="t m0 x1c h7 y2e ff9 fs4 fc0 sc0 ls0 ws0">.</div><div class="t m9 x1d h7 y2e ff8 fs4 fc0 sc0 ls0 ws0">088<span class="_ _5"> </span><span class="ff3">on<span class="_ _d"> </span>av<span class="_ _0"></span>erage<span class="_ _d"> </span>with<span class="_ _5"> </span>pseudomedian-of-9<span class="_ _d"> </span>(“ninther”)<span class="_ _5"> </span>pivots</span></div><div class="t m0 x1e h9 y2f ff7 fs5 fc0 sc0 ls0 ws0">1</div><div class="t m9 x1f h7 y2e ff3 fs4 fc0 sc0 ls0 ws0">–</div><div class="t m1 x18 h7 y30 ff3 fs4 fc0 sc0 ls0 ws0">Timsort<span class="_ _d"> </span>is<span class="_ _d"> </span>muc<span class="_ _0"></span>h<span class="_ _a"> </span>more<span class="_ _d"> </span>heuristic<span class="_ _d"> </span>in<span class="_ _d"> </span>nature.<span class="_ _12"> </span>It<span class="_ _d"> </span>picks<span class="_ _d"> </span>up<span class="_ _d"> </span>existing<span class="_ _d"> </span>runs<span class="_ _a"> </span>and<span class="_ _d"> </span>tries<span class="_ _d"> </span>to<span class="_ _d"> </span>p<span class="_ _7"></span>erform</div><div class="t ma x18 h7 y31 ff3 fs4 fc0 sc0 ls0 ws0">merges<span class="_ _5"> </span>in<span class="_ _5"> </span>a<span class="_ _d"> </span>fa<span class="_ _4"></span>v<span class="_ _4"></span>orable<span class="_ _5"> </span>order<span class="_ _5"> </span>(</div><div class="t m0 x20 h7 y31 ff3 fs4 fc0 sc0 ls0 ws0">i.<span class="_ _10"></span>e.</div><div class="t ma x21 h7 y31 ff3 fs4 fc0 sc0 ls0 ws0">,<span class="_ _5"> </span>av<span class="_ _0"></span>oiding<span class="_ _5"> </span>merges<span class="_ _d"> </span>of<span class="_ _5"> </span>runs<span class="_ _5"> </span>with<span class="_ _d"> </span>v<span class="_ _4"></span>ery<span class="_ _5"> </span>diﬀerent<span class="_ _5"> </span>lengths),<span class="_ _5"> </span>but</div><div class="t mb x18 h7 y32 ff3 fs4 fc0 sc0 ls0 ws0">man<span class="_ _4"></span>y<span class="_ _5"> </span>desirable<span class="_ _5"> </span>guarantees<span class="_ _5"> </span>are<span class="_ _5"> </span>missing:<span class="_ _3"> </span>Although<span class="_ _d"> </span>it<span class="_ _5"> </span>was<span class="_ _5"> </span>announced<span class="_ _5"> </span>as<span class="_ _5"> </span>an</div><div class="t m0 x22 h7 y32 ff9 fs4 fc0 sc0 ls0 ws0">O</div><div class="t mb x23 h7 y32 ff8 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x24 h7 y32 ff9 fs4 fc0 sc0 ls0 ws0">n<span class="_ _13"> </span><span class="ff8">log<span class="_ _13"> </span></span>n</div><div class="t mb x25 h7 y32 ff8 fs4 fc0 sc0 ls0 ws0">)<span class="_ _5"> </span><span class="ff3">worst-</span></div><div class="t m5 x18 h7 y33 ff3 fs4 fc0 sc0 ls0 ws0">case<span class="_ _5"> </span>metho<span class="_ _7"></span>d<span class="_ _d"> </span>with<span class="_ _d"> </span>its<span class="_ _5"> </span>introduction<span class="_ _d"> </span>in<span class="_ _5"> </span>Python<span class="_ _d"> </span>in<span class="_ _d"> </span>2002<span class="_ _5"> </span>[</div><div class="t m0 x26 h7 y33 ff3 fs4 fc0 sc0 ls0 ws0">22</div><div class="t m5 x27 h7 y33 ff3 fs4 fc0 sc0 ls0 ws0">],<span class="_ _5"> </span>a<span class="_ _d"> </span>rigorous<span class="_ _d"> </span>proof<span class="_ _d"> </span>of<span class="_ _d"> </span>this<span class="_ _5"> </span>b<span class="_ _7"></span>ound<span class="_ _d"> </span>was</div><div class="t m2 x18 h7 y34 ff3 fs4 fc0 sc0 ls0 ws0">only<span class="_ _5"> </span>given<span class="_ _5"> </span>in<span class="_ _5"> </span>2015<span class="_ _d"> </span>b<span class="_ _0"></span>y<span class="_ _d"> </span>Auger,<span class="_ _5"> </span>Nicaud,<span class="_ _5"> </span>and<span class="_ _5"> </span>Pivoteau<span class="_ _5"> </span>[</div><div class="t m0 x26 h7 y34 ff3 fs4 fc0 sc0 ls0 ws0">1</div><div class="t m2 x28 h7 y34 ff3 fs4 fc0 sc0 ls0 ws0">]<span class="_ _5"> </span>and<span class="_ _d"> </span>required<span class="_ _5"> </span>a<span class="_ _5"> </span>rather<span class="_ _d"> </span>sophisticated</div><div class="t m1 x18 h7 y35 ff3 fs4 fc0 sc0 ls0 ws0">amortization<span class="_ _a"> </span>argument.</div><div class="t m0 xb h9 y36 ff7 fs5 fc0 sc0 ls0 ws0">2</div><div class="t m1 x29 h7 y35 ff3 fs4 fc0 sc0 ls0 ws0">The<span class="_ _a"> </span>core<span class="_ _a"> </span>complication<span class="_ _a"> </span>is<span class="_ _a"> </span>that<span class="_ _c"> </span>–<span class="_ _a"> </span>unlike<span class="_ _a"> </span>for<span class="_ _a"> </span>standard<span class="_ _a"> </span>mergesort</div><div class="t mc x18 h7 y37 ff3 fs4 fc0 sc0 ls0 ws0">v<span class="_ _6"></span>ariants<span class="_ _5"> </span>–<span class="_ _d"> </span>a<span class="_ _5"> </span>given<span class="_ _5"> </span>elemen<span class="_ _0"></span>t<span class="_ _d"> </span>might<span class="_ _5"> </span>participate<span class="_ _5"> </span>in<span class="_ _d"> </span>more<span class="_ _5"> </span>than<span class="_ _d"> </span>a<span class="_ _5"> </span>logarithmic<span class="_ _d"> </span>n<span class="_ _0"></span>umber<span class="_ _d"> </span>of<span class="_ _5"> </span>merges.</div><div class="t m1 x18 h7 y38 ff3 fs4 fc0 sc0 ls0 ws0">Indeed,<span class="_ _a"> </span>Buss<span class="_ _d"> </span>and<span class="_ _a"> </span>Knop<span class="_ _d"> </span>[</div><div class="t m0 x2a h7 y38 ff3 fs4 fc0 sc0 ls0 ws0">7</div><div class="t m1 x29 h7 y38 ff3 fs4 fc0 sc0 ls0 ws0">]<span class="_ _a"> </span>ha<span class="_ _0"></span>ve<span class="_ _d"> </span>very<span class="_ _d"> </span>recently<span class="_ _d"> </span>shown<span class="_ _d"> </span>that<span class="_ _a"> </span>for<span class="_ _d"> </span>some<span class="_ _a"> </span>family<span class="_ _d"> </span>of<span class="_ _a"> </span>inputs,<span class="_ _a"> </span>the</div><div class="t md x18 h7 y39 ff3 fs4 fc0 sc0 ls0 ws0">a<span class="_ _4"></span>v<span class="_ _0"></span>erage<span class="_ _d"> </span>num<span class="_ _0"></span>b<span class="_ _7"></span>er<span class="_ _d"> </span>of<span class="_ _5"> </span>merges<span class="_ _d"> </span>a<span class="_ _5"> </span>single<span class="_ _d"> </span>element<span class="_ _5"> </span>participates<span class="_ _5"> </span>in<span class="_ _d"> </span>is<span class="_ _5"> </span>at<span class="_ _d"> </span>least</div><div class="t m0 x2b hb y3a ffa fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x2c h9 y3b ffb fs5 fc0 sc0 ls0 ws0">3</div><div class="t m0 x2c h9 y3c ffb fs5 fc0 sc0 ls0 ws0">2</div><div class="t m0 x2d h7 y39 ff4 fs4 fc0 sc0 ls0 ws0">−<span class="_ _9"> </span><span class="ff9">o</span></div><div class="t md x2e h7 y39 ff8 fs4 fc0 sc0 ls0 ws0">(1)</div><div class="t m0 x2f hb y3a ffa fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x30 h7 y39 ff4 fs4 fc0 sc0 ls0 ws0">·<span class="_ _9"> </span><span class="ff8">lg<span class="_ _13"> </span><span class="ff9">n</span></span></div><div class="t md x31 h7 y39 ff3 fs4 fc0 sc0 ls0 ws0">.<span class="_ _3"> </span>So<span class="_ _5"> </span>in</div><div class="t me x18 h7 y3d ff3 fs4 fc0 sc0 ls0 ws0">the<span class="_ _5"> </span>worst<span class="_ _5"> </span>case,<span class="_ _5"> </span>Timsort<span class="_ _d"> </span>do<span class="_ _7"></span>es,</div><div class="t m0 x32 h7 y3d ff3 fs4 fc0 sc0 ls0 ws0">e.<span class="_ _10"></span>g.</div><div class="t me x33 h7 y3d ff3 fs4 fc0 sc0 ls0 ws0">,<span class="_ _5"> </span>(at<span class="_ _d"> </span>least)<span class="_ _5"> </span><span class="ff5">1.5<span class="_ _a"> </span>times<span class="_ _5"> </span>as<span class="_ _a"> </span>many<span class="_ _d"> </span>element<span class="_ _d"> </span>moves<span class="_ _d"> </span>as<span class="_ _a"> </span>standar<span class="_ _6"></span>d</span></div><div class="t m0 x18 h7 y3e ff5 fs4 fc0 sc0 ls0 ws0">mer<span class="_ _0"></span>gesort.</div><div class="t m0 x1a h7 y3f ff3 fs4 fc0 sc0 ls0 ws0">In<span class="_ _5"> </span>terms<span class="_ _d"> </span>of<span class="_ _5"> </span>adapting<span class="_ _d"> </span>to<span class="_ _5"> </span>existing<span class="_ _d"> </span>order,<span class="_ _5"> </span>the<span class="_ _5"> </span>only<span class="_ _d"> </span>prov<span class="_ _0"></span>en<span class="_ _5"> </span>guarantee<span class="_ _5"> </span>for<span class="_ _5"> </span>Timsort’s<span class="_ _d"> </span>running</div><div class="t m5 x18 h7 y40 ff3 fs4 fc0 sc0 ls0 ws0">time<span class="_ _8"> </span>is<span class="_ _8"> </span>a<span class="_ _8"> </span>trivial</div><div class="t m0 x34 h7 y40 ff9 fs4 fc0 sc0 ls0 ws0">O</div><div class="t m5 x35 h7 y40 ff8 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x36 h7 y40 ff9 fs4 fc0 sc0 ls0 ws0">nr</div><div class="t m5 x37 h7 y40 ff8 fs4 fc0 sc0 ls0 ws0">) <span class="ff3">b<span class="_ _7"></span>ound<span class="_ _8"> </span>when<span class="_ _8"> </span>the<span class="_ _8"> </span>input<span class="_ _5"> </span>consists<span class="_ _8"> </span>of</span></div><div class="t m0 x38 h7 y40 ff9 fs4 fc0 sc0 ls0 ws0">r</div><div class="t m5 x39 h7 y40 ff3 fs4 fc0 sc0 ls0 ws0">runs.<span class="_ _c"> </span>Proving<span class="_ _8"> </span>an<span class="_ _8"> </span>informativ<span class="_ _0"></span>e<span class="_ _5"> </span>upper</div><div class="t m5 x18 h7 y41 ff3 fs4 fc0 sc0 ls0 ws0">b<span class="_ _7"></span>ound<span class="_ _9"> </span>lik<span class="_ _4"></span>e</div><div class="t m0 x3a h7 y41 ff9 fs4 fc0 sc0 ls0 ws0">O</div><div class="t m5 x15 h7 y41 ff8 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x3b h7 y41 ff9 fs4 fc0 sc0 ls0 ws0">n</div><div class="t m5 x3c h7 y41 ff8 fs4 fc0 sc0 ls0 ws0">+</div><div class="t m0 x3d h7 y41 ff9 fs4 fc0 sc0 ls0 ws0">n<span class="_ _13"> </span><span class="ff8">log<span class="_ _13"> </span></span>r</div><div class="t m5 x3e h7 y41 ff8 fs4 fc0 sc0 ls0 ws0">)<span class="_ _9"> </span><span class="ff3">has<span class="_ _9"> </span>remained<span class="_ _9"> </span>elusiv<span class="_ _4"></span>e,<span class="_ _9"> </span>(although<span class="_ _9"> </span>it<span class="_ _9"> </span>is<span class="_ _9"> </span>conjectured<span class="_ _9"> </span>to<span class="_ _8"> </span>hold<span class="_ _9"> </span>in<span class="_ _9"> </span>[</span></div><div class="t m0 x3f h7 y41 ff3 fs4 fc0 sc0 ls0 ws0">1</div><div class="t m5 x40 h7 y41 ff3 fs4 fc0 sc0 ls0 ws0">]<span class="_ _9"> </span>and<span class="_ _9"> </span>[</div><div class="t m0 x41 h7 y41 ff3 fs4 fc0 sc0 ls0 ws0">7</div><div class="t m5 x42 h7 y41 ff3 fs4 fc0 sc0 ls0 ws0">]).</div><div class="t m5 x18 h7 y42 ff3 fs4 fc0 sc0 ls0 ws0">This<span class="_ _9"> </span>is<span class="_ _9"> </span>in<span class="_ _9"> </span>sharp<span class="_ _9"> </span>contrast<span class="_ _9"> </span>to<span class="_ _9"> </span>av<span class="_ _6"></span>ailable<span class="_ _9"> </span>alternatives:<span class="_ _a"> </span>T<span class="_ _6"></span>akaoka<span class="_ _9"> </span>[</div><div class="t m0 x43 h7 y42 ff3 fs4 fc0 sc0 ls0 ws0">27</div><div class="t m5 x44 h7 y42 ff3 fs4 fc0 sc0 ls0 ws0">,</div><div class="t m0 x45 h7 y42 ff3 fs4 fc0 sc0 ls0 ws0">28</div><div class="t m5 x9 h7 y42 ff3 fs4 fc0 sc0 ls0 ws0">]<span class="_ _9"> </span>and<span class="_ _9"> </span>Barbay<span class="_ _9"> </span>and<span class="_ _9"> </span>Na<span class="_ _0"></span>v<span class="_ _0"></span>arro<span class="_ _9"> </span>[</div><div class="t m0 x42 h7 y42 ff3 fs4 fc0 sc0 ls0 ws0">3</div><div class="t m5 x46 h7 y42 ff3 fs4 fc0 sc0 ls0 ws0">]</div><div class="t m1 x18 h7 y43 ff3 fs4 fc0 sc0 ls0 ws0">indep<span class="_ _7"></span>enden<span class="_ _4"></span>tly<span class="_ _d"> </span>disco<span class="_ _4"></span>v<span class="_ _4"></span>ered<span class="_ _d"> </span>a<span class="_ _d"> </span>sorting<span class="_ _d"> </span>metho<span class="_ _7"></span>d<span class="_ _d"> </span>that<span class="_ _d"> </span>adapts<span class="_ _d"> </span>to<span class="_ _d"> </span>the<span class="_ _d"> </span><span class="ff5">entr<span class="_ _0"></span>opy<span class="_ _a"> </span>of<span class="_ _d"> </span>the<span class="_ _a"> </span>distribution</span></div><div class="t me x18 h7 y44 ff5 fs4 fc0 sc0 ls0 ws0">of<span class="_ _d"> </span>run<span class="_ _d"> </span>lengths: <span class="ff3">they<span class="_ _5"> </span>sort<span class="_ _5"> </span>an<span class="_ _5"> </span>input<span class="_ _d"> </span>consisting<span class="_ _5"> </span>of</span></div><div class="t m0 x47 h7 y44 ff9 fs4 fc0 sc0 ls0 ws0">r</div><div class="t me x48 h7 y44 ff3 fs4 fc0 sc0 ls0 ws0">runs<span class="_ _5"> </span>with<span class="_ _d"> </span>resp<span class="_ _7"></span>ectiv<span class="_ _4"></span>e<span class="_ _5"> </span>lengths</div><div class="t m0 x2f h7 y44 ff9 fs4 fc0 sc0 ls0 ws0">L</div><div class="t m0 x30 h9 y45 ffb fs5 fc0 sc0 ls0 ws0">1</div><div class="t m0 x49 h7 y44 ff9 fs4 fc0 sc0 ls0 ws0">,<span class="_ _13"> </span>.<span class="_ _13"> </span>.<span class="_ _13"> </span>.<span class="_ _13"> </span>,<span class="_ _13"> </span>L</div><div class="t m0 x4a hc y45 ffc fs5 fc0 sc0 ls0 ws0">r</div><div class="t me x4b h7 y44 ff3 fs4 fc0 sc0 ls0 ws0">in</div><div class="t m5 x18 h7 y46 ff3 fs4 fc0 sc0 ls0 ws0">time</div><div class="t m0 x4c h7 y46 ff9 fs4 fc0 sc0 ls0 ws0">O</div><div class="t m0 x4d hb y47 ffa fs4 fc0 sc0 ls0 ws0"></div><div class="t m5 x4e h7 y46 ff8 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x4f h7 y46 ff4 fs4 fc0 sc0 ls0 ws0">H</div><div class="t m5 x50 h7 y46 ff8 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x51 hc y48 ffc fs5 fc0 sc0 ls0 ws0">L</div><div class="t m0 x52 hd y49 ffd fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x15 hc y4a ffc fs5 fc0 sc0 ls0 ws0">n</div><div class="t m0 x53 h7 y46 ff9 fs4 fc0 sc0 ls0 ws0">,<span class="_ _13"> </span>.<span class="_ _13"> </span>.<span class="_ _13"> </span>.<span class="_ _13"> </span>,</div><div class="t m0 x54 hc y48 ffc fs5 fc0 sc0 ls0 ws0">L</div><div class="t m0 x55 he y49 ffe fs6 fc0 sc0 ls0 ws0">r</div><div class="t m0 x56 hc y4a ffc fs5 fc0 sc0 ls0 ws0">n</div><div class="t m5 x57 h7 y46 ff8 fs4 fc0 sc0 ls0 ws0">)<span class="_ _13"> </span>+<span class="_ _13"> </span>1)</div><div class="t m0 x58 h7 y46 ff9 fs4 fc0 sc0 ls0 ws0">n</div><div class="t m0 x59 hb y47 ffa fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x5a h7 y46 ff4 fs4 fc0 sc0 ls0 ws0">⊆<span class="_ _8"> </span><span class="ff9">O</span></div><div class="t m5 x5b h7 y46 ff8 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x5c h7 y46 ff9 fs4 fc0 sc0 ls0 ws0">n</div><div class="t m5 x5d h7 y46 ff8 fs4 fc0 sc0 ls0 ws0">+</div><div class="t m0 x5e h7 y46 ff9 fs4 fc0 sc0 ls0 ws0">n<span class="_ _13"> </span><span class="ff8">lg<span class="_ _13"> </span></span>r</div><div class="t m5 x5f h7 y46 ff8 fs4 fc0 sc0 ls0 ws0">)<span class="ff3">,<span class="_ _5"> </span>where</span></div><div class="t m0 x26 h7 y46 ff4 fs4 fc0 sc0 ls0 ws0">H</div><div class="t m5 x60 h7 y46 ff8 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x61 h7 y46 ff9 fs4 fc0 sc0 ls0 ws0">p</div><div class="t m0 x62 h9 y4b ffb fs5 fc0 sc0 ls0 ws0">1</div><div class="t m0 x63 h7 y46 ff9 fs4 fc0 sc0 ls0 ws0">,<span class="_ _13"> </span>.<span class="_ _13"> </span>.<span class="_ _13"> </span>.<span class="_ _13"> </span>,<span class="_ _13"> </span>p</div><div class="t m0 xa hc y4b ffc fs5 fc0 sc0 ls0 ws0">r</div><div class="t m5 x64 h7 y46 ff8 fs4 fc0 sc0 ls0 ws0">) =</div><div class="t m0 x4 hb y4c ffa fs4 fc0 sc0 ls0 ws0">P</div><div class="t m0 x65 hc y4d ffc fs5 fc0 sc0 ls0 ws0">r</div><div class="t m0 x65 h9 y4e ffc fs5 fc0 sc0 ls0 ws0">i<span class="ffb">=1</span></div><div class="t m0 x2e h7 y46 ff9 fs4 fc0 sc0 ls0 ws0">p</div><div class="t m0 x23 hc y4b ffc fs5 fc0 sc0 ls0 ws0">i</div><div class="t m0 x66 h7 y46 ff8 fs4 fc0 sc0 ls0 ws0">lg</div><div class="t m5 x67 h7 y46 ff8 fs4 fc0 sc0 ls0 ws0">(1</div><div class="t m0 x3f h7 y46 ff9 fs4 fc0 sc0 ls0 ws0">/p</div><div class="t m0 x68 hc y4b ffc fs5 fc0 sc0 ls0 ws0">i</div><div class="t m5 x69 h7 y46 ff8 fs4 fc0 sc0 ls0 ws0">)<span class="_ _5"> </span><span class="ff3">is<span class="_ _8"> </span>the</span></div><div class="t m5 x18 h7 y4f ff3 fs4 fc0 sc0 ls0 ws0">binary<span class="_ _8"> </span>Shannon<span class="_ _5"> </span>en<span class="_ _0"></span>tropy<span class="_ _6"></span>.<span class="_ _c"> </span>Since</div><div class="t m0 x1c h7 y4f ff4 fs4 fc0 sc0 ls0 ws0">H</div><div class="t m5 x6a h7 y4f ff8 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x33 hc y50 ffc fs5 fc0 sc0 ls0 ws0">L</div><div class="t m0 x6b hd y51 ffd fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x6c hc y52 ffc fs5 fc0 sc0 ls0 ws0">n</div><div class="t m0 x6d h7 y4f ff9 fs4 fc0 sc0 ls0 ws0">,<span class="_ _13"> </span>.<span class="_ _13"> </span>.<span class="_ _13"> </span>.<span class="_ _13"> </span>,</div><div class="t m0 x6e hc y50 ffc fs5 fc0 sc0 ls0 ws0">L</div><div class="t m0 x6f he y51 ffe fs6 fc0 sc0 ls0 ws0">r</div><div class="t m0 x70 hc y52 ffc fs5 fc0 sc0 ls0 ws0">n</div><div class="t m5 x71 h7 y4f ff8 fs4 fc0 sc0 ls0 ws0">)</div><div class="t m0 x72 h7 y4f ff9 fs4 fc0 sc0 ls0 ws0">n<span class="_ _14"> </span><span class="ff4">−<span class="_ _14"></span></span>O</div><div class="t m5 x73 h7 y4f ff8 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x74 h7 y4f ff9 fs4 fc0 sc0 ls0 ws0">n</div><div class="t m5 x75 h7 y4f ff8 fs4 fc0 sc0 ls0 ws0">) <span class="ff3">comparisons<span class="_ _5"> </span>are<span class="_ _8"> </span>necessary<span class="_ _5"> </span>for<span class="_ _8"> </span>distinct</span></div><div class="t mf x18 h7 y53 ff3 fs4 fc0 sc0 ls0 ws0">k<span class="_ _4"></span>eys,<span class="_ _5"> </span>this<span class="_ _d"> </span>is<span class="_ _5"> </span>optimal<span class="_ _d"> </span>up<span class="_ _5"> </span>to<span class="_ _d"> </span>linear<span class="_ _d"> </span>terms.<span class="_ _c"> </span>Their<span class="_ _d"> </span>algorithms<span class="_ _5"> </span>are<span class="_ _d"> </span>also<span class="_ _d"> </span>conceptually<span class="_ _5"> </span>simple:<span class="_ _3"> </span>ﬁnd</div><div class="t m10 x18 h7 y54 ff3 fs4 fc0 sc0 ls0 ws0">runs<span class="_ _5"> </span>in<span class="_ _d"> </span>a<span class="_ _5"> </span>linear<span class="_ _d"> </span>scan,<span class="_ _5"> </span>determine<span class="_ _5"> </span>an<span class="_ _d"> </span>optimal<span class="_ _5"> </span>merging<span class="_ _d"> </span>order<span class="_ _5"> </span>using<span class="_ _d"> </span>a<span class="_ _5"> </span>Huﬀman<span class="_ _d"> </span>tree<span class="_ _5"> </span>of<span class="_ _d"> </span>the<span class="_ _5"> </span>run</div><div class="t md x18 h7 y55 ff3 fs4 fc0 sc0 ls0 ws0">lengths,<span class="_ _5"> </span>and<span class="_ _d"> </span>execute<span class="_ _5"> </span>those<span class="_ _d"> </span>merges<span class="_ _5"> </span>b<span class="_ _2"></span>ottom-up<span class="_ _5"> </span>in<span class="_ _d"> </span>the<span class="_ _5"> </span>tree.<span class="_ _3"> </span>W<span class="_ _6"></span>e<span class="_ _d"> </span>will<span class="_ _5"> </span>refer<span class="_ _d"> </span>to<span class="_ _5"> </span>this<span class="_ _d"> </span>algorithm<span class="_ _5"> </span>to</div><div class="t m0 x18 h7 y56 ff3 fs4 fc0 sc0 ls0 ws0">determine<span class="_ _5"> </span>an<span class="_ _d"> </span>optimal<span class="_ _5"> </span>merging<span class="_ _d"> </span>order<span class="_ _5"> </span>as<span class="_ _d"> </span><span class="ff5">Huﬀman-Mer<span class="_ _0"></span>ge<span class="ff3">.</span></span></div><div class="t m4 x1a h7 y57 ff3 fs4 fc0 sc0 ls0 ws0">Straigh<span class="_ _4"></span>t-forw<span class="_ _4"></span>ard<span class="_ _5"> </span>implementations<span class="_ _5"> </span>of<span class="_ _5"> </span>Huﬀman-Merge<span class="_ _5"> </span>add<span class="_ _d"> </span>signiﬁcan<span class="_ _4"></span>t<span class="_ _5"> </span>ov<span class="_ _0"></span>erhead<span class="_ _5"> </span>in<span class="_ _d"> </span>terms</div><div class="t m11 x18 h7 y58 ff3 fs4 fc0 sc0 ls0 ws0">of<span class="_ _5"> </span>time<span class="_ _d"> </span>and<span class="_ _5"> </span>space;<span class="_ _5"> </span>(ﬁnding<span class="_ _d"> </span>the<span class="_ _5"> </span>Huﬀman<span class="_ _d"> </span>tree<span class="_ _5"> </span>requires<span class="_ _5"> </span>storing<span class="_ _d"> </span>and<span class="_ _5"> </span>sorting<span class="_ _5"> </span>the<span class="_ _d"> </span>run<span class="_ _5"> </span>lengths).</div><div class="t m12 x18 h7 y59 ff3 fs4 fc0 sc0 ls0 ws0">This<span class="_ _5"> </span>renders<span class="_ _5"> </span>these<span class="_ _d"> </span>methods<span class="_ _d"> </span>uncomp<span class="_ _7"></span>etitive<span class="_ _5"> </span>to<span class="_ _5"> </span>(reasonable<span class="_ _5"> </span>implementations<span class="_ _5"> </span>of)<span class="_ _d"> </span>elemen<span class="_ _0"></span>tary</div><div class="t m1 x18 h7 y5a ff3 fs4 fc0 sc0 ls0 ws0">sorting<span class="_ _d"> </span>metho<span class="_ _7"></span>ds.<span class="_ _12"> </span>Moreo<span class="_ _0"></span>ver,<span class="_ _d"> </span>Huﬀman-Merge<span class="_ _a"> </span>leads<span class="_ _d"> </span>to<span class="_ _d"> </span>an<span class="_ _a"> </span><span class="ff5">unstable<span class="_ _a"> </span></span>sorting<span class="_ _d"> </span>method<span class="_ _a"> </span>since<span class="_ _d"> </span>it</div><div class="t mb x18 h7 y5b ff3 fs4 fc0 sc0 ls0 ws0">merges<span class="_ _5"> </span>non-adjacent<span class="_ _5"> </span>runs.<span class="_ _c"> </span>The<span class="_ _d"> </span>main<span class="_ _5"> </span>motiv<span class="_ _0"></span>ation<span class="_ _d"> </span>for<span class="_ _5"> </span>the<span class="_ _d"> </span>in<span class="_ _0"></span>ven<span class="_ _0"></span>tion<span class="_ _d"> </span>of<span class="_ _5"> </span>Timsort<span class="_ _d"> </span>w<span class="_ _4"></span>as<span class="_ _5"> </span>to<span class="_ _d"> </span>ﬁnd<span class="_ _5"> </span>a</div><div class="t m5 x18 h7 y5c ff3 fs4 fc0 sc0 ls0 ws0">fast<span class="_ _5"> </span>general-purp<span class="_ _7"></span>ose<span class="_ _5"> </span>sorting<span class="_ _5"> </span>metho<span class="_ _7"></span>d<span class="_ _5"> </span>that<span class="_ _5"> </span>is<span class="_ _5"> </span><span class="ff5">stable<span class="_ _d"> </span></span>[</div><div class="t m0 xe h7 y5c ff3 fs4 fc0 sc0 ls0 ws0">22</div><div class="t m5 x76 h7 y5c ff3 fs4 fc0 sc0 ls0 ws0">],<span class="_ _5"> </span>and<span class="_ _5"> </span>the<span class="_ _5"> </span>Jav<span class="_ _6"></span>a<span class="_ _5"> </span>library<span class="_ _5"> </span>ev<span class="_ _0"></span>en<span class="_ _5"> </span>dictates<span class="_ _5"> </span>the</div><div class="t m5 x18 h7 y5d ff3 fs4 fc0 sc0 ls0 ws0">sorting<span class="_ _8"> </span>metho<span class="_ _7"></span>d<span class="_ _8"> </span>used<span class="_ _8"> </span>for<span class="_ _8"> </span>ob<span class="_ _7"></span>jects<span class="_ _8"> </span>to<span class="_ _8"> </span>b<span class="_ _7"></span>e<span class="_ _8"> </span>stable.<span class="_ _3"> </span>W<span class="_ _6"></span>e<span class="_ _8"> </span>remark<span class="_ _8"> </span>that<span class="_ _8"> </span>while<span class="_ _8"> </span>stability<span class="_ _8"> </span>is<span class="_ _8"> </span>a<span class="_ _8"> </span>m<span class="_ _0"></span>uch<span class="_ _8"> </span>desired</div><div class="t m1 x18 h7 y5e ff3 fs4 fc0 sc0 ls0 ws0">feature,<span class="_ _a"> </span>practical,<span class="_ _a"> </span>stable<span class="_ _d"> </span>sorting<span class="_ _a"> </span>metho<span class="_ _7"></span>ds<span class="_ _a"> </span>do<span class="_ _d"> </span>not<span class="_ _a"> </span>try<span class="_ _a"> </span>to<span class="_ _d"> </span><span class="ff5">exploit<span class="_ _3"> </span></span>the<span class="_ _a"> </span>presence<span class="_ _a"> </span>of<span class="_ _d"> </span>duplicate</div><div class="t m13 x18 h7 y5f ff3 fs4 fc0 sc0 ls0 ws0">elemen<span class="_ _4"></span>ts<span class="_ _5"> </span>to<span class="_ _d"> </span>sp<span class="_ _7"></span>eed<span class="_ _5"> </span>up<span class="_ _d"> </span>sorting,<span class="_ _5"> </span>and<span class="_ _d"> </span>we<span class="_ _5"> </span>will<span class="_ _5"> </span>fo<span class="_ _7"></span>cus<span class="_ _d"> </span>on<span class="_ _5"> </span>the<span class="_ _d"> </span>p<span class="_ _7"></span>erformance<span class="_ _d"> </span>for<span class="_ _5"> </span>distinct<span class="_ _d"> </span>k<span class="_ _4"></span>eys<span class="_ _5"> </span>in<span class="_ _d"> </span>this</div><div class="t m0 x18 h7 y60 ff3 fs4 fc0 sc0 ls0 ws0">article.</div><div class="t m1 x1a h7 y61 ff3 fs4 fc0 sc0 ls0 ws0">It<span class="_ _d"> </span>is<span class="_ _a"> </span>conceptually<span class="_ _d"> </span>simple<span class="_ _d"> </span>to<span class="_ _a"> </span>modify<span class="_ _a"> </span>the<span class="_ _d"> </span>idea<span class="_ _d"> </span>of<span class="_ _a"> </span>T<span class="_ _6"></span>akaoka<span class="_ _d"> </span>resp.<span class="_ _d"> </span>Barbay-Na<span class="_ _0"></span>v<span class="_ _0"></span>arro<span class="_ _a"> </span>to<span class="_ _d"> </span>sort</div><div class="t mf x18 h7 y62 ff3 fs4 fc0 sc0 ls0 ws0">stably:<span class="_ _3"> </span>replace<span class="_ _5"> </span>the<span class="_ _d"> </span>Huﬀman<span class="_ _5"> </span>tree<span class="_ _d"> </span>by<span class="_ _5"> </span>an<span class="_ _5"> </span><span class="ff5">optimal<span class="_ _a"> </span>binary<span class="_ _d"> </span>se<span class="_ _6"></span>ar<span class="_ _4"></span>ch<span class="_ _d"> </span>tr<span class="_ _0"></span>e<span class="_ _0"></span>e<span class="_ _a"> </span><span class="ff3">and<span class="_ _5"> </span>otherwise<span class="_ _d"> </span>pro<span class="_ _7"></span>ceed<span class="_ _5"> </span>as</span></span></div><div class="t m14 x18 h7 y63 ff3 fs4 fc0 sc0 ls0 ws0">b<span class="_ _7"></span>efore<span class="_ _5"> </span>(using<span class="_ _d"> </span>a<span class="_ _5"> </span>stable<span class="_ _5"> </span>merging<span class="_ _d"> </span>pro<span class="_ _7"></span>cedure).<span class="_ _3"> </span>Since<span class="_ _5"> </span>we<span class="_ _5"> </span>only<span class="_ _5"> </span>hav<span class="_ _0"></span>e<span class="_ _5"> </span>weigh<span class="_ _0"></span>ts<span class="_ _d"> </span>at<span class="_ _5"> </span>the<span class="_ _d"> </span>lea<span class="_ _0"></span>ves<span class="_ _5"> </span>of<span class="_ _5"> </span>the</div><div class="t m15 x18 h7 y64 ff3 fs4 fc0 sc0 ls0 ws0">tree,<span class="_ _5"> </span>we<span class="_ _5"> </span>can<span class="_ _d"> </span>compute<span class="_ _5"> </span>this<span class="_ _d"> </span>tree<span class="_ _d"> </span>in</div><div class="t m0 x77 h7 y64 ff9 fs4 fc0 sc0 ls0 ws0">O</div><div class="t m15 x6b h7 y64 ff8 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x78 h7 y64 ff9 fs4 fc0 sc0 ls0 ws0">n</div><div class="t m15 x79 h7 y64 ff8 fs4 fc0 sc0 ls0 ws0">+</div><div class="t m0 x7a h7 y64 ff9 fs4 fc0 sc0 ls0 ws0">r<span class="_ _15"> </span><span class="ff8">log<span class="_ _13"> </span></span>r</div><div class="t m15 x7b h7 y64 ff8 fs4 fc0 sc0 ls0 ws0">)<span class="_ _5"> </span><span class="ff3">time<span class="_ _d"> </span>using<span class="_ _d"> </span>the<span class="_ _5"> </span>Hu-T<span class="_ _6"></span>uck<span class="_ _0"></span>er-<span class="_ _d"> </span>or<span class="_ _5"> </span>Garsia-W<span class="_ _6"></span>achs-</span></div><div class="t m16 x18 h7 y65 ff3 fs4 fc0 sc0 ls0 ws0">algorithm,<span class="_ _5"> </span>but</div><div class="t m0 x7c h7 y65 ff9 fs4 fc0 sc0 ls0 ws0">r</div><div class="t m16 x7d h7 y65 ff3 fs4 fc0 sc0 ls0 ws0">can<span class="_ _5"> </span>b<span class="_ _7"></span>e<span class="_ _d"> </span><span class="ff8">Θ(</span></div><div class="t m0 x29 h7 y65 ff9 fs4 fc0 sc0 ls0 ws0">n</div><div class="t m16 x7e h7 y65 ff8 fs4 fc0 sc0 ls0 ws0">)<span class="_ _5"> </span><span class="ff3">and<span class="_ _d"> </span>the<span class="_ _5"> </span>algorithms<span class="_ _d"> </span>are<span class="_ _d"> </span>fairly<span class="_ _5"> </span>sophisticated,<span class="_ _d"> </span>so<span class="_ _5"> </span>this<span class="_ _d"> </span>idea<span class="_ _5"> </span>seems</span></div><div class="t m0 x18 h7 y66 ff3 fs4 fc0 sc0 ls0 ws0">not<span class="_ _5"> </span>very<span class="_ _5"> </span>app<span class="_ _7"></span>ealing<span class="_ _5"> </span>for<span class="_ _d"> </span>practical<span class="_ _5"> </span>use.</div><div class="t m0 x18 hf y67 fff fs7 fc0 sc0 ls0 ws0">1</div><div class="t m3 x7f h10 y68 ff10 fs8 fc0 sc0 ls0 ws0">The<span class="_ _8"> </span>median<span class="_ _5"> </span>of<span class="_ _8"> </span>three<span class="_ _8"> </span>elements<span class="_ _8"> </span>is<span class="_ _5"> </span>c<span class="_ _0"></span>hosen<span class="_ _5"> </span>as<span class="_ _8"> </span>the<span class="_ _5"> </span>piv<span class="_ _0"></span>ot,<span class="_ _5"> </span>eac<span class="_ _4"></span>h<span class="_ _8"> </span>of<span class="_ _5"> </span>whic<span class="_ _0"></span>h<span class="_ _5"> </span>is<span class="_ _8"> </span>a<span class="_ _5"> </span>median<span class="_ _8"> </span>of<span class="_ _8"> </span>three<span class="_ _5"> </span>other<span class="_ _8"> </span>elements.</div><div class="t m1 x7f h10 y69 ff10 fs8 fc0 sc0 ls0 ws0">This<span class="_ _5"> </span>is<span class="_ _5"> </span>a<span class="_ _5"> </span>go<span class="_ _7"></span>o<span class="_ _7"></span>d<span class="_ _5"> </span>approximation<span class="_ _5"> </span>of<span class="_ _5"> </span>the<span class="_ _5"> </span>median<span class="_ _5"> </span>of<span class="_ _5"> </span>9<span class="_ _d"> </span>elements<span class="_ _8"> </span>and<span class="_ _d"> </span>often<span class="_ _5"> </span>used<span class="_ _5"> </span>as<span class="_ _5"> </span>pivot<span class="_ _5"> </span>selection<span class="_ _5"> </span>rule<span class="_ _5"> </span>in</div><div class="t m0 x7f h10 y6a ff10 fs8 fc0 sc0 ls0 ws0">library<span class="_ _8"> </span>implementations.</div><div class="t m0 x18 hf y6b fff fs7 fc0 sc0 ls0 ws0">2</div><div class="t mf x7f h10 y6c ff10 fs8 fc0 sc0 ls0 ws0">A<span class="_ _8"> </span>further<span class="_ _5"> </span>manifestation<span class="_ _8"> </span>of<span class="_ _8"> </span>the<span class="_ _5"> </span>complexit<span class="_ _4"></span>y<span class="_ _8"> </span>of<span class="_ _5"> </span>Timsort<span class="_ _8"> </span>was<span class="_ _8"> </span>reported<span class="_ _5"> </span>b<span class="_ _0"></span>y<span class="_ _5"> </span>de<span class="_ _8"> </span>Gouw<span class="_ _8"> </span>et<span class="_ _8"> </span>al.<span class="_ _5"> </span>[</div><div class="t m0 x66 h10 y6c ff10 fs8 fc0 sc0 ls0 ws0">8</div><div class="t mf x80 h10 y6c ff10 fs8 fc0 sc0 ls0 ws0">]:<span class="_ _a"> </span>The<span class="_ _8"> </span>original</div><div class="t m1 x7f h10 y6d ff10 fs8 fc0 sc0 ls0 ws0">rules<span class="_ _5"> </span>to<span class="_ _8"> </span>maintain<span class="_ _8"> </span>the<span class="_ _5"> </span>desired<span class="_ _5"> </span>in<span class="_ _0"></span>v<span class="_ _4"></span>ariant<span class="_ _8"> </span>for<span class="_ _5"> </span>run<span class="_ _8"> </span>lengths<span class="_ _5"> </span>on<span class="_ _5"> </span>the<span class="_ _8"> </span>stack<span class="_ _8"> </span>was<span class="_ _8"> </span>not<span class="_ _5"> </span>suﬃcient<span class="_ _8"> </span>in<span class="_ _5"> </span>some<span class="_ _8"> </span>cases.</div><div class="t m0 x7f h10 y6e ff10 fs8 fc0 sc0 ls0 ws0">This<span class="_ _8"> </span>(algorithmic!)<span class="_ _a"> </span>bug<span class="_ _8"> </span>had<span class="_ _5"> </span>remained<span class="_ _8"> </span>unnoticed<span class="_ _5"> </span>un<span class="_ _0"></span>til<span class="_ _5"> </span>their<span class="_ _8"> </span>attempt<span class="_ _8"> </span>to<span class="_ _5"> </span>formally<span class="_ _8"> </span>verify<span class="_ _8"> </span>the<span class="_ _8"> </span>correctness</div><div class="t m0 x7f h10 y2a ff10 fs8 fc0 sc0 ls0 ws0">of<span class="_ _8"> </span>the<span class="_ _5"> </span>Ja<span class="_ _0"></span>v<span class="_ _0"></span>a<span class="_ _5"> </span>implemen<span class="_ _0"></span>tation<span class="_ _5"> </span>of<span class="_ _8"> </span>Timsort<span class="_ _8"> </span>failed<span class="_ _5"> </span>because<span class="_ _5"> </span>of<span class="_ _8"> </span>it.</div><a class="l" href="#pf14" data-dest-detail='[20,"XYZ",107.717,583.056,null]'><div class="d m8" style="border-style:none;position:absolute;left:814.027443px;bottom:1230.160463px;width:11.955000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf2" data-dest-detail='[2,"XYZ",116.058,180.93,null]'><div class="d m8" style="border-style:none;position:absolute;left:827.149087px;bottom:1204.219555px;width:6.462000px;height:12.490000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",90.709,229.025,null]'><div class="d m8" style="border-style:none;position:absolute;left:567.405708px;bottom:1121.375631px;width:11.955000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",107.717,222.195,null]'><div class="d m8" style="border-style:none;position:absolute;left:567.659371px;bottom:1099.619336px;width:6.974000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf2" data-dest-detail='[2,"XYZ",116.239,151.811,null]'><div class="d m8" style="border-style:none;position:absolute;left:356.448101px;bottom:1074.607409px;width:6.462000px;height:11.937000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",90.709,653.744,null]'><div class="d m8" style="border-style:none;position:absolute;left:367.688266px;bottom:1034.347093px;width:6.974000px;height:8.267000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",107.717,222.195,null]'><div class="d m8" style="border-style:none;position:absolute;left:773.639455px;bottom:901.654023px;width:6.974000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",90.709,653.744,null]'><div class="d m8" style="border-style:none;position:absolute;left:825.333123px;bottom:901.654023px;width:6.974000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf14" data-dest-detail='[20,"XYZ",107.717,743.244,null]'><div class="d m8" style="border-style:none;position:absolute;left:600.385367px;bottom:879.896048px;width:11.955000px;height:8.267000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf14" data-dest-detail='[20,"XYZ",107.717,706.535,null]'><div class="d m8" style="border-style:none;position:absolute;left:625.659358px;bottom:879.896048px;width:11.955000px;height:8.267000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",107.717,149.419,null]'><div class="d m8" style="border-style:none;position:absolute;left:833.020313px;bottom:879.896048px;width:6.974000px;height:8.267000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",90.709,229.025,null]'><div class="d m8" style="border-style:none;position:absolute;left:544.077033px;bottom:573.147582px;width:11.955000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",90.709,628.12,null]'><div class="d m8" style="border-style:none;position:absolute;left:746.473905px;bottom:237.452879px;width:6.345000px;height:7.351000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.679893,0.000000,0.000000,1.679893,0.000000,0.000000]}'></div></div>
