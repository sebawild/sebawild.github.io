<div id="pf10" class="pf w0 h0" data-page-no="10"><div class="pc pc10 w0 h0"><img class="bi x0 y70 w2 hf" alt="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA34AAAABCAIAAAAO1+vKAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAHElEQVRIx+3BMQEAAAzDoPq3nGcq9gGrBgAA/w7aJgLyLrSq2gAAAABJRU5ErkJggg=="/><div class="t m0 x0 h5 y39 ff4 fs3 fc0 sc0 ls0 ws0">16<span class="_ _2d"> </span><span class="ff17">Quic<span class="_ _3"></span>ksort<span class="_ _6"> </span>Is<span class="_ _6"> </span>Optimal<span class="_ _6"> </span>F<span class="_ _10"></span>or<span class="_ _6"> </span>Many<span class="_ _5"> </span>Equal<span class="_ _6"> </span>Keys</span></div><div class="t m5 x0 h5 y3a ff4 fs3 fc0 sc0 ls0 ws0">Lik<span class="_ _3"></span>ewise<span class="_ _9"> </span>in<span class="_ _9"> </span>the<span class="_ _9"> </span>search<span class="_ _6"> </span>tree,<span class="_ _e"> </span>all<span class="_ _9"> </span>elemen<span class="_ _3"></span>ts<span class="_ _9"> </span>are<span class="_ _9"> </span>gathered<span class="_ _9"> </span>in<span class="_ _9"> </span>the<span class="_ _9"> </span>single<span class="_ _9"> </span>leaf<span class="_ _9"> </span>and<span class="_ _e"> </span>no<span class="_ _9"> </span>comparisons</div><div class="t m0 x0 h5 y3c ff4 fs3 fc0 sc0 ls0 ws0">happ<span class="_ _4"></span>en.<span class="_ _2"> </span>So<span class="_ _9"> </span>assume<span class="_ _5"> </span>the<span class="_ _9"> </span>claim<span class="_ _6"> </span>holds<span class="_ _6"> </span>for<span class="_ _6"> </span>inputs<span class="_ _6"> </span>with<span class="_ _9"> </span>less<span class="_ _6"> </span>than<span class="_ _6"> </span><span class="ff5">k<span class="_ _9"> </span></span>elements.</div><div class="t m13 x58 h5 y3e ff4 fs3 fc0 sc0 ls0 ws0">If<span class="_ _6"> </span>now</div><div class="t m0 x137 h5 y3e ff5 fs3 fc0 sc0 ls0 ws0">n<span class="_ _8"> </span><span class="ffa">≥<span class="_ _8"> </span></span>k</div><div class="t m13 xbe h5 y3e ff4 fs3 fc0 sc0 ls0 ws0">,<span class="_ _6"> </span>Quicksort<span class="_ _5"> </span>chooses<span class="_ _6"> </span>a<span class="_ _9"> </span>piv<span class="_ _3"></span>ot</div><div class="t m0 xab h5 y3e ff5 fs3 fc0 sc0 ls0 ws0">P</div><div class="t m13 x172 h5 y3e ff4 fs3 fc0 sc0 ls0 ws0">from<span class="_ _6"> </span>the<span class="_ _6"> </span>ﬁrst</div><div class="t m0 xcb h5 y3e ff5 fs3 fc0 sc0 ls0 ws0">k</div><div class="t m13 x158 h5 y3e ff4 fs3 fc0 sc0 ls0 ws0">elemen<span class="_ _3"></span>ts,<span class="_ _6"> </span>compares<span class="_ _6"> </span>all<span class="_ _6"> </span>elements</div><div class="t m1 x0 h5 y3f ff4 fs3 fc0 sc0 ls0 ws0">to</div><div class="t m0 x40 h5 y3f ff5 fs3 fc0 sc0 ls0 ws0">P</div><div class="t m1 x44 h5 y3f ff4 fs3 fc0 sc0 ls0 ws0">,<span class="_ _5"> </span>and<span class="_ _8"> </span>divides<span class="_ _5"> </span>the<span class="_ _8"> </span>input<span class="_ _5"> </span>in<span class="_ _3"></span>to<span class="_ _8"> </span>segments</div><div class="t m0 x126 h11 y3f ff19 fs3 fc0 sc0 ls0 ws0">U</div><div class="t m0 x1a5 h6 y3c2 ff9 fs4 fc0 sc0 ls0 ws0">(1)</div><div class="t m1 x172 h5 y3f ff4 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m0 x59 h11 y3f ff19 fs3 fc0 sc0 ls0 ws0">U</div><div class="t m0 x74 h6 y3c2 ff9 fs4 fc0 sc0 ls0 ws0">(2)</div><div class="t m1 x15a h5 y3f ff4 fs3 fc0 sc0 ls0 ws0">con<span class="_ _3"></span>taining<span class="_ _8"> </span>the<span class="_ _5"> </span>elemen<span class="_ _3"></span>ts<span class="_ _8"> </span>strictly<span class="_ _5"> </span>smaller</div><div class="t m26 x0 h5 y40 ff4 fs3 fc0 sc0 ls0 ws0">resp.<span class="_ _b"> </span>strictly<span class="_ _5"> </span>larger<span class="_ _9"> </span>than</div><div class="t m0 x1a9 h5 y40 ff5 fs3 fc0 sc0 ls0 ws0">P</div><div class="t m26 x13c h5 y40 ff4 fs3 fc0 sc0 ls0 ws0">.<span class="_ _b"> </span>All<span class="_ _5"> </span>duplicates<span class="_ _9"> </span>of</div><div class="t m0 x8a h5 y40 ff5 fs3 fc0 sc0 ls0 ws0">P</div><div class="t m26 x10a h5 y40 ff4 fs3 fc0 sc0 ls0 ws0">are<span class="_ _6"> </span>put<span class="_ _9"> </span>in<span class="_ _6"> </span>place<span class="_ _6"> </span>and<span class="_ _9"> </span>v<span class="_ _0"></span>anish<span class="_ _6"> </span>from<span class="_ _9"> </span>the<span class="_ _6"> </span>recursion</div><div class="t m0 x0 h5 y41 ff4 fs3 fc0 sc0 ls0 ws0">tree.</div><div class="t m28 x58 h5 y42 ff4 fs3 fc0 sc0 ls0 ws0">No<span class="_ _3"></span>w<span class="_ _6"> </span>consider<span class="_ _6"> </span>what<span class="_ _6"> </span>happ<span class="_ _4"></span>ens<span class="_ _9"> </span>up<span class="_ _4"></span>on<span class="_ _6"> </span>inserting<span class="_ _6"> </span>the</div><div class="t m0 x73 h5 y42 ff5 fs3 fc0 sc0 ls0 ws0">k</div><div class="t m28 x74 h5 y42 ff4 fs3 fc0 sc0 ls0 ws0">th<span class="_ _6"> </span>element<span class="_ _5"> </span>in<span class="_ _6"> </span>the<span class="_ _6"> </span>search<span class="_ _6"> </span>tree.<span class="_ _2"> </span>This<span class="_ _9"> </span>is<span class="_ _6"> </span>the</div><div class="t m5 x0 h5 y43 ff4 fs3 fc0 sc0 ls0 ws0">ﬁrst<span class="_ _9"> </span>time<span class="_ _6"> </span>a<span class="_ _9"> </span>leaf<span class="_ _9"> </span>is<span class="_ _9"> </span>split<span class="_ _9"> </span>and<span class="_ _9"> </span>the<span class="_ _9"> </span>k<span class="_ _3"></span>ey<span class="_ _9"> </span>for<span class="_ _9"> </span>the<span class="_ _6"> </span>inner<span class="_ _9"> </span>no<span class="_ _4"></span>de<span class="_ _9"> </span>(the<span class="_ _9"> </span>ro<span class="_ _4"></span>ot<span class="_ _9"> </span>of<span class="_ _9"> </span>the<span class="_ _9"> </span>tree)<span class="_ _9"> </span>is<span class="_ _9"> </span>c<span class="_ _3"></span>hosen<span class="_ _6"> </span>from</div><div class="t m12 x0 h5 y44 ff4 fs3 fc0 sc0 ls0 ws0">the<span class="_ _6"> </span>ﬁrst</div><div class="t m0 x46 h5 y44 ff5 fs3 fc0 sc0 ls0 ws0">k</div><div class="t m12 x47 h5 y44 ff4 fs3 fc0 sc0 ls0 ws0">inserted<span class="_ _6"> </span>elements<span class="_ _5"> </span>ov<span class="_ _0"></span>erall.<span class="_ _b"> </span>W<span class="_ _3c"></span>e<span class="_ _9"> </span>th<span class="_ _3"></span>us<span class="_ _6"> </span>choose<span class="_ _6"> </span>same<span class="_ _9"> </span>v<span class="_ _0"></span>alue</div><div class="t m0 x19c h5 y44 ff5 fs3 fc0 sc0 ls0 ws0">P</div><div class="t m12 x1ac h5 y44 ff4 fs3 fc0 sc0 ls0 ws0">that<span class="_ _6"> </span>was<span class="_ _5"> </span>chosen<span class="_ _5"> </span>as<span class="_ _9"> </span>piv<span class="_ _3"></span>ot<span class="_ _6"> </span>in</div><div class="t m25 x0 h5 y45 ff4 fs3 fc0 sc0 ls0 ws0">Quic<span class="_ _3"></span>ksort.<span class="_ _2"> </span>The<span class="_ _6"> </span>other<span class="_ _6"> </span>elements<span class="_ _5"> </span>from<span class="_ _6"> </span>the<span class="_ _6"> </span>leaf<span class="_ _6"> </span>are<span class="_ _6"> </span>compared<span class="_ _5"> </span>to</div><div class="t m0 xdc h5 y45 ff5 fs3 fc0 sc0 ls0 ws0">P</div><div class="t m25 x148 h5 y45 ff4 fs3 fc0 sc0 ls0 ws0">and<span class="_ _6"> </span>inserted<span class="_ _5"> </span>into<span class="_ _5"> </span>one<span class="_ _6"> </span>of<span class="_ _6"> </span>the</div><div class="t m19 x0 h5 y46 ff4 fs3 fc0 sc0 ls0 ws0">t<span class="_ _3"></span>w<span class="_ _3"></span>o<span class="_ _5"> </span>new<span class="_ _6"> </span>leav<span class="_ _3"></span>es<span class="_ _5"> </span>(unless<span class="_ _6"> </span>they<span class="_ _6"> </span>are<span class="_ _6"> </span>duplicates<span class="_ _6"> </span>of</div><div class="t m0 xac h5 y46 ff5 fs3 fc0 sc0 ls0 ws0">P</div><div class="t m19 x10a h5 y46 ff4 fs3 fc0 sc0 ls0 ws0">).<span class="_ _2"> </span>Any<span class="_ _5"> </span>later<span class="_ _6"> </span>insertions<span class="_ _6"> </span>must<span class="_ _5"> </span>start<span class="_ _6"> </span>at<span class="_ _6"> </span>the<span class="_ _6"> </span>ro<span class="_ _4"></span>ot,</div><div class="t mb x0 h5 y47 ff4 fs3 fc0 sc0 ls0 ws0">so<span class="_ _6"> </span>eac<span class="_ _3"></span>h<span class="_ _6"> </span>of<span class="_ _6"> </span>these<span class="_ _6"> </span>elements<span class="_ _5"> </span>are<span class="_ _6"> </span>also<span class="_ _6"> </span>compared<span class="_ _6"> </span>to</div><div class="t m0 x10a h5 y47 ff5 fs3 fc0 sc0 ls0 ws0">P</div><div class="t mb x59 h5 y47 ff4 fs3 fc0 sc0 ls0 ws0">b<span class="_ _4"></span>efore<span class="_ _6"> </span>the<span class="_ _6"> </span>insertion<span class="_ _6"> </span>contin<span class="_ _0"></span>ues<span class="_ _6"> </span>in<span class="_ _6"> </span>one<span class="_ _9"> </span>of<span class="_ _5"> </span>the</div><div class="t m0 x0 h5 y49 ff4 fs3 fc0 sc0 ls0 ws0">subtrees,<span class="_ _6"> </span>or<span class="_ _6"> </span>stops<span class="_ _6"> </span>if<span class="_ _6"> </span>a<span class="_ _9"> </span>duplicate<span class="_ _6"> </span>of<span class="_ _6"> </span><span class="ff5">P<span class="_ _b"> </span></span>is<span class="_ _6"> </span>found.</div><div class="t m1 x58 h5 y4a ff4 fs3 fc0 sc0 ls0 ws0">So<span class="_ _5"> </span>w<span class="_ _0"></span>e<span class="_ _5"> </span>execute<span class="_ _5"> </span>the<span class="_ _8"> </span>same<span class="_ _5"> </span>set<span class="_ _5"> </span>of<span class="_ _8"> </span>comparisons<span class="_ _5"> </span>in<span class="_ _5"> </span>both<span class="_ _5"> </span>pro<span class="_ _4"></span>cesses<span class="_ _5"> </span>at<span class="_ _5"> </span>the<span class="_ _8"> </span>ro<span class="_ _4"></span>ot<span class="_ _5"> </span>of<span class="_ _5"> </span>the<span class="_ _8"> </span>tree.<span class="_ _b"> </span>T<span class="_ _3c"></span>ow<span class="_ _0"></span>ards</div><div class="t m14 x0 h5 y4b ff4 fs3 fc0 sc0 ls0 ws0">applying<span class="_ _6"> </span>the<span class="_ _5"> </span>inductive<span class="_ _5"> </span>hypothesis<span class="_ _6"> </span>for<span class="_ _6"> </span>recursive<span class="_ _5"> </span>calls<span class="_ _6"> </span>resp.<span class="_ _6"> </span>subtrees,<span class="_ _6"> </span>we<span class="_ _5"> </span>note<span class="_ _6"> </span>that<span class="_ _6"> </span>the<span class="_ _6"> </span>relative</div><div class="t m28 x0 h5 y4c ff4 fs3 fc0 sc0 ls0 ws0">order<span class="_ _6"> </span>of<span class="_ _6"> </span>elements<span class="_ _5"> </span>is<span class="_ _6"> </span>retained<span class="_ _6"> </span>in<span class="_ _9"> </span>b<span class="_ _4"></span>oth<span class="_ _6"> </span>pro<span class="_ _4"></span>cesses,<span class="_ _6"> </span>so<span class="_ _6"> </span>the<span class="_ _6"> </span>elements<span class="_ _6"> </span>inserted<span class="_ _6"> </span>in<span class="_ _6"> </span>the<span class="_ _6"> </span>left/right<span class="_ _5"> </span>child</div><div class="t m0 x0 h5 y4e ff4 fs3 fc0 sc0 ls0 ws0">of<span class="_ _6"> </span>the<span class="_ _6"> </span>ro<span class="_ _4"></span>ot<span class="_ _6"> </span>are<span class="_ _6"> </span>exactly<span class="_ _9"> </span><span class="ff19">U</span></div><div class="t m0 x122 h6 y3c3 ff9 fs4 fc0 sc0 ls0 ws0">(1)</div><div class="t m0 xaf h5 y4e ff4 fs3 fc0 sc0 ls0 ws0">resp.<span class="_ _6"> </span><span class="ff19">U</span></div><div class="t m0 xa7 h6 y3c3 ff9 fs4 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 xff h5 y4e ff4 fs3 fc0 sc0 ls0 ws0">in<span class="_ _6"> </span>b<span class="_ _4"></span>oth<span class="_ _6"> </span>cases.<span class="_ _b"> </span>The<span class="_ _5"> </span>claim<span class="_ _6"> </span>thus<span class="_ _5"> </span>follows<span class="_ _5"> </span>by<span class="_ _5"> </span>induction.</div><div class="t m0 x14f h1c y3c4 ff23 fs3 fc0 sc0 ls0 ws0"></div><div class="t m1 x0 h5 y3c5 ff4 fs3 fc0 sc0 ls0 ws0">The<span class="_ _5"> </span>proof<span class="_ _5"> </span>relies<span class="_ _5"> </span>on<span class="_ _8"> </span>the<span class="_ _5"> </span>fact<span class="_ _5"> </span>that<span class="_ _8"> </span>Algorithm<span class="_ _5"> </span>1<span class="_ _5"> </span>retains<span class="_ _8"> </span>the<span class="_ _5"> </span>relative<span class="_ _8"> </span>order<span class="_ _5"> </span>of<span class="_ _8"> </span>elements,<span class="_ _8"> </span>but<span class="_ _5"> </span>practical</div><div class="t m5 x0 h5 y3c6 ff4 fs3 fc0 sc0 ls0 ws0">non-stable,<span class="_ _2"> </span>in-place<span class="_ _2"> </span>implemen<span class="_ _3"></span>tations<span class="_ _e"> </span>(</div><div class="t m0 x11d h5 y3c6 ff4 fs3 fc0 sc0 ls0 ws0">e.<span class="_ _7"></span>g.</div><div class="t m5 x168 h5 y3c6 ff4 fs3 fc0 sc0 ls0 ws0">,<span class="_ _2"> </span>those<span class="_ _2"> </span>in<span class="_ _2"> </span>[</div><div class="t m0 x177 h5 y3c6 ff4 fs3 fc0 sc0 ls0 ws0">4</div><div class="t m5 x192 h5 y3c6 ff4 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m0 x16 h5 y3c6 ff4 fs3 fc0 sc0 ls0 ws0">41</div><div class="t m5 x1e0 h5 y3c6 ff4 fs3 fc0 sc0 ls0 ws0">])<span class="_ _2"> </span>do<span class="_ _e"> </span>not<span class="_ _2"> </span>fulﬁll<span class="_ _2"> </span>this<span class="_ _e"> </span>requirement.</div><div class="t m2a x0 h5 y3c7 ff4 fs3 fc0 sc0 ls0 ws0">Ho<span class="_ _3"></span>w<span class="_ _3"></span>ev<span class="_ _3"></span>er,<span class="_ _5"> </span>a<span class="_ _9"> </span>w<span class="_ _3"></span>eak<span class="_ _3"></span>er<span class="_ _5"> </span>version<span class="_ _5"> </span>of<span class="_ _9"> </span>Lemma<span class="_ _6"> </span>6.1<span class="_ _6"> </span>remains<span class="_ _6"> </span>v<span class="_ _0"></span>alid<span class="_ _6"> </span>for<span class="_ _9"> </span>an<span class="_ _3"></span>y<span class="_ _5"> </span>fat-pivot<span class="_ _5"> </span>partitioning<span class="_ _9"> </span>metho<span class="_ _4"></span>d:</div><div class="t m5 x0 h5 y3c8 ff4 fs3 fc0 sc0 ls0 ws0">the<span class="_ _6"> </span>tw<span class="_ _0"></span>o<span class="_ _9"> </span>pro<span class="_ _4"></span>cesses<span class="_ _6"> </span>alwa<span class="_ _3"></span>ys<span class="_ _6"> </span>hav<span class="_ _0"></span>e<span class="_ _9"> </span>the<span class="_ _6"> </span>same<span class="_ _9"> </span><span class="ffb">distribution<span class="_ _e"> </span></span>of<span class="_ _6"> </span>the<span class="_ _9"> </span>n<span class="_ _3"></span>um<span class="_ _3"></span>b<span class="_ _4"></span>er<span class="_ _6"> </span>of<span class="_ _9"> </span>comparisons<span class="_ _6"> </span>and<span class="_ _9"> </span>tree</div><div class="t m5 x0 h5 y3c9 ff4 fs3 fc0 sc0 ls0 ws0">shap<span class="_ _4"></span>es<span class="_ _2"> </span>ov<span class="_ _0"></span>er<span class="_ _2"> </span><span class="ffb">r<span class="_ _3"></span>andomly<span class="_ _2"> </span>or<span class="_ _3"></span>der<span class="_ _0"></span>e<span class="_ _0"></span>d <span class="ff4">inputs.<span class="_ _1c"> </span>In<span class="_ _2"> </span>this<span class="_ _2"> </span>general<span class="_ _2"> </span>case,<span class="_ _b"> </span>sorting<span class="_ _2"> </span>the<span class="_ _2"> </span>input<span class="_ _b"> </span>corresponds</span></span></div><div class="t m5 x0 h5 y3ca ff4 fs3 fc0 sc0 ls0 ws0">to<span class="_ _2"> </span>inserting<span class="_ _e"> </span>a<span class="_ _2"> </span>(diﬀeren<span class="_ _3"></span>t,<span class="_ _2"> </span>but<span class="_ _2"> </span>uniquely<span class="_ _e"> </span>determined)<span class="_ _2"> </span>p<span class="_ _4"></span>erm<span class="_ _3"></span>utation<span class="_ _e"> </span>of<span class="_ _2"> </span>the<span class="_ _2"> </span>input<span class="_ _e"> </span>into<span class="_ _e"> </span>a<span class="_ _2"> </span>fringe-</div><div class="t m5 x0 h5 y3cb ff4 fs3 fc0 sc0 ls0 ws0">balanced<span class="_ _6"> </span>tree;<span class="_ _9"> </span>my</div><div class="t m0 x1b2 h5 y3cb ff4 fs3 fc0 sc0 ls0 ws0">Ph.<span class="_ _7"></span>D.</div><div class="t m5 x1e1 h5 y3cb ff4 fs3 fc0 sc0 ls0 ws0">thesis<span class="_ _6"> </span>[</div><div class="t m0 x14c h5 y3cb ff4 fs3 fc0 sc0 ls0 ws0">47</div><div class="t m5 xda h5 y3cb ff4 fs3 fc0 sc0 ls0 ws0">]<span class="_ _6"> </span>gives<span class="_ _6"> </span>some<span class="_ _9"> </span>more<span class="_ _6"> </span>details<span class="_ _9"> </span>on<span class="_ _6"> </span>that.<span class="_ _3b"> </span>Suc<span class="_ _0"></span>h<span class="_ _9"> </span>a<span class="_ _9"> </span>distributional</div><div class="t m11 x0 h5 y3cc ff4 fs3 fc0 sc0 ls0 ws0">v<span class="_ _3"></span>ersion<span class="_ _6"> </span>of<span class="_ _6"> </span>Lemma<span class="_ _6"> </span>6.1<span class="_ _9"> </span>is<span class="_ _6"> </span>suﬃcien<span class="_ _3"></span>t<span class="_ _6"> </span>for<span class="_ _6"> </span>all<span class="_ _6"> </span>results<span class="_ _9"> </span>in<span class="_ _6"> </span>this<span class="_ _6"> </span>pap<span class="_ _4"></span>er,<span class="_ _9"> </span>so<span class="_ _6"> </span>our<span class="_ _6"> </span>results<span class="_ _6"> </span>apply<span class="_ _6"> </span>to<span class="_ _9"> </span>practical</div><div class="t m0 x0 h5 y3cd ff4 fs3 fc0 sc0 ls0 ws0">implemen<span class="_ _3"></span>tations,<span class="_ _6"> </span>as<span class="_ _6"> </span>well.</div><div class="t m0 x0 h10 y3ce ff1 fs7 fc0 sc0 ls0 ws0">6.2. Sea<span class="_ _3"></span>rch<span class="_ _e"> </span>Costs</div><div class="t m22 x0 h5 y3cf ff4 fs3 fc0 sc0 ls0 ws0">The<span class="_ _6"> </span>second<span class="_ _6"> </span>lemma<span class="_ _6"> </span>relates<span class="_ _6"> </span>the<span class="_ _6"> </span>costs<span class="_ _6"> </span>to<span class="_ _6"> </span>build<span class="_ _6"> </span>a<span class="_ _9"> </span>searc<span class="_ _3"></span>h<span class="_ _5"> </span>tree<span class="_ _6"> </span>to<span class="_ _9"> </span>the<span class="_ _5"> </span>cost<span class="_ _9"> </span>of<span class="_ _5"> </span>searching<span class="_ _5"> </span>in<span class="_ _6"> </span>the<span class="_ _9"> </span>ﬁnal</div><div class="t m0 x0 h5 y3d0 ff4 fs3 fc0 sc0 ls0 ws0">tree.</div><div class="t m0 x0 h5 y3d1 ff1d fs3 fc0 sc0 ls0 ws0">Lemma<span class="_ _e"> </span>6.2<span class="_ _9"> </span>(Search<span class="_ _9"> </span>Costs):</div><div class="t m1 x16c h5 y3d1 ff17 fs3 fc0 sc0 ls0 ws0">Let</div><div class="t m0 x16f h11 y3d1 ff19 fs3 fc0 sc0 ls0 ws0">U</div><div class="t m1 x105 h5 y3d1 ff7 fs3 fc0 sc0 ls0 ws0">=<span class="_ _8"> </span>(</div><div class="t m0 x43 h5 y3d1 ff5 fs3 fc0 sc0 ls0 ws0">U</div><div class="t m0 x124 h6 y3d2 ff9 fs4 fc0 sc0 ls0 ws0">1</div><div class="t m0 xb1 h5 y3d1 ff5 fs3 fc0 sc0 ls0 ws0">,<span class="_ _c"> </span>.<span class="_ _c"> </span>.<span class="_ _c"> </span>.<span class="_ _c"> </span>,<span class="_ _c"> </span>U</div><div class="t m0 x73 h6 y3d2 ff6 fs4 fc0 sc0 ls0 ws0">n</div><div class="t m1 x74 h5 y3d1 ff7 fs3 fc0 sc0 ls0 ws0">)<span class="_ _8"> </span><span class="ff17">b<span class="_ _4"></span>e<span class="_ _8"> </span>an<span class="_ _5"> </span>input<span class="_ _8"> </span>(with<span class="_ _8"> </span>or<span class="_ _5"> </span>without<span class="_ _32"> </span>dup<span class="_ _4"></span>licates),</span></div><div class="t m5 x8b h5 y3d3 ff17 fs3 fc0 sc0 ls0 ws0">let</div><div class="t m0 x84 h5 y3d3 ffa fs3 fc0 sc0 ls0 ws0">T</div><div class="t m5 x5 h5 y3d3 ff17 fs3 fc0 sc0 ls0 ws0">b<span class="_ _4"></span>e<span class="_ _6"> </span>built<span class="_ _5"> </span>from</div><div class="t m0 xf5 h11 y3d3 ff19 fs3 fc0 sc0 ls0 ws0">U</div><div class="t m5 x12d h5 y3d3 ff17 fs3 fc0 sc0 ls0 ws0">b<span class="_ _3"></span>y<span class="_ _5"> </span>successive<span class="_ _5"> </span>insertions<span class="_ _6"> </span>using<span class="_ _6"> </span>Algorithm<span class="_ _6"> </span>2<span class="_ _6"> </span>and<span class="_ _6"> </span>let</div><div class="t m0 x12b h5 y3d3 ff5 fs3 fc0 sc0 ls0 ws0">B</div><div class="t m0 x35 h1f y3d4 ff24 fs4 fc0 sc0 ls0 ws0">U</div><div class="t m5 x11 h5 y3d3 ff17 fs3 fc0 sc0 ls0 ws0">b<span class="_ _4"></span>e<span class="_ _6"> </span>the<span class="_ _5"> </span>num<span class="_ _3"></span>ber</div><div class="t m5 x8b h5 y3d5 ff17 fs3 fc0 sc0 ls0 ws0">of<span class="_ _9"> </span>comparisons<span class="_ _e"> </span>done<span class="_ _9"> </span>in<span class="_ _e"> </span>this<span class="_ _9"> </span>pro<span class="_ _4"></span>cess.<span class="_ _14"> </span>Assume<span class="_ _9"> </span>there<span class="_ _e"> </span>are</div><div class="t m0 x3f h5 y3d5 ff5 fs3 fc0 sc0 ls0 ws0">I</div><div class="t m5 x17 h5 y3d5 ff17 fs3 fc0 sc0 ls0 ws0">inner<span class="_ _9"> </span>no<span class="_ _4"></span>des<span class="_ _e"> </span>in</div><div class="t m0 x12b h5 y3d5 ffa fs3 fc0 sc0 ls0 ws0">T</div><div class="t m5 x162 h5 y3d5 ff17 fs3 fc0 sc0 ls0 ws0">.<span class="_ _39"> </span>Searching<span class="_ _9"> </span>each</div><div class="t m1 x8b h5 y3d6 ff17 fs3 fc0 sc0 ls0 ws0">elemen<span class="_ _3"></span>t<span class="_ _5"> </span>of</div><div class="t m0 x1e2 h11 y3d6 ff19 fs3 fc0 sc0 ls0 ws0">U</div><div class="t m1 x138 h5 y3d6 ff17 fs3 fc0 sc0 ls0 ws0">in</div><div class="t m0 x114 h5 y3d6 ffa fs3 fc0 sc0 ls0 ws0">T</div><div class="t m1 x1a0 h5 y3d6 ff17 fs3 fc0 sc0 ls0 ws0">using<span class="_ _5"> </span>Algorithm<span class="_ _6"> </span>3<span class="_ _6"> </span>(ignoring<span class="_ _5"> </span>the<span class="_ _6"> </span>sequential<span class="_ _5"> </span>searc<span class="_ _3"></span>h<span class="_ _5"> </span>in<span class="_ _6"> </span>leav<span class="_ _0"></span>es)<span class="_ _6"> </span>uses</div><div class="t m0 x63 h5 y3d6 ff5 fs3 fc0 sc0 ls0 ws0">B</div><div class="t m0 x1ce h1f y3d7 ff24 fs4 fc0 sc0 ls0 ws0">U</div><div class="t m0 x101 h5 y3d6 ffa fs3 fc0 sc0 ls0 ws0">±<span class="_ _c"></span><span class="ff5">c<span class="_ _19"> </span></span>·<span class="_ _19"></span><span class="ff5">I<span class="_ _7"></span>k</span></div><div class="t m0 x8b h5 y3d8 ff17 fs3 fc0 sc0 ls0 ws0">comparisons.</div><div class="t m0 x0 h5 y3d9 ff1d fs3 fc0 sc0 ls0 ws0">Pro<span class="_ _4"></span>of:</div><div class="t m5 x160 h5 y3d9 ff4 fs3 fc0 sc0 ls0 ws0">The<span class="_ _9"> </span>elements<span class="_ _9"> </span>in<span class="_ _e"> </span>the<span class="_ _9"> </span>leav<span class="_ _0"></span>es<span class="_ _e"> </span>of</div><div class="t m0 xdb h5 y3d9 ffa fs3 fc0 sc0 ls0 ws0">T</div><div class="t m5 xec h5 y3d9 ff4 fs3 fc0 sc0 ls0 ws0">require<span class="_ _9"> </span>the<span class="_ _e"> </span>exact<span class="_ _9"> </span>same<span class="_ _e"> </span>comparisons<span class="_ _e"> </span>for<span class="_ _9"> </span>insert<span class="_ _e"> </span>and</div><div class="t m5 x0 h5 y3da ff4 fs3 fc0 sc0 ls0 ws0">searc<span class="_ _3"></span>h<span class="_ _9"> </span>to<span class="_ _e"> </span>ﬁnd<span class="_ _9"> </span>the<span class="_ _e"> </span>path<span class="_ _9"> </span>to<span class="_ _e"> </span>their<span class="_ _9"> </span>leaf.<span class="_ _38"> </span>(W<span class="_ _10"></span>e<span class="_ _9"> </span>ignore<span class="_ _e"> </span>the<span class="_ _e"> </span>sequen<span class="_ _0"></span>tial<span class="_ _e"> </span>search<span class="_ _9"> </span>within<span class="_ _9"> </span>the<span class="_ _e"> </span>leaf<span class="_ _4"></span>).<span class="_ _14"> </span>So</div><div class="t m11 x0 h5 y3db ff4 fs3 fc0 sc0 ls0 ws0">consider<span class="_ _6"> </span>the<span class="_ _6"> </span>key</div><div class="t m0 x1dd h5 y3db ff5 fs3 fc0 sc0 ls0 ws0">v<span class="_ _5"> </span><span class="ffa">∈</span></div><div class="t m11 xf1 h5 y3db ff7 fs3 fc0 sc0 ls0 ws0">[</div><div class="t m0 x30 h5 y3db ff5 fs3 fc0 sc0 ls0 ws0">u</div><div class="t m11 x12d h5 y3db ff7 fs3 fc0 sc0 ls0 ws0">]<span class="_ _6"> </span><span class="ff4">of<span class="_ _6"> </span>an<span class="_ _6"> </span>inner<span class="_ _9"> </span>no<span class="_ _4"></span>de.<span class="_ _2"> </span>The<span class="_ _6"> </span>ﬁrst<span class="_ _9"> </span>o<span class="_ _4"></span>ccurrences<span class="_ _6"> </span>of</span></div><div class="t m0 x7e h5 y3db ff5 fs3 fc0 sc0 ls0 ws0">v</div><div class="t m11 x19d h5 y3db ff4 fs3 fc0 sc0 ls0 ws0">in</div><div class="t m0 x153 h11 y3db ff19 fs3 fc0 sc0 ls0 ws0">U</div><div class="t m11 x1b0 h5 y3db ff4 fs3 fc0 sc0 ls0 ws0">are<span class="_ _6"> </span>simply<span class="_ _6"> </span>added<span class="_ _6"> </span>to</div><div class="t m23 x0 h5 y3dc ff4 fs3 fc0 sc0 ls0 ws0">the<span class="_ _6"> </span>leaf<span class="_ _6"> </span>that<span class="_ _6"> </span>later<span class="_ _6"> </span>b<span class="_ _4"></span>ecomes<span class="_ _9"> </span>the<span class="_ _6"> </span>inner<span class="_ _6"> </span>no<span class="_ _4"></span>de<span class="_ _6"> </span>with<span class="_ _6"> </span>lab<span class="_ _4"></span>el</div><div class="t m0 x128 h5 y3dc ff5 fs3 fc0 sc0 ls0 ws0">v</div><div class="t m23 x1e3 h5 y3dc ff4 fs3 fc0 sc0 ls0 ws0">.<span class="_ _2"> </span>Each<span class="_ _5"> </span>of<span class="_ _6"> </span>these<span class="_ _9"> </span>en<span class="_ _3"></span>tails<span class="_ _5"> </span>one<span class="_ _9"> </span>comparison</div><div class="t m1 x0 h5 y3dd ff4 fs3 fc0 sc0 ls0 ws0">more<span class="_ _6"> </span>when<span class="_ _6"> </span>searching<span class="_ _5"> </span>for<span class="_ _9"> </span>it<span class="_ _6"> </span>in</div><div class="t m0 xb9 h5 y3dd ffa fs3 fc0 sc0 ls0 ws0">T</div><div class="t m1 x4d h5 y3dd ff4 fs3 fc0 sc0 ls0 ws0">as<span class="_ _6"> </span>we<span class="_ _5"> </span>paid<span class="_ _6"> </span>when<span class="_ _9"> </span>inserting<span class="_ _6"> </span>it<span class="_ _6"> </span>(namely<span class="_ _9"> </span>the<span class="_ _6"> </span>last<span class="_ _6"> </span>comparison<span class="_ _9"> </span>with</div><div class="t m0 x0 h5 y3de ff5 fs3 fc0 sc0 ls0 ws0">v</div><div class="t m1d x76 h5 y3de ff4 fs3 fc0 sc0 ls0 ws0">that<span class="_ _6"> </span>identiﬁes<span class="_ _5"> </span>them<span class="_ _9"> </span>as<span class="_ _6"> </span>equal).<span class="_ _b"> </span>Ho<span class="_ _3"></span>w<span class="_ _0"></span>ever,<span class="_ _6"> </span>there<span class="_ _6"> </span>are<span class="_ _9"> </span>b<span class="_ _4"></span>e<span class="_ _6"> </span>at<span class="_ _6"> </span>most</div><div class="t m0 x152 h5 y3de ff5 fs3 fc0 sc0 ls0 ws0">k</div><div class="t m1d x1a h5 y3de ff4 fs3 fc0 sc0 ls0 ws0">suc<span class="_ _3"></span>h<span class="_ _6"> </span>elements<span class="_ _5"> </span>b<span class="_ _4"></span>efore<span class="_ _9"> </span>the<span class="_ _6"> </span>leaf</div><div class="t m3 x0 h5 y3df ff4 fs3 fc0 sc0 ls0 ws0">o<span class="_ _3"></span>v<span class="_ _3"></span>erﬂo<span class="_ _3"></span>ws,<span class="_ _6"> </span>and<span class="_ _6"> </span>for<span class="_ _6"> </span>the<span class="_ _6"> </span>remaining<span class="_ _9"> </span>duplicate<span class="_ _6"> </span>insertions<span class="_ _6"> </span>of</div><div class="t m0 x15c h5 y3df ff5 fs3 fc0 sc0 ls0 ws0">v</div><div class="t m3 x1c5 h5 y3df ff4 fs3 fc0 sc0 ls0 ws0">,<span class="_ _6"> </span>we<span class="_ _5"> </span><span class="ffb">do<span class="_ _9"> </span></span>the<span class="_ _6"> </span>last<span class="_ _9"> </span>comparison<span class="_ _6"> </span>(same<span class="_ _6"> </span>as</div><div class="t m1 x0 h5 y3e0 ff4 fs3 fc0 sc0 ls0 ws0">in<span class="_ _6"> </span>the<span class="_ _6"> </span>search).<span class="_ _2"> </span>So<span class="_ _6"> </span>searc<span class="_ _3"></span>hing<span class="_ _6"> </span>pa<span class="_ _3"></span>ys<span class="_ _6"> </span>up<span class="_ _6"> </span>to</div><div class="t m0 x105 h5 y3e0 ff5 fs3 fc0 sc0 ls0 ws0">I<span class="_ _8"> </span><span class="ffa">·<span class="_ _19"> </span></span>k</div><div class="t m1 x124 h5 y3e0 ff4 fs3 fc0 sc0 ls0 ws0">comparisons<span class="_ _6"> </span>more.<span class="_ _b"> </span>On<span class="_ _5"> </span>the<span class="_ _6"> </span>other<span class="_ _6"> </span>hand,<span class="_ _6"> </span>whenever<span class="_ _5"> </span>a</div><div class="t md x0 h5 y3e1 ff4 fs3 fc0 sc0 ls0 ws0">leaf<span class="_ _6"> </span>ov<span class="_ _0"></span>erﬂows,<span class="_ _5"> </span>we<span class="_ _5"> </span>need<span class="_ _9"> </span>a<span class="_ _6"> </span>certain<span class="_ _6"> </span>num<span class="_ _0"></span>b<span class="_ _f"></span>er<span class="_ _6"> </span>of<span class="_ _6"> </span>comparisons<span class="_ _9"> </span>to<span class="_ _6"> </span>select<span class="_ _6"> </span>the<span class="_ _9"> </span>median,<span class="_ _6"> </span>say<span class="_ _5"> </span>at<span class="_ _6"> </span>most</div><div class="t m0 x1ba h5 y3e1 ff5 fs3 fc0 sc0 ls0 ws0">c<span class="_ _a"> </span><span class="ffa">·<span class="_ _a"> </span></span>k</div><div class="t m0 x0 h5 y3e2 ff4 fs3 fc0 sc0 ls0 ws0">for<span class="_ _6"> </span>some<span class="_ _6"> </span>constant<span class="_ _5"> </span><span class="ff5">c</span>.<span class="_ _b"> </span>So<span class="_ _5"> </span>insertion<span class="_ _6"> </span>pays<span class="_ _5"> </span>up<span class="_ _9"> </span>to<span class="_ _5"> </span><span class="ff5">I<span class="_ _5"> </span><span class="ffa">·<span class="_ _a"> </span></span>ck<span class="_ _e"> </span></span>comparisons<span class="_ _5"> </span>more<span class="_ _9"> </span>than<span class="_ _6"> </span>insertion.</div><div class="t m0 x14f h1c y3e3 ff23 fs3 fc0 sc0 ls0 ws0"></div><a class="l" href="#pf5" data-dest-detail='[5,"XYZ",74.409,758.183,null]'><div class="d mf" style="border-style:none;position:absolute;left:377.767624px;bottom:836.635443px;width:58.316000px;height:11.629000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf26" data-dest-detail='[38,"XYZ",79.391,686.651,null]'><div class="d mf" style="border-style:none;position:absolute;left:563.150539px;bottom:817.437626px;width:7.447000px;height:8.863000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf27" data-dest-detail='[39,"XYZ",74.409,172.579,null]'><div class="d mf" style="border-style:none;position:absolute;left:585.281449px;bottom:817.437626px;width:12.902000px;height:8.863000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",74.409,235.479,null]'><div class="d mf" style="border-style:none;position:absolute;left:362.257171px;bottom:791.113702px;width:55.079000px;height:11.629000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf28" data-dest-detail='[40,"XYZ",74.409,620.898,null]'><div class="d mf" style="border-style:none;position:absolute;left:388.268635px;bottom:703.633273px;width:12.902000px;height:8.862000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",74.409,235.479,null]'><div class="d mf" style="border-style:none;position:absolute;left:205.546671px;bottom:677.307669px;width:54.573000px;height:11.629000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf6" data-dest-detail='[6,"XYZ",74.409,639.38,null]'><div class="d mf" style="border-style:none;position:absolute;left:551.824700px;bottom:487.530154px;width:60.989000px;height:11.629000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf6" data-dest-detail='[6,"XYZ",74.409,256.625,null]'><div class="d mf" style="border-style:none;position:absolute;left:322.117808px;bottom:440.988718px;width:58.617000px;height:12.902000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.679893,0.000000,0.000000,1.679893,0.000000,0.000000]}'></div></div>
