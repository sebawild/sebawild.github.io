<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Average Cost of QuickXsort with Pivot Sampling</title>
  <meta name="description" content="">

  <link rel="stylesheet" href="/fonts/pagella/stylesheet.css" type="text/css" charset="utf-8" />
  <link rel="stylesheet" href="/fonts/epigrafica/stylesheet.css" type="text/css" charset="utf-8" />
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://wild-inter.net/publications/wild-2018a">
  <link rel="alternate" type="application/rss+xml" title="Sebastian Wild's Site" href="https://wild-inter.net/feed.xml">
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Sebastian</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#46433A" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#46433A" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#46433A" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="/research">Research</a>
          
        
          
          <a class="page-link" href="/teaching/">Teaching</a>
          
        
          
          <a class="page-link" href="/posts/">Blog</a>
          
        
          
          <a class="page-link" href="/about">About</a>
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post">
	<div class="post-back">
		<small>
			<a href="/publications/">⬑ All Publications</a>
		</small>
	</div>

	<header class="publication-header">
		<h1 class="publication-title"><p>Average Cost of QuickXsort with Pivot Sampling</p>
</h1>

		<div class="publication-meta">
			<p style="text-align:left">
				<small>
				Mar 2018
				<span style="padding-left:1em;">
					<small>(Written: Jan 2018)</small>
				</span>
				</small>
			</p>
			<p>
				
				<p>Sebastian Wild:</p>

			</p>
			<p>
				<p><a href="http://www.math.uu.se/math.uu.se/department-of-mathematics/AofA2018" title="AofA 2018"><small>International Conference on Probabilistic, Combinatorial and Asymptotic Methods for the</small> Analysis of Algorithms (AofA) 2018</a></p>

			</p>
			<p>
				
				
				
				
				
				
				
					|&nbsp;<a href="http://arxiv.org/abs/1803.05948" title="1803.05948">arxiv</a>
				
				
				
				|
			</p>

			

		</div>

	</header>

	<div class="publication-content">
		
<script type="text/x-mathjax-config">
	var font = "Neo-Euler";
	MathJax.Hub.Config({
		tex2jax: {
			inlineMath: [['$','$']],
			displayMath: [['\\[','\\]']],
			processEscapes: true,
		},
		"SVG":{ 
			font:font
		},
		"HTML-CSS": {
			webFont: font,
			imageFont: font,
			preferredFont: font,
			availableFonts: [],
			scale: 85,
			mtextFontInherit: true
		}
	});
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<p>The purpose of this paper is to simplify and improve
the analysis of a more distant relative of Quicksort: <em>Quick<strong>X</strong>Sort</em>.
For that, I precisely solve a variation of the Quicksort recurrence
for which previous works proved upper bounds using ad-hoc arguments
specific to certain algorithms X.</p>

<h2 id="results">Results</h2>

<p>The main result is a transfer theorem that allows to obtain the costs of QuickXSort
directly from the costs of X in isolation, including the option to choose
median-of-$k$ pivots.</p>

<p>I demonstrate in the paper that the precise solution of the recurrence improves the prediction accuracy of comparison counts by one order of magnitude.</p>

<p>Stating the actual recurrence requires a good deal of notation,
so for now, let me point to the <a href="http://arxiv.org/abs/1803.05948">arxiv paper</a>
for that.</p>

<h2 id="quickxsort-and-quickmergesort">QuickXSort and QuickMergeSort</h2>

<p>QuickXSort is a scheme for turning many non-inplace sorting methods X
into a constant-extra-space sorting method with almost the same number of
comparisons, in fact with overall linear overhead.
This sounds magic, but the idea is simple.</p>

<p>For the method to work, we require X to use its extra space only to temporarily
offload some elements to facilitate their rearrangement.
The stereotypical example of such a method is <em>Mergesort:</em>
merging requires a buffer to hold one of the runs
(unless we use one of the comparatively complicated inplace merging methods,
which are not deemed competitive in terms of running time with standard out-of-place
merging methods).
It is enough to have a buffer for the first run and merge back into the position
it previously occupied.
Using bottom-up Mergesort, a buffer for $n/2$ elements is the only
extra space we need to sort $n$ elements then.</p>

<p>QuickMergeSort then works as follows:
We start with a partitioning step as in Quicksort.
Then we sort one of the resulting segments by Mergesort, using
the other segment as buffer.
Whenever a merge operation has to move a run into the buffer, we do so using
swap operations. That way the original content of the buffer is never lost,
but only permuted (in some hard-to-predict fashion),
and when we are done with Mergesorting one segment, the other segment
contains the same elements as before (but in arbitrary order).
The second segment is then sorted recursively.</p>

<p>Since we only have one recursive call in QuickXSort,
we can use tail-recursion elimination to avoid any extra space for these calls.</p>

<h3 id="which-segment-do-we-sort-with-x">Which segment do we sort with X?</h3>

<p>The general scheme has some degrees of freedom,
one of them is how to choose the segment to sort with X.
A natural choice is to sort <em>the largest segment with X for which the other segment
offers sufficient buffer space</em>.
This ultimately depends on the amount of space needed by X,
and on the sizes of the segments produced by the partitioning step.</p>

<p>For the example of Mergesort, we obtain two difference regimes:
For roughly balanced partitions, we can sort the larger segment with Mergesort,
whereas for rather unbalanced partitions,
we must sort the smaller segment with Mergesort to guarantee enough buffer space.
This makes the recurrence of the costs more challenging to analyze.</p>

<h2 id="quickheapsort">QuickHeapSort</h2>

<p>Another good option—and indeed the historically first one—for X is Heapsort.
But wait; Heapsort?
Isn’t Heapsort that single elementary method with
reasonable performance that achieves constant extra space right away!?</p>

<h3 id="external-heapsort">External Heapsort</h3>

<p>Yes, at first sight Heapsort appears to be the candidate <em>least</em> likely to profit
from the QuickXSort scheme.
Indeed, the typical inplace textbook versions of Heapsort wouldn’t profit.
But those have to maintain their in the very rigid shape imposed upon them by storing
it as an implicit heap in a contiguous region of the array.
And this rigid structure comes at the price of extra comparisons:</p>

<p>To extract the maximum, we have to move the last element in heap-part of the array
to the root of the heap and let it sink from there.
This requires up to <em>two</em> comparisons per level of the heap, since we have to find
the larger child (which is potentially promoted) and we have to compare this child
with the sinking element.
(Floyd’s optimization, and more sophisticated tricks exist to bring this number
further down, but it remains more than the height of the heap.)</p>

<p>By using an output buffer to hold elements extracted from the heap,
we can instead simply promote elements to fill the gap left behind by the
extracted max. So we only at most one comparison per level of the heap.</p>

<p>This “external heapsort” thus uses $\sim n\lg n$ comparisons,
but requires a buffer to hold $n$ elements.
By using it as our X in QuickXSort, we can avoid the extra space requirement.</p>

	</div>
</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Sebastian Wild</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>
				<a href="mailto:sebawild@gmail.com" title="Contact me">sebawild at gmail</a>,
				<a href="http://pgp.mit.edu:11371/pks/lookup?op=get&search=0x38600ABC14973198">PGP Key</a>
			</li>
			<li>
				<a href="mailto:wild@uwaterloo.ca" title="Contact me">wild at uwaterloo.ca</a>,
				<a href="http://pgp.mit.edu:11371/pks/lookup?op=get&search=0x34EE39A78B149255">PGP Key</a>
          <li>
				<del><a href="mailto:wild@cs.uni-kl.de" title="Contact me">wild at cs.uni-kl.de</a></del>
          </li>
          <li><a href="http://wwwagak.cs.uni-kl.de/home/staff/sebastian-wild">Website at TU KL</a></li>
          <li><a href="http://orcid.org/0000-0002-6061-9177">ORCID ID: 0000-0002-6061-9177</a></li>
          <li><a href="https://scholar.google.de/citations?user=aMyZiK0AAAAJ">Google Scholar Profile</a></li>
		  <li><a href="http://dblp.uni-trier.de/pers/hd/w/Wild:Sebastian">DBLP Publication List</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          

          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>
			Website of <a href=/about>Sebastian Wild</a>.

        </p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
