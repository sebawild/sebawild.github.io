<div id="pf60" class="pf w0 h0" data-page-no="60"><div class="pc pc60 w0 h0"><img class="bi xc yf6c w2 h73" alt="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA4wAAADzCAIAAABCNA98AAAACXBIWXMAABYlAAAWJQFJUiTwAAAEM0lEQVR42u3ZMQ7CMAxA0Rg1W+5/0mSLZG5QwQImvDd3cN02+lLbnLMBAEAlkZm2AABAKQ8rAABApAIAgEgFAECkAgCASAUAQKQCAIBIBQBApAIAgEgFAACRCgCASAUAAJEKAIBIBQAAkQoAgEgFAACRCgCASAUAAJEKAAAiFQAAkQoAACIVAACRCgAAIhUAAJEKAAAiFQAARCoAACIVAABEKgAAIhUAAEQqAAAiFQAARCoAACIVAABEKgAAiFQAAEQqAACIVAAARCoAAIhUAABEKgAAiFQAABCpAACIVAAAEKkAAIhUAAAQqQAAiFQAABCpAACIVAAAEKkAACBSAQAQqQAAIFIBABCpAAAgUgEAEKkAACBSAQBApAIAIFIBAECkAgAgUgEAQKQCACBSAQBApAIAIFIBAECkAgCASAUAQKQCAIBIBQBApAIAgEgFAECkAgCASAUAAJEKAIBIBQAAkQoAgEgFAACRCgCASAUAAJEKAIBIBQAAkQoAACIVAACRCgAAIhUAAJEKAAAiFQAAkQoAACIVAABEKgAAIhUAAEQqAAAiFQAARCoAACIVAABEKgAAIhUAAEQqAACIVAAARCoAAIhUAABEKgAAiFQAAEQqAACIVAAAEKkAAIhUAAAQqQAAiFQAABCpAACIVAAAEKkAAIhUAAAQqQAAIFIBABCpAAAgUgEAEKkAACBSAQAQqQAAIFIBAECkAgAgUgEAQKQCACBSAQBApAIAIFIBAECkAgAgUgEAQKQCAIBIBQBApAIAgEgFAECkAgCASAUAQKQCAIBIBQBApAIAgEgFAACRCgCASAUAAJEKAIBIBQAAkQoAgEgFAACRCgAAIhUAAJEKAAAiFQAAkQoAACIVAACRCgAAIhUAAJEKAAAiFQAARCoAACIVAABEKgAAIhUAAEQqAAAiFQAARCoAAIhUAABEKgAAiFQAAEQqAACIVAAARCoAAIhUAABEKgAAiFQAABCpAACIVAAAEKkAAIhUAAAQqQAAiFQAABCpAAAgUgEAEKkAACBSAQAQqQAAIFIBABCpAAAgUgEAEKkAACBSAQBApAIAIFIBAECkAgAgUgEAQKQCACBSAQBApAIAgEgFAKCqywoAoLUWEWfcSGZ6mpzwSXqVAQCoxu9+AABEKgAAiFQAAEQqAACIVAAARCoAAIhUAABEKgAAiFQAABCpAACIVAAAEKkAAIhUAAAQqQAAiFQAABCpAACIVAAAEKkAACBSAQAQqQAAIFIBABCpAAAgUgEAEKkAACBSAQBApAIAIFIBAECkAgAgUgEAQKQCACBSAQBApAIAIFIBAECkAgCASAUAQKQCAIBIBQBApAIAgEgFAECkAgCASAUAAJEKAEBllxUAH7D37r3fXJCZNSePiK+PvdYaY7xyZdk1Arx9/DrRgP+pvd8d+34MkQqc5wlP+Ci51SbQpAAAAABJRU5ErkJggg=="/><div class="t m0 xc he y30 ff8 fs4 fc0 sc0 ls0 ws0">4<span class="_ _4c"> </span>Average<span class="_ _9"> </span>Case<span class="_ _a"> </span>Analysis<span class="_ _9"> </span>of<span class="_ _9"> </span>Dual-Pivot<span class="_ _9"> </span>Quicksort</div><div class="t m28 x26 hd y31 ff5 fs4 fc0 sc0 ls0 ws0">In<span class="_ _a"> </span>addition<span class="_ _a"> </span>to<span class="_ _a"> </span>the<span class="_ _a"> </span>deepened<span class="_ _a"> </span>understanding<span class="_ _a"> </span>of<span class="_ _4"> </span>Algorithm<span class="_ _a"> </span><span class="ff6">7</span>,<span class="_ _a"> </span>Lemma<span class="_ _a"> </span><span class="ff6">4</span>.<span class="ff6">8<span class="_ _a"> </span></span>also</div><div class="t m0 xc hd y32 ff5 fs4 fc0 sc0 ls0 ws0">allo<span class="_ _20"></span>ws<span class="_ _a"> </span>to<span class="_ _a"> </span>compute<span class="_ _4"> </span>the<span class="_ _9"> </span>expected<span class="_ _a"> </span>value<span class="_ _9"> </span>of<span class="_ _a"> </span><span class="ffa">χ</span>:</div><div class="t m0 xc h3 yf6d ff1 fs1 fc0 sc0 ls0 ws0">Proposition 4.9:<span class="_ _4c"> </span><span class="ff8 fs4">For<span class="_ _9"> </span>the<span class="_ _a"> </span>crossing<span class="_ _9"> </span>point<span class="_ _9"> </span><span class="ffa">χ<span class="_ _9"> </span></span>of<span class="_ _9"> </span><span class="ffa">i<span class="_ _a"> </span></span>and<span class="_ _9"> </span><span class="ffa">j<span class="_ _9"> </span></span>holds</span></div><div class="t m0 x1ca h1f yf6e ff13 fs4 fc0 sc0 ls0 ws0">E</div><div class="t m0 x105 h10 yf6f ffb fs4 fc0 sc0 ls0 ws0">[</div><div class="t m0 x97 he yf6e ffa fs4 fc0 sc0 ls0 ws0">χ<span class="_ _9"> </span><span class="ff11">|<span class="_ _a"> </span></span>p<span class="ff5">,<span class="_ _5"> </span></span>q</div><div class="t m0 x178 h10 yf6f ffb fs4 fc0 sc0 ls0 ws0">]</div><div class="t m0 x192 h10 yf6e ffb fs4 fc0 sc0 ls0 ws0">=<span class="_ _9"> </span><span class="ffa">p<span class="_ _31"> </span></span>+<span class="_ _3c"> </span><span class="ffa">1<span class="_ _34"> </span></span>+<span class="_ _21"> </span>(<span class="ffa">q<span class="_ _3c"> </span></span>−<span class="_ _31"> </span><span class="ffa">p<span class="_ _31"> </span></span>−<span class="_ _31"> </span><span class="ffa">1</span>)</div><div class="t m0 x36 hf yf70 ffa fs6 fc0 sc0 ls0 ws0">p</div><div class="t m0 x156 h1d yf71 ffa fs6 fc0 sc0 ls0 ws0">p<span class="ffb">+</span>n<span class="ffb">−</span>q</div><div class="t m0 x85 hd yf6e ff5 fs4 fc0 sc0 ls0 ws0">,</div><div class="t m0 xb3 h10 yf72 ff13 fs4 fc0 sc0 ls0 ws0">E<span class="_ _31"> </span><span class="ffa">χ<span class="_ _a"> </span><span class="ffb">=</span></span></div><div class="t m0 x60 hf yf73 ffa fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x60 hf yf74 ffa fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 x14c h10 yf72 ffa fs4 fc0 sc0 ls0 ws0">n<span class="_ _31"> </span><span class="ffb">+</span></div><div class="t m0 x147 hf yf73 ffa fs6 fc0 sc0 ls0 ws0">3</div><div class="t m0 x147 hf yf74 ffa fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 x18d h10 yf72 ffb fs4 fc0 sc0 ls0 ws0">−</div><div class="t m0 x86 hf yf73 ffa fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x185 hf yf74 ffa fs6 fc0 sc0 ls0 ws0">n</div><div class="t m0 x13b hd yf72 ff5 fs4 fc0 sc0 ls0 ws0">.</div><div class="t m0 xc h9 yf75 ff7 fs4 fc0 sc0 ls0 ws0">Proof.</div><div class="t m2 x1a hd yf75 ff5 fs4 fc0 sc0 ls0 ws0">By<span class="_ _8"> </span>Lemma<span class="_ _8"> </span><span class="ff6">4</span>.<span class="ff6">8</span>,<span class="_ _8"> </span>w<span class="_ _20"></span>e<span class="_ _8"> </span>know</div><div class="t m0 x18b h10 yf75 ffa fs4 fc0 sc0 ls0 ws0">χ<span class="_ _34"> </span><span class="ffb">=<span class="_ _34"> </span></span>p<span class="_ _9"> </span><span class="ffb">+<span class="_ _3c"> </span></span>1<span class="_ _9"> </span><span class="ffb">+<span class="_ _3c"> </span></span>µ</div><div class="t m2 x150 hd yf75 ff5 fs4 fc0 sc0 ls0 ws0">for</div><div class="t m0 x1c h6 yf75 ffa fs4 fc0 sc0 ls0 ws0">µ</div><div class="t m2 x6f hd yf75 ff5 fs4 fc0 sc0 ls0 ws0">the<span class="_ _8"> </span>number<span class="_ _8"> </span>of</div><div class="t m0 x1ef h6 yf75 ffa fs4 fc0 sc0 ls0 ws0">m</div><div class="t m2 xda hd yf75 ff5 fs4 fc0 sc0 ls0 ws0">-type</div><div class="t m4 xc hd yf76 ff5 fs4 fc0 sc0 ls0 ws0">elements left<span class="_ _3c"> </span>of the</div><div class="t m0 xee h10 yf76 ffb fs4 fc0 sc0 ls0 ws0">(<span class="ffa">p<span class="_ _2"> </span></span>+<span class="_ _2"> </span><span class="ffa">1</span>)</div><div class="t m4 x130 hd yf76 ff5 fs4 fc0 sc0 ls0 ws0">st non-</div><div class="t m0 x1f1 h6 yf76 ffa fs4 fc0 sc0 ls0 ws0">m</div><div class="t m4 xb4 hd yf76 ff5 fs4 fc0 sc0 ls0 ws0">-element.<span class="_ _0"> </span>Assume no<span class="_ _20"></span>w<span class="_ _33"></span>,</div><div class="t m0 x171 h6 yf76 ffa fs4 fc0 sc0 ls0 ws0">A</div><div class="t m0 x87 hf yf77 ffa fs6 fc0 sc0 ls0 ws0">0</div><div class="t m4 x3a hd yf76 ff5 fs4 fc0 sc0 ls0 ws0">contains a<span class="_ _3c"> </span>random</div><div class="t m2 xc hd yf78 ff5 fs4 fc0 sc0 ls0 ws0">permutation<span class="_ _4"> </span>with<span class="_ _a"> </span>giv<span class="_ _20"></span>en<span class="_ _a"> </span>piv<span class="_ _20"></span>ots</div><div class="t m0 x120 h6 yf78 ffa fs4 fc0 sc0 ls0 ws0">p<span class="_ _a"> </span>&lt;<span class="_ _a"> </span>q</div><div class="t m2 x4d hd yf78 ff5 fs4 fc0 sc0 ls0 ws0">.<span class="_ _17"> </span>Then,<span class="_ _4"> </span>trivially<span class="_ _33"></span>,</div><div class="t m0 x1be h10 yf78 ffa fs4 fc0 sc0 ls0 ws0">0<span class="_ _a"> </span><span class="fff">6<span class="_ _a"> </span></span>µ<span class="_ _4"> </span><span class="fff">6<span class="_ _a"> </span><span class="ff11">|</span></span>M<span class="ff11">|<span class="_ _a"> </span><span class="ffb">=<span class="_ _a"> </span></span></span>q<span class="_ _3c"> </span><span class="ffb">−<span class="_ _31"> </span></span>p<span class="_ _3c"> </span><span class="ffb">−<span class="_ _31"> </span></span>1</div><div class="t m2 xce hd yf78 ff5 fs4 fc0 sc0 ls0 ws0">.</div><div class="t m0 xc hd yf79 ff5 fs4 fc0 sc0 ls0 ws0">By<span class="_ _a"> </span>linearity<span class="_ _a"> </span>of<span class="_ _a"> </span>the<span class="_ _a"> </span>expectation,<span class="_ _a"> </span><span class="ff13">E</span></div><div class="t m0 x211 h10 yf7a ffb fs4 fc0 sc0 ls0 ws0">[</div><div class="t m0 xb4 he yf79 ffa fs4 fc0 sc0 ls0 ws0">χ<span class="_ _9"> </span><span class="ff11">|<span class="_ _a"> </span></span>p<span class="ff5">,<span class="_ _5"> </span></span>q</div><div class="t m0 x110 h10 yf7a ffb fs4 fc0 sc0 ls0 ws0">]</div><div class="t m0 x86 h10 yf79 ffb fs4 fc0 sc0 ls0 ws0">=<span class="_ _9"> </span><span class="ffa">p<span class="_ _31"> </span></span>+<span class="_ _3c"> </span><span class="ffa">1<span class="_ _31"> </span></span>+<span class="_ _31"> </span><span class="ff13">E</span></div><div class="t m0 x102 h10 yf7a ffb fs4 fc0 sc0 ls0 ws0">[</div><div class="t m0 x121 he yf79 ffa fs4 fc0 sc0 ls0 ws0">µ<span class="_ _9"> </span><span class="ff11">|<span class="_ _a"> </span></span>p<span class="ff5">,<span class="_ _5"> </span></span>q</div><div class="t m0 x1b2 h10 yf7a ffb fs4 fc0 sc0 ls0 ws0">]</div><div class="t m0 x92 hd yf79 ff5 fs4 fc0 sc0 ls0 ws0">.</div><div class="t m2 x26 hd yf7b ff5 fs4 fc0 sc0 ls0 ws0">T<span class="_ _1a"></span>o<span class="_ _4"> </span>determine</div><div class="t m0 xa3 h1f yf7b ff13 fs4 fc0 sc0 ls0 ws0">E</div><div class="t m0 xbe h10 yf7c ffb fs4 fc0 sc0 ls0 ws0">[</div><div class="t m0 x1b6 he yf7b ffa fs4 fc0 sc0 ls0 ws0">µ<span class="_ _9"> </span><span class="ff11">|<span class="_ _a"> </span></span>p<span class="ff5">,<span class="_ _5"> </span></span>q</div><div class="t m0 x201 h10 yf7c ffb fs4 fc0 sc0 ls0 ws0">]</div><div class="t m2 x1c9 hd yf7b ff5 fs4 fc0 sc0 ls0 ws0">,<span class="_ _4"> </span>w<span class="_ _20"></span>e<span class="_ _4"> </span>imagine<span class="_ _4"> </span>the<span class="_ _4"> </span>follo<span class="_ _b"></span>wing<span class="_ _4"> </span>process<span class="_ _a"> </span>of<span class="_ _4"> </span>creating<span class="_ _4"> </span>all</div><div class="t m2 xc hd yf7d ff5 fs4 fc0 sc0 ls0 ws0">permutations<span class="_ _4"> </span>with<span class="_ _4"> </span>piv<span class="_ _20"></span>ots</div><div class="t m0 xac h6 yf7d ffa fs4 fc0 sc0 ls0 ws0">p</div><div class="t m2 x6a hd yf7d ff5 fs4 fc0 sc0 ls0 ws0">and</div><div class="t m0 x7 h6 yf7d ffa fs4 fc0 sc0 ls0 ws0">q</div><div class="t m2 x4a hd yf7d ff5 fs4 fc0 sc0 ls0 ws0">.<span class="_ _8"> </span>First,<span class="_ _4"> </span>take<span class="_ _4"> </span>the<span class="_ _a"> </span>elements<span class="_ _4"> </span>from</div><div class="t m0 x20 h6 yf7d ffa fs4 fc0 sc0 ls0 ws0">S</div><div class="t m2 x1cb hd yf7d ff5 fs4 fc0 sc0 ls0 ws0">and</div><div class="t m0 x199 h6 yf7d ffa fs4 fc0 sc0 ls0 ws0">L</div><div class="t m2 x115 hd yf7d ff5 fs4 fc0 sc0 ls0 ws0">and</div><div class="t m2 xc hd yf7e ff5 fs4 fc0 sc0 ls0 ws0">arrange<span class="_ _0"> </span>them<span class="_ _0"> </span>in<span class="_ _0"> </span>random<span class="_ _0"> </span>order<span class="_ _1a"></span>.<span class="_ _19"> </span>There<span class="_ _0"> </span>are</div><div class="t m0 x6b h9 yf7e ff5 fs4 fc0 sc0 ls0 ws0">#<span class="ff7">sl</span></div><div class="t m0 x5a h10 yf7f ffb fs4 fc0 sc0 ls0 ws0">:</div><div class="t m0 xf8 h1b yf7e ffb fs4 fc0 sc0 ls0 ws0">=<span class="_ _17"> </span><span class="ff11">|<span class="ffa">S<span class="_ _3c"> </span><span class="ff12">∪<span class="_ _3c"> </span></span>L</span>|<span class="_ _17"> </span></span>=<span class="_ _17"> </span><span class="ffa">p<span class="_ _3c"> </span></span>−<span class="_ _1"> </span><span class="ffa">1<span class="_ _3c"> </span></span>+<span class="_ _3c"> </span><span class="ffa">n<span class="_ _1"> </span></span>−<span class="_ _3c"> </span><span class="ffa">q</span></div><div class="t m2 x1b0 hd yf7e ff5 fs4 fc0 sc0 ls0 ws0">such</div><div class="t m2 xc hd yf80 ff5 fs4 fc0 sc0 ls0 ws0">elements<span class="_ _a"> </span>and</div><div class="t m0 x10 h10 yf80 ff5 fs4 fc0 sc0 ls0 ws0">#<span class="ff7">sl<span class="_ _31"> </span><span class="ffb">+<span class="_ _31"> </span><span class="ffa">1</span></span></span></div><div class="t m2 x73 hd yf80 ff5 fs4 fc0 sc0 ls0 ws0">differ<span class="_ _b"></span>ent<span class="_ _a"> </span>places,<span class="_ _a"> </span>where<span class="_ _a"> </span>insertions<span class="_ _a"> </span>are<span class="_ _9"> </span>possible<span class="_ _5"> </span>—<span class="_ _5"> </span>left<span class="_ _a"> </span>and</div><div class="t m2 xc hd yf81 ff5 fs4 fc0 sc0 ls0 ws0">right<span class="_ _8"> </span>of<span class="_ _8"> </span>the<span class="_ _8"> </span>elements<span class="_ _8"> </span>and<span class="_ _8"> </span>betw<span class="_ _3"></span>een<span class="_ _8"> </span>any<span class="_ _8"> </span>tw<span class="_ _20"></span>o.<span class="_ _2f"> </span>Now<span class="_ _33"></span>,<span class="_ _21"> </span>take<span class="_ _8"> </span>the<span class="_ _8"> </span>elements<span class="_ _8"> </span>fr<span class="_ _b"></span>om</div><div class="t m0 xc h6 yf82 ffa fs4 fc0 sc0 ls0 ws0">M</div><div class="t m2 x14a hd yf82 ff5 fs4 fc0 sc0 ls0 ws0">in<span class="_ _0"> </span>random<span class="_ _17"> </span>or<span class="_ _b"></span>der<span class="_ _0"> </span>and<span class="_ _17"> </span>choose<span class="_ _0"> </span>a</div><div class="t m0 x1bc h23 yf82 ffd fs4 fc0 sc0 ls0 ws0">multiset</div><div class="t m2 x11d hd yf82 ff5 fs4 fc0 sc0 ls0 ws0">of</div><div class="t m0 x5a h10 yf82 ff11 fs4 fc0 sc0 ls0 ws0">|<span class="ffa">M</span>|<span class="_ _17"> </span><span class="ffb">=<span class="_ _8"> </span><span class="ffa">q<span class="_ _3c"> </span></span>−<span class="_ _3c"> </span><span class="ffa">p<span class="_ _1"> </span></span>−<span class="_ _1"> </span><span class="ffa">1</span></span></div><div class="t m2 x153 hd yf82 ff5 fs4 fc0 sc0 ls0 ws0">insertion<span class="_ _0"> </span>slots</div><div class="t m2 xc hd yf83 ff5 fs4 fc0 sc0 ls0 ws0">among<span class="_ _17"> </span>the</div><div class="t m0 x166 h10 yf83 ff5 fs4 fc0 sc0 ls0 ws0">#<span class="ff7">sl<span class="_ _3c"> </span><span class="ffb">+<span class="_ _1"> </span><span class="ffa">1</span></span></span></div><div class="t m2 x5c hd yf83 ff5 fs4 fc0 sc0 ls0 ws0">ones.<span class="_ _14"> </span>Finally<span class="_ _33"></span>,<span class="_ _17"> </span>successiv<span class="_ _20"></span>ely<span class="_ _17"> </span>insert<span class="_ _17"> </span>the</div><div class="t m0 x12b h6 yf83 ffa fs4 fc0 sc0 ls0 ws0">m</div><div class="t m2 x1d7 hd yf83 ff5 fs4 fc0 sc0 ls0 ws0">-elements<span class="_ _17"> </span>into<span class="_ _17"> </span>the</div><div class="t m3 xc hd yf84 ff5 fs4 fc0 sc0 ls0 ws0">slots<span class="_ _a"> </span>corresponding<span class="_ _9"> </span>to<span class="_ _a"> </span>the<span class="_ _a"> </span>sorted<span class="_ _a"> </span>multiset.<span class="_ _17"> </span>After<span class="_ _a"> </span>each<span class="_ _a"> </span>insertion,<span class="_ _9"> </span>the<span class="_ _a"> </span>slot<span class="_ _a"> </span>mov<span class="_ _3"></span>es</div><div class="t m0 xc hd yf85 ffd fs4 fc0 sc0 ls0 ws0">behind<span class="_ _a"> </span><span class="ff5">the<span class="_ _a"> </span>newly<span class="_ _9"> </span>inserted<span class="_ _a"> </span>element.</span></div><div class="t m1f x26 hd yf86 ff5 fs4 fc0 sc0 ls0 ws0">The<span class="_ _a"> </span>process<span class="_ _9"> </span>is<span class="_ _a"> </span>probably<span class="_ _9"> </span>best<span class="_ _a"> </span>understood<span class="_ _a"> </span>via<span class="_ _a"> </span>an<span class="_ _a"> </span>example,<span class="_ _a"> </span>so<span class="_ _9"> </span>let<span class="_ _a"> </span>us<span class="_ _a"> </span>execute</div><div class="t m4 xc hd yf87 ff5 fs4 fc0 sc0 ls0 ws0">this construction once for</div><div class="t m0 x0 h10 yf87 ffa fs4 fc0 sc0 ls0 ws0">n<span class="_ _9"> </span><span class="ffb">=<span class="_ _a"> </span></span>9</div><div class="t m4 x10d hd yf87 ff5 fs4 fc0 sc0 ls0 ws0">,</div><div class="t m0 x145 h10 yf87 ffa fs4 fc0 sc0 ls0 ws0">p<span class="_ _9"> </span><span class="ffb">=<span class="_ _a"> </span></span>4</div><div class="t m4 x183 hd yf87 ff5 fs4 fc0 sc0 ls0 ws0">and</div><div class="t m0 x133 h10 yf87 ffa fs4 fc0 sc0 ls0 ws0">q<span class="_ _9"> </span><span class="ffb">=<span class="_ _a"> </span></span>8</div><div class="t m4 x5a hd yf87 ff5 fs4 fc0 sc0 ls0 ws0">.<span class="_ _0"> </span>W<span class="_ _1a"></span>e start with</div><div class="t m0 x17e h1b yf87 ffa fs4 fc0 sc0 ls0 ws0">S<span class="_ _2"> </span><span class="ff12">∪<span class="_ _5"></span></span>L<span class="_ _a"> </span><span class="ffb">=<span class="_ _9"> </span><span class="ff11">{</span></span>1</div><div class="t m4 x23 hd yf87 ff5 fs4 fc0 sc0 ls0 ws0">,</div><div class="t m0 x199 h6 yf87 ffa fs4 fc0 sc0 ls0 ws0">2</div><div class="t m4 x1b0 hd yf87 ff5 fs4 fc0 sc0 ls0 ws0">,</div><div class="t m0 x115 h6 yf87 ffa fs4 fc0 sc0 ls0 ws0">3</div><div class="t m4 xdb hd yf87 ff5 fs4 fc0 sc0 ls0 ws0">,</div><div class="t m0 x208 he yf87 ffa fs4 fc0 sc0 ls0 ws0">9<span class="ff11">}</span></div><div class="t m2 xc hd yf88 ff5 fs4 fc0 sc0 ls0 ws0">in<span class="_ _a"> </span>random<span class="_ _a"> </span>order:</div><div class="t m0 x1e6 h74 yf89 ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x1ca h6 yf88 ffa fs4 fc0 sc0 ls0 ws0">2</div><div class="t m0 x1b6 h74 yf89 ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 xe5 h6 yf88 ffa fs4 fc0 sc0 ls0 ws0">9</div><div class="t m0 x74 h74 yf89 ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x45 h6 yf88 ffa fs4 fc0 sc0 ls0 ws0">3</div><div class="t m0 x0 h74 yf89 ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x1ee h6 yf88 ffa fs4 fc0 sc0 ls0 ws0">1</div><div class="t m0 x8 h74 yf89 ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m2 x82 hd yf88 ff5 fs4 fc0 sc0 ls0 ws0">.<span class="_ _17"> </span>The</div><div class="t m0 x4a h10 yf88 ff5 fs4 fc0 sc0 ls0 ws0">#<span class="ff7">sl<span class="_ _a"> </span><span class="ffb">=<span class="_ _4"> </span><span class="ffa">4</span></span></span></div><div class="t m2 x86 hd yf88 ff5 fs4 fc0 sc0 ls0 ws0">elements<span class="_ _a"> </span>induce</div><div class="t m0 x39 h10 yf88 ff5 fs4 fc0 sc0 ls0 ws0">#<span class="ff7">sl<span class="_ _31"> </span><span class="ffb">+<span class="_ _3c"> </span><span class="ffa">1<span class="_ _a"> </span></span>=<span class="_ _4"> </span><span class="ffa">5</span></span></span></div><div class="t m2 x13a hd yf88 ff5 fs4 fc0 sc0 ls0 ws0">slots<span class="_ _a"> </span>for</div><div class="t m2 xc hd yf8a ff5 fs4 fc0 sc0 ls0 ws0">possible<span class="_ _a"> </span>insertions,<span class="_ _a"> </span>written<span class="_ _4"> </span>as</div><div class="t m0 x12 h74 yf8b ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m2 x198 hd yf8a ff5 fs4 fc0 sc0 ls0 ws0">.<span class="_ _17"> </span>Now<span class="_ _9"> </span>w<span class="_ _b"></span>e<span class="_ _a"> </span>choose<span class="_ _a"> </span>some<span class="_ _4"> </span>or<span class="_ _b"></span>der<span class="_ _a"> </span>for</div><div class="t m0 x20e h10 yf8a ffa fs4 fc0 sc0 ls0 ws0">M<span class="_ _a"> </span><span class="ffb">=<span class="_ _a"> </span><span class="ff11">{</span></span>5</div><div class="t m2 x1e9 hd yf8a ff5 fs4 fc0 sc0 ls0 ws0">,</div><div class="t m0 xcc h6 yf8a ffa fs4 fc0 sc0 ls0 ws0">6</div><div class="t m2 x1a4 hd yf8a ff5 fs4 fc0 sc0 ls0 ws0">,</div><div class="t m0 x209 he yf8a ffa fs4 fc0 sc0 ls0 ws0">7<span class="ff11">}</span></div><div class="t m2 x9e hd yf8a ff5 fs4 fc0 sc0 ls0 ws0">,</div><div class="t md xc hd yf8c ff5 fs4 fc0 sc0 ls0 ws0">sa<span class="_ _20"></span>y</div><div class="t m0 x1d3 h6 yf8c ffa fs4 fc0 sc0 ls0 ws0">5</div><div class="t md xe4 hd yf8c ff5 fs4 fc0 sc0 ls0 ws0">,</div><div class="t m0 x1a2 h6 yf8c ffa fs4 fc0 sc0 ls0 ws0">7</div><div class="t md x4f hd yf8c ff5 fs4 fc0 sc0 ls0 ws0">,</div><div class="t m0 x50 h6 yf8c ffa fs4 fc0 sc0 ls0 ws0">6</div><div class="t md x210 hd yf8c ff5 fs4 fc0 sc0 ls0 ws0">.<span class="_ _17"> </span>Then,<span class="_ _9"> </span>w<span class="_ _b"></span>e<span class="_ _a"> </span>choose<span class="_ _a"> </span>a<span class="_ _a"> </span>multiset<span class="_ _4"> </span>of<span class="_ _a"> </span>slots<span class="_ _a"> </span>with<span class="_ _a"> </span>cardinality</div><div class="t m0 x125 h10 yf8c ff11 fs4 fc0 sc0 ls0 ws0">|<span class="ffa">M</span>|<span class="_ _9"> </span><span class="ffb">=<span class="_ _a"> </span><span class="ffa">3</span></span></div><div class="t md x20c hd yf8c ff5 fs4 fc0 sc0 ls0 ws0">;<span class="_ _a"> </span>suppose</div><div class="t m2 xc hd yf8d ff5 fs4 fc0 sc0 ls0 ws0">w<span class="_ _20"></span>e<span class="_ _17"> </span>choose<span class="_ _8"> </span>the<span class="_ _17"> </span>second<span class="_ _17"> </span>slot<span class="_ _8"> </span>twice<span class="_ _17"> </span>and<span class="_ _17"> </span>the<span class="_ _8"> </span>last<span class="_ _17"> </span>one<span class="_ _17"> </span>once.<span class="_ _15"> </span>No<span class="_ _20"></span>w<span class="_ _1a"></span>,<span class="_ _8"> </span>all<span class="_ _8"> </span>necessary</div><div class="t m0 xc hd yf8e ff5 fs4 fc0 sc0 ls0 ws0">decisions<span class="_ _a"> </span>for<span class="_ _a"> </span>the<span class="_ _a"> </span>insertions<span class="_ _a"> </span>ha<span class="_ _20"></span>v<span class="_ _20"></span>e<span class="_ _a"> </span>been<span class="_ _a"> </span>taken:</div><div class="t m0 xd5 h74 yf8f ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x26 h6 yf90 ffa fs4 fc0 sc0 ls0 ws0">2</div><div class="t m0 x1b3 h74 yf8f ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x1a2 h6 yf90 ffa fs4 fc0 sc0 ls0 ws0">9</div><div class="t m0 x4f h74 yf8f ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x161 h6 yf90 ffa fs4 fc0 sc0 ls0 ws0">3</div><div class="t m0 xd7 h74 yf8f ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x1c0 h6 yf90 ffa fs4 fc0 sc0 ls0 ws0">1</div><div class="t m0 x4c h74 yf8f ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x15 h1b yf90 ff12 fs4 fc0 sc0 ls0 ws0">→</div><div class="t m0 x42 h74 yf8f ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x105 h6 yf90 ffa fs4 fc0 sc0 ls0 ws0">2<span class="_ _5"> </span><span class="ff17">5</span></div><div class="t m0 x81 h74 yf8f ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x130 h6 yf90 ffa fs4 fc0 sc0 ls0 ws0">9</div><div class="t m0 xac h74 yf8f ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x108 h6 yf90 ffa fs4 fc0 sc0 ls0 ws0">3</div><div class="t m0 x6 h74 yf8f ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x76 h6 yf90 ffa fs4 fc0 sc0 ls0 ws0">1</div><div class="t m0 x2 h74 yf8f ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 xb7 h1b yf90 ff12 fs4 fc0 sc0 ls0 ws0">→</div><div class="t m0 x4b h74 yf8f ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x1b9 h6 yf90 ffa fs4 fc0 sc0 ls0 ws0">2<span class="_ _5"> </span>5<span class="_ _5"> </span><span class="ff17">7</span></div><div class="t m0 x6c h74 yf8f ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x34 h6 yf90 ffa fs4 fc0 sc0 ls0 ws0">9</div><div class="t m0 xf8 h74 yf8f ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 xa6 h6 yf90 ffa fs4 fc0 sc0 ls0 ws0">3</div><div class="t m0 x126 h74 yf8f ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x204 h6 yf90 ffa fs4 fc0 sc0 ls0 ws0">1</div><div class="t m0 x38 h74 yf8f ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 xf6 h1b yf90 ff12 fs4 fc0 sc0 ls0 ws0">→</div><div class="t m0 x1b2 h74 yf8f ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x188 h6 yf90 ffa fs4 fc0 sc0 ls0 ws0">2<span class="_ _5"> </span>5<span class="_ _5"> </span>7</div><div class="t m0 xfb h74 yf8f ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x138 h6 yf90 ffa fs4 fc0 sc0 ls0 ws0">9</div><div class="t m0 x9c h74 yf8f ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x14 h6 yf90 ffa fs4 fc0 sc0 ls0 ws0">3</div><div class="t m0 x1ef h74 yf8f ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x94 h6 yf90 ffa fs4 fc0 sc0 ls0 ws0">1<span class="_ _5"> </span><span class="ff17">6</span></div><div class="t m0 x1b7 h74 yf8f ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m2 xc hd yf91 ff5 fs4 fc0 sc0 ls0 ws0">Note<span class="_ _0"> </span>that<span class="_ _0"> </span>throughout<span class="_ _0"> </span>the<span class="_ _0"> </span>process,<span class="_ _0"> </span>w<span class="_ _20"></span>e<span class="_ _0"> </span>ha<span class="_ _b"></span>v<span class="_ _20"></span>e</div><div class="t m0 x1aa h10 yf91 ff5 fs4 fc0 sc0 ls0 ws0">#<span class="ff7">sl<span class="_ _3c"> </span><span class="ffb">+<span class="_ _3c"> </span><span class="ffa">1</span></span></span></div><div class="t m2 x156 hd yf91 ff5 fs4 fc0 sc0 ls0 ws0">slots<span class="_ _0"> </span>and<span class="_ _0"> </span>that<span class="_ _0"> </span>the<span class="_ _0"> </span>relativ<span class="_ _20"></span>e</div><div class="t m2 xc hd yf92 ff5 fs4 fc0 sc0 ls0 ws0">order<span class="_ _0"> </span>among<span class="_ _17"> </span>the</div><div class="t m0 x64 h6 yf92 ffa fs4 fc0 sc0 ls0 ws0">m</div><div class="t m2 x67 hd yf92 ff5 fs4 fc0 sc0 ls0 ws0">-elements<span class="_ _17"> </span>is<span class="_ _0"> </span>preser<span class="_ _6"></span>v<span class="_ _20"></span>ed.<span class="_ _22"> </span>Finally<span class="_ _1a"></span>,<span class="_ _17"> </span>attach</div><div class="t m0 x1e4 h6 yf92 ffa fs4 fc0 sc0 ls0 ws0">p</div><div class="t m2 x111 hd yf92 ff5 fs4 fc0 sc0 ls0 ws0">and</div><div class="t m0 x3b h6 yf92 ffa fs4 fc0 sc0 ls0 ws0">q</div><div class="t m2 x1c5 hd yf92 ff5 fs4 fc0 sc0 ls0 ws0">at<span class="_ _17"> </span>begin-</div><div class="t m2 xc hd yf93 ff5 fs4 fc0 sc0 ls0 ws0">ning<span class="_ _a"> </span>and<span class="_ _a"> </span>end<span class="_ _5"> </span>—<span class="_ _5"> </span>again<span class="_ _4"> </span>in<span class="_ _a"> </span>random<span class="_ _a"> </span>order<span class="_ _1a"></span>.<span class="_ _8"> </span>For<span class="_ _a"> </span>example</div><div class="t m0 x36 h74 yf94 ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 xa1 h6 yf93 ffa fs4 fc0 sc0 ls0 ws0">2<span class="_ _5"> </span>5<span class="_ _5"> </span>7</div><div class="t m0 x1d7 h74 yf94 ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x1d8 h6 yf93 ffa fs4 fc0 sc0 ls0 ws0">9</div><div class="t m0 x92 h74 yf94 ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 xe3 h6 yf93 ffa fs4 fc0 sc0 ls0 ws0">3</div><div class="t m0 xca h74 yf94 ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x8a h6 yf93 ffa fs4 fc0 sc0 ls0 ws0">1<span class="_ _5"> </span>6</div><div class="t m0 xc1 h74 yf94 ff28 fs4 fc0 sc0 ls0 ws0"></div><div class="t m2 x1c5 hd yf93 ff5 fs4 fc0 sc0 ls0 ws0">becomes</div><div class="t m0 xc hd yf95 ffa fs4 fc0 sc0 ls0 ws0">8<span class="_ _31"> </span>2<span class="_ _5"> </span>5<span class="_ _5"> </span>7<span class="_ _5"> </span>9<span class="_ _5"> </span>3<span class="_ _5"> </span>1<span class="_ _5"> </span>6<span class="_ _31"> </span>4<span class="ff5">.</span></div><div class="t m2 x26 hd ye30 ff5 fs4 fc0 sc0 ls0 ws0">If<span class="_ _21"> </span>all<span class="_ _8"> </span>random<span class="_ _21"> </span>choices<span class="_ _21"> </span>are<span class="_ _8"> </span>done<span class="_ _21"> </span>uniformly<span class="_ _1a"></span>,<span class="_ _34"> </span>the<span class="_ _21"> </span>resulting<span class="_ _8"> </span>per<span class="_ _6"></span>mutation<span class="_ _21"> </span>is</div><div class="t m2 xc hd yd53 ff5 fs4 fc0 sc0 ls0 ws0">uniformly<span class="_ _8"> </span>distributed<span class="_ _17"> </span>among<span class="_ _17"> </span>all<span class="_ _17"> </span>with<span class="_ _8"> </span>piv<span class="_ _3"></span>ots</div><div class="t m0 x1b5 h6 yd53 ffa fs4 fc0 sc0 ls0 ws0">p</div><div class="t m2 xf0 hd yd53 ff5 fs4 fc0 sc0 ls0 ws0">and</div><div class="t m0 x2e h6 yd53 ffa fs4 fc0 sc0 ls0 ws0">q</div><div class="t m2 x11f hd yd53 ff5 fs4 fc0 sc0 ls0 ws0">:<span class="_ _19"> </span>W<span class="_ _3"></span>e<span class="_ _17"> </span>create<span class="_ _17"> </span>each<span class="_ _17"> </span>such</div><div class="t m2 xc hd y303 ff5 fs4 fc0 sc0 ls0 ws0">permutation<span class="_ _21"> </span>in<span class="_ _8"> </span>exactly<span class="_ _21"> </span>one<span class="_ _8"> </span>w<span class="_ _20"></span>a<span class="_ _20"></span>y<span class="_ _21"> </span>as<span class="_ _8"> </span>the<span class="_ _21"> </span>shuf<span class="_ _20"></span>ﬂe<span class="_ _21"> </span>of<span class="_ _8"> </span>elements<span class="_ _8"> </span>from</div><div class="t m0 x35 h1b y303 ffa fs4 fc0 sc0 ls0 ws0">S<span class="_ _1"> </span><span class="ff12">∪<span class="_ _9"> </span></span>L</div><div class="t m2 x115 hd y303 ff5 fs4 fc0 sc0 ls0 ws0">and</div><div class="t m0 xc hd y304 ff5 fs4 fc0 sc0 ls0 ws0">elements<span class="_ _a"> </span>from<span class="_ _9"> </span><span class="ffa">M</span>,<span class="_ _a"> </span>retaining<span class="_ _a"> </span>relativ<span class="_ _20"></span>e<span class="_ _a"> </span>order<span class="_ _1a"></span>.</div><div class="t m1f x26 hd y305 ff5 fs4 fc0 sc0 ls0 ws0">Recall<span class="_ _a"> </span>that</div><div class="t m0 x206 h6 y305 ffa fs4 fc0 sc0 ls0 ws0">µ</div><div class="t m1f x16 hd y305 ff5 fs4 fc0 sc0 ls0 ws0">is<span class="_ _a"> </span>the<span class="_ _9"> </span>number<span class="_ _a"> </span>of</div><div class="t m0 x19c h6 y305 ffa fs4 fc0 sc0 ls0 ws0">m</div><div class="t m1f x106 hd y305 ff5 fs4 fc0 sc0 ls0 ws0">-type<span class="_ _a"> </span>elements<span class="_ _9"> </span>left<span class="_ _a"> </span>of<span class="_ _a"> </span>the</div><div class="t m0 x17e h10 y305 ffb fs4 fc0 sc0 ls0 ws0">(<span class="ffa">p<span class="_ _31"> </span></span>+<span class="_ _31"> </span><span class="ffa">1</span>)</div><div class="t m1f x7b hd y305 ff5 fs4 fc0 sc0 ls0 ws0">st<span class="_ _a"> </span>non-</div><div class="t m0 x61 h6 y305 ffa fs4 fc0 sc0 ls0 ws0">m</div><div class="t m1f x9e hd y305 ff5 fs4 fc0 sc0 ls0 ws0">-</div><div class="t m16 xc hd y23b ff5 fs4 fc0 sc0 ls0 ws0">element.<span class="_ _0"> </span>The<span class="_ _a"> </span>abov<span class="_ _3"></span>e<span class="_ _a"> </span>process<span class="_ _a"> </span>rev<span class="_ _3"></span>eals<span class="_ _a"> </span>the<span class="_ _a"> </span>beha<span class="_ _b"></span>vior<span class="_ _a"> </span>of</div><div class="t m0 x8c h6 y23b ffa fs4 fc0 sc0 ls0 ws0">µ</div><div class="t m16 x1c hd y23b ff5 fs4 fc0 sc0 ls0 ws0">:<span class="_ _0"> </span>There<span class="_ _a"> </span>are<span class="_ _a"> </span>exactly</div><div class="t m0 xc6 h6 y23b ffa fs4 fc0 sc0 ls0 ws0">p</div><div class="t m16 xd2 hd y23b ff5 fs4 fc0 sc0 ls0 ws0">slots</div><div class="t m0 xc hb y11 ff6 fs4 fc0 sc0 ls0 ws0">94</div><a class="l" href="#pf40" data-dest-detail='[64,"XYZ",70.866,764.85,null]'><div class="d m1" style="border-style:none;position:absolute;left:599.723490px;bottom:1241.471183px;width:71.975000px;height:15.028000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf5e" data-dest-detail='[94,"XYZ",70.866,366.26,null]'><div class="d m1" style="border-style:none;position:absolute;left:729.034935px;bottom:1241.471183px;width:65.005000px;height:15.028000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf5e" data-dest-detail='[94,"XYZ",70.866,366.26,null]'><div class="d m1" style="border-style:none;position:absolute;left:214.450104px;bottom:1048.676580px;width:68.299000px;height:15.073000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.679893,0.000000,0.000000,1.679893,0.000000,0.000000]}'></div></div>
