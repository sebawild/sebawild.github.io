<div id="pfa5" class="pf w0 h0" data-page-no="a5"><div class="pc pca5 w0 h0"><img class="bi xc y10 w2 ha" alt="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA4wAAAABCAIAAAAabrduAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAHUlEQVRIx+3BMQEAAAzDoPrXGwGzsQNYNQAA+OQAdnsC3T923LwAAAAASUVORK5CYII="/><div class="t m0 x146 he y30 ff8 fs4 fc0 sc0 ls0 ws0">8.1.3<span class="_ _4c"> </span>Runtime<span class="_ _9"> </span>Measurement<span class="_ _a"> </span>Methodology</div><div class="t m0 xc h3 y1a2 ff1 fs1 fc0 sc0 ls0 ws0">8.1.3<span class="_ _22"> </span>Runtime Measurement Methodology</div><div class="t m2 xc hd y599 ff5 fs4 fc0 sc0 ls0 ws0">Measuring<span class="_ _17"> </span>running<span class="_ _0"> </span>times<span class="_ _17"> </span>of<span class="_ _17"> </span>programs<span class="_ _0"> </span>is<span class="_ _17"> </span>a<span class="_ _17"> </span>nuisance.<span class="_ _22"> </span>In<span class="_ _0"> </span>principle,<span class="_ _8"> </span>one<span class="_ _0"> </span>only</div><div class="t m15 xc hd y59a ff5 fs4 fc0 sc0 ls0 ws0">needs<span class="_ _a"> </span>to<span class="_ _a"> </span>recor<span class="_ _b"></span>d<span class="_ _a"> </span>time<span class="_ _a"> </span>before<span class="_ _9"> </span>and<span class="_ _a"> </span>after<span class="_ _a"> </span>a<span class="_ _a"> </span>run,<span class="_ _a"> </span>then<span class="_ _a"> </span>the<span class="_ _a"> </span>differ<span class="_ _b"></span>ence<span class="_ _a"> </span>is<span class="_ _a"> </span>the<span class="_ _a"> </span>running</div><div class="t m27 xc hd y59b ff5 fs4 fc0 sc0 ls0 ws0">time.<span class="_ _0"> </span>How<span class="_ _3"></span>ev<span class="_ _20"></span>er<span class="_ _3"></span>,<span class="_ _a"> </span>the<span class="_ _a"> </span>devil<span class="_ _a"> </span>is<span class="_ _a"> </span>in<span class="_ _a"> </span>the<span class="_ _a"> </span>detail.<span class="_ _17"> </span>The<span class="_ _a"> </span>ﬁrst<span class="_ _a"> </span>question<span class="_ _a"> </span>is<span class="_ _a"> </span>the<span class="_ _a"> </span>notion<span class="_ _4"> </span>of<span class="_ _a"> </span>time.</div><div class="t m7 xc h9 y59c ff5 fs4 fc0 sc0 ls0 ws0">W<span class="_ _1a"></span>e<span class="_ _a"> </span>ha<span class="_ _20"></span>v<span class="_ _20"></span>e<span class="_ _a"> </span><span class="ff7">wall<span class="_ _9"> </span>clock<span class="_ _a"> </span>time<span class="_ _5"> </span></span>—<span class="_ _5"> </span>the<span class="_ _9"> </span>actual<span class="_ _a"> </span>time<span class="_ _a"> </span>period<span class="_ _a"> </span>passed<span class="_ _a"> </span>according<span class="_ _9"> </span>to<span class="_ _a"> </span>the<span class="_ _a"> </span>clock</div><div class="t m5 xc h9 y59d ff5 fs4 fc0 sc0 ls0 ws0">attached<span class="_ _a"> </span>to<span class="_ _9"> </span>you<span class="_ _9"> </span>ofﬁce<span class="_ _9"> </span>w<span class="_ _b"></span>all<span class="_ _5"> </span>—<span class="_ _5"> </span>v<span class="_ _20"></span>ersus<span class="_ _a"> </span><span class="ff7">pr<span class="_ _b"></span>ocessor<span class="_ _9"> </span>time<span class="ff5">,<span class="_ _a"> </span>the<span class="_ _a"> </span>time<span class="_ _a"> </span>that<span class="_ _a"> </span>the<span class="_ _9"> </span>processor</span></span></div><div class="t m2 xc hd y59e ff5 fs4 fc0 sc0 ls0 ws0">actually<span class="_ _a"> </span>spent<span class="_ _a"> </span>executing</div><div class="t m0 x130 h23 y59e ffd fs4 fc0 sc0 ls0 ws0">your</div><div class="t m2 x1c3 hd y59e ff5 fs4 fc0 sc0 ls0 ws0">program.<span class="_ _17"> </span>I<span class="_ _a"> </span>measure<span class="_ _a"> </span>processor<span class="_ _a"> </span>time<span class="_ _a"> </span>to<span class="_ _a"> </span>alleviate</div><div class="t m0 xc hd y59f ff5 fs4 fc0 sc0 ls0 ws0">disturbances<span class="_ _a"> </span>b<span class="_ _20"></span>y<span class="_ _a"> </span>other<span class="_ _a"> </span>programs.</div><div class="t m3 x26 hd y5a0 ff5 fs4 fc0 sc0 ls0 ws0">The<span class="_ _a"> </span>next<span class="_ _a"> </span>task<span class="_ _a"> </span>is<span class="_ _a"> </span>to<span class="_ _a"> </span>ﬁnd<span class="_ _a"> </span>processor<span class="_ _9"> </span>timers<span class="_ _a"> </span>that<span class="_ _a"> </span>offer<span class="_ _a"> </span>suf<span class="_ _b"></span>ﬁcient<span class="_ _a"> </span>resolution<span class="_ _a"> </span>and</div><div class="t m2 xc hd y5a1 ff5 fs4 fc0 sc0 ls0 ws0">accuracy<span class="_ _33"></span>.<span class="_ _27"> </span>Sorting<span class="_ _17"> </span>a<span class="_ _8"> </span>single<span class="_ _17"> </span>list<span class="_ _17"> </span>for<span class="_ _17"> </span>the<span class="_ _17"> </span>considered<span class="_ _17"> </span>sizes<span class="_ _17"> </span>takes<span class="_ _17"> </span>betw<span class="_ _20"></span>een<span class="_ _8"> </span>a<span class="_ _17"> </span>fe<span class="_ _b"></span>w</div><div class="t m2 xc hd y5a3 ff5 fs4 fc0 sc0 ls0 ws0">and<span class="_ _4"> </span>a<span class="_ _0"> </span>few<span class="_ _4"> </span>hundred<span class="_ _0"> </span>milliseconds.<span class="_ _12"> </span>For<span class="_ _0"> </span>C</div><div class="t m0 x1d6 hd y1b9a ff5 fs4 fc0 sc0 ls0 ws0">++</div><div class="t m2 xff hd y5a3 ff5 fs4 fc0 sc0 ls0 ws0">,<span class="_ _0"> </span>I<span class="_ _0"> </span>used<span class="_ _4"> </span>the<span class="_ _0"> </span>Linux<span class="_ _4"> </span>runtime<span class="_ _0"> </span>librar<span class="_ _6"></span>y<span class="_ _33"></span>,</div><div class="t m2 xc hd y5a4 ff5 fs4 fc0 sc0 ls0 ws0">speciﬁcally<span class="_ _8"> </span>the<span class="_ _8"> </span>function</div><div class="t m0 xa5 h18 y5a4 ff9 fs4 fc0 sc0 ls0 ws0">clock_gettime(CLOCK_PROCESS_CPUTIME_ID,<span class="_ _12"> </span>&amp;res);</div><div class="t m18 xc hd y5a5 ff5 fs4 fc0 sc0 ls0 ws0">from</div><div class="t m0 x1da h18 y5a5 ff9 fs4 fc0 sc0 ls0 ws0">sys/time.h</div><div class="t m18 x16 hd y5a5 ff5 fs4 fc0 sc0 ls0 ws0">.<span class="_ _0"> </span>On<span class="_ _a"> </span>the<span class="_ _4"> </span>test<span class="_ _9"> </span>machine,<span class="_ _4"> </span>its<span class="_ _9"> </span>claims<span class="_ _a"> </span>to<span class="_ _4"> </span>ha<span class="_ _20"></span>v<span class="_ _20"></span>e<span class="_ _a"> </span>nanosecond<span class="_ _a"> </span>accuracy<span class="_ _33"></span>,</div><div class="t m25 xc hd y5a8 ff5 fs4 fc0 sc0 ls0 ws0">which<span class="_ _a"> </span>sounds<span class="_ _a"> </span>v<span class="_ _20"></span>er<span class="_ _6"></span>y<span class="_ _a"> </span>optimistic.<span class="_ _0"> </span>It<span class="_ _a"> </span>reported<span class="_ _a"> </span>reasonable<span class="_ _a"> </span>time<span class="_ _a"> </span>spans<span class="_ _a"> </span>in<span class="_ _a"> </span>a<span class="_ _a"> </span>small<span class="_ _a"> </span>test.</div><div class="t m2 x26 hd y5a9 ff5 fs4 fc0 sc0 ls0 ws0">For<span class="_ _17"> </span>Ja<span class="_ _20"></span>va,<span class="_ _17"> </span>I<span class="_ _17"> </span>could<span class="_ _17"> </span>not<span class="_ _17"> </span>ﬁnd<span class="_ _8"> </span>a<span class="_ _17"> </span>suitable<span class="_ _17"> </span>processor<span class="_ _0"> </span>timer<span class="_ _8"> </span>with<span class="_ _17"> </span>high<span class="_ _17"> </span>accuracy<span class="_ _a1"></span>.</div><div class="t m1c xc hd y5aa ff5 fs4 fc0 sc0 ls0 ws0">Ho<span class="_ _20"></span>w<span class="_ _b"></span>ev<span class="_ _3"></span>er<span class="_ _3"></span>,<span class="_ _a"> </span>the<span class="_ _a"> </span>function</div><div class="t m0 x113 h18 y5aa ff9 fs4 fc0 sc0 ls0 ws0">ManagementFactory.getThreadMXBean().getThreadCpu-</div><div class="t m0 xc hd y5ab ff9 fs4 fc0 sc0 ls0 ws0">Time(threadId)<span class="_ _a"> </span><span class="ff5">can<span class="_ _a"> </span>giv<span class="_ _20"></span>e<span class="_ _a"> </span>the<span class="_ _a"> </span>processor<span class="_ _a"> </span>time<span class="_ _a"> </span>of<span class="_ _a"> </span>a<span class="_ _a"> </span>giv<span class="_ _20"></span>en<span class="_ _a"> </span>thread<span class="_ _a"> </span>with<span class="_ _a"> </span><span class="ff6">10<span class="_ _5"> </span></span>ms<span class="_ _a"> </span>accu-</span></div><div class="t m27 xc hd y5ac ff5 fs4 fc0 sc0 ls0 ws0">racy<span class="_ _33"></span>.<span class="_ _0"> </span>S<span class="_ _6"></span>o,<span class="_ _a"> </span>I<span class="_ _4"> </span>repeat<span class="_ _9"> </span>ev<span class="_ _20"></span>er<span class="_ _6"></span>y<span class="_ _a"> </span>single<span class="_ _a"> </span>sorting<span class="_ _a"> </span>process<span class="_ _a"> </span>until<span class="_ _a"> </span>it<span class="_ _a"> </span>takes<span class="_ _a"> </span>some<span class="_ _a"> </span>seconds<span class="_ _a"> </span>to<span class="_ _4"> </span>run</div><div class="t m3 xc hd y5ad ff5 fs4 fc0 sc0 ls0 ws0">in<span class="_ _a"> </span>total<span class="_ _a"> </span>in<span class="_ _a"> </span>a<span class="_ _a"> </span>new<span class="_ _9"> </span>thread.<span class="_ _0"> </span>Then,<span class="_ _a"> </span>the<span class="_ _a"> </span>abov<span class="_ _3"></span>e<span class="_ _a"> </span>function<span class="_ _a"> </span>is<span class="_ _a"> </span>called<span class="_ _a"> </span>for<span class="_ _a"> </span>this<span class="_ _a"> </span>new<span class="_ _9"> </span>thread.</div><div class="t m1d xc hd y5ae ff5 fs4 fc0 sc0 ls0 ws0">For<span class="_ _a"> </span>time<span class="_ _a"> </span>spans<span class="_ _9"> </span>of<span class="_ _a"> </span>a<span class="_ _a"> </span>few<span class="_ _a"> </span>seconds,<span class="_ _a"> </span><span class="ff6">10<span class="_ _5"> </span></span>ms<span class="_ _a"> </span>accuracy<span class="_ _9"> </span>provides<span class="_ _9"> </span>measurements<span class="_ _a"> </span>with</div><div class="t m0 xc h1b y5af ff12 fs4 fc0 sc0 ls0 ws0">±</div><div class="t m4 xfd hd y5af ff6 fs4 fc0 sc0 ls0 ws0">1<span class="_ _5"> </span><span class="ff5">%<span class="_ _a"> </span>error<span class="_ _1a"></span>,<span class="_ _a"> </span>which<span class="_ _a"> </span>is<span class="_ _a"> </span>acceptable.<span class="_ _17"> </span>The<span class="_ _9"> </span>total<span class="_ _a"> </span>time<span class="_ _a"> </span>is<span class="_ _a"> </span>then<span class="_ _a"> </span>divided<span class="_ _a"> </span>b<span class="_ _20"></span>y<span class="_ _a"> </span>the<span class="_ _a"> </span>number<span class="_ _a"> </span>of</span></div><div class="t m21 xc hd y5b0 ff5 fs4 fc0 sc0 ls0 ws0">repetitions.<span class="_ _0"> </span>This<span class="_ _4"> </span>increases<span class="_ _a"> </span>the<span class="_ _a"> </span>o<span class="_ _b"></span>v<span class="_ _20"></span>erall<span class="_ _a"> </span>time<span class="_ _a"> </span>for<span class="_ _a"> </span>si<span class="_ _6"></span>mulations,<span class="_ _a"> </span>but<span class="_ _a"> </span>pro<span class="_ _20"></span>vides<span class="_ _4"> </span>reliable</div><div class="t m0 xc hd y5b1 ff5 fs4 fc0 sc0 ls0 ws0">measurements.</div><div class="t md xc hd y1b9b ff5 fs4 fc0 sc0 ls0 ws0">I<span class="_ _a"> </span>conducted<span class="_ _a"> </span>some<span class="_ _a"> </span>experiments<span class="_ _4"> </span>to<span class="_ _a"> </span>assess<span class="_ _a"> </span>the<span class="_ _a"> </span>quality<span class="_ _a"> </span>of<span class="_ _a"> </span>both<span class="_ _4"> </span>methods<span class="_ _a"> </span>of<span class="_ _a"> </span>runtime</div><div class="t m1d xc hd y1b9c ff5 fs4 fc0 sc0 ls0 ws0">measurements.<span class="_ _0"> </span>T<span class="_ _1a"></span>o<span class="_ _a"> </span>this<span class="_ _a"> </span>end,<span class="_ _a"> </span>I<span class="_ _a"> </span>ran<span class="_ _a"> </span>the<span class="_ _9"> </span>same<span class="_ _a"> </span>algorithm<span class="_ _a"> </span>on<span class="_ _a"> </span>the<span class="_ _a"> </span>same<span class="_ _a"> </span>input<span class="_ _a"> </span>many</div><div class="t m0 xc hd y1b9d ff5 fs4 fc0 sc0 ls0 ws0">times<span class="_ _a"> </span>and<span class="_ _a"> </span>recorded<span class="_ _9"> </span>ev<span class="_ _20"></span>ery<span class="_ _a"> </span>single<span class="_ _a"> </span>running<span class="_ _a"> </span>tim<span class="_ _6"></span>e.<span class="_ _0"> </span>In<span class="_ _a"> </span>a<span class="_ _a"> </span>perfect<span class="_ _a"> </span>environment,<span class="_ _a"> </span>ev<span class="_ _20"></span>ery</div><div class="t m2 xc hd y1b9e ff5 fs4 fc0 sc0 ls0 ws0">such<span class="_ _4"> </span>run<span class="_ _4"> </span>should<span class="_ _4"> </span>take<span class="_ _4"> </span>exactly<span class="_ _4"> </span>the<span class="_ _4"> </span>same<span class="_ _a"> </span>time<span class="_ _4"> </span>and<span class="_ _4"> </span>the<span class="_ _4"> </span>variance<span class="_ _a"> </span>should<span class="_ _4"> </span>be<span class="_ _4"> </span>zero.</div><div class="t m18 xc hd y1b9f ff5 fs4 fc0 sc0 ls0 ws0">The<span class="_ _a"> </span>actual<span class="_ _a"> </span>result<span class="_ _a"> </span>is<span class="_ _a"> </span>then<span class="_ _a"> </span>somewhat<span class="_ _9"> </span>disillusioning:<span class="_ _17"> </span>A<span class="_ _9"> </span>spread<span class="_ _a"> </span>of<span class="_ _a"> </span>about</div><div class="t m0 x9c h1b y1b9f ff12 fs4 fc0 sc0 ls0 ws0">±</div><div class="t m18 x17a hd y1b9f ff6 fs4 fc0 sc0 ls0 ws0">2<span class="_ _5"> </span><span class="ff5">%<span class="_ _a"> </span>w<span class="_ _20"></span>as</span></div><div class="t m14 xc hd y1ba0 ff5 fs4 fc0 sc0 ls0 ws0">observ<span class="_ _b"></span>ed<span class="_ _a"> </span>repeatedly<span class="_ _a1"></span>.<span class="_ _17"> </span>Moreo<span class="_ _20"></span>v<span class="_ _20"></span>er<span class="_ _3"></span>,<span class="_ _a"> </span>a<span class="_ _a"> </span>typical<span class="_ _9"> </span>measurement<span class="_ _a"> </span>contains<span class="_ _a"> </span>a<span class="_ _a"> </span>few<span class="_ _9"> </span>outliers</div><div class="t m7 xc hd y1ba1 ff5 fs4 fc0 sc0 ls0 ws0">that<span class="_ _a"> </span>took<span class="_ _9"> </span>much<span class="_ _a"> </span>more<span class="_ _a"> </span>time<span class="_ _a"> </span>than<span class="_ _a"> </span>the<span class="_ _9"> </span>rest.<span class="_ _17"> </span>Presumably<span class="_ _9"> </span>those<span class="_ _a"> </span>outliers<span class="_ _a"> </span>are<span class="_ _9"> </span>due<span class="_ _a"> </span>to</div><div class="t m0 xc hd y1ba2 ff5 fs4 fc0 sc0 ls0 ws0">interferences<span class="_ _a"> </span>of<span class="_ _a"> </span>task<span class="_ _a"> </span>switches<span class="_ _a"> </span>and<span class="_ _a"> </span>interrupts<span class="_ _a"> </span>b<span class="_ _20"></span>y<span class="_ _a"> </span>other<span class="_ _a"> </span>processes.</div><div class="t m4 x26 hd y1ba3 ff5 fs4 fc0 sc0 ls0 ws0">This<span class="_ _9"> </span>liability<span class="_ _9"> </span>of<span class="_ _a"> </span>runtime<span class="_ _9"> </span>measurements<span class="_ _9"> </span>to<span class="_ _a"> </span>noise<span class="_ _9"> </span>should<span class="_ _9"> </span>be<span class="_ _a"> </span>taken<span class="_ _9"> </span>into<span class="_ _9"> </span>account</div><div class="t m2 xc hd y1ba4 ff5 fs4 fc0 sc0 ls0 ws0">when<span class="_ _0"> </span>inter<span class="_ _6"></span>preting<span class="_ _0"> </span>experimental<span class="_ _0"> </span>results.<span class="_ _1e"> </span>For<span class="_ _0"> </span>example,<span class="_ _17"> </span>the<span class="_ _0"> </span>actual<span class="_ _0"> </span>variance<span class="_ _0"> </span>in</div><div class="t m2 xc hd y1ba5 ff5 fs4 fc0 sc0 ls0 ws0">runtimes<span class="_ _17"> </span>due<span class="_ _8"> </span>to<span class="_ _17"> </span>differ<span class="_ _b"></span>ent<span class="_ _17"> </span>lists<span class="_ _8"> </span>of<span class="_ _17"> </span>the<span class="_ _17"> </span>same<span class="_ _8"> </span>size<span class="_ _17"> </span>is<span class="_ _17"> </span>most<span class="_ _8"> </span>probably<span class="_ _17"> </span>buried<span class="_ _17"> </span>b<span class="_ _b"></span>y</div><div class="t m19 xc hd y1ba6 ff5 fs4 fc0 sc0 ls0 ws0">measurement<span class="_ _9"> </span>noise.<span class="_ _17"> </span>Ho<span class="_ _20"></span>w<span class="_ _20"></span>ev<span class="_ _20"></span>er<span class="_ _3"></span>,<span class="_ _9"> </span>the<span class="_ _a"> </span>sample<span class="_ _a"> </span>mean<span class="_ _a"> </span>pro<span class="_ _20"></span>vides<span class="_ _a"> </span>a<span class="_ _a"> </span>usable<span class="_ _a"> </span>estimate<span class="_ _9"> </span>of</div><div class="t m0 xc hd y1ba7 ff5 fs4 fc0 sc0 ls0 ws0">the<span class="_ _a"> </span>actual<span class="_ _a"> </span>expected<span class="_ _a"> </span>runtime.</div><div class="t m0 x1ec hb y11 ff6 fs4 fc0 sc0 ls0 ws0">163</div></div><div class="pi" data-data='{"ctm":[1.679893,0.000000,0.000000,1.679893,0.000000,0.000000]}'></div></div>
