<div id="pf6" class="pf w0 h0" data-page-no="6"><div class="pc pc6 w0 h0"><img class="bi x23 y102 w5 h13" alt="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkYAAAMrCAIAAAAjosoLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAJxklEQVR42u3YwQnCQBRFUb9OKrAZ+1/ZjB1EnltXYSBoxvGcrQPiC/GSVJITv6yqOk+Of637f8sh3Cww+n+IuxSAOZxNAICkAYCkAYCkAYCkASBpACBpACBpACBpAEgaAEgaAEgaAEgaAEgaAJIGAJIGAJIGAJIGgKQBgKQBgKQBgKQBIGkAIGkAIGkAIGkAIGkASBoASBoASBoASBoAkgYAkgYAkgYAkgaApAGApAGApAGApAGApAEgaQAgaQAgaQAgaQBIGgBIGgBIGgBIGgBIGgCSBgCSBgCSBgCSBoCkAYCkAYCkAYCkASBpACBpACBpACBpACBpAEgaAEgaAEgaAEgaAJIGAJIGAJIGAJIGgKQBgKQBgKQBgKQBgKQBIGkAIGkAIGkAIGkASBoASBoASBoASBoASBoAkgYAkgYAkgYAkgaApAGApAGApAGApAEgaQAgaQAgaQAgaQAgaQBIGgBIGgBIGgBIGgCSBgCSBgCSBgCSBoCkAYCkAYCkAYCkAYCkASBpACBpACBpACBpAEgaAEgaAEgaAOzTTADAyKqq92QSewEwAS8eAZA0AJA0AJA0AJA0ACQNACQNACQNACQNAEkDAEkDAEkDAEkDAEkDQNIAQNIAQNIAQNIAkDQAkDQAkDQAkDQAJA0AJA0AJA0AJA0AJA0ASQMASQMASQMASQNA0gBA0gBA0gBA0gCQNBMAIGkAIGkAIGkAIGkASBoASBoASBoASBoAkgYAkgYAkgYAkgYAkgaApAGApAGApAGApAEgaQAgaQAgaQAgaQBIGgBIGgBIGgBIGgBIGgCSBgCSBgCSBgCSBoCkAYCkAYCkAYCkASBpACBpACBpACBpACBpAEgaAEgaAEgaAEgaAJIGAJIGAJIGAJIGAJIGgKQBgKQBgKQBgKQBIGkAIGkAIGkAIGkASBoASBoASBoASBoASBoAkgYAkgYAkgYAkgaApAGApAGApAGApAEgaQAgaQAgaQAgaQAgaQBIGgBIGgBIGgBIGgCSBgCSBgCSBgCSBgCSBoCkAYCkAYCkAYCkASBpACBpACBpACBpAEgaAEgaAEgaAEgaAEgaAJIGAJIGAJIGAJIGgKQBgKQBgKQBgKQBIGkAIGkAIGkAIGkAIGkASBoASBoASBoASBoAkgYAkgYAkgYAkgYAkgaApAGApAGApAGApAEgaQAgaQAgaQAgaQBIGgBIGgBIGgBIGgBIGgCSBgCSBgCSBgCSBoCkAYCkAYCkAYCkASBpACBpACBpACBpACBpAEgaAEgaAEgaAEgaAJIGAJIGAJIGAJIGAJIGgKQBgKQBgKQBgKQBIGkAIGkAIGkAIGkASBoASBoASBoASBoASBoAkgYAkgYAkgYAkgaApAGApAGApAGApAEgaQAgaQAgaQAgaQAgaQBIGgBIGgBIGgBIGgCSBgCSBgCSBgCSBgCSBoCkAYCkAYCkAYCkASBpACBpACBpACBpAEgaAEgaAEgaAEgaAEgaAJIGAJIGAJIGAJIGgKQBgKQBgKQBgKQBIGkAIGkAIGkAIGkAIGkASBoASBoASBoASBoAkgYAkgYAkgYAkgYAkgaApAGApAGApAGApAEgaQAgaQAgaQAgaQBIGgBIGgAcqj3v109/x+X2MDQAntIAQNIAkDQAkDQAkDQAkDQAkDQAJA0AJA0AJA0AJA0ASQMASQMASQMASQNA0gBA0gBA0gBA0gBA0gCQNACQNACQNACQNAAkDQAkDQAkDQAkDYD/VUmsAICnNACQNACQNACQNAAkDQAkDQAkDQAkDQBJAwBJAwBJAwBJAwBJA0DSAEDSAEDSAEDSAJA0AJA0AJA0AJA0ACQNACQNACQNACQNACQNAEkDAEkDAEkDAEkDQNIAQNIAQNIAQNIAkDQAkDQAkDQAkDQAkDQAJA0AJA0AJA0AJA0ASQMASQMASQMASQMASQNA0gBA0gBA0gBA0gCQNACQNACQNACQNAAkDQAkDQAkDQAkDQAkDQBJAwBJAwBJAwBJA0DSAEDSAEDSAEDSAJA0AJA0AJA0AJA0AJA0ACQNACQNACQNACQNAEkDAEkDAEkDAEkDAEkDQNIAQNIAQNIAQNIAkDQAkDQAkDQAkDQAJA0AJA0AJA0AJA0AJA0ASQMASQMASQMASQNA0gBA0gBA0gBA0gCQNACQNACQNACQNACQNAAkDQAkDQAkDQAkDQBJAwBJAwBJAwBJAwBJA0DSAEDSAEDSAEDSAJA0AJA0AJA0AJA0ACQNACQNACQNACQNACQNAEkDAEkDAEkDAEkDQNIAQNIAQNIAQNIAkDQAkDQAkDQAkDQAkDQAJA0AJA0AJA0AJA0ASQMASQMASQMASQNA0kwAgKQBgKQBgKQBgKQBIGkAIGkAIGkAIGkASBoASBoASBoASBoASBoAkgYAkgYAkgYAkgaApAGApAGApAGApAEgaQAgaQAgaQAgaQAgaQBIGgBIGgBIGgBIGgCSBgCSBgCSBgCSBoCkAYCkAYCkAYCkAYCkASBpACBpACBpACBpAEgaAEgaAEgaAEgaAEgaAJIGAJIGAJIGAJIGgKQBgKQBgKQBgKQBIGkAIGkAIGkAIGkAIGkASBoASBoASBoASBoAkgYAkgYAkgYAkgaApAGApAGApAGApAGApAEgaQAgaQAgaQAgaQBIGgBIGgBIGgBIGgBIGgCSBgCSBgCSBgCSBsD0mgkA9quqjU+TmOgbV8HQAMzBi0cAJA0AJA0AJA0AJA0ASQMASQMASQMASQNA0gBA0gBA0gBA0gBA0gCQNACQNACQNACQNAAkDQAkDQAkDQAkDQBJAwBJAwBJAwBJAwBJA0DSAEDSAEDSAEDSAJA0AJA0AJA0AJA0ACTNBABIGgBIGgBIGgBIGgCSBgCSBgCSBgCSBoCkAYCkAYCkAYCkAYCkASBpACBpACBpACBpAEgaAEgaAEgaAEgaAJIGAJIGAJIGAJIGAJIGgKQBgKQBgKQBgKQBIGkAIGkAIGkAIGkASBoASBoASBoASBoASBoAkgYAkgYAkgYAkgaApAGApAGApAGApAGApAEgaQAgaQAgaQAgaQBIGgBIGgBIGgBIGgCSBgCSBgCSBgCSBgCSBoCkAYCkAYCkAYCkASBpACBpACBpACBpAEgaAEgaAEgaAEgaAEgaAJIGAJIGAJIGAJIGgKQBgKQBgKQBgKQBgKQBIGkAIGkAIGkAIGkASBoASBoASBoASBoAkgYAkgYAkgYAkgYAkgaApAGApAGApAGApAEgaQAgaQAgaQAgaQBIGgBIGgBIGgBIGgBIGgCSBgCSBgCSBgC9mgl4t67rsiwbB5JYCRjTCyCGJ04eMOzeAAAAAElFTkSuQmCC"/><div class="t m0 x24 h5 y2e ff1 fs3 fc1 sc0 ls0 ws0">XX<span class="fc0">:6<span class="_ _12"> </span>Entrop<span class="_ _0"></span>y<span class="_ _9"> </span>T<span class="_ _6"></span>rees<span class="_ _8"> </span>and<span class="_ _8"> </span>RMQ<span class="_ _8"> </span>In<span class="_ _9"> </span>Optimal<span class="_ _8"> </span>Average-Case<span class="_ _b"> </span>Space</span></div><div class="t m1 x23 h6 y2f ff3 fs4 fc0 sc0 ls0 ws0">starting<span class="_ _5"> </span>index<span class="_ _b"> </span>within<span class="_ _5"> </span>its<span class="_ _b"> </span>block.<span class="_ _3"> </span>The<span class="_ _5"> </span>space<span class="_ _5"> </span>for<span class="_ _b"> </span>this<span class="_ _5"> </span>is</div><div class="t m0 x3e h6 y2f ff5 fs4 fc0 sc0 ls0 ws0">m<span class="_ _e"> </span><span class="ff4">lg</span></div><div class="t m1 xe9 h6 y2f ff4 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 xd3 h6 y2f ff5 fs4 fc0 sc0 ls0 ws0">bS</div><div class="t m1 xc3 h6 y2f ff4 fs4 fc0 sc0 ls0 ws0">)<span class="ff3">:<span class="_ _3"> </span>w<span class="_ _0"></span>e<span class="_ _b"> </span>hav<span class="_ _0"></span>e<span class="_ _5"> </span>to<span class="_ _b"> </span>prepare<span class="_ _5"> </span>for<span class="_ _b"> </span>the</span></div><div class="t m0 x23 h6 y30 ff3 fs4 fc0 sc0 ls0 ws0">w<span class="_ _4"></span>orst<span class="_ _5"> </span>case<span class="_ _b"> </span>of<span class="_ _5"> </span>a<span class="_ _b"> </span>blo<span class="_ _7"></span>ck<span class="_ _5"> </span>full<span class="_ _5"> </span>of<span class="_ _b"> </span>maximal<span class="_ _5"> </span>ob<span class="_ _7"></span>jects.</div><div class="t m1 x25 h6 y32 ff3 fs4 fc0 sc0 ls0 ws0">It<span class="_ _9"> </span>remains<span class="_ _9"> </span>to<span class="_ _9"> </span>choose<span class="_ _3"> </span>the<span class="_ _8"> </span>blo<span class="_ _7"></span>ck<span class="_ _9"> </span>size;</div><div class="t m0 x1b h6 y32 ff5 fs4 fc0 sc0 ls0 ws0">b</div><div class="t m1 x9c h6 y32 ff4 fs4 fc0 sc0 ls0 ws0">=</div><div class="t m0 xb2 h6 y32 ff4 fs4 fc0 sc0 ls0 ws0">lg</div><div class="t m0 x118 h8 y103 fff fs5 fc0 sc0 ls0 ws0">2</div><div class="t m0 x101 h6 y32 ff5 fs4 fc0 sc0 ls0 ws0">n</div><div class="t m1 x3d h6 y32 ff3 fs4 fc0 sc0 ls0 ws0">yields<span class="_ _9"> </span>the<span class="_ _9"> </span>claimed<span class="_ _9"> </span>b<span class="_ _7"></span>ounds.<span class="_ _1a"> </span>Note<span class="_ _9"> </span>that</div><div class="t m0 x119 h6 y33 ff7 fs4 fc0 sc0 ls0 ws0">blo<span class="_ _0"></span>ckStart</div><div class="t m1 x4d h6 y33 ff3 fs4 fc0 sc0 ls0 ws0">is</div><div class="t m0 x11a h6 y33 ff5 fs4 fc0 sc0 ls0 ws0">o</div><div class="t m1 xe6 h6 y33 ff4 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 xaa h6 y33 ff5 fs4 fc0 sc0 ls0 ws0">n</div><div class="t m1 x11b h6 y33 ff4 fs4 fc0 sc0 ls0 ws0">)<span class="_ _9"> </span><span class="ff3">(for</span></div><div class="t m0 x11c h6 y33 ff5 fs4 fc0 sc0 ls0 ws0">b</div><div class="t m1 x11d h6 y33 ff4 fs4 fc0 sc0 ls0 ws0">=</div><div class="t m0 x29 h6 y33 ff5 fs4 fc0 sc0 ls0 ws0">ω</div><div class="t m1 x11e h6 y33 ff4 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x11f h6 y33 ff4 fs4 fc0 sc0 ls0 ws0">lg<span class="_ _e"> </span><span class="ff5">n/<span class="_ _f"></span></span>¯<span class="_ _1d"></span><span class="ff5">s</span></div><div class="t m1 x5c h6 y33 ff4 fs4 fc0 sc0 ls0 ws0">)<span class="ff3">),<span class="_ _3"> </span>but</span></div><div class="t m0 xb1 h6 y33 ff7 fs4 fc0 sc0 ls0 ws0">blo<span class="_ _0"></span>ckL<span class="_ _0"></span>o<span class="_ _0"></span>c<span class="_ _0"></span>alStart</div><div class="t m1 x120 h6 y33 ff3 fs4 fc0 sc0 ls0 ws0">has,<span class="_ _3"> </span>in<span class="_ _9"> </span>general,<span class="_ _3"> </span>non-negligible</div><div class="t m14 x23 h6 y34 ff3 fs4 fc0 sc0 ls0 ws0">space<span class="_ _5"> </span>ov<span class="_ _0"></span>erhead. The<span class="_ _5"> </span>error<span class="_ _5"> </span>term<span class="_ _b"> </span>only<span class="_ _b"> </span>comes<span class="_ _b"> </span>from<span class="_ _b"> </span>ignoring<span class="_ _b"> </span>ceilings<span class="_ _5"> </span>around<span class="_ _b"> </span>the<span class="_ _b"> </span>logarithms;<span class="_ _b"> </span>its</div><div class="t m0 x23 h6 y35 ff3 fs4 fc0 sc0 ls0 ws0">constan<span class="_ _4"></span>t<span class="_ _5"> </span>can<span class="_ _b"> </span>b<span class="_ _7"></span>e<span class="_ _5"> </span>b<span class="_ _7"></span>ounded<span class="_ _b"> </span>explicitly<span class="_ _6"></span>.<span class="_ _1e"> </span><span class="ff13 fc2">J</span></div><div class="t m0 x23 h7 y104 ff1 fs1 fc0 sc0 ls0 ws0">2.3<span class="_ _17"> </span>Comp<span class="_ _0"></span>ressed<span class="_ _3"> </span>piecewise-constant<span class="_ _3"> </span>a<span class="_ _0"></span>rrays</div><div class="t m2 x23 h6 y105 ff3 fs4 fc0 sc0 ls0 ws0">Let</div><div class="t m0 x97 h6 y105 ff5 fs4 fc0 sc0 ls0 ws0">A</div><div class="t m2 x121 h6 y105 ff4 fs4 fc0 sc0 ls0 ws0">[1</div><div class="t m0 x122 h6 y105 ff5 fs4 fc0 sc0 ls0 ws0">..n</div><div class="t m2 x123 h6 y105 ff4 fs4 fc0 sc0 ls0 ws0">] <span class="ff3">b<span class="_ _7"></span>e<span class="_ _5"> </span>a<span class="_ _a"> </span>static<span class="_ _5"> </span>array<span class="_ _a"> </span>of<span class="_ _a"> </span>ob<span class="_ _7"></span>jects<span class="_ _a"> </span>of<span class="_ _5"> </span>size</span></div><div class="t m0 xce h6 y105 ff5 fs4 fc0 sc0 ls0 ws0">w</div><div class="t m2 x124 h6 y105 ff3 fs4 fc0 sc0 ls0 ws0">bits<span class="_ _a"> </span>each.<span class="_ _9"> </span>The<span class="_ _5"> </span>only<span class="_ _a"> </span>op<span class="_ _7"></span>eration<span class="_ _5"> </span>is<span class="_ _a"> </span>the<span class="_ _5"> </span>standard</div><div class="t m2 x23 h6 y106 ff3 fs4 fc0 sc0 ls0 ws0">read-access</div><div class="t m0 x5a h6 y106 ff5 fs4 fc0 sc0 ls0 ws0">A</div><div class="t m2 x11a h6 y106 ff4 fs4 fc0 sc0 ls0 ws0">[</div><div class="t m0 xa9 h6 y106 ff5 fs4 fc0 sc0 ls0 ws0">i</div><div class="t m2 x125 h6 y106 ff4 fs4 fc0 sc0 ls0 ws0">]<span class="_ _a"> </span><span class="ff3">where</span></div><div class="t m0 x126 h6 y106 ff5 fs4 fc0 sc0 ls0 ws0">i<span class="_ _a"> </span><span class="ff8">∈</span></div><div class="t m2 x28 h6 y106 ff4 fs4 fc0 sc0 ls0 ws0">[</div><div class="t m0 xa5 h6 y106 ff5 fs4 fc0 sc0 ls0 ws0">n</div><div class="t m2 x127 h6 y106 ff4 fs4 fc0 sc0 ls0 ws0">]<span class="ff3">.<span class="_ _3"> </span>Let</span></div><div class="t m0 xb3 h6 y106 ff5 fs4 fc0 sc0 ls0 ws0">m</div><div class="t m2 xe4 h6 y106 ff3 fs4 fc0 sc0 ls0 ws0">b<span class="_ _7"></span>e<span class="_ _a"> </span>the<span class="_ _5"> </span>num<span class="_ _0"></span>b<span class="_ _7"></span>er<span class="_ _5"> </span>of<span class="_ _a"> </span>indices</div><div class="t m0 xc3 h6 y106 ff5 fs4 fc0 sc0 ls0 ws0">i</div><div class="t m2 x89 h6 y106 ff3 fs4 fc0 sc0 ls0 ws0">with</div><div class="t m0 x128 h6 y106 ff5 fs4 fc0 sc0 ls0 ws0">A</div><div class="t m2 xae h6 y106 ff4 fs4 fc0 sc0 ls0 ws0">[</div><div class="t m0 x129 h6 y106 ff5 fs4 fc0 sc0 ls0 ws0">i</div><div class="t m2 x12a h6 y106 ff4 fs4 fc0 sc0 ls0 ws0">]</div><div class="t m0 xb5 h6 y106 ff8 fs4 fc0 sc0 ls0 ws0">6</div><div class="t m2 xb5 h6 y106 ff4 fs4 fc0 sc0 ls0 ws0">=</div><div class="t m0 x27 h6 y106 ff5 fs4 fc0 sc0 ls0 ws0">A</div><div class="t m2 xee h6 y106 ff4 fs4 fc0 sc0 ls0 ws0">[</div><div class="t m0 xbc h6 y106 ff5 fs4 fc0 sc0 ls0 ws0">i<span class="_ _13"> </span><span class="ff8">−</span></div><div class="t m2 x5f h6 y106 ff4 fs4 fc0 sc0 ls0 ws0">1]<span class="ff3">,</span></div><div class="t m0 x12b h6 y106 ff3 fs4 fc0 sc0 ls0 ws0">i.<span class="_ _f"></span>e.</div><div class="t m2 xc5 h6 y106 ff3 fs4 fc0 sc0 ls0 ws0">,<span class="_ _5"> </span>the</div><div class="t m2 x23 h6 y107 ff3 fs4 fc0 sc0 ls0 ws0">n<span class="_ _4"></span>um<span class="_ _0"></span>b<span class="_ _7"></span>er<span class="_ _b"> </span>of<span class="_ _5"> </span>times<span class="_ _5"> </span>we<span class="_ _a"> </span>see<span class="_ _b"> </span>the<span class="_ _5"> </span>v<span class="_ _0"></span>alue<span class="_ _5"> </span>in</div><div class="t m0 x100 h6 y107 ff5 fs4 fc0 sc0 ls0 ws0">A</div><div class="t m2 x8a h6 y107 ff6 fs4 fc0 sc0 ls0 ws0">change<span class="_ _b"> </span><span class="ff3">in<span class="_ _5"> </span>a<span class="_ _5"> </span>sequential<span class="_ _5"> </span>scan.<span class="_ _3"> </span>W<span class="_ _6"></span>e<span class="_ _5"> </span>alw<span class="_ _0"></span>ays<span class="_ _5"> </span>coun<span class="_ _4"></span>t</span></div><div class="t m0 x12b h6 y107 ff5 fs4 fc0 sc0 ls0 ws0">i</div><div class="t m2 x6b h6 y107 ff4 fs4 fc0 sc0 ls0 ws0">= 1<span class="_ _5"> </span><span class="ff3">as</span></div><div class="t m20 x23 h6 y108 ff3 fs4 fc0 sc0 ls0 ws0">a<span class="_ _5"> </span>change,<span class="_ _5"> </span>so</div><div class="t m0 x12c h6 y108 ff5 fs4 fc0 sc0 ls0 ws0">m<span class="_ _a"> </span><span class="ff8">≥</span></div><div class="t m20 x39 h6 y108 ff4 fs4 fc0 sc0 ls0 ws0">1<span class="ff3">.<span class="_ _3"> </span>Bet<span class="_ _4"></span>w<span class="_ _0"></span>een<span class="_ _b"> </span>tw<span class="_ _0"></span>o<span class="_ _b"> </span>such<span class="_ _5"> </span>c<span class="_ _0"></span>hange<span class="_ _b"> </span>indices,<span class="_ _b"> </span>the<span class="_ _b"> </span>v<span class="_ _6"></span>alue<span class="_ _b"> </span>in</span></div><div class="t m0 x55 h6 y108 ff5 fs4 fc0 sc0 ls0 ws0">A</div><div class="t m20 x6e h6 y108 ff3 fs4 fc0 sc0 ls0 ws0">is<span class="_ _5"> </span>constant.<span class="_ _3"> </span>W<span class="_ _6"></span>e<span class="_ _5"> </span>hence</div><div class="t m0 x23 h6 y109 ff3 fs4 fc0 sc0 ls0 ws0">call<span class="_ _5"> </span>such<span class="_ _5"> </span>arrays<span class="_ _a"> </span>piecewise-constant<span class="_ _5"> </span>arrays.<span class="_ _9"> </span>W<span class="_ _6"></span>e<span class="_ _b"> </span>can<span class="_ _5"> </span>store<span class="_ _b"> </span>such<span class="_ _5"> </span>arra<span class="_ _4"></span>ys<span class="_ _5"> </span>in<span class="_ _b"> </span>compressed<span class="_ _5"> </span>form.</div><div class="t m0 x23 h11 y10a ff13 fs4 fc2 sc0 ls0 ws0">I<span class="_ _a"> </span><span class="ff1 fc0">Lemma<span class="_ _5"> </span>3</span></div><div class="t m2 x12c h12 y10a ff14 fs4 fc0 sc0 ls0 ws0">(Comp<span class="_ _4"></span>ressed<span class="_ _a"> </span>piecewise-constant<span class="_ _5"> </span>arra<span class="_ _0"></span>y)</div><div class="t m0 x21 h11 y10a ff1 fs4 fc0 sc0 ls0 ws0">.</div><div class="t m2 xbd h6 y10a ff6 fs4 fc0 sc0 ls0 ws0">L<span class="_ _0"></span>et</div><div class="t m0 x3f h6 y10a ff5 fs4 fc0 sc0 ls0 ws0">A</div><div class="t m2 x80 h6 y10a ff4 fs4 fc0 sc0 ls0 ws0">[1</div><div class="t m0 xe9 h6 y10a ff5 fs4 fc0 sc0 ls0 ws0">..n</div><div class="t m2 xd6 h6 y10a ff4 fs4 fc0 sc0 ls0 ws0">]<span class="_ _5"> </span><span class="ff6">b<span class="_ _0"></span>e<span class="_ _b"> </span>a<span class="_ _5"> </span>static<span class="_ _b"> </span>arr<span class="_ _0"></span>ay<span class="_ _b"> </span>with</span></div><div class="t m0 x12d h6 y10a ff5 fs4 fc0 sc0 ls0 ws0">m</div><div class="t m2 x12e h6 y10a ff6 fs4 fc0 sc0 ls0 ws0">value</div><div class="t m2 x119 h6 y10b ff6 fs4 fc0 sc0 ls0 ws0">changes.<span class="_ _3"> </span>Ther<span class="_ _0"></span>e<span class="_ _b"> </span>is<span class="_ _8"> </span>a<span class="_ _b"> </span>data<span class="_ _b"> </span>structur<span class="_ _0"></span>e<span class="_ _b"> </span>for<span class="_ _b"> </span>storing</div><div class="t m0 x67 h6 y10b ff5 fs4 fc0 sc0 ls0 ws0">A</div><div class="t m2 x78 h6 y10b ff6 fs4 fc0 sc0 ls0 ws0">that<span class="_ _b"> </span>al<span class="_ _f"></span>lows<span class="_ _b"> </span>c<span class="_ _4"></span>onstant-time<span class="_ _b"> </span>r<span class="_ _0"></span>e<span class="_ _0"></span>ad-ac<span class="_ _0"></span>c<span class="_ _0"></span>ess<span class="_ _b"> </span>to</div><div class="t m0 x52 h6 y10b ff5 fs4 fc0 sc0 ls0 ws0">A</div><div class="t m2 xc7 h6 y10b ff4 fs4 fc0 sc0 ls0 ws0">[</div><div class="t m0 x12f h6 y10b ff5 fs4 fc0 sc0 ls0 ws0">i</div><div class="t m2 xca h6 y10b ff4 fs4 fc0 sc0 ls0 ws0">]</div><div class="t m0 x119 h6 y10c ff6 fs4 fc0 sc0 ls0 ws0">using<span class="_ _b"> </span><span class="ff5">mw<span class="_ _14"> </span><span class="ff4">+<span class="_ _14"> </span></span>m<span class="_ _e"> </span><span class="ff4">lg</span></span></div><div class="t m0 xfe h8 y10d ffa fs5 fc0 sc0 ls0 ws0">n</div><div class="t m0 x130 h8 y10e ffa fs5 fc0 sc0 ls0 ws0">m</div><div class="t m0 x10f h6 y10c ff4 fs4 fc0 sc0 ls0 ws0">+<span class="_ _14"> </span><span class="ff5">O</span></div><div class="t m0 x131 hd y10f ff11 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 xff h8 y110 ffa fs5 fc0 sc0 ls0 ws0">n<span class="_ _13"> </span><span class="fff">lg<span class="_ _13"> </span>lg<span class="_ _13"> </span></span>n</div><div class="t m0 xa5 h8 y10e fff fs5 fc0 sc0 ls0 ws0">lg<span class="_ _13"> </span><span class="ffa">n</span></div><div class="t m0 xb9 h6 y10c ff4 fs4 fc0 sc0 ls0 ws0">+<span class="_ _14"> </span><span class="ff5">m</span></div><div class="t m0 x5c hd y10f ff11 fs4 fc0 sc0 ls0 ws0"></div><div class="t m0 x8a h6 y10c ff6 fs4 fc0 sc0 ls0 ws0">bits<span class="_ _b"> </span>of<span class="_ _8"> </span>sp<span class="_ _6"></span>ac<span class="_ _4"></span>e.</div><div class="t m0 x23 h11 y111 ff1 fs4 fc2 sc0 ls0 ws0">Pro<span class="_ _7"></span>of.</div><div class="t m2 x7b h6 y111 ff3 fs4 fc0 sc0 ls0 ws0">W<span class="_ _6"></span>e<span class="_ _5"> </span>store<span class="_ _5"> </span>an<span class="_ _5"> </span>array</div><div class="t m0 x28 h6 y111 ff5 fs4 fc0 sc0 ls0 ws0">V</div><div class="t m2 x29 h6 y111 ff4 fs4 fc0 sc0 ls0 ws0">[1</div><div class="t m0 x11e h6 y111 ff5 fs4 fc0 sc0 ls0 ws0">..m</div><div class="t m2 x62 h6 y111 ff4 fs4 fc0 sc0 ls0 ws0">]<span class="_ _5"> </span><span class="ff3">of<span class="_ _5"> </span>the<span class="_ _5"> </span>distinct<span class="_ _b"> </span>v<span class="_ _0"></span>alues<span class="_ _5"> </span>in<span class="_ _5"> </span>the<span class="_ _b"> </span>order<span class="_ _5"> </span>they<span class="_ _5"> </span>app<span class="_ _7"></span>ear<span class="_ _5"> </span>in</span></div><div class="t m0 x132 h6 y111 ff5 fs4 fc0 sc0 ls0 ws0">A</div><div class="t m2 x133 h6 y111 ff3 fs4 fc0 sc0 ls0 ws0">,<span class="_ _5"> </span>and<span class="_ _5"> </span>a</div><div class="t mb x23 h6 y112 ff3 fs4 fc0 sc0 ls0 ws0">bitv<span class="_ _4"></span>ector</div><div class="t m0 x134 h6 y112 ff5 fs4 fc0 sc0 ls0 ws0">C</div><div class="t mb x5a h6 y112 ff4 fs4 fc0 sc0 ls0 ws0">[1</div><div class="t m0 x11a h6 y112 ff5 fs4 fc0 sc0 ls0 ws0">..n</div><div class="t mb x135 h6 y112 ff4 fs4 fc0 sc0 ls0 ws0">]<span class="_ _5"> </span><span class="ff3">where</span></div><div class="t m0 xbf h6 y112 ff5 fs4 fc0 sc0 ls0 ws0">C</div><div class="t mb x136 h6 y112 ff4 fs4 fc0 sc0 ls0 ws0">[</div><div class="t m0 x54 h6 y112 ff5 fs4 fc0 sc0 ls0 ws0">i</div><div class="t mb x137 h6 y112 ff4 fs4 fc0 sc0 ls0 ws0">] = 1<span class="_ _5"> </span><span class="ff3">iﬀ</span></div><div class="t m0 x2f h6 y112 ff5 fs4 fc0 sc0 ls0 ws0">A</div><div class="t mb x3b h6 y112 ff4 fs4 fc0 sc0 ls0 ws0">[</div><div class="t m0 xe2 h6 y112 ff5 fs4 fc0 sc0 ls0 ws0">i</div><div class="t mb x138 h6 y112 ff4 fs4 fc0 sc0 ls0 ws0">]</div><div class="t m0 xe3 h6 y112 ff8 fs4 fc0 sc0 ls0 ws0">6</div><div class="t mb xe3 h6 y112 ff4 fs4 fc0 sc0 ls0 ws0">=</div><div class="t m0 xcd h6 y112 ff5 fs4 fc0 sc0 ls0 ws0">A</div><div class="t mb xdb h6 y112 ff4 fs4 fc0 sc0 ls0 ws0">[</div><div class="t m0 xce h6 y112 ff5 fs4 fc0 sc0 ls0 ws0">i<span class="_ _14"> </span><span class="ff8">−</span></div><div class="t mb x118 h6 y112 ff4 fs4 fc0 sc0 ls0 ws0">1]<span class="ff3">.<span class="_ _3"> </span>W<span class="_ _6"></span>e<span class="_ _5"> </span>alwa<span class="_ _0"></span>ys<span class="_ _5"> </span>set</span></div><div class="t m0 xd9 h6 y112 ff5 fs4 fc0 sc0 ls0 ws0">C</div><div class="t mb x9 h6 y112 ff4 fs4 fc0 sc0 ls0 ws0">[1] = 1<span class="ff3">.<span class="_ _3"> </span>Since</span></div><div class="t m0 x132 h6 y112 ff5 fs4 fc0 sc0 ls0 ws0">C</div><div class="t mb x139 h6 y112 ff3 fs4 fc0 sc0 ls0 ws0">has</div><div class="t m0 xc7 h6 y112 ff5 fs4 fc0 sc0 ls0 ws0">m</div><div class="t m2 x23 h6 y113 ff3 fs4 fc0 sc0 ls0 ws0">ones,<span class="_ _14"> </span>we<span class="_ _14"> </span>can<span class="_ _14"> </span>store<span class="_ _14"> </span>it<span class="_ _14"> </span>in<span class="_ _14"> </span>compressed<span class="_ _14"> </span>form<span class="_ _14"> </span>using<span class="_ _14"> </span>Lemma<span class="_ _14"> </span>1.<span class="_ _9"> </span>Then,</div><div class="t m0 x8e h6 y113 ff5 fs4 fc0 sc0 ls0 ws0">A</div><div class="t m2 x89 h6 y113 ff4 fs4 fc0 sc0 ls0 ws0">[</div><div class="t m0 xf8 h6 y113 ff5 fs4 fc0 sc0 ls0 ws0">j</div><div class="t m2 x107 h6 y113 ff4 fs4 fc0 sc0 ls0 ws0">]<span class="_ _14"> </span><span class="ff3">is<span class="_ _14"> </span>giv<span class="_ _0"></span>en<span class="_ _14"> </span>by</span></div><div class="t m0 xee h6 y113 ff5 fs4 fc0 sc0 ls0 ws0">V</div><div class="t m2 x72 h6 y113 ff4 fs4 fc0 sc0 ls0 ws0">[</div><div class="t m0 x13a h6 y113 ff7 fs4 fc0 sc0 ls0 ws0">r<span class="_ _0"></span>ank</div><div class="t m0 x12d he y114 ff12 fs5 fc0 sc0 ls0 ws0">1</div><div class="t m2 x6b h6 y113 ff4 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x13b h6 y113 ff5 fs4 fc0 sc0 ls0 ws0">C,<span class="_ _e"> </span>j</div><div class="t m2 x13c h6 y113 ff4 fs4 fc0 sc0 ls0 ws0">)]<span class="ff3">,</span></div><div class="t m1 x119 h6 y115 ff3 fs4 fc0 sc0 ls0 ws0">whic<span class="_ _4"></span>h<span class="_ _8"> </span>can<span class="_ _9"> </span>b<span class="_ _7"></span>e<span class="_ _8"> </span>found<span class="_ _9"> </span>in</div><div class="t m0 xbf h6 y115 ff5 fs4 fc0 sc0 ls0 ws0">O</div><div class="t m1 x136 h6 y115 ff4 fs4 fc0 sc0 ls0 ws0">(1)<span class="ff3">.<span class="_ _1"> </span>The<span class="_ _8"> </span>space<span class="_ _8"> </span>is</span></div><div class="t m0 xce h6 y115 ff5 fs4 fc0 sc0 ls0 ws0">mw</div><div class="t m1 xdc h6 y115 ff3 fs4 fc0 sc0 ls0 ws0">for</div><div class="t m0 x8b h6 y115 ff5 fs4 fc0 sc0 ls0 ws0">V</div><div class="t m1 x53 h6 y115 ff3 fs4 fc0 sc0 ls0 ws0">and</div><div class="t m0 xf4 h6 y115 ff5 fs4 fc0 sc0 ls0 ws0">m<span class="_ _e"> </span><span class="ff4">lg</span></div><div class="t m0 x9e h8 y116 ffa fs5 fc0 sc0 ls0 ws0">n</div><div class="t m0 x13d h8 y117 ffa fs5 fc0 sc0 ls0 ws0">m</div><div class="t m1 x8 h6 y115 ff4 fs4 fc0 sc0 ls0 ws0">+</div><div class="t m0 xb4 h6 y115 ff5 fs4 fc0 sc0 ls0 ws0">O</div><div class="t m1 xd1 h6 y115 ff4 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 xa0 h6 y115 ff5 fs4 fc0 sc0 ls0 ws0">m</div><div class="t m1 x83 h6 y115 ff4 fs4 fc0 sc0 ls0 ws0">+</div><div class="t m0 xe h6 y115 ff5 fs4 fc0 sc0 ls0 ws0">n<span class="_ _e"> </span><span class="ff4">lg<span class="_ _e"> </span>lg<span class="_ _e"> </span></span>n/<span class="_ _e"> </span><span class="ff4">lg<span class="_ _18"> </span></span>n</div><div class="t m1 xca h6 y115 ff4 fs4 fc0 sc0 ls0 ws0">)</div><div class="t m0 x23 h6 y118 ff3 fs4 fc0 sc0 ls0 ws0">for<span class="_ _5"> </span><span class="ff5">C<span class="_ _f"></span></span>.<span class="_ _1f"> </span><span class="ff13 fc2">J</span></div><div class="t md x25 h6 y119 ff3 fs4 fc0 sc0 ls0 ws0">This<span class="_ _5"> </span>combination<span class="_ _5"> </span>of<span class="_ _b"> </span>a<span class="_ _5"> </span>sparse<span class="_ _b"> </span>(compressed)<span class="_ _b"> </span>bitvector<span class="_ _5"> </span>for<span class="_ _5"> </span>changes<span class="_ _5"> </span>and<span class="_ _b"> </span>an<span class="_ _b"> </span>ordinary<span class="_ _5"> </span>(dense)</div><div class="t m1b x119 h6 y11a ff3 fs4 fc0 sc0 ls0 ws0">v<span class="_ _4"></span>ector<span class="_ _5"> </span>for<span class="_ _b"> </span>v<span class="_ _0"></span>alues<span class="_ _5"> </span>was<span class="_ _5"> </span>used<span class="_ _5"> </span>in<span class="_ _b"> </span>previous<span class="_ _5"> </span>work,</div><div class="t m0 x71 h6 y11a ff3 fs4 fc0 sc0 ls0 ws0">e.<span class="_ _f"></span>g.</div><div class="t m1b x32 h6 y11a ff3 fs4 fc0 sc0 ls0 ws0">,<span class="_ _5"> </span>[</div><div class="t m0 x113 h6 y11a ff3 fs4 fc0 sc0 ls0 ws0">11</div><div class="t m1b xdd h6 y11a ff3 fs4 fc0 sc0 ls0 ws0">,</div><div class="t m0 xf9 h6 y11a ff3 fs4 fc0 sc0 ls0 ws0">4</div><div class="t m1b x92 h6 y11a ff3 fs4 fc0 sc0 ls0 ws0">],<span class="_ _5"> </span>without<span class="_ _b"> </span>giving<span class="_ _5"> </span>it<span class="_ _b"> </span>a<span class="_ _5"> </span>name.<span class="_ _3"> </span>W<span class="_ _6"></span>e<span class="_ _5"> </span>feel</div><div class="t m0 x23 h6 y11b ff3 fs4 fc0 sc0 ls0 ws0">that<span class="_ _5"> </span>a<span class="_ _b"> </span>name<span class="_ _5"> </span>helps<span class="_ _b"> </span>reduce<span class="_ _5"> </span>the<span class="_ _b"> </span>conceptual<span class="_ _b"> </span>and<span class="_ _5"> </span>notational<span class="_ _b"> </span>complexity<span class="_ _a"> </span>of<span class="_ _b"> </span>later<span class="_ _b"> </span>constructions.</div><div class="t m0 x23 h14 y11c ff13 fs4 fc2 sc0 ls0 ws0">I</div><div class="t m2 x13e h12 y11c ff14 fs4 fc0 sc0 ls0 ws0">Rema<span class="_ _4"></span>rk<span class="_ _5"> </span>(Further<span class="_ _5"> </span>op<span class="_ _7"></span>erations).<span class="_ _1c"> </span><span class="ff3">Without<span class="_ _b"> </span>additional<span class="_ _b"> </span>space,<span class="_ _5"> </span>the<span class="_ _b"> </span>compressed<span class="_ _b"> </span>piecewise-constan<span class="_ _0"></span>t</span></div><div class="t m1 x23 h6 y11d ff3 fs4 fc0 sc0 ls0 ws0">arra<span class="_ _4"></span>y<span class="_ _5"> </span>data<span class="_ _b"> </span>structure<span class="_ _5"> </span>can<span class="_ _b"> </span>also<span class="_ _5"> </span>answer<span class="_ _5"> </span>the<span class="_ _5"> </span>following<span class="_ _5"> </span>query<span class="_ _5"> </span>in<span class="_ _b"> </span>constant<span class="_ _a"> </span>time<span class="_ _b"> </span>using<span class="_ _5"> </span>rank<span class="_ _b"> </span>and</div><div class="t m1e x23 h6 y11e ff3 fs4 fc0 sc0 ls0 ws0">select<span class="_ _5"> </span>on<span class="_ _5"> </span>the<span class="_ _b"> </span>bitvector:</div><div class="t m0 xb7 h6 y11e ff7 fs4 fc0 sc0 ls0 ws0">runlen</div><div class="t m1e xc4 h6 y11e ff4 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x13f h6 y11e ff5 fs4 fc0 sc0 ls0 ws0">i</div><div class="t m1e x140 h6 y11e ff4 fs4 fc0 sc0 ls0 ws0">)<span class="ff3">,<span class="_ _5"> </span>the<span class="_ _5"> </span>num<span class="_ _0"></span>b<span class="_ _7"></span>er<span class="_ _b"> </span>of<span class="_ _5"> </span>entries<span class="_ _5"> </span>to<span class="_ _5"> </span>the<span class="_ _5"> </span>left<span class="_ _b"> </span>of<span class="_ _5"> </span>index</span></div><div class="t m0 xd h6 y11e ff5 fs4 fc0 sc0 ls0 ws0">i</div><div class="t m1e xfb h6 y11e ff3 fs4 fc0 sc0 ls0 ws0">that<span class="_ _5"> </span>contain</div><div class="t m0 x23 h6 y11f ff3 fs4 fc0 sc0 ls0 ws0">the<span class="_ _5"> </span>same<span class="_ _b"> </span>v<span class="_ _0"></span>alue;<span class="_ _5"> </span><span class="ff7">runlen<span class="_ _f"></span><span class="ff4">(<span class="ff5">i</span>) = max<span class="ff8">{<span class="ff5">`<span class="_ _a"> </span></span>≥<span class="_ _a"> </span></span>1 : <span class="ff8">∀<span class="ff5">i<span class="_ _14"> </span></span>−<span class="_ _18"></span><span class="ff5">`<span class="_ _a"> </span>&lt;<span class="_ _a"> </span>j<span class="_ _5"> </span>&lt;<span class="_ _a"> </span>i<span class="_ _a"> </span></span></span>: <span class="ff5">A</span>[<span class="ff5">j<span class="_ _f"></span></span>] = <span class="ff5">A</span>[<span class="ff5">i</span>]<span class="ff8">}</span></span></span>.</div><div class="t m0 x48 h7 y120 ff1 fs1 fc0 sc0 ls0 ws0">3<span class="_ _d"> </span>Random<span class="_ _3"> </span>RMQ<span class="_ _3"> </span>and<span class="_ _9"> </span>random<span class="_ _3"> </span>BST<span class="_ _6"></span>s</div><div class="t m1 x119 h6 y121 ff3 fs4 fc0 sc0 ls0 ws0">W<span class="_ _6"></span>e<span class="_ _9"> </span>consider<span class="_ _3"> </span>the<span class="_ _9"> </span>random<span class="_ _3"> </span>p<span class="_ _7"></span>erm<span class="_ _4"></span>utation<span class="_ _9"> </span>mo<span class="_ _7"></span>del<span class="_ _3"> </span>for<span class="_ _3"> </span>RMQ:<span class="_ _9"> </span>Every<span class="_ _9"> </span>(relativ<span class="_ _4"></span>e)<span class="_ _9"> </span>ordering<span class="_ _3"> </span>of<span class="_ _9"> </span>the</div><div class="t m1 x23 h6 y122 ff3 fs4 fc0 sc0 ls0 ws0">elemen<span class="_ _4"></span>ts<span class="_ _3"> </span>in</div><div class="t m0 x12c h6 y122 ff5 fs4 fc0 sc0 ls0 ws0">A</div><div class="t m1 x125 h6 y122 ff4 fs4 fc0 sc0 ls0 ws0">[1</div><div class="t m0 x38 h6 y122 ff5 fs4 fc0 sc0 ls0 ws0">..n</div><div class="t m1 x47 h6 y122 ff4 fs4 fc0 sc0 ls0 ws0">]<span class="_ _3"> </span><span class="ff3">is considered<span class="_ _3"> </span>to occur<span class="_ _3"> </span>with the<span class="_ _3"> </span>same probabilit<span class="_ _0"></span>y<span class="_ _6"></span>.<span class="_ _20"> </span>Without<span class="_ _3"> </span>loss of</span></div><div class="t m1 x23 h6 y123 ff3 fs4 fc0 sc0 ls0 ws0">generalit<span class="_ _4"></span>y<span class="_ _6"></span>,<span class="_ _9"> </span>we<span class="_ _8"> </span>identify<span class="_ _9"> </span>these</div><div class="t m0 x61 h6 y123 ff5 fs4 fc0 sc0 ls0 ws0">n</div><div class="t m1 x2c h6 y123 ff3 fs4 fc0 sc0 ls0 ws0">elemen<span class="_ _4"></span>ts<span class="_ _9"> </span>with<span class="_ _9"> </span>their<span class="_ _9"> </span>rank,</div><div class="t m0 x34 h6 y123 ff3 fs4 fc0 sc0 ls0 ws0">i.<span class="_ _f"></span>e.</div><div class="t m1 x43 h6 y123 ff3 fs4 fc0 sc0 ls0 ws0">,</div><div class="t m0 x106 h6 y123 ff5 fs4 fc0 sc0 ls0 ws0">A</div><div class="t m1 xfa h6 y123 ff4 fs4 fc0 sc0 ls0 ws0">[1</div><div class="t m0 x8 h6 y123 ff5 fs4 fc0 sc0 ls0 ws0">..n</div><div class="t m1 x129 h6 y123 ff4 fs4 fc0 sc0 ls0 ws0">]<span class="_ _9"> </span><span class="ff3">contains<span class="_ _8"> </span>a<span class="_ _9"> </span>random</span></div><div class="t m0 x23 h6 y124 ff3 fs4 fc0 sc0 ls0 ws0">p<span class="_ _7"></span>erm<span class="_ _4"></span>utation<span class="_ _5"> </span>of<span class="_ _b"> </span><span class="ff4">[1<span class="ff5">..n</span>]</span>.<span class="_ _3"> </span>W<span class="_ _6"></span>e<span class="_ _5"> </span>refer<span class="_ _b"> </span>to<span class="_ _5"> </span>this<span class="_ _b"> </span>as<span class="_ _b"> </span>a<span class="_ _5"> </span>random<span class="_ _b"> </span>RMQ<span class="_ _5"> </span>instance.</div><div class="t m2 x25 h6 y125 ff3 fs4 fc0 sc0 ls0 ws0">Let</div><div class="t m0 x122 h6 y125 ff5 fs4 fc0 sc0 ls0 ws0">T</div><div class="t m0 x4b h8 y126 ffa fs5 fc0 sc0 ls0 ws0">n</div><div class="t m0 x4d h6 y125 ff8 fs4 fc0 sc0 ls0 ws0">∈<span class="_ _a"> </span>T</div><div class="t m0 xa9 h8 y126 ffa fs5 fc0 sc0 ls0 ws0">n</div><div class="t m2 x135 h6 y125 ff3 fs4 fc0 sc0 ls0 ws0">b<span class="_ _7"></span>e<span class="_ _5"> </span>(the<span class="_ _5"> </span>random<span class="_ _5"> </span>shap<span class="_ _7"></span>e<span class="_ _5"> </span>of<span class="_ _7"></span>)<span class="_ _5"> </span>the<span class="_ _5"> </span>Cartesian<span class="_ _5"> </span>tree<span class="_ _5"> </span>asso<span class="_ _7"></span>ciated<span class="_ _5"> </span>with<span class="_ _5"> </span>a<span class="_ _5"> </span>random<span class="_ _5"> </span>RMQ</div><div class="t m1f x23 h6 y127 ff3 fs4 fc0 sc0 ls0 ws0">instance<span class="_ _5"> </span>(recall<span class="_ _b"> </span>Section<span class="_ _b"> </span>1.2).<span class="_ _3"> </span>W<span class="_ _6"></span>e<span class="_ _5"> </span>will<span class="_ _b"> </span>drop<span class="_ _b"> </span>the<span class="_ _5"> </span>subscript</div><div class="t m0 x80 h6 y127 ff5 fs4 fc0 sc0 ls0 ws0">n</div><div class="t m1f x64 h6 y127 ff3 fs4 fc0 sc0 ls0 ws0">when<span class="_ _5"> </span>it<span class="_ _b"> </span>is<span class="_ _b"> </span>clear<span class="_ _5"> </span>form<span class="_ _b"> </span>the<span class="_ _b"> </span>context.</div><div class="t m2 x119 h6 y128 ff3 fs4 fc0 sc0 ls0 ws0">W<span class="_ _6"></span>e<span class="_ _a"> </span>can<span class="_ _a"> </span>precisely<span class="_ _a"> </span>characterize<span class="_ _a"> </span>the<span class="_ _a"> </span>distribution<span class="_ _a"> </span>of</div><div class="t m0 x88 h6 y128 ff5 fs4 fc0 sc0 ls0 ws0">T</div><div class="t m0 x112 h8 y129 ffa fs5 fc0 sc0 ls0 ws0">n</div><div class="t m2 x141 h6 y128 ff3 fs4 fc0 sc0 ls0 ws0">:<span class="_ _3"> </span>Let</div><div class="t m0 x92 h6 y128 ff5 fs4 fc0 sc0 ls0 ws0">t<span class="_ _a"> </span><span class="ff8">∈<span class="_ _a"> </span>T</span></div><div class="t m0 x8d h8 y129 ffa fs5 fc0 sc0 ls0 ws0">n</div><div class="t m2 x6a h6 y128 ff3 fs4 fc0 sc0 ls0 ws0">b<span class="_ _7"></span>e<span class="_ _a"> </span>a<span class="_ _a"> </span>given<span class="_ _a"> </span>(shape<span class="_ _a"> </span>of<span class="_ _a"> </span>a)<span class="_ _a"> </span>binary</div><div class="t m21 x23 h6 y12a ff3 fs4 fc0 sc0 ls0 ws0">tree,<span class="_ _5"> </span>and<span class="_ _b"> </span>let</div><div class="t m0 x12c h6 y12a ff5 fs4 fc0 sc0 ls0 ws0">i</div><div class="t m21 xe6 h6 y12a ff3 fs4 fc0 sc0 ls0 ws0">b<span class="_ _7"></span>e<span class="_ _5"> </span>the<span class="_ _b"> </span>inorder<span class="_ _b"> </span>index<span class="_ _b"> </span>of<span class="_ _b"> </span>the<span class="_ _b"> </span>ro<span class="_ _7"></span>ot<span class="_ _5"> </span>of</div><div class="t m0 x21 h6 y12a ff5 fs4 fc0 sc0 ls0 ws0">t</div><div class="t m21 x141 h6 y12a ff3 fs4 fc0 sc0 ls0 ws0">.<span class="_ _3"> </span>The<span class="_ _b"> </span>minim<span class="_ _0"></span>um<span class="_ _b"> </span>in<span class="_ _b"> </span>a<span class="_ _b"> </span>random<span class="_ _b"> </span>p<span class="_ _7"></span>ermutation</div><div class="t m1d x23 h6 y12b ff3 fs4 fc0 sc0 ls0 ws0">is<span class="_ _5"> </span>lo<span class="_ _7"></span>cated<span class="_ _b"> </span>at<span class="_ _b"> </span>ev<span class="_ _4"></span>ery<span class="_ _5"> </span>p<span class="_ _7"></span>osition</div><div class="t m0 x29 h6 y12b ff5 fs4 fc0 sc0 ls0 ws0">i<span class="_ _a"> </span><span class="ff8">∈</span></div><div class="t m1d x2b h6 y12b ff4 fs4 fc0 sc0 ls0 ws0">[</div><div class="t m0 xb9 h6 y12b ff5 fs4 fc0 sc0 ls0 ws0">n</div><div class="t m1d xd0 h6 y12b ff4 fs4 fc0 sc0 ls0 ws0">]<span class="_ _5"> </span><span class="ff3">with<span class="_ _b"> </span>probability</span></div><div class="t m0 x117 h8 y12c fff fs5 fc0 sc0 ls0 ws0">1</div><div class="t m0 x3d h8 y12d ffa fs5 fc0 sc0 ls0 ws0">n</div><div class="t m1d xde h6 y12b ff3 fs4 fc0 sc0 ls0 ws0">.<span class="_ _3"> </span>Apart<span class="_ _5"> </span>from<span class="_ _b"> </span>renaming,<span class="_ _5"> </span>the<span class="_ _b"> </span>subarrays</div><div class="t m0 x23 h6 y12e ff5 fs4 fc0 sc0 ls0 ws0">A</div><div class="t mb x49 h6 y12e ff4 fs4 fc0 sc0 ls0 ws0">[1</div><div class="t m0 x25 h6 y12e ff5 fs4 fc0 sc0 ls0 ws0">..i<span class="_ _14"> </span><span class="ff8">−</span></div><div class="t mb xfc h6 y12e ff4 fs4 fc0 sc0 ls0 ws0">1]<span class="_ _5"> </span><span class="ff3">and</span></div><div class="t m0 xaa h6 y12e ff5 fs4 fc0 sc0 ls0 ws0">A</div><div class="t mb xf1 h6 y12e ff4 fs4 fc0 sc0 ls0 ws0">[</div><div class="t m0 x142 h6 y12e ff5 fs4 fc0 sc0 ls0 ws0">i</div><div class="t mb xcb h6 y12e ff4 fs4 fc0 sc0 ls0 ws0">+<span class="_ _14"> </span>1</div><div class="t m0 x126 h6 y12e ff5 fs4 fc0 sc0 ls0 ws0">..n</div><div class="t mb xff h6 y12e ff4 fs4 fc0 sc0 ls0 ws0">]<span class="_ _5"> </span><span class="ff3">contain<span class="_ _5"> </span>a<span class="_ _5"> </span>random<span class="_ _b"> </span>p<span class="_ _7"></span>ermutation<span class="_ _5"> </span>of</span></div><div class="t m0 x143 h6 y12e ff5 fs4 fc0 sc0 ls0 ws0">i<span class="_ _14"> </span><span class="ff8">−</span></div><div class="t mb x106 h6 y12e ff4 fs4 fc0 sc0 ls0 ws0">1<span class="_ _5"> </span><span class="ff3">resp.</span></div><div class="t m0 xa h6 y12e ff5 fs4 fc0 sc0 ls0 ws0">n<span class="_ _14"> </span><span class="ff8">−<span class="_ _18"></span></span>i</div><div class="t mb x56 h6 y12e ff3 fs4 fc0 sc0 ls0 ws0">elemen<span class="_ _4"></span>ts,<span class="_ _5"> </span>and</div><div class="t m1 x23 h6 y12f ff3 fs4 fc0 sc0 ls0 ws0">these<span class="_ _5"> </span>tw<span class="_ _0"></span>o<span class="_ _5"> </span>p<span class="_ _7"></span>ermutations<span class="_ _5"> </span>are<span class="_ _5"> </span>indep<span class="_ _7"></span>endent<span class="_ _5"> </span>of<span class="_ _5"> </span>each<span class="_ _a"> </span>other<span class="_ _b"> </span>conditional<span class="_ _5"> </span>on<span class="_ _5"> </span>their<span class="_ _b"> </span>sizes.<span class="_ _3"> </span>W<span class="_ _6"></span>e<span class="_ _5"> </span>thus</div><div class="t m0 x23 h6 y130 ff3 fs4 fc0 sc0 ls0 ws0">ha<span class="_ _4"></span>v<span class="_ _0"></span>e</div><div class="t m0 x25 h6 y131 ff15 fs4 fc0 sc0 ls0 ws0">P<span class="ff4">[<span class="ff5">T</span></span></div><div class="t m0 x4a h8 y132 ffa fs5 fc0 sc0 ls0 ws0">n</div><div class="t m0 xea h6 y131 ff4 fs4 fc0 sc0 ls0 ws0">= <span class="ff5">t</span>]<span class="_ _11"> </span>=</div><div class="t m0 x144 hd y133 ff11 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x145 h6 y134 ff4 fs4 fc0 sc0 ls0 ws0">1<span class="ff5">,<span class="_ _21"> </span>n<span class="_ _a"> </span><span class="ff8">≤<span class="_ _a"> </span></span></span>1;</div><div class="t m0 xa4 h8 y135 fff fs5 fc0 sc0 ls0 ws0">1</div><div class="t m0 x3a h8 y136 ffa fs5 fc0 sc0 ls0 ws0">n</div><div class="t m0 x146 h6 y137 ff8 fs4 fc0 sc0 ls0 ws0">·<span class="_ _14"> </span><span class="ff15">P<span class="ff4">[<span class="ff5">T</span></span></span></div><div class="t m0 xa5 h8 y138 ffa fs5 fc0 sc0 ls0 ws0">i<span class="ffb">−<span class="fff">1</span></span></div><div class="t m0 x11f h6 y137 ff4 fs4 fc0 sc0 ls0 ws0">= <span class="ff5">t</span></div><div class="t m0 xe1 h8 y138 ffa fs5 fc0 sc0 ls0 ws0">`</div><div class="t m0 x5b h6 y137 ff4 fs4 fc0 sc0 ls0 ws0">]<span class="_ _14"> </span><span class="ff8">·<span class="_ _18"></span><span class="ff15">P</span></span>[<span class="ff5">T</span></div><div class="t m0 xda h8 y138 ffa fs5 fc0 sc0 ls0 ws0">n<span class="ffb">−</span>i</div><div class="t m0 xb1 h6 y137 ff4 fs4 fc0 sc0 ls0 ws0">= <span class="ff5">t</span></div><div class="t m0 x88 h8 y138 ffa fs5 fc0 sc0 ls0 ws0">r</div><div class="t m0 x32 h6 y137 ff4 fs4 fc0 sc0 ls0 ws0">]<span class="ff5">,<span class="_ _22"> </span>n<span class="_ _a"> </span><span class="ff8">≥<span class="_ _a"> </span></span></span>2<span class="ff5">,</span></div><div class="t m0 xc9 h6 y131 ff3 fs4 fc0 sc0 ls0 ws0">(1)</div><a class="l" href="#pf5" data-dest-detail='[5,"XYZ",99.071,497.703,null]'><div class="d m9" style="border-style:none;position:absolute;left:505.352941px;bottom:732.429739px;width:40.821000px;height:11.955000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",99.071,432.524,null]'><div class="d m9" style="border-style:none;position:absolute;left:546.965686px;bottom:638.988562px;width:11.955000px;height:8.267000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",99.071,657.709,null]'><div class="d m9" style="border-style:none;position:absolute;left:573.183007px;bottom:638.988562px;width:6.974000px;height:8.267000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf3" data-dest-detail='[3,"XYZ",99.071,335.676,null]'><div class="d m9" style="border-style:none;position:absolute;left:300.316993px;bottom:332.645425px;width:49.198000px;height:11.955000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.633987,0.000000,0.000000,1.633987,0.000000,0.000000]}'></div></div>
