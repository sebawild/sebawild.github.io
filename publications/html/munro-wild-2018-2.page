<div id="pf2" class="pf w0 h0" data-page-no="2"><div class="pc pc2 w0 h0"><img class="bi x11 y2d w2 ha" alt="" src="data:image/png;base64,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"/><div class="t m0 x12 h5 y2e ff1 fs3 fc0 sc0 ls0 ws0">63:2<span class="_ _13"> </span>Nea<span class="_ _0"></span>rly-Optimal<span class="_ _a"> </span>Mergesort</div><div class="t m1 x13 h7 y2f ff3 fs5 fc0 sc0 ls0 ws0">Making<span class="_ _3"> </span>use<span class="_ _3"> </span>of<span class="_ _3"> </span>existing<span class="_ _3"> </span>runs<span class="_ _3"> </span>in<span class="_ _3"> </span>the<span class="_ _3"> </span>input<span class="_ _3"> </span>is<span class="_ _3"> </span>a<span class="_ _3"> </span>well-kno<span class="_ _0"></span>wn<span class="_ _3"> </span>option<span class="_ _3"> </span>in<span class="_ _3"> </span>mergesort;</div><div class="t m0 x14 h7 y2f ff3 fs5 fc0 sc0 ls0 ws0">e.<span class="_ _11"></span>g.</div><div class="t m1 x15 h7 y2f ff3 fs5 fc0 sc0 ls0 ws0">,</div><div class="t m1 x11 h7 y30 ff3 fs5 fc0 sc0 ls0 ws0">Kn<span class="_ _4"></span>uth<span class="_ _a"> </span>[</div><div class="t m0 x16 h7 y30 ff3 fs5 fc0 sc0 ls0 ws0">17</div><div class="t m1 x17 h7 y30 ff3 fs5 fc0 sc0 ls0 ws0">]<span class="_ _a"> </span>discusses<span class="_ _a"> </span>a<span class="_ _a"> </span>bottom-up<span class="_ _a"> </span>mergesort<span class="_ _a"> </span>v<span class="_ _0"></span>ariant<span class="_ _b"> </span>that<span class="_ _a"> </span>do<span class="_ _7"></span>es<span class="_ _a"> </span>this.<span class="_ _1"> </span>He<span class="_ _a"> </span>calls<span class="_ _a"> </span>it<span class="_ _a"> </span>“natural</div><div class="t m8 x11 h7 y31 ff3 fs5 fc0 sc0 ls0 ws0">mergesort”<span class="_ _5"> </span>and<span class="_ _b"> </span>we<span class="_ _5"> </span>will<span class="_ _5"> </span>use<span class="_ _b"> </span>this<span class="_ _b"> </span>as<span class="_ _5"> </span>an<span class="_ _b"> </span>umbrella<span class="_ _5"> </span>term<span class="_ _b"> </span>for<span class="_ _5"> </span>any<span class="_ _5"> </span>mergesort<span class="_ _b"> </span>v<span class="_ _6"></span>ariant<span class="_ _5"> </span>that<span class="_ _b"> </span>picks<span class="_ _5"> </span>up</div><div class="t m9 x11 h7 y32 ff3 fs5 fc0 sc0 ls0 ws0">existing<span class="_ _5"> </span>runs<span class="_ _b"> </span>in<span class="_ _5"> </span>the<span class="_ _b"> </span>input<span class="_ _5"> </span>(instead<span class="_ _b"> </span>of<span class="_ _5"> </span>blindly<span class="_ _b"> </span>starting<span class="_ _5"> </span>with<span class="_ _b"> </span>runs<span class="_ _b"> </span>of<span class="_ _5"> </span>size<span class="_ _b"> </span><span class="ffa">1</span>).<span class="_ _f"> </span>The<span class="_ _b"> </span>Jav<span class="_ _6"></span>a<span class="_ _5"> </span>library</div><div class="t ma x11 h7 y33 ff3 fs5 fc0 sc0 ls0 ws0">uses<span class="_ _5"> </span><span class="ff7">Timsort<span class="_ _f"> </span></span>[</div><div class="t m0 x18 h7 y33 ff3 fs5 fc0 sc0 ls0 ws0">25</div><div class="t ma x19 h7 y33 ff3 fs5 fc0 sc0 ls0 ws0">,</div><div class="t m0 x1a h7 y33 ff3 fs5 fc0 sc0 ls0 ws0">15</div><div class="t ma x1b h7 y33 ff3 fs5 fc0 sc0 ls0 ws0">],<span class="_ _5"> </span>a<span class="_ _b"> </span>natural<span class="_ _b"> </span>mergesort<span class="_ _5"> </span>originally<span class="_ _b"> </span>developed<span class="_ _b"> </span>as<span class="_ _5"> </span>Python’s<span class="_ _b"> </span>new<span class="_ _b"> </span>library<span class="_ _5"> </span>sort.</div><div class="t m4 x13 h7 y34 ff3 fs5 fc0 sc0 ls0 ws0">While<span class="_ _8"> </span>fat-pivot<span class="_ _8"> </span>quicksort<span class="_ _8"> </span>prov<span class="_ _6"></span>ably<span class="_ _5"> </span>adapts<span class="_ _8"> </span>to<span class="_ _5"> </span>the<span class="_ _8"> </span><span class="ff7">entr<span class="_ _0"></span>opy<span class="_ _b"> </span>of<span class="_ _5"> </span>the<span class="_ _5"> </span>multiplicities<span class="_ _b"> </span><span class="ff3">of<span class="_ _5"> </span>k<span class="_ _0"></span>eys<span class="_ _5"> </span>[</span></span></div><div class="t m0 x1c h7 y34 ff3 fs5 fc0 sc0 ls0 ws0">34</div><div class="t m4 x1d h7 y34 ff3 fs5 fc0 sc0 ls0 ws0">]<span class="_ _8"> </span>–</div><div class="t mb x11 h7 y35 ff3 fs5 fc0 sc0 ls0 ws0">it<span class="_ _5"> </span>is<span class="_ _b"> </span>optimal<span class="_ _b"> </span>up<span class="_ _b"> </span>to<span class="_ _5"> </span>a<span class="_ _b"> </span>factor<span class="_ _b"> </span>of<span class="_ _5"> </span><span class="ffa">1</span></div><div class="t m0 x1e h7 y35 ffb fs5 fc0 sc0 ls0 ws0">.</div><div class="t mb x1f h7 y35 ffa fs5 fc0 sc0 ls0 ws0">088<span class="_ _5"> </span><span class="ff3">on<span class="_ _b"> </span>av<span class="_ _0"></span>erage<span class="_ _b"> </span>with<span class="_ _5"> </span>pseudomedian-of-9<span class="_ _b"> </span>(“ninther”)<span class="_ _5"> </span>pivots</span></div><div class="t m0 x20 h9 y36 ff9 fs6 fc0 sc0 ls0 ws0">1</div><div class="t mb x21 h7 y35 ff3 fs5 fc0 sc0 ls0 ws0">–</div><div class="t m1 x11 h7 y37 ff3 fs5 fc0 sc0 ls0 ws0">Timsort<span class="_ _b"> </span>is<span class="_ _b"> </span>muc<span class="_ _0"></span>h<span class="_ _a"> </span>more<span class="_ _b"> </span>heuristic<span class="_ _b"> </span>in<span class="_ _b"> </span>nature.<span class="_ _14"> </span>It<span class="_ _b"> </span>picks<span class="_ _b"> </span>up<span class="_ _b"> </span>existing<span class="_ _b"> </span>runs<span class="_ _a"> </span>and<span class="_ _b"> </span>tries<span class="_ _b"> </span>to<span class="_ _b"> </span>p<span class="_ _7"></span>erform</div><div class="t m1 x11 h7 y38 ff3 fs5 fc0 sc0 ls0 ws0">merges<span class="_ _b"> </span>in<span class="_ _a"> </span>a<span class="_ _b"> </span>fav<span class="_ _0"></span>orable<span class="_ _a"> </span>order<span class="_ _b"> </span>(</div><div class="t m0 x22 h7 y38 ff3 fs5 fc0 sc0 ls0 ws0">i.<span class="_ _11"></span>e.</div><div class="t m1 x23 h7 y38 ff3 fs5 fc0 sc0 ls0 ws0">,<span class="_ _a"> </span>a<span class="_ _0"></span>voiding<span class="_ _b"> </span>merges<span class="_ _b"> </span>of<span class="_ _a"> </span>runs<span class="_ _b"> </span>with<span class="_ _a"> </span>v<span class="_ _0"></span>ery<span class="_ _a"> </span>diﬀeren<span class="_ _0"></span>t<span class="_ _a"> </span>lengths)<span class="_ _b"> </span>by</div><div class="t mc x11 h7 y39 ff3 fs5 fc0 sc0 ls0 ws0">distinguishing<span class="_ _5"> </span>a<span class="_ _b"> </span>handful<span class="_ _5"> </span>of<span class="_ _b"> </span>cases<span class="_ _b"> </span>of<span class="_ _5"> </span>how<span class="_ _5"> </span>the<span class="_ _b"> </span>lengths<span class="_ _5"> </span>of<span class="_ _b"> </span>the<span class="_ _5"> </span>4<span class="_ _b"> </span>most<span class="_ _b"> </span>recen<span class="_ _0"></span>t<span class="_ _b"> </span>runs<span class="_ _b"> </span>relate<span class="_ _5"> </span>to<span class="_ _b"> </span>each</div><div class="t md x11 h7 y3a ff3 fs5 fc0 sc0 ls0 ws0">other.<span class="_ _f"> </span>The<span class="_ _b"> </span>rules<span class="_ _5"> </span>are<span class="_ _b"> </span>easy<span class="_ _5"> </span>to<span class="_ _5"> </span>implement<span class="_ _5"> </span>and<span class="_ _5"> </span>were<span class="_ _5"> </span>empirically<span class="_ _5"> </span>shown<span class="_ _5"> </span>to<span class="_ _5"> </span>b<span class="_ _7"></span>e<span class="_ _b"> </span>eﬀective<span class="_ _5"> </span>in<span class="_ _5"> </span>most</div><div class="t me x11 h7 y3b ff3 fs5 fc0 sc0 ls0 ws0">cases,<span class="_ _5"> </span>but<span class="_ _b"> </span>their<span class="_ _b"> </span>in<span class="_ _4"></span>terpla<span class="_ _4"></span>y<span class="_ _5"> </span>is<span class="_ _b"> </span>quite<span class="_ _b"> </span>in<span class="_ _4"></span>tricate.<span class="_ _3"> </span>Although<span class="_ _5"> </span>announced<span class="_ _b"> </span>as<span class="_ _b"> </span>an</div><div class="t m0 x24 h7 y3b ffb fs5 fc0 sc0 ls0 ws0">O</div><div class="t me x25 h7 y3b ffa fs5 fc0 sc0 ls0 ws0">(</div><div class="t m0 x26 h7 y3b ffb fs5 fc0 sc0 ls0 ws0">n<span class="_ _c"> </span><span class="ffa">log<span class="_ _15"> </span></span>n</div><div class="t me x27 h7 y3b ffa fs5 fc0 sc0 ls0 ws0">)<span class="_ _5"> </span><span class="ff3">worst-case</span></div><div class="t mf x11 h7 y3c ff3 fs5 fc0 sc0 ls0 ws0">metho<span class="_ _7"></span>d<span class="_ _5"> </span>with<span class="_ _b"> </span>its<span class="_ _5"> </span>introduction<span class="_ _b"> </span>in<span class="_ _5"> </span>2002<span class="_ _b"> </span>[</div><div class="t m0 x28 h7 y3c ff3 fs5 fc0 sc0 ls0 ws0">24</div><div class="t mf x29 h7 y3c ff3 fs5 fc0 sc0 ls0 ws0">],<span class="_ _5"> </span>a<span class="_ _b"> </span>rigorous<span class="_ _5"> </span>pro<span class="_ _7"></span>of<span class="_ _b"> </span>of<span class="_ _5"> </span>this<span class="_ _b"> </span>b<span class="_ _7"></span>ound<span class="_ _5"> </span>was<span class="_ _5"> </span>only<span class="_ _5"> </span>given<span class="_ _5"> </span>in</div><div class="t m10 x11 h7 y3d ff3 fs5 fc0 sc0 ls0 ws0">2015<span class="_ _5"> </span>by<span class="_ _5"> </span>A<span class="_ _0"></span>uger,<span class="_ _b"> </span>Nicaud,<span class="_ _5"> </span>and<span class="_ _b"> </span>Piv<span class="_ _4"></span>oteau<span class="_ _5"> </span>[</div><div class="t m0 x2a h7 y3d ff3 fs5 fc0 sc0 ls0 ws0">2</div><div class="t m10 x2b h7 y3d ff3 fs5 fc0 sc0 ls0 ws0">]<span class="_ _5"> </span>and<span class="_ _b"> </span>required<span class="_ _5"> </span>a<span class="_ _5"> </span>rather<span class="_ _b"> </span>sophisticated<span class="_ _5"> </span>amortization</div><div class="t m0 x11 h7 y3e ff3 fs5 fc0 sc0 ls0 ws0">argumen<span class="_ _4"></span>t.</div><div class="t m11 x13 h7 y3f ff3 fs5 fc0 sc0 ls0 ws0">The<span class="_ _5"> </span>core<span class="_ _b"> </span>complication<span class="_ _b"> </span>is<span class="_ _5"> </span>that<span class="_ _b"> </span>–<span class="_ _b"> </span>unlik<span class="_ _0"></span>e<span class="_ _b"> </span>for<span class="_ _b"> </span>standard<span class="_ _5"> </span>mergesort<span class="_ _b"> </span>v<span class="_ _0"></span>ariants<span class="_ _5"> </span>–<span class="_ _5"> </span>a<span class="_ _b"> </span>given<span class="_ _5"> </span>element</div><div class="t mc x11 h7 y40 ff3 fs5 fc0 sc0 ls0 ws0">migh<span class="_ _4"></span>t<span class="_ _5"> </span>participate<span class="_ _b"> </span>in<span class="_ _b"> </span>more<span class="_ _5"> </span>than<span class="_ _b"> </span>a<span class="_ _5"> </span>logarithmic<span class="_ _b"> </span>num<span class="_ _0"></span>b<span class="_ _7"></span>er<span class="_ _b"> </span>of<span class="_ _5"> </span>merges.<span class="_ _3"> </span>Indeed,<span class="_ _b"> </span>Buss<span class="_ _5"> </span>and<span class="_ _b"> </span>Knop<span class="_ _b"> </span>[</div><div class="t m0 x2c h7 y40 ff3 fs5 fc0 sc0 ls0 ws0">9</div><div class="t mc x2d h7 y40 ff3 fs5 fc0 sc0 ls0 ws0">]</div><div class="t m1 x11 h7 y41 ff3 fs5 fc0 sc0 ls0 ws0">ha<span class="_ _4"></span>v<span class="_ _4"></span>e<span class="_ _5"> </span>very<span class="_ _5"> </span>recently<span class="_ _5"> </span>shown<span class="_ _5"> </span>that<span class="_ _5"> </span>for<span class="_ _b"> </span>some<span class="_ _b"> </span>family<span class="_ _5"> </span>of<span class="_ _b"> </span>inputs,<span class="_ _b"> </span>the<span class="_ _5"> </span>av<span class="_ _0"></span>erage<span class="_ _b"> </span>num<span class="_ _0"></span>b<span class="_ _7"></span>er<span class="_ _5"> </span>of<span class="_ _b"> </span>merges<span class="_ _b"> </span>a</div><div class="t m4 x11 h7 y42 ff3 fs5 fc0 sc0 ls0 ws0">single<span class="_ _5"> </span>element<span class="_ _5"> </span>participates<span class="_ _b"> </span>in<span class="_ _5"> </span>is<span class="_ _b"> </span>at<span class="_ _b"> </span>least</div><div class="t m0 x2e hb y43 ffc fs5 fc0 sc0 ls0 ws0"></div><div class="t m0 x2f h9 y44 ffd fs6 fc0 sc0 ls0 ws0">3</div><div class="t m0 x2f h9 y45 ffd fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 x30 h7 y42 ff4 fs5 fc0 sc0 ls0 ws0">−<span class="_ _9"> </span><span class="ffb">o</span></div><div class="t m4 x31 h7 y42 ffa fs5 fc0 sc0 ls0 ws0">(1)</div><div class="t m0 x32 hb y43 ffc fs5 fc0 sc0 ls0 ws0"></div><div class="t m0 x33 h7 y42 ff4 fs5 fc0 sc0 ls0 ws0">·<span class="_ _9"> </span><span class="ffa">lg<span class="_ _15"> </span><span class="ffb">n</span></span></div><div class="t m4 x34 h7 y42 ff3 fs5 fc0 sc0 ls0 ws0">.<span class="_ _3"> </span>So<span class="_ _5"> </span>in<span class="_ _b"> </span>the<span class="_ _b"> </span>w<span class="_ _4"></span>orst<span class="_ _5"> </span>case,<span class="_ _b"> </span>Timsort<span class="_ _b"> </span>do<span class="_ _7"></span>es,</div><div class="t m0 x11 h7 y46 ff3 fs5 fc0 sc0 ls0 ws0">e.<span class="_ _11"></span>g.</div><div class="t m1 x35 h7 y46 ff3 fs5 fc0 sc0 ls0 ws0">,<span class="_ _b"> </span>asymptotically<span class="_ _b"> </span>at<span class="_ _b"> </span>least<span class="_ _b"> </span><span class="ff7">1.5<span class="_ _a"> </span>times<span class="_ _b"> </span>as<span class="_ _a"> </span>many<span class="_ _b"> </span>element<span class="_ _b"> </span>moves<span class="_ _a"> </span>as<span class="_ _b"> </span>standar<span class="_ _4"></span>d<span class="_ _b"> </span>mer<span class="_ _4"></span>gesort. <span class="ff3">In</span></span></div><div class="t m1 x11 h7 y47 ff3 fs5 fc0 sc0 ls0 ws0">terms<span class="_ _a"> </span>of<span class="_ _a"> </span>adapting<span class="_ _a"> </span>to<span class="_ _b"> </span>existing<span class="_ _a"> </span>order,<span class="_ _a"> </span>prov<span class="_ _6"></span>able<span class="_ _a"> </span>guarantees<span class="_ _b"> </span>for<span class="_ _a"> </span>Timsort<span class="_ _a"> </span>had<span class="_ _a"> </span>long<span class="_ _a"> </span>remained</div><div class="t m4 x11 h7 y48 ff3 fs5 fc0 sc0 ls0 ws0">elusiv<span class="_ _0"></span>e;<span class="_ _b"> </span>an<span class="_ _5"> </span>upp<span class="_ _7"></span>er<span class="_ _b"> </span>b<span class="_ _7"></span>ound<span class="_ _5"> </span>of</div><div class="t m0 x36 h7 y48 ffb fs5 fc0 sc0 ls0 ws0">O</div><div class="t m4 x37 h7 y48 ffa fs5 fc0 sc0 ls0 ws0">(</div><div class="t m0 x38 h7 y48 ffb fs5 fc0 sc0 ls0 ws0">n</div><div class="t m4 x1f h7 y48 ffa fs5 fc0 sc0 ls0 ws0">+</div><div class="t m0 x7 h7 y48 ffb fs5 fc0 sc0 ls0 ws0">n<span class="_ _15"> </span><span class="ffa">log<span class="_ _c"> </span></span>r</div><div class="t m4 x2e h7 y48 ffa fs5 fc0 sc0 ls0 ws0">)<span class="_ _5"> </span><span class="ff3">was<span class="_ _5"> </span>conjectured<span class="_ _5"> </span>in<span class="_ _5"> </span>[</span></div><div class="t m0 x39 h7 y48 ff3 fs5 fc0 sc0 ls0 ws0">2</div><div class="t m4 x3a h7 y48 ff3 fs5 fc0 sc0 ls0 ws0">]<span class="_ _5"> </span>and<span class="_ _b"> </span>[</div><div class="t m0 x3b h7 y48 ff3 fs5 fc0 sc0 ls0 ws0">9</div><div class="t m4 x3c h7 y48 ff3 fs5 fc0 sc0 ls0 ws0">]),<span class="_ _5"> </span>but<span class="_ _b"> </span>indeed<span class="_ _5"> </span>only<span class="_ _5"> </span>for</div><div class="t m12 x11 h7 y49 ff3 fs5 fc0 sc0 ls0 ws0">this<span class="_ _5"> </span>very<span class="_ _5"> </span>conference,<span class="_ _5"> </span>Auger,<span class="_ _5"> </span>Jugé,<span class="_ _5"> </span>Nicaud<span class="_ _b"> </span>and<span class="_ _b"> </span>Piv<span class="_ _0"></span>oteau<span class="_ _b"> </span>[</div><div class="t m0 x3d h7 y49 ff3 fs5 fc0 sc0 ls0 ws0">1</div><div class="t m12 x3e h7 y49 ff3 fs5 fc0 sc0 ls0 ws0">]<span class="_ _5"> </span>ﬁnally<span class="_ _b"> </span>giv<span class="_ _4"></span>e<span class="_ _5"> </span>a<span class="_ _b"> </span>pro<span class="_ _7"></span>of.<span class="_ _f"> </span>The<span class="_ _b"> </span>hidden</div><div class="t m4 x11 h7 y4a ff3 fs5 fc0 sc0 ls0 ws0">constan<span class="_ _0"></span>ts<span class="_ _5"> </span>in<span class="_ _5"> </span>their<span class="_ _5"> </span>b<span class="_ _7"></span>ound<span class="_ _5"> </span>are<span class="_ _5"> </span>quite<span class="_ _5"> </span>big<span class="_ _5"> </span>(and<span class="_ _5"> </span>far<span class="_ _5"> </span>a<span class="_ _0"></span>wa<span class="_ _0"></span>y<span class="_ _5"> </span>from<span class="_ _5"> </span>the<span class="_ _5"> </span>co<span class="_ _7"></span>eﬃcien<span class="_ _4"></span>t</div><div class="t m0 x3f h9 y4b ffd fs6 fc0 sc0 ls0 ws0">3</div><div class="t m0 x3f h9 y4c ffd fs6 fc0 sc0 ls0 ws0">2</div><div class="t m4 x40 h7 y4a ff3 fs5 fc0 sc0 ls0 ws0">of<span class="_ _5"> </span>the<span class="_ _5"> </span>abov<span class="_ _0"></span>e<span class="_ _5"> </span>low<span class="_ _0"></span>er</div><div class="t m0 x11 h7 y4d ff3 fs5 fc0 sc0 ls0 ws0">b<span class="_ _7"></span>ound).</div><div class="t m13 x13 h7 y4e ff3 fs5 fc0 sc0 ls0 ws0">A<span class="_ _5"> </span>further<span class="_ _5"> </span>manifestation<span class="_ _b"> </span>of<span class="_ _5"> </span>the<span class="_ _5"> </span>complexity<span class="_ _5"> </span>of<span class="_ _5"> </span>Timsort’s<span class="_ _5"> </span>rules<span class="_ _b"> </span>w<span class="_ _4"></span>as<span class="_ _5"> </span>rep<span class="_ _7"></span>orted<span class="_ _5"> </span>by<span class="_ _5"> </span>de<span class="_ _5"> </span>Gouw</div><div class="t m14 x11 h7 y4f ff3 fs5 fc0 sc0 ls0 ws0">et<span class="_ _5"> </span>al.<span class="_ _b"> </span>[</div><div class="t m0 x41 h7 y4f ff3 fs5 fc0 sc0 ls0 ws0">10</div><div class="t m14 x42 h7 y4f ff3 fs5 fc0 sc0 ls0 ws0">]:<span class="_ _f"> </span>The<span class="_ _b"> </span>original<span class="_ _5"> </span>rules<span class="_ _b"> </span>to<span class="_ _5"> </span>maintain<span class="_ _5"> </span>the<span class="_ _5"> </span>desired<span class="_ _b"> </span>inv<span class="_ _6"></span>arian<span class="_ _4"></span>t<span class="_ _5"> </span>for<span class="_ _b"> </span>run<span class="_ _5"> </span>lengths<span class="_ _b"> </span>on<span class="_ _5"> </span>the<span class="_ _b"> </span>stac<span class="_ _4"></span>k</div><div class="t m5 x11 h7 y50 ff3 fs5 fc0 sc0 ls0 ws0">are<span class="_ _5"> </span>insuﬃcient<span class="_ _5"> </span>in<span class="_ _5"> </span>some<span class="_ _5"> </span>cases.<span class="_ _f"> </span>This<span class="_ _b"> </span>(algorithmic!)<span class="_ _f"> </span>bug<span class="_ _b"> </span>had<span class="_ _5"> </span>remained<span class="_ _5"> </span>unnoticed<span class="_ _5"> </span>until<span class="_ _5"> </span>their</div><div class="t m15 x11 h7 y51 ff3 fs5 fc0 sc0 ls0 ws0">attempt<span class="_ _5"> </span>to<span class="_ _5"> </span>formally<span class="_ _b"> </span>v<span class="_ _0"></span>erify<span class="_ _b"> </span>the<span class="_ _5"> </span>correctness<span class="_ _5"> </span>of<span class="_ _b"> </span>the<span class="_ _5"> </span>Jav<span class="_ _6"></span>a<span class="_ _5"> </span>implementation<span class="_ _5"> </span>failed<span class="_ _5"> </span>b<span class="_ _7"></span>ecause<span class="_ _5"> </span>of<span class="_ _b"> </span>it.</div><div class="t m16 x11 h7 y52 ff3 fs5 fc0 sc0 ls0 ws0">Gou<span class="_ _4"></span>w<span class="_ _5"> </span>et<span class="_ _5"> </span>al.<span class="_ _b"> </span>prop<span class="_ _7"></span>osed<span class="_ _5"> </span>tw<span class="_ _0"></span>o<span class="_ _b"> </span>options<span class="_ _5"> </span>for<span class="_ _5"> </span>correcting<span class="_ _b"> </span>Timsort,<span class="_ _5"> </span>one<span class="_ _b"> </span>of<span class="_ _5"> </span>which<span class="_ _5"> </span>w<span class="_ _0"></span>as<span class="_ _b"> </span>applied<span class="_ _5"> </span>for<span class="_ _5"> </span>the</div><div class="t mc x11 h7 y53 ff3 fs5 fc0 sc0 ls0 ws0">Ja<span class="_ _4"></span>v<span class="_ _6"></span>a<span class="_ _b"> </span>library<span class="_ _6"></span>.<span class="_ _3"> </span>But<span class="_ _5"> </span>now,<span class="_ _5"> </span>Auger<span class="_ _5"> </span>et<span class="_ _b"> </span>al.<span class="_ _5"> </span>[</div><div class="t m0 x43 h7 y53 ff3 fs5 fc0 sc0 ls0 ws0">1</div><div class="t mc x44 h7 y53 ff3 fs5 fc0 sc0 ls0 ws0">]<span class="_ _5"> </span>demonstrated<span class="_ _b"> </span>that<span class="_ _b"> </span><span class="ff7">this<span class="_ _b"> </span>c<span class="_ _0"></span>orr<span class="_ _0"></span>e<span class="_ _0"></span>ction<span class="_ _a"> </span>is<span class="_ _b"> </span>stil<span class="_ _2"></span>l<span class="_ _a"> </span>insuﬃcient:</span></div><div class="t m1 x11 h7 y54 ff3 fs5 fc0 sc0 ls0 ws0">as<span class="_ _b"> </span>of<span class="_ _b"> </span>this<span class="_ _b"> </span>writing,<span class="_ _a"> </span>the<span class="_ _b"> </span>Ja<span class="_ _4"></span>v<span class="_ _6"></span>a<span class="_ _a"> </span>run<span class="_ _0"></span>time<span class="_ _b"> </span>library<span class="_ _a"> </span>con<span class="_ _0"></span>tains<span class="_ _b"> </span>a<span class="_ _b"> </span>ﬂaw<span class="_ _0"></span>ed<span class="_ _a"> </span>sorting<span class="_ _5"> </span>metho<span class="_ _7"></span>d!<span class="_ _14"> </span>All<span class="_ _b"> </span>of<span class="_ _b"> </span>this</div><div class="t m17 x11 h7 y55 ff3 fs5 fc0 sc0 ls0 ws0">indicates<span class="_ _5"> </span>that<span class="_ _b"> </span>already<span class="_ _b"> </span>the<span class="_ _5"> </span>core<span class="_ _b"> </span>algorithm<span class="_ _b"> </span>in<span class="_ _5"> </span>Timsort<span class="_ _b"> </span>is<span class="_ _b"> </span>(to<span class="_ _7"></span>o?)<span class="_ _f"> </span>complicated,<span class="_ _b"> </span>and<span class="_ _b"> </span>it<span class="_ _5"> </span>raises<span class="_ _b"> </span>the</div><div class="t m0 x11 h7 y56 ff3 fs5 fc0 sc0 ls0 ws0">question<span class="_ _5"> </span>whether<span class="_ _b"> </span>Timsort’s<span class="_ _5"> </span>go<span class="_ _7"></span>o<span class="_ _7"></span>d<span class="_ _b"> </span>prop<span class="_ _7"></span>erties<span class="_ _5"> </span>cannot<span class="_ _b"> </span>b<span class="_ _7"></span>e<span class="_ _5"> </span>achiev<span class="_ _0"></span>ed<span class="_ _b"> </span>in<span class="_ _5"> </span>a<span class="_ _b"> </span>simpler<span class="_ _5"> </span>wa<span class="_ _0"></span>y<span class="_ _6"></span>.</div><div class="t m1 x13 h7 y57 ff3 fs5 fc0 sc0 ls0 ws0">F<span class="_ _6"></span>or<span class="_ _a"> </span>its<span class="_ _f"> </span>theoretical<span class="_ _f"> </span>guaran<span class="_ _4"></span>tees<span class="_ _a"> </span>on<span class="_ _f"> </span>adapting<span class="_ _f"> </span>to<span class="_ _a"> </span>existing<span class="_ _f"> </span>runs<span class="_ _f"> </span>this<span class="_ _f"> </span>is<span class="_ _a"> </span>certainly<span class="_ _f"> </span>the<span class="_ _f"> </span>case.</div><div class="t m4 x11 h7 y58 ff3 fs5 fc0 sc0 ls0 ws0">T<span class="_ _6"></span>akaoka<span class="_ _5"> </span>[</div><div class="t m0 x45 h7 y58 ff3 fs5 fc0 sc0 ls0 ws0">29</div><div class="t m4 x46 h7 y58 ff3 fs5 fc0 sc0 ls0 ws0">,</div><div class="t m0 x47 h7 y58 ff3 fs5 fc0 sc0 ls0 ws0">30</div><div class="t m4 x48 h7 y58 ff3 fs5 fc0 sc0 ls0 ws0">]<span class="_ _5"> </span>and<span class="_ _b"> </span>Barba<span class="_ _4"></span>y<span class="_ _5"> </span>and<span class="_ _b"> </span>Na<span class="_ _4"></span>v<span class="_ _0"></span>arro<span class="_ _5"> </span>[</div><div class="t m0 x30 h7 y58 ff3 fs5 fc0 sc0 ls0 ws0">5</div><div class="t m4 x49 h7 y58 ff3 fs5 fc0 sc0 ls0 ws0">]<span class="_ _5"> </span>indep<span class="_ _7"></span>endently<span class="_ _5"> </span>describ<span class="_ _7"></span>ed<span class="_ _5"> </span>a<span class="_ _b"> </span>sorting<span class="_ _b"> </span>method<span class="_ _b"> </span>that</div><div class="t m1 x11 h7 y59 ff3 fs5 fc0 sc0 ls0 ws0">w<span class="_ _4"></span>e<span class="_ _5"> </span>call<span class="_ _5"> </span><span class="ff7">Huﬀman-Mer<span class="_ _4"></span>ge<span class="_ _b"> </span><span class="ff3">(see<span class="_ _b"> </span>below<span class="_ _5"> </span>why).<span class="_ _f"> </span>It<span class="_ _5"> </span>adapts<span class="_ _5"> </span>even<span class="_ _5"> </span>to<span class="_ _5"> </span>the<span class="_ _b"> </span></span>entr<span class="_ _0"></span>opy<span class="_ _b"> </span>of<span class="_ _b"> </span>the<span class="_ _b"> </span>distribution</span></div><div class="t m1 x11 h7 y5a ff7 fs5 fc0 sc0 ls0 ws0">of run lengths:<span class="_ _10"> </span><span class="ff3">it sorts<span class="_ _3"> </span>an input of</span></div><div class="t m0 x4a h7 y5a ffb fs5 fc0 sc0 ls0 ws0">r</div><div class="t m1 x4b h7 y5a ff3 fs5 fc0 sc0 ls0 ws0">runs with respective<span class="_ _3"> </span>lengths</div><div class="t m0 x25 h7 y5a ffb fs5 fc0 sc0 ls0 ws0">L</div><div class="t m0 x4c h9 y5b ffd fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x4d h7 y5a ffb fs5 fc0 sc0 ls0 ws0">,<span class="_ _15"> </span>.<span class="_ _15"> </span>.<span class="_ _c"> </span>.<span class="_ _15"> </span>,<span class="_ _15"> </span>L</div><div class="t m0 x4e hc y5b ffe fs6 fc0 sc0 ls0 ws0">r</div><div class="t m1 x4f h7 y5a ff3 fs5 fc0 sc0 ls0 ws0">in time</div><div class="t m0 x11 h7 y5c ffb fs5 fc0 sc0 ls0 ws0">O</div><div class="t m0 x50 hb y5d ffc fs5 fc0 sc0 ls0 ws0"></div><div class="t m1 x51 h7 y5c ffa fs5 fc0 sc0 ls0 ws0">(</div><div class="t m0 x35 h7 y5c ff4 fs5 fc0 sc0 ls0 ws0">H</div><div class="t m1 x52 h7 y5c ffa fs5 fc0 sc0 ls0 ws0">(</div><div class="t m0 x53 hc y5e ffe fs6 fc0 sc0 ls0 ws0">L</div><div class="t m0 x16 hd y5f fff fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x54 hc y60 ffe fs6 fc0 sc0 ls0 ws0">n</div><div class="t m0 x55 h7 y5c ffb fs5 fc0 sc0 ls0 ws0">,<span class="_ _15"> </span>.<span class="_ _15"> </span>.<span class="_ _c"> </span>.<span class="_ _15"> </span>,</div><div class="t m0 x56 hc y5e ffe fs6 fc0 sc0 ls0 ws0">L</div><div class="t m0 x57 he y5f ff10 fs7 fc0 sc0 ls0 ws0">r</div><div class="t m0 x58 hc y60 ffe fs6 fc0 sc0 ls0 ws0">n</div><div class="t m1 x59 h7 y5c ffa fs5 fc0 sc0 ls0 ws0">) + 1)</div><div class="t m0 x5a h7 y5c ffb fs5 fc0 sc0 ls0 ws0">n</div><div class="t m0 x5b hb y5d ffc fs5 fc0 sc0 ls0 ws0"></div><div class="t m0 x5c h7 y5c ff4 fs5 fc0 sc0 ls0 ws0">⊆<span class="_ _f"> </span><span class="ffb">O</span></div><div class="t m1 x5d h7 y5c ffa fs5 fc0 sc0 ls0 ws0">(</div><div class="t m0 x5e h7 y5c ffb fs5 fc0 sc0 ls0 ws0">n</div><div class="t m1 x5f h7 y5c ffa fs5 fc0 sc0 ls0 ws0">+</div><div class="t m0 x60 h7 y5c ffb fs5 fc0 sc0 ls0 ws0">n<span class="_ _15"> </span><span class="ffa">lg<span class="_ _c"> </span></span>r</div><div class="t m1 x61 h7 y5c ffa fs5 fc0 sc0 ls0 ws0">)<span class="ff3">,<span class="_ _f"> </span>where</span></div><div class="t m0 x62 h7 y5c ff4 fs5 fc0 sc0 ls0 ws0">H</div><div class="t m1 x63 h7 y5c ffa fs5 fc0 sc0 ls0 ws0">(</div><div class="t m0 x64 h7 y5c ffb fs5 fc0 sc0 ls0 ws0">p</div><div class="t m0 x34 h9 y61 ffd fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x65 h7 y5c ffb fs5 fc0 sc0 ls0 ws0">,<span class="_ _15"> </span>.<span class="_ _15"> </span>.<span class="_ _c"> </span>.<span class="_ _15"> </span>,<span class="_ _15"> </span>p</div><div class="t m0 x66 hc y61 ffe fs6 fc0 sc0 ls0 ws0">r</div><div class="t m1 x67 h7 y5c ffa fs5 fc0 sc0 ls0 ws0">)<span class="_ _f"> </span>=</div><div class="t m0 x3b hb y62 ffc fs5 fc0 sc0 ls0 ws0">P</div><div class="t m0 x68 hc y63 ffe fs6 fc0 sc0 ls0 ws0">r</div><div class="t m0 x68 h9 y64 ffe fs6 fc0 sc0 ls0 ws0">i<span class="ffd">=1</span></div><div class="t m0 x69 h7 y5c ffb fs5 fc0 sc0 ls0 ws0">p</div><div class="t m0 x6a hc y61 ffe fs6 fc0 sc0 ls0 ws0">i</div><div class="t m0 x6b h7 y5c ffa fs5 fc0 sc0 ls0 ws0">lg</div><div class="t m1 x6c h7 y5c ffa fs5 fc0 sc0 ls0 ws0">(1</div><div class="t m0 x6d h7 y5c ffb fs5 fc0 sc0 ls0 ws0">/p</div><div class="t m0 x6e hc y61 ffe fs6 fc0 sc0 ls0 ws0">i</div><div class="t m1 x4f h7 y5c ffa fs5 fc0 sc0 ls0 ws0">)<span class="_ _f"> </span><span class="ff3">is<span class="_ _f"> </span>the</span></div><div class="t m1 x11 h7 y65 ff3 fs5 fc0 sc0 ls0 ws0">binary<span class="_ _3"> </span>Shannon<span class="_ _3"> </span>entrop<span class="_ _0"></span>y<span class="_ _6"></span>.</div><div class="t m0 x6f h9 y66 ff9 fs6 fc0 sc0 ls0 ws0">2</div><div class="t m1 x37 h7 y65 ff3 fs5 fc0 sc0 ls0 ws0">Since</div><div class="t m0 x70 h7 y65 ff4 fs5 fc0 sc0 ls0 ws0">H</div><div class="t m1 x71 h7 y65 ffa fs5 fc0 sc0 ls0 ws0">(</div><div class="t m0 x72 hc y67 ffe fs6 fc0 sc0 ls0 ws0">L</div><div class="t m0 x2a hd y68 fff fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x73 hc y69 ffe fs6 fc0 sc0 ls0 ws0">n</div><div class="t m0 x2b h7 y65 ffb fs5 fc0 sc0 ls0 ws0">,<span class="_ _15"> </span>.<span class="_ _15"> </span>.<span class="_ _c"> </span>.<span class="_ _15"> </span>,</div><div class="t m0 x31 hc y67 ffe fs6 fc0 sc0 ls0 ws0">L</div><div class="t m0 x74 he y68 ff10 fs7 fc0 sc0 ls0 ws0">r</div><div class="t m0 x75 hc y69 ffe fs6 fc0 sc0 ls0 ws0">n</div><div class="t m1 x76 h7 y65 ffa fs5 fc0 sc0 ls0 ws0">)</div><div class="t m0 x77 h7 y65 ffb fs5 fc0 sc0 ls0 ws0">n<span class="_ _5"> </span><span class="ff4">−<span class="_ _5"> </span></span>O</div><div class="t m1 x78 h7 y65 ffa fs5 fc0 sc0 ls0 ws0">(</div><div class="t m0 x79 h7 y65 ffb fs5 fc0 sc0 ls0 ws0">n</div><div class="t m1 x3e h7 y65 ffa fs5 fc0 sc0 ls0 ws0">)<span class="_ _3"> </span><span class="ff3">comparisons<span class="_ _3"> </span>are necessary<span class="_ _f"> </span>for</span></div><div class="t m1 x11 h7 y6a ff3 fs5 fc0 sc0 ls0 ws0">distinct<span class="_ _b"> </span>keys,<span class="_ _a"> </span>Huﬀman-Merge<span class="_ _b"> </span>is<span class="_ _a"> </span>optimal<span class="_ _b"> </span>up<span class="_ _a"> </span>to</div><div class="t m0 x7a h7 y6a ffb fs5 fc0 sc0 ls0 ws0">O</div><div class="t m1 x33 h7 y6a ffa fs5 fc0 sc0 ls0 ws0">(</div><div class="t m0 x62 h7 y6a ffb fs5 fc0 sc0 ls0 ws0">n</div><div class="t m1 x7b h7 y6a ffa fs5 fc0 sc0 ls0 ws0">)<span class="ff3">.<span class="_ _14"> </span>The<span class="_ _a"> </span>algorithm<span class="_ _b"> </span>is<span class="_ _a"> </span>also<span class="_ _b"> </span>conceptually</span></div><div class="t m4 x11 h7 y6b ff3 fs5 fc0 sc0 ls0 ws0">simple:<span class="_ _a"> </span>ﬁnd<span class="_ _8"> </span>runs<span class="_ _8"> </span>in<span class="_ _8"> </span>a<span class="_ _8"> </span>linear<span class="_ _8"> </span>scan,<span class="_ _8"> </span>determine<span class="_ _8"> </span>an<span class="_ _8"> </span>optimal<span class="_ _8"> </span>merging<span class="_ _9"> </span>order<span class="_ _8"> </span>using<span class="_ _8"> </span>a<span class="_ _8"> </span>Huﬀman<span class="_ _8"> </span>tree<span class="_ _8"> </span>of</div><div class="t ma x11 h7 y6c ff3 fs5 fc0 sc0 ls0 ws0">the<span class="_ _5"> </span>run<span class="_ _b"> </span>lengths,<span class="_ _b"> </span>and<span class="_ _5"> </span>execute<span class="_ _b"> </span>those<span class="_ _b"> </span>merges<span class="_ _5"> </span>b<span class="_ _7"></span>ottom-up<span class="_ _b"> </span>in<span class="_ _b"> </span>the<span class="_ _b"> </span>tree.<span class="_ _f"> </span>How<span class="_ _0"></span>ever,<span class="_ _5"> </span>straight-forw<span class="_ _0"></span>ard</div><div class="t m0 x11 hf y6d ff11 fs8 fc0 sc0 ls0 ws0">1</div><div class="t m3 x50 h10 y6e ff12 fs9 fc0 sc0 ls0 ws0">The<span class="_ _8"> </span>median<span class="_ _5"> </span>of<span class="_ _8"> </span>three<span class="_ _8"> </span>elements<span class="_ _8"> </span>is<span class="_ _5"> </span>c<span class="_ _0"></span>hosen<span class="_ _5"> </span>as<span class="_ _8"> </span>the<span class="_ _5"> </span>piv<span class="_ _0"></span>ot,<span class="_ _5"> </span>eac<span class="_ _4"></span>h<span class="_ _8"> </span>of<span class="_ _5"> </span>whic<span class="_ _0"></span>h<span class="_ _5"> </span>is<span class="_ _8"> </span>a<span class="_ _5"> </span>median<span class="_ _8"> </span>of<span class="_ _8"> </span>three<span class="_ _5"> </span>other<span class="_ _8"> </span>elements.</div><div class="t m18 x50 h10 y6f ff12 fs9 fc0 sc0 ls0 ws0">This<span class="_ _8"> </span>is<span class="_ _8"> </span>a<span class="_ _5"> </span>goo<span class="_ _7"></span>d<span class="_ _5"> </span>appro<span class="_ _0"></span>ximation<span class="_ _5"> </span>of<span class="_ _8"> </span>the<span class="_ _8"> </span>median<span class="_ _5"> </span>of<span class="_ _8"> </span>9<span class="_ _8"> </span>elements<span class="_ _8"> </span>and<span class="_ _8"> </span>a<span class="_ _5"> </span>recommended<span class="_ _8"> </span>pivot<span class="_ _8"> </span>selection<span class="_ _8"> </span>rule<span class="_ _8"> </span>[</div><div class="t m0 x1d h10 y6f ff12 fs9 fc0 sc0 ls0 ws0">8</div><div class="t m18 x7c h10 y6f ff12 fs9 fc0 sc0 ls0 ws0">].</div><div class="t m0 x11 hf y70 ff11 fs8 fc0 sc0 ls0 ws0">2</div><div class="t m1 x7d h10 y71 ff12 fs9 fc0 sc0 ls0 ws0">Note<span class="_ _5"> </span>that</div><div class="t m0 x7e h10 y71 ff13 fs9 fc0 sc0 ls0 ws0">H</div><div class="t m1 x47 h10 y71 ff14 fs9 fc0 sc0 ls0 ws0">(</div><div class="t m0 x7f h10 y71 ff15 fs9 fc0 sc0 ls0 ws0">L</div><div class="t m0 x58 hf y72 ff16 fs8 fc0 sc0 ls0 ws0">1</div><div class="t m0 x80 h10 y71 ff15 fs9 fc0 sc0 ls0 ws0">/n,<span class="_ _12"> </span>.<span class="_ _15"> </span>.<span class="_ _15"> </span>.<span class="_ _12"> </span>,<span class="_ _15"> </span>L</div><div class="t m0 x81 h11 y72 ff17 fs8 fc0 sc0 ls0 ws0">r</div><div class="t m0 x82 h10 y71 ff15 fs9 fc0 sc0 ls0 ws0">/n</div><div class="t m1 x83 h10 y71 ff14 fs9 fc0 sc0 ls0 ws0">)<span class="_ _5"> </span><span class="ff12">can<span class="_ _5"> </span>b<span class="_ _7"></span>e<span class="_ _5"> </span>signiﬁcantly<span class="_ _5"> </span>smaller<span class="_ _5"> </span>than</span></div><div class="t m0 x84 h10 y71 ff14 fs9 fc0 sc0 ls0 ws0">lg<span class="_ _15"> </span><span class="ff15">r</span></div><div class="t m1 x85 h10 y71 ff12 fs9 fc0 sc0 ls0 ws0">: Consider<span class="_ _5"> </span>the<span class="_ _b"> </span>run<span class="_ _5"> </span>lengths</div><div class="t m0 x86 h10 y71 ff15 fs9 fc0 sc0 ls0 ws0">L</div><div class="t m0 x87 hf y72 ff16 fs8 fc0 sc0 ls0 ws0">1</div><div class="t m1 x88 h10 y71 ff14 fs9 fc0 sc0 ls0 ws0">=</div><div class="t m0 x7d h10 y73 ff15 fs9 fc0 sc0 ls0 ws0">n<span class="_ _9"> </span><span class="ff13">−<span class="_ _c"> </span>d</span>n/<span class="_ _15"> </span><span class="ff14">lg<span class="_ _15"> </span></span>n<span class="ff13">e</span></div><div class="t m1 x7f h10 y73 ff12 fs9 fc0 sc0 ls0 ws0">and</div><div class="t m0 x1a h10 y73 ff15 fs9 fc0 sc0 ls0 ws0">L</div><div class="t m0 x89 hf y74 ff16 fs8 fc0 sc0 ls0 ws0">2</div><div class="t m1 x8a h10 y73 ff14 fs9 fc0 sc0 ls0 ws0">=</div><div class="t m0 x5a h10 y73 ff13 fs9 fc0 sc0 ls0 ws0">·<span class="_ _12"></span>·<span class="_ _15"></span>·</div><div class="t m1 xb h10 y73 ff14 fs9 fc0 sc0 ls0 ws0">=</div><div class="t m0 x37 h10 y73 ff15 fs9 fc0 sc0 ls0 ws0">L</div><div class="t m0 x22 h11 y74 ff17 fs8 fc0 sc0 ls0 ws0">r</div><div class="t m1 x8b h10 y73 ff14 fs9 fc0 sc0 ls0 ws0">=<span class="_ _5"> </span>1<span class="ff12">,</span></div><div class="t m0 x8c h10 y73 ff12 fs9 fc0 sc0 ls0 ws0">i.<span class="_ _2"></span>e.</div><div class="t m1 x4a h10 y73 ff12 fs9 fc0 sc0 ls0 ws0">,</div><div class="t m0 x2b h10 y73 ff15 fs9 fc0 sc0 ls0 ws0">r</div><div class="t m1 x8d h10 y73 ff14 fs9 fc0 sc0 ls0 ws0">=<span class="_ _5"> </span>1<span class="_ _c"> </span>+</div><div class="t m0 x8e h10 y73 ff13 fs9 fc0 sc0 ls0 ws0">d<span class="ff15">n/<span class="_ _12"> </span><span class="ff14">lg<span class="_ _15"> </span></span>n</span>e</div><div class="t m1 x8f h10 y73 ff12 fs9 fc0 sc0 ls0 ws0">.<span class="_ _16"> </span>Then</div><div class="t m0 x66 h10 y73 ff13 fs9 fc0 sc0 ls0 ws0">H<span class="_ _5"> </span>≤</div><div class="t m1 x90 h10 y73 ff14 fs9 fc0 sc0 ls0 ws0">2<span class="ff12">,<span class="_ _5"> </span>but</span></div><div class="t m0 x40 h10 y73 ff14 fs9 fc0 sc0 ls0 ws0">lg<span class="_ _15"> </span><span class="ff15">r<span class="_ _5"> </span><span class="ff13">∼<span class="_ _5"> </span></span></span>lg<span class="_ _15"> </span><span class="ff15">n</span></div><div class="t m1 x91 h10 y73 ff12 fs9 fc0 sc0 ls0 ws0">.<span class="_ _16"> </span>(Indeed,</div><div class="t m0 x7d h10 y26 ff13 fs9 fc0 sc0 ls0 ws0">H<span class="_ _9"> </span>→<span class="_ _9"> </span><span class="ff14">1<span class="_ _5"> </span><span class="ff12">and<span class="_ _8"> </span>the<span class="_ _8"> </span>input<span class="_ _5"> </span>can<span class="_ _8"> </span>indeed<span class="_ _8"> </span>b<span class="_ _7"></span>e<span class="_ _5"> </span>sorted<span class="_ _8"> </span>with<span class="_ _8"> </span>ov<span class="_ _0"></span>erall<span class="_ _5"> </span>costs<span class="_ _8"> </span><span class="ff14">2<span class="ff15">n</span></span>.)</span></span></div><a class="l" href="#pff" data-dest-detail='[15,"XYZ",90.709,569.022,null]'><div class="d m7" style="border-style:none;position:absolute;left:238.600246px;bottom:1208.404169px;width:11.955000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",90.709,382.486,null]'><div class="d m7" style="border-style:none;position:absolute;left:283.581062px;bottom:1143.131925px;width:11.956000px;height:8.267000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",90.709,618.836,null]'><div class="d m7" style="border-style:none;position:absolute;left:310.476149px;bottom:1143.131925px;width:11.955000px;height:8.267000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",90.709,147.191,null]'><div class="d m7" style="border-style:none;position:absolute;left:814.027443px;bottom:1120.957337px;width:11.955000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf2" data-dest-detail='[2,"XYZ",116.058,162.001,null]'><div class="d m7" style="border-style:none;position:absolute;left:827.149087px;bottom:1095.016429px;width:6.462000px;height:12.490000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",90.709,408.076,null]'><div class="d m7" style="border-style:none;position:absolute;left:461.458214px;bottom:968.658236px;width:11.955000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",107.717,500.716,null]'><div class="d m7" style="border-style:none;position:absolute;left:467.226967px;bottom:946.901941px;width:6.974000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",107.717,231.384,null]'><div class="d m7" style="border-style:none;position:absolute;left:832.974956px;bottom:881.211404px;width:6.973000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",107.717,500.716,null]'><div class="d m7" style="border-style:none;position:absolute;left:624.784134px;bottom:772.426572px;width:6.974000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",107.717,231.384,null]'><div class="d m7" style="border-style:none;position:absolute;left:679.510009px;bottom:772.426572px;width:6.974000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",107.717,549.127,null]'><div class="d m7" style="border-style:none;position:absolute;left:595.333929px;bottom:750.670277px;width:6.974000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",107.717,205.624,null]'><div class="d m7" style="border-style:none;position:absolute;left:226.778839px;bottom:663.223446px;width:11.955000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",107.717,549.127,null]'><div class="d m7" style="border-style:none;position:absolute;left:444.007486px;bottom:576.194908px;width:6.974000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",90.709,295.313,null]'><div class="d m7" style="border-style:none;position:absolute;left:249.282686px;bottom:466.991782px;width:11.955000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",90.709,270.143,null]'><div class="d m7" style="border-style:none;position:absolute;left:276.056821px;bottom:466.991782px;width:11.956000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",107.717,373.098,null]'><div class="d m7" style="border-style:none;position:absolute;left:490.930258px;bottom:466.991782px;width:6.974000px;height:8.266000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf2" data-dest-detail='[2,"XYZ",116.239,142.346,null]'><div class="d m7" style="border-style:none;position:absolute;left:367.276692px;bottom:374.192811px;width:6.462000px;height:14.278000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",107.717,257.933,null]'><div class="d m7" style="border-style:none;position:absolute;left:830.527352px;bottom:238.672481px;width:6.344000px;height:7.350000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.679893,0.000000,0.000000,1.679893,0.000000,0.000000]}'></div></div>
