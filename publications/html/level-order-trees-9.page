<div id="pf9" class="pf w0 h0" data-page-no="9"><div class="pc pc9 w0 h0"><img class="bi xbb y5d w7 h1d" alt="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOgAAAAmCAIAAABBKUDrAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAZUlEQVR42u3SQREAMAjAsDEJ+PeDKR7o4Egk9Bpd+WCbLwHGBeOCcTEuGBeMi3HBuGBcMC7GBeOCcTEuGBeMi3HBuGBcMC7GBeOCcTEuGBeMi3HBuGBcMC7GBeOCcTEuGBeMy00DV2sCITbRwEkAAAAASUVORK5CYII="/><div class="t m0 x0 h5 y2c ff1 fs3 fc0 sc0 ls0 ws0">M.<span class="_ _a"> </span>He,<span class="_ _e"> </span>J.<span class="_ _11"> </span>I.<span class="_ _a"> </span>Munro,<span class="_ _a"> </span>Y.<span class="_ _a"> </span>Nekrich,<span class="_ _a"> </span>S.<span class="_ _a"> </span>Wild,<span class="_ _e"> </span>K.<span class="_ _a"> </span>Wu<span class="_ _18"> </span>9</div><div class="t m18 x0 h7 y2d ff7 fs4 fc0 sc0 ls0 ws0">level-or<span class="_ _2"></span>der<span class="_ _e"> </span>changer<span class="_ _d"> </span><span class="ff3">if</span></div><div class="t m0 x142 h7 y2d ff4 fs4 fc0 sc0 ls0 ws0">w</div><div class="t m0 xd7 h13 y197 ff15 fs5 fc0 sc0 ls0 ws0">i<span class="ff17">−<span class="ff11">1</span></span></div><div class="t m18 x13 h7 y2d ff3 fs4 fc0 sc0 ls0 ws0">and</div><div class="t m0 x11f h7 y2d ff4 fs4 fc0 sc0 ls0 ws0">w</div><div class="t m0 xff h13 y197 ff15 fs5 fc0 sc0 ls0 ws0">i</div><div class="t m18 xf0 h7 y2d ff3 fs4 fc0 sc0 ls0 ws0">are<span class="_ _4"> </span>in<span class="_ _e"> </span>diﬀeren<span class="_ _2"></span>t<span class="_ _e"> </span>mini<span class="_ _4"> </span>(micro)<span class="_ _e"> </span>trees.<span class="_ _d"> </span>The<span class="_ _e"> </span>follo<span class="_ _2"></span>wing<span class="_ _e"> </span>lemma</div><div class="t m0 x0 h7 y2e ff3 fs4 fc0 sc0 ls0 ws0">b<span class="_ _7"></span>ounds<span class="_ _4"> </span>the<span class="_ _e"> </span>n<span class="_ _2"></span>umber<span class="_ _e"> </span>of<span class="_ _4"> </span>tier-1<span class="_ _e"> </span>(tier-2)<span class="_ _4"> </span>level-order<span class="_ _4"> </span>c<span class="_ _2"></span>hangers<span class="_ _e"> </span>(see<span class="_ _4"> </span>App<span class="_ _7"></span>endix<span class="_ _e"> </span>D<span class="_ _4"> </span>for<span class="_ _4"> </span>its<span class="_ _e"> </span>pro<span class="_ _7"></span>of<span class="_ _7"></span>).</div><div class="t m0 x0 h7 y198 ff12 fs4 fc1 sc0 ls0 ws0">I<span class="_ _d"> </span><span class="ff1 fc0">Lemma<span class="_ _26"> </span>4.</span></div><div class="t m2 x17d h7 y198 ff7 fs4 fc0 sc0 ls0 ws0">The<span class="_ _d"> </span>numb<span class="_ _5"></span>er<span class="_ _d"> </span>of<span class="_ _3"> </span>tier-1<span class="_ _3"> </span>(tier-2)<span class="_ _3"> </span>level-or<span class="_ _2"></span>der<span class="_ _3"> </span>changers<span class="_ _3"> </span>is</div><div class="t m0 xd0 h7 y198 ff4 fs4 fc0 sc0 ls0 ws0">O</div><div class="t m2 x126 h7 y198 ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x17f h7 y198 ff4 fs4 fc0 sc0 ls0 ws0">n/H</div><div class="t m2 x8d h7 y198 ff6 fs4 fc0 sc0 ls0 ws0">+</div><div class="t m0 x3f h7 y198 ff4 fs4 fc0 sc0 ls0 ws0">nH<span class="_ _7"></span>/B</div><div class="t m2 x149 h7 y198 ff6 fs4 fc0 sc0 ls0 ws0">)<span class="_ _d"> </span>=</div><div class="t m0 x0 h7 y199 ff4 fs4 fc0 sc0 ls0 ws0">O<span class="_ _7"></span><span class="ff6">(</span>n/<span class="_ _13"> </span><span class="ff6">log</span></div><div class="t m0 x11d h13 y19a ff11 fs5 fc0 sc0 ls0 ws0">2</div><div class="t m0 x140 h7 y199 ff4 fs4 fc0 sc0 ls0 ws0">n<span class="ff6">)<span class="_ _e"> </span><span class="ff7">(</span></span>O<span class="_ _7"></span><span class="ff6">(</span>n/H</div><div class="t m0 x59 h17 y19b ff17 fs5 fc0 sc0 ls0 ws0">0</div><div class="t m0 xd6 h7 y199 ff6 fs4 fc0 sc0 ls0 ws0">+<span class="_ _10"> </span><span class="ff4">nH</span></div><div class="t m0 x115 h17 y19b ff17 fs5 fc0 sc0 ls0 ws0">0</div><div class="t m0 xa2 h7 y199 ff4 fs4 fc0 sc0 ls0 ws0">/B</div><div class="t m0 x11f h17 y19b ff17 fs5 fc0 sc0 ls0 ws0">0</div><div class="t m0 x169 h7 y199 ff6 fs4 fc0 sc0 ls0 ws0">) = <span class="ff4">O<span class="_ _7"></span></span>(<span class="ff4">n/</span>(log<span class="_ _13"> </span>log<span class="_ _11"> </span><span class="ff4">n</span>)</div><div class="t m0 x10d h13 y19b ff11 fs5 fc0 sc0 ls0 ws0">2</div><div class="t m0 x22 h7 y199 ff6 fs4 fc0 sc0 ls0 ws0">)<span class="ff7">).</span></div><div class="t m0 x0 h7 y19c ff3 fs4 fc0 sc0 ls0 ws0">With<span class="_ _4"> </span>that<span class="_ _e"> </span>preparation<span class="_ _4"> </span>done,<span class="_ _e"> </span>w<span class="_ _2"></span>e<span class="_ _e"> </span>proceed<span class="_ _e"> </span>similarly<span class="_ _4"> </span>as<span class="_ _e"> </span>for<span class="_ _4"> </span>preorder.</div><div class="t m0 x0 h7 y19d ff1 fs4 fc0 sc0 ls0 ws0">Select</div><div class="t m1 x11d h7 y19d ff3 fs4 fc0 sc0 ls0 ws0">Giv<span class="_ _5"></span>en<span class="_ _4"> </span>the<span class="_ _4"> </span>level-order<span class="_ _4"> </span>rank</div><div class="t m0 x18 h7 y19d ff4 fs4 fc0 sc0 ls0 ws0">i</div><div class="t m1 xe1 h7 y19d ff3 fs4 fc0 sc0 ls0 ws0">,<span class="_ _4"> </span>ﬁnd</div><div class="t m0 x155 h7 y19d ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m1 x119 h7 y19d ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x36 h7 y19d ff4 fs4 fc0 sc0 ls0 ws0">w</div><div class="t m0 xa6 h13 y19e ff15 fs5 fc0 sc0 ls0 ws0">i</div><div class="t m1 x1e h7 y19d ff6 fs4 fc0 sc0 ls0 ws0">)<span class="ff3">.<span class="_ _3"> </span>W<span class="_ _6"></span>e<span class="_ _4"> </span>store</span></div><div class="t m0 x4 h7 y19d ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 xe4 h13 y19e ff11 fs5 fc0 sc0 ls0 ws0">1</div><div class="t m1 x180 h7 y19d ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x27 h7 y19d ff4 fs4 fc0 sc0 ls0 ws0">w</div><div class="t m0 x104 h13 y19e ff11 fs5 fc0 sc0 ls0 ws0">1</div><div class="t m1 x9d h7 y19d ff6 fs4 fc0 sc0 ls0 ws0">)</div><div class="t m0 x88 h7 y19d ff4 fs4 fc0 sc0 ls0 ws0">,<span class="_ _13"> </span>.<span class="_ _13"> </span>.<span class="_ _13"> </span>.<span class="_ _13"> </span>,<span class="_ _13"> </span>τ</div><div class="t m0 xd0 h13 y19e ff11 fs5 fc0 sc0 ls0 ws0">1</div><div class="t m1 x158 h7 y19d ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x126 h7 y19d ff4 fs4 fc0 sc0 ls0 ws0">w</div><div class="t m0 xfb h13 y19e ff15 fs5 fc0 sc0 ls0 ws0">n</div><div class="t m1 x9 h7 y19d ff6 fs4 fc0 sc0 ls0 ws0">)<span class="_ _4"> </span><span class="ff3">in<span class="_ _4"> </span>a<span class="_ _e"> </span>piece-wise</span></div><div class="t m1a x0 h7 y19f ff3 fs4 fc0 sc0 ls0 ws0">constan<span class="_ _5"></span>t<span class="_ _4"> </span>array<span class="_ _8"></span>,<span class="_ _e"> </span>using<span class="_ _e"> </span>the<span class="_ _4"> </span>same<span class="_ _e"> </span>tec<span class="_ _2"></span>hnique<span class="_ _e"> </span>as<span class="_ _4"> </span>for<span class="_ _e"> </span>preorder<span class="_ _e"> </span>(compressed<span class="_ _4"> </span>bitvector<span class="_ _4"> </span>for<span class="_ _e"> </span>c<span class="_ _2"></span>hangers,</div><div class="t m0 x0 h7 y1a0 ff3 fs4 fc0 sc0 ls0 ws0">explicit<span class="_ _4"> </span>v<span class="_ _2"></span>alues<span class="_ _e"> </span>at<span class="_ _4"> </span>changers),<span class="_ _4"> </span>and<span class="_ _4"> </span>similarly<span class="_ _e"> </span>for<span class="_ _4"> </span><span class="ff4">τ</span></div><div class="t m0 x61 h13 y1a1 ff11 fs5 fc0 sc0 ls0 ws0">2</div><div class="t m0 x170 h7 y1a0 ff6 fs4 fc0 sc0 ls0 ws0">(<span class="ff4">w</span></div><div class="t m0 x73 h13 y1a1 ff11 fs5 fc0 sc0 ls0 ws0">1</div><div class="t m0 x10d h7 y1a0 ff6 fs4 fc0 sc0 ls0 ws0">)<span class="ff4">,<span class="_ _13"> </span>.<span class="_ _13"> </span>.<span class="_ _13"> </span>.<span class="_ _13"> </span>,<span class="_ _13"> </span>τ</span></div><div class="t m0 x14d h13 y1a1 ff11 fs5 fc0 sc0 ls0 ws0">3</div><div class="t m0 x117 h7 y1a0 ff6 fs4 fc0 sc0 ls0 ws0">(<span class="ff4">w</span></div><div class="t m0 x7 h13 y1a1 ff15 fs5 fc0 sc0 ls0 ws0">n</div><div class="t m0 x50 h7 y1a0 ff6 fs4 fc0 sc0 ls0 ws0">)<span class="ff3">.<span class="_ _d"> </span>Both<span class="_ _e"> </span>require<span class="_ _4"> </span><span class="ff4">o</span></span>(<span class="ff4">n</span>)<span class="_ _e"> </span><span class="ff3">bits.</span></div><div class="t m2 x9b h7 y1a2 ff3 fs4 fc0 sc0 ls0 ws0">F<span class="_ _6"></span>or</div><div class="t m0 xb4 h7 y1a2 ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x11d h13 y1a3 ff11 fs5 fc0 sc0 ls0 ws0">3</div><div class="t m2 xd1 h7 y1a2 ff3 fs4 fc0 sc0 ls0 ws0">,<span class="_ _4"> </span>we<span class="_ _4"> </span>ha<span class="_ _5"></span>v<span class="_ _5"></span>e<span class="_ _4"> </span>to<span class="_ _e"> </span>tak<span class="_ _2"></span>e<span class="_ _e"> </span>an<span class="_ _4"> </span>extra<span class="_ _4"> </span>step<span class="_ _e"> </span>as<span class="_ _4"> </span>w<span class="_ _5"></span>e<span class="_ _4"> </span>don’t<span class="_ _e"> </span>visit<span class="_ _4"> </span>nodes<span class="_ _e"> </span>in<span class="_ _4"> </span>preorder<span class="_ _e"> </span>no<span class="_ _2"></span>w.<span class="_ _3"> </span>But<span class="_ _4"> </span>we</div><div class="t mc x0 h7 y1a4 ff3 fs4 fc0 sc0 ls0 ws0">can<span class="_ _4"> </span>store<span class="_ _e"> </span>the<span class="_ _4"> </span>micro-tree-lo<span class="_ _7"></span>cal<span class="_ _e"> </span><span class="ff7">level-or<span class="_ _2"></span>der<span class="_ _d"> </span><span class="ff3">rank<span class="_ _e"> </span>at<span class="_ _4"> </span>all<span class="_ _e"> </span>tier-2<span class="_ _4"> </span>level-order<span class="_ _4"> </span>changers<span class="_ _4"> </span>and<span class="_ _e"> </span>compute</span></span></div><div class="t m1 x0 h7 y1a5 ff3 fs4 fc0 sc0 ls0 ws0">the<span class="_ _4"> </span>distance<span class="_ _4"> </span>of</div><div class="t m0 x79 h7 y1a5 ff4 fs4 fc0 sc0 ls0 ws0">w</div><div class="t m0 x13a h13 y1a6 ff15 fs5 fc0 sc0 ls0 ws0">i</div><div class="t m1 x5b h7 y1a5 ff3 fs4 fc0 sc0 ls0 ws0">from<span class="_ _4"> </span>its<span class="_ _4"> </span>tier-2<span class="_ _e"> </span>c<span class="_ _2"></span>hanger.<span class="_ _3"> </span>The<span class="_ _e"> </span>sum<span class="_ _4"> </span>is<span class="_ _4"> </span>the<span class="_ _4"> </span>micro-tree-lo<span class="_ _7"></span>cal<span class="_ _e"> </span>lev<span class="_ _2"></span>el-order<span class="_ _e"> </span>rank<span class="_ _4"> </span>of</div><div class="t m0 x0 h7 y1a7 ff4 fs4 fc0 sc0 ls0 ws0">w</div><div class="t m0 x181 h13 y1a8 ff15 fs5 fc0 sc0 ls0 ws0">i</div><div class="t m0 x6c h7 y1a7 ff3 fs4 fc0 sc0 ls0 ws0">,<span class="_ _4"> </span>which<span class="_ _4"> </span>we<span class="_ _4"> </span>translate<span class="_ _4"> </span>to<span class="_ _e"> </span><span class="ff4">τ</span></div><div class="t m0 x4d h13 y1a8 ff11 fs5 fc0 sc0 ls0 ws0">3</div><div class="t m0 x115 h7 y1a7 ff6 fs4 fc0 sc0 ls0 ws0">(<span class="ff4">w</span></div><div class="t m0 x124 h13 y1a8 ff15 fs5 fc0 sc0 ls0 ws0">i</div><div class="t m0 xe9 h7 y1a7 ff6 fs4 fc0 sc0 ls0 ws0">)<span class="_ _4"> </span><span class="ff3">using<span class="_ _e"> </span>the<span class="_ _4"> </span>lo<span class="_ _7"></span>okup<span class="_ _e"> </span>table.</span></div><div class="t m0 x0 h7 y1a9 ff1 fs4 fc0 sc0 ls0 ws0">Rank</div><div class="t m25 xb4 h7 y1a9 ff3 fs4 fc0 sc0 ls0 ws0">Giv<span class="_ _5"></span>en<span class="_ _4"> </span>a<span class="_ _e"> </span>node</div><div class="t m0 x10 h7 y1a9 ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m25 xd7 h7 y1a9 ff3 fs4 fc0 sc0 ls0 ws0">b<span class="_ _5"></span>y</div><div class="t m0 x84 h7 y1a9 ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m25 x85 h7 y1a9 ff3 fs4 fc0 sc0 ls0 ws0">-name,<span class="_ _4"> </span>we<span class="_ _4"> </span>now<span class="_ _4"> </span>seek<span class="_ _4"> </span>the</div><div class="t m0 x22 h7 y1a9 ff4 fs4 fc0 sc0 ls0 ws0">i</div><div class="t m25 x54 h7 y1a9 ff3 fs4 fc0 sc0 ls0 ws0">with</div><div class="t m0 xcf h7 y1a9 ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m25 x27 h7 y1a9 ff6 fs4 fc0 sc0 ls0 ws0">=</div><div class="t m0 x9d h7 y1a9 ff4 fs4 fc0 sc0 ls0 ws0">w</div><div class="t m0 x13b h13 y1aa ff15 fs5 fc0 sc0 ls0 ws0">i</div><div class="t m25 x167 h7 y1a9 ff3 fs4 fc0 sc0 ls0 ws0">.<span class="_ _d"> </span>W<span class="_ _6"></span>e<span class="_ _e"> </span>pro<span class="_ _7"></span>ceed<span class="_ _4"> </span>similarly<span class="_ _e"> </span>as</div><div class="t me x0 h7 y1ab ff3 fs4 fc0 sc0 ls0 ws0">for<span class="_ _4"> </span>preorder<span class="_ _e"> </span>rank,</div><div class="t m0 x9c h7 y1ab ff3 fs4 fc0 sc0 ls0 ws0">i.<span class="_ _b"></span>e.</div><div class="t me x46 h7 y1ab ff3 fs4 fc0 sc0 ls0 ws0">,<span class="_ _4"> </span>we<span class="_ _4"> </span>compute</div><div class="t m0 xe1 h7 y1ab ff4 fs4 fc0 sc0 ls0 ws0">i</div><div class="t me x19 h7 y1ab ff3 fs4 fc0 sc0 ls0 ws0">as</div><div class="t m0 x35 h7 y1ab ff4 fs4 fc0 sc0 ls0 ws0">j</div><div class="t me x155 h7 y1ab ff6 fs4 fc0 sc0 ls0 ws0">+<span class="_ _10"> </span>(</div><div class="t m0 x6b h7 y1ab ff4 fs4 fc0 sc0 ls0 ws0">j</div><div class="t m0 xf8 h17 y1ac ff17 fs5 fc0 sc0 ls0 ws0">0</div><div class="t m0 x182 h7 y1ab ff5 fs4 fc0 sc0 ls0 ws0">−<span class="_ _10"> </span><span class="ff4">j</span></div><div class="t me x73 h7 y1ab ff6 fs4 fc0 sc0 ls0 ws0">)<span class="_ _10"> </span>+<span class="_ _11"> </span>(</div><div class="t m0 x39 h7 y1ab ff4 fs4 fc0 sc0 ls0 ws0">i<span class="_ _10"> </span><span class="ff5">−<span class="_ _11"></span></span>j</div><div class="t me x5 h7 y1ab ff6 fs4 fc0 sc0 ls0 ws0">)<span class="_ _4"> </span><span class="ff3">for</span></div><div class="t m0 x13b h7 y1ab ff4 fs4 fc0 sc0 ls0 ws0">w</div><div class="t m0 x107 h13 y1ad ff15 fs5 fc0 sc0 ls0 ws0">j</div><div class="t me x2b h7 y1ab ff3 fs4 fc0 sc0 ls0 ws0">and</div><div class="t m0 x8b h7 y1ab ff4 fs4 fc0 sc0 ls0 ws0">w</div><div class="t m0 x172 h13 y1ad ff15 fs5 fc0 sc0 ls0 ws0">j</div><div class="t m0 x9 h1a y1ae ff19 fs9 fc0 sc0 ls0 ws0">0</div><div class="t me x55 h7 y1ab ff3 fs4 fc0 sc0 ls0 ws0">the<span class="_ _4"> </span>tier-1<span class="_ _e"> </span>resp.</div><div class="t m0 x0 h7 y1af ff3 fs4 fc0 sc0 ls0 ws0">tier-2<span class="_ _4"> </span>level-order<span class="_ _4"> </span>changers<span class="_ _4"> </span>of<span class="_ _4"> </span><span class="ff4">v<span class="_ _4"> </span><span class="ff6">= </span>w</span></div><div class="t m0 x18 h13 y1b0 ff15 fs5 fc0 sc0 ls0 ws0">i</div><div class="t m0 xe1 h7 y1af ff3 fs4 fc0 sc0 ls0 ws0">.</div><div class="t m2 x9b h7 y1b1 ff3 fs4 fc0 sc0 ls0 ws0">F<span class="_ _6"></span>rom<span class="_ _e"> </span>the<span class="_ _e"> </span>micro-tree<span class="_ _e"> </span>lo<span class="_ _7"></span>okup<span class="_ _e"> </span>table,<span class="_ _a"> </span>w<span class="_ _2"></span>e<span class="_ _a"> </span>obtain</div><div class="t m0 xdb h7 y1b1 ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x21 h13 y1b2 ff11 fs5 fc0 sc0 ls0 ws0">3</div><div class="t m2 x183 h7 y1b1 ff3 fs4 fc0 sc0 ls0 ws0">of</div><div class="t m0 x99 h7 y1b1 ff4 fs4 fc0 sc0 ls0 ws0">w</div><div class="t m0 x25 h13 y1b2 ff15 fs5 fc0 sc0 ls0 ws0">j</div><div class="t m0 x153 h1a y1b3 ff19 fs9 fc0 sc0 ls0 ws0">0</div><div class="t m2 x5 h7 y1b1 ff3 fs4 fc0 sc0 ls0 ws0">and<span class="_ _e"> </span>the<span class="_ _e"> </span>level-order<span class="_ _e"> </span>distance<span class="_ _e"> </span>to</div><div class="t m0 x0 h7 y1b4 ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m2 x3 h7 y1b4 ff3 fs4 fc0 sc0 ls0 ws0">.<span class="_ _25"> </span>F<span class="_ _6"></span>or<span class="_ _a"> </span>tier-2<span class="_ _e"> </span>c<span class="_ _2"></span>hangers,<span class="_ _a"> </span>we<span class="_ _e"> </span>store<span class="_ _e"> </span>the<span class="_ _e"> </span>mapping<span class="_ _e"> </span>from</div><div class="t m0 x184 h7 y1b4 ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m2 x23 h7 y1b4 ff3 fs4 fc0 sc0 ls0 ws0">to<span class="_ _e"> </span>distance<span class="_ _e"> </span>(in<span class="_ _e"> </span>level<span class="_ _e"> </span>order)<span class="_ _e"> </span>to<span class="_ _e"> </span>tier-1</div><div class="t m1f x0 h7 y1b5 ff3 fs4 fc0 sc0 ls0 ws0">c<span class="_ _5"></span>hanger,<span class="_ _4"> </span>as<span class="_ _e"> </span>w<span class="_ _2"></span>ell<span class="_ _e"> </span>as</div><div class="t m0 x30 h7 y1b5 ff5 fs4 fc0 sc0 ls0 ws0">h<span class="ff4">τ</span></div><div class="t m0 xf7 h13 y1b6 ff11 fs5 fc0 sc0 ls0 ws0">2</div><div class="t m0 x6f h7 y1b5 ff4 fs4 fc0 sc0 ls0 ws0">,<span class="_ _13"> </span>τ</div><div class="t m0 x185 h13 y1b6 ff11 fs5 fc0 sc0 ls0 ws0">3</div><div class="t m0 x12 h7 y1b5 ff5 fs4 fc0 sc0 ls0 ws0">i</div><div class="t m1f x64 h7 y1b5 ff3 fs4 fc0 sc0 ls0 ws0">of<span class="_ _4"> </span>its<span class="_ _e"> </span>tier-1<span class="_ _4"> </span>changer.<span class="_ _d"> </span>Finally<span class="_ _6"></span>,<span class="_ _e"> </span>for<span class="_ _4"> </span>tier-1<span class="_ _e"> </span>c<span class="_ _2"></span>hangers,<span class="_ _e"> </span>w<span class="_ _5"></span>e<span class="_ _4"> </span>map</div><div class="t m0 x5e h7 y1b5 ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m1f xaf h7 y1b5 ff3 fs4 fc0 sc0 ls0 ws0">to<span class="_ _4"> </span>its</div><div class="t m0 x0 h7 y1b7 ff3 fs4 fc0 sc0 ls0 ws0">lev<span class="_ _5"></span>er-order<span class="_ _4"> </span>rank.<span class="_ _3"> </span>That<span class="_ _e"> </span>determines<span class="_ _4"> </span>all<span class="_ _4"> </span>summands<span class="_ _e"> </span>for<span class="_ _4"> </span><span class="ff4">i</span>.</div><div class="t m0 x0 h6 y1b8 ff1 fs1 fc0 sc0 ls0 ws0">5.3<span class="_ _21"> </span>Local<span class="_ _3"> </span>navigation</div><div class="t m3 x0 h7 y1b9 ff3 fs4 fc0 sc0 ls0 ws0">V<span class="_ _6"></span>arious<span class="_ _4"> </span>lo<span class="_ _7"></span>cal<span class="_ _e"> </span>na<span class="_ _5"></span>vigation<span class="_ _4"> </span>op<span class="_ _17"></span>erations<span class="_ _4"> </span>are<span class="_ _e"> </span>p<span class="_ _7"></span>ossible;<span class="_ _e"> </span>F<span class="_ _8"></span>or<span class="_ _e"> </span>the<span class="_ _e"> </span>succinct<span class="_ _4"> </span>distance<span class="_ _e"> </span>oracle<span class="_ _4"> </span>for<span class="_ _e"> </span>in<span class="_ _2"></span>terv<span class="_ _2"></span>al</div><div class="t m2 x0 h7 y1ba ff3 fs4 fc0 sc0 ls0 ws0">graphs,<span class="_ _a"> </span>w<span class="_ _2"></span>e<span class="_ _a"> </span>only<span class="_ _e"> </span>need</div><div class="t m0 x5c h9 y1ba ff9 fs4 fc0 sc0 ls0 ws0">last_child</div><div class="t m2 x186 h7 y1ba ff3 fs4 fc0 sc0 ls0 ws0">and</div><div class="t m0 x35 h9 y1ba ff9 fs4 fc0 sc0 ls0 ws0">parent</div><div class="t m2 x182 h7 y1ba ff3 fs4 fc0 sc0 ls0 ws0">.<span class="_ _15"> </span>Note<span class="_ _e"> </span>that</div><div class="t m0 x180 h9 y1ba ff9 fs4 fc0 sc0 ls0 ws0">parent</div><div class="t m2 xea h7 y1ba ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x2b h7 y1ba ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m2 x177 h7 y1ba ff6 fs4 fc0 sc0 ls0 ws0">)<span class="_ _e"> </span>=</div><div class="t m0 x16b h9 y1ba ff9 fs4 fc0 sc0 ls0 ws0">anc</div><div class="t m2 x148 h7 y1ba ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x130 h7 y1ba ff4 fs4 fc0 sc0 ls0 ws0">v<span class="_ _7"></span>,</div><div class="t m2 x7d h7 y1ba ff6 fs4 fc0 sc0 ls0 ws0">1)<span class="ff3">,<span class="_ _a"> </span>so<span class="_ _e"> </span>it<span class="_ _a"> </span>is</span></div><div class="t m2 x0 h7 y1bb ff3 fs4 fc0 sc0 ls0 ws0">subsumed<span class="_ _d"> </span>b<span class="_ _5"></span>y<span class="_ _d"> </span>the<span class="_ _d"> </span>lev<span class="_ _2"></span>el-ancestor<span class="_ _d"> </span>solution<span class="_ _d"> </span>b<span class="_ _7"></span>elow.</div><div class="t m0 x73 h9 y1bb ff9 fs4 fc0 sc0 ls0 ws0">last_child</div><div class="t m2 x9d h7 y1bb ff3 fs4 fc0 sc0 ls0 ws0">can<span class="_ _d"> </span>easily<span class="_ _d"> </span>b<span class="_ _7"></span>e<span class="_ _d"> </span>implemen<span class="_ _5"></span>ted</div><div class="t m1d x0 h7 y1bc ff3 fs4 fc0 sc0 ls0 ws0">directly<span class="_ _4"> </span>(details<span class="_ _e"> </span>omitted);<span class="_ _4"> </span>it<span class="_ _e"> </span>can<span class="_ _4"> </span>also<span class="_ _e"> </span>be<span class="_ _e"> </span>obtained<span class="_ _4"> </span>as</div><div class="t m0 x184 h9 y1bc ff9 fs4 fc0 sc0 ls0 ws0">last_child</div><div class="t m1d x29 h7 y1bc ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x51 h7 y1bc ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m1d x107 h7 y1bc ff6 fs4 fc0 sc0 ls0 ws0">) =</div><div class="t m0 xd0 h9 y1bc ff9 fs4 fc0 sc0 ls0 ws0">child</div><div class="t m1d x52 h7 y1bc ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x154 h7 y1bc ff4 fs4 fc0 sc0 ls0 ws0">v<span class="_ _7"></span>,<span class="_ _13"> </span><span class="ff9">degree</span></div><div class="t m1d x147 h7 y1bc ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 xc0 h7 y1bc ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m1d xb6 h7 y1bc ff6 fs4 fc0 sc0 ls0 ws0">))<span class="ff3">,</span></div><div class="t m0 x0 h7 y1bd ff3 fs4 fc0 sc0 ls0 ws0">see<span class="_ _4"> </span>App<span class="_ _7"></span>endix<span class="_ _e"> </span>B.</div><div class="t m0 x0 h6 y1be ff1 fs1 fc0 sc0 ls0 ws0">5.4<span class="_ _21"> </span>Previous<span class="_ _d"> </span>Internal<span class="_ _d"> </span>in<span class="_ _3"> </span>Level<span class="_ _3"> </span>Order</div><div class="t m1 x0 h7 y1bf ff3 fs4 fc0 sc0 ls0 ws0">Giv<span class="_ _5"></span>en</div><div class="t m0 xdd h7 y1bf ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m1 xb4 h7 y1bf ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x11d h7 y1bf ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m1 x140 h7 y1bf ff6 fs4 fc0 sc0 ls0 ws0">)<span class="ff3">,<span class="_ _4"> </span>ﬁnd</span></div><div class="t m0 x13a h9 y1bf ff9 fs4 fc0 sc0 ls0 ws0">prev_internal</div><div class="t m1 x65 h7 y1bf ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 xac h7 y1bf ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m1 xcb h7 y1bf ff6 fs4 fc0 sc0 ls0 ws0">) =</div><div class="t m0 xce h7 y1bf ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m1 xf5 h7 y1bf ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x35 h7 y1bf ff4 fs4 fc0 sc0 ls0 ws0">w</div><div class="t m1 x6a h7 y1bf ff6 fs4 fc0 sc0 ls0 ws0">)<span class="ff3">,<span class="_ _4"> </span>where</span></div><div class="t m0 x73 h7 y1bf ff4 fs4 fc0 sc0 ls0 ws0">w</div><div class="t m1 x183 h7 y1bf ff3 fs4 fc0 sc0 ls0 ws0">is<span class="_ _4"> </span>the<span class="_ _4"> </span>last<span class="_ _4"> </span>non-leaf<span class="_ _e"> </span>node<span class="_ _4"> </span>(</div><div class="t m0 xb5 h9 y1bf ff9 fs4 fc0 sc0 ls0 ws0">degree</div><div class="t m1 xb9 h7 y1bf ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 xaf h7 y1bf ff4 fs4 fc0 sc0 ls0 ws0">w</div><div class="t m1 xc0 h7 y1bf ff6 fs4 fc0 sc0 ls0 ws0">)</div><div class="t m0 x187 h7 y1bf ff4 fs4 fc0 sc0 ls0 ws0">&gt;</div><div class="t m24 x0 h7 y1c0 ff6 fs4 fc0 sc0 ls0 ws0">0<span class="ff3">)<span class="_ _4"> </span>preceding</span></div><div class="t m0 xa1 h7 y1c0 ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m24 x79 h7 y1c0 ff3 fs4 fc0 sc0 ls0 ws0">in<span class="_ _4"> </span>level<span class="_ _4"> </span>order.<span class="_ _d"> </span>In<span class="_ _e"> </span>the<span class="_ _4"> </span>micro-tree<span class="_ _4"> </span>lo<span class="_ _7"></span>okup<span class="_ _4"> </span>table,<span class="_ _e"> </span>w<span class="_ _2"></span>e<span class="_ _e"> </span>store<span class="_ _4"> </span>whether<span class="_ _4"> </span>there<span class="_ _4"> </span>is<span class="_ _e"> </span>an</div><div class="t m1 x0 h7 y1c1 ff3 fs4 fc0 sc0 ls0 ws0">in<span class="_ _5"></span>ternal<span class="_ _4"> </span>node<span class="_ _4"> </span>to<span class="_ _4"> </span>the<span class="_ _4"> </span>left<span class="_ _4"> </span>of</div><div class="t m0 x12d h7 y1c1 ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m1 x134 h7 y1c1 ff3 fs4 fc0 sc0 ls0 ws0">inside<span class="_ _4"> </span>the<span class="_ _4"> </span>micro-tree,<span class="_ _4"> </span>and<span class="_ _9"> </span>if<span class="_ _4"> </span>so,<span class="_ _4"> </span>its</div><div class="t m0 x104 h7 y1c1 ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x9d h13 y1c2 ff11 fs5 fc0 sc0 ls0 ws0">3</div><div class="t m1 x29 h7 y1c1 ff3 fs4 fc0 sc0 ls0 ws0">.<span class="_ _d"> </span>If</div><div class="t m0 x2b h7 y1c1 ff4 fs4 fc0 sc0 ls0 ws0">w</div><div class="t m1 xd0 h7 y1c1 ff3 fs4 fc0 sc0 ls0 ws0">do<span class="_ _7"></span>es<span class="_ _4"> </span>not<span class="_ _4"> </span>lie<span class="_ _4"> </span>in</div><div class="t m0 x90 h7 y1c1 ff4 fs4 fc0 sc0 ls0 ws0">µ</div><div class="t m0 x9a h13 y1c3 ff15 fs5 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x149 h19 y1c4 ff18 fs9 fc0 sc0 ls0 ws0">1</div><div class="t m0 x92 h13 y1c3 ff11 fs5 fc0 sc0 ls0 ws0">(<span class="ff15">v<span class="_ _7"></span></span>)</div><div class="t m0 x9a h13 y1c5 ff15 fs5 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x149 h19 y1c6 ff18 fs9 fc0 sc0 ls0 ws0">2</div><div class="t m0 x92 h13 y1c5 ff11 fs5 fc0 sc0 ls0 ws0">(<span class="ff15">v<span class="_ _7"></span></span>)</div><div class="t m1 xb1 h7 y1c1 ff3 fs4 fc0 sc0 ls0 ws0">,</div><div class="t m2 x0 h7 y1c7 ff3 fs4 fc0 sc0 ls0 ws0">w<span class="_ _5"></span>e<span class="_ _4"> </span>get</div><div class="t m0 x13e h7 y1c7 ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m2 x11d h7 y1c7 ff3 fs4 fc0 sc0 ls0 ws0">’s<span class="_ _4"> </span>tier-2<span class="_ _e"> </span>lev<span class="_ _5"></span>el-order<span class="_ _4"> </span>changer</div><div class="t m0 xa4 h7 y1c7 ff4 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m0 x161 h17 y1c8 ff17 fs5 fc0 sc0 ls0 ws0">0</div><div class="t m2 x188 h7 y1c7 ff3 fs4 fc0 sc0 ls0 ws0">from<span class="_ _4"> </span>the<span class="_ _e"> </span>lo<span class="_ _7"></span>okup<span class="_ _4"> </span>table,<span class="_ _e"> </span>for<span class="_ _4"> </span>which<span class="_ _4"> </span>we<span class="_ _4"> </span>store<span class="_ _e"> </span>whether</div><div class="t m19 x0 h7 y1c9 ff3 fs4 fc0 sc0 ls0 ws0">there<span class="_ _4"> </span>is<span class="_ _e"> </span>an<span class="_ _e"> </span>in<span class="_ _2"></span>ternal<span class="_ _e"> </span>node<span class="_ _e"> </span>to<span class="_ _e"> </span>the<span class="_ _4"> </span>left<span class="_ _e"> </span>of</div><div class="t m0 xce h7 y1c9 ff4 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m0 xf5 h17 y1ca ff17 fs5 fc0 sc0 ls0 ws0">0</div><div class="t m19 x189 h7 y1c9 ff3 fs4 fc0 sc0 ls0 ws0">inside<span class="_ _4"> </span>the<span class="_ _e"> </span>micro-tree,<span class="_ _e"> </span>and<span class="_ _4"> </span>if<span class="_ _e"> </span>so,<span class="_ _4"> </span>store<span class="_ _e"> </span>its</div><div class="t m0 x106 h7 y1c9 ff5 fs4 fc0 sc0 ls0 ws0">h<span class="ff4">τ</span></div><div class="t m0 x151 h13 y1cb ff11 fs5 fc0 sc0 ls0 ws0">2</div><div class="t m0 xc8 h7 y1c9 ff4 fs4 fc0 sc0 ls0 ws0">,<span class="_ _13"> </span>τ</div><div class="t m0 xaf h13 y1cb ff11 fs5 fc0 sc0 ls0 ws0">3</div><div class="t m0 x91 h7 y1c9 ff5 fs4 fc0 sc0 ls0 ws0">i</div><div class="t m19 x18a h7 y1c9 ff3 fs4 fc0 sc0 ls0 ws0">.<span class="_ _3"> </span>If</div><div class="t m0 x0 h7 y1cc ff4 fs4 fc0 sc0 ls0 ws0">w</div><div class="t m1b x6c h7 y1cc ff3 fs4 fc0 sc0 ls0 ws0">is<span class="_ _4"> </span>also<span class="_ _e"> </span>not<span class="_ _4"> </span>in</div><div class="t m0 x63 h7 y1cc ff4 fs4 fc0 sc0 ls0 ws0">µ</div><div class="t m0 x4a h13 y1cd ff15 fs5 fc0 sc0 ls0 ws0">τ</div><div class="t m0 x5b h19 y1ce ff18 fs9 fc0 sc0 ls0 ws0">1</div><div class="t m0 x30 h13 y1cd ff11 fs5 fc0 sc0 ls0 ws0">(<span class="ff15">v<span class="_ _7"></span></span>)</div><div class="t m1b x10 h7 y1cc ff3 fs4 fc0 sc0 ls0 ws0">,<span class="_ _4"> </span>we<span class="_ _4"> </span>mov<span class="_ _2"></span>e<span class="_ _e"> </span>to</div><div class="t m0 xf0 h7 y1cc ff4 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m0 x86 h17 y1cd ff17 fs5 fc0 sc0 ls0 ws0">0</div><div class="t m1b xcd h7 y1cc ff3 fs4 fc0 sc0 ls0 ws0">’s<span class="_ _4"> </span>tier-1<span class="_ _e"> </span>lev<span class="_ _2"></span>el-order<span class="_ _e"> </span>c<span class="_ _5"></span>hanger<span class="_ _4"> </span>(</div><div class="t m0 x51 h7 y1cc ff5 fs4 fc0 sc0 ls0 ws0">h<span class="ff4">τ</span></div><div class="t m0 x18b h13 y1cf ff11 fs5 fc0 sc0 ls0 ws0">2</div><div class="t m1b x48 h7 y1cc ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x177 h7 y1cc ff4 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m1b xd0 h7 y1cc ff6 fs4 fc0 sc0 ls0 ws0">)</div><div class="t m0 x158 h7 y1cc ff4 fs4 fc0 sc0 ls0 ws0">,<span class="_ _13"> </span>τ</div><div class="t m0 x8 h13 y1cf ff11 fs5 fc0 sc0 ls0 ws0">3</div><div class="t m1b x8c h7 y1cc ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 x18c h7 y1cc ff4 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m1b x55 h7 y1cc ff6 fs4 fc0 sc0 ls0 ws0">)</div><div class="t m0 x154 h7 y1cc ff5 fs4 fc0 sc0 ls0 ws0">i</div><div class="t m1b x11b h7 y1cc ff3 fs4 fc0 sc0 ls0 ws0">is<span class="_ _4"> </span>stored<span class="_ _e"> </span>for</div><div class="t m0 x0 h7 y1d0 ff4 fs4 fc0 sc0 ls0 ws0">u</div><div class="t m0 x15a h17 y1d1 ff17 fs5 fc0 sc0 ls0 ws0">0</div><div class="t m0 x18d h7 y1d0 ff3 fs4 fc0 sc0 ls0 ws0">).<span class="_ _d"> </span>At<span class="_ _4"> </span>tier-1<span class="_ _e"> </span>c<span class="_ _2"></span>hangers<span class="_ _e"> </span><span class="ff4">u</span>,<span class="_ _4"> </span>we<span class="_ _4"> </span>store<span class="_ _4"> </span><span class="ff9">prev_internal<span class="ff6">(<span class="ff4">u</span>)<span class="_ _e"> </span></span></span>directly<span class="_ _8"></span>.</div><div class="t m0 x0 h6 y1d2 ff1 fs1 fc0 sc0 ls0 ws0">5.5<span class="_ _21"> </span>Depth<span class="_ _d"> </span>and<span class="_ _d"> </span>Level-Ancestor</div><div class="t m0 x0 h7 y1d3 ff1 fs4 fc0 sc0 ls0 ws0">Depth</div><div class="t m2 x18e h7 y1d3 ff3 fs4 fc0 sc0 ls0 ws0">Giv<span class="_ _5"></span>en</div><div class="t m0 x43 h7 y1d3 ff4 fs4 fc0 sc0 ls0 ws0">τ</div><div class="t m2 xd5 h7 y1d3 ff6 fs4 fc0 sc0 ls0 ws0">(</div><div class="t m0 xe h7 y1d3 ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m2 x13c h7 y1d3 ff6 fs4 fc0 sc0 ls0 ws0">)<span class="ff3">,<span class="_ _e"> </span>compute<span class="_ _e"> </span>the<span class="_ _e"> </span>level<span class="_ _e"> </span>on<span class="_ _e"> </span>whic<span class="_ _5"></span>h</span></div><div class="t m0 x73 h7 y1d3 ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m2 x22 h7 y1d3 ff3 fs4 fc0 sc0 ls0 ws0">lies.<span class="_ _25"> </span>W<span class="_ _6"></span>e<span class="_ _e"> </span>store<span class="_ _e"> </span>the<span class="_ _e"> </span>global<span class="_ _e"> </span>depth<span class="_ _a"> </span>of<span class="_ _e"> </span>the</div><div class="t m11 x0 h7 y1d4 ff3 fs4 fc0 sc0 ls0 ws0">mini-tree<span class="_ _4"> </span>ro<span class="_ _7"></span>ot<span class="_ _e"> </span>and<span class="_ _4"> </span>the<span class="_ _e"> </span>mini-tree-local<span class="_ _e"> </span>depth<span class="_ _4"> </span>at<span class="_ _4"> </span>each<span class="_ _4"> </span>micro-tree<span class="_ _e"> </span>root.<span class="_ _3"> </span>F<span class="_ _6"></span>or<span class="_ _4"> </span>a<span class="_ _e"> </span>no<span class="_ _7"></span>de</div><div class="t m0 x3f h7 y1d4 ff4 fs4 fc0 sc0 ls0 ws0">v</div><div class="t m11 x113 h7 y1d4 ff3 fs4 fc0 sc0 ls0 ws0">,<span class="_ _4"> </span>ﬁnd<span class="_ _e"> </span>the</div><div class="t m2 x0 h7 y1d5 ff3 fs4 fc0 sc0 ls0 ws0">depth<span class="_ _e"> </span>relative<span class="_ _e"> </span>to<span class="_ _e"> </span>the<span class="_ _e"> </span>micro-tree<span class="_ _a"> </span>ro<span class="_ _7"></span>ot<span class="_ _e"> </span>using<span class="_ _e"> </span>the<span class="_ _a"> </span>lo<span class="_ _7"></span>okup<span class="_ _e"> </span>table,<span class="_ _a"> </span>and<span class="_ _e"> </span>add<span class="_ _a"> </span>the<span class="_ _e"> </span>mini-tree-lo<span class="_ _7"></span>cal</div><div class="t m0 x0 h7 y1d6 ff3 fs4 fc0 sc0 ls0 ws0">depth<span class="_ _4"> </span>and<span class="_ _e"> </span>the<span class="_ _4"> </span>global<span class="_ _e"> </span>depth.<span class="_ _d"> </span>W<span class="_ _6"></span>e<span class="_ _4"> </span>may<span class="_ _4"> </span>need<span class="_ _e"> </span>to<span class="_ _4"> </span>adjust<span class="_ _4"> </span>for<span class="_ _e"> </span>dumm<span class="_ _2"></span>y<span class="_ _e"> </span>ro<span class="_ _7"></span>ots<span class="_ _4"> </span>but<span class="_ _e"> </span>that<span class="_ _4"> </span>is<span class="_ _e"> </span>trivial.</div><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",116.079,524.276,null]'><div class="d m7" style="border-style:none;position:absolute;left:675.839869px;bottom:1130.552288px;width:9.603000px;height:11.955000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",99.071,292.421,null]'><div class="d m7" style="border-style:none;position:absolute;left:186.570261px;bottom:538.196078px;width:54.711000px;height:10.793000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.633987,0.000000,0.000000,1.633987,0.000000,0.000000]}'></div></div>
