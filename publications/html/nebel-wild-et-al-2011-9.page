<div id="pf9" class="pf w0 h0" data-page-no="9"><div class="pc pc9 w0 h0"><div class="t m0 x0 h1 y0 ff1 fs0 fc0 sc0 ls0 ws0">Marc<span class="_ _0"></span>h<span class="_ _1"> </span>3,<span class="_ _c"> </span>2011<span class="_ _d"> </span>15:9<span class="_ _2"> </span>WSPC/INSTR<span class="_ _0"></span>UCTION<span class="_ _1"> </span>FILE<span class="_ _3"> </span>jaguc</div><div class="t m0 x21 h3 y2f ff3 fs1 fc0 sc0 ls0 ws0">9</div><div class="t m0 x19 h1 y30 ff1 fs0 fc0 sc0 ls0 ws0">dynamic<span class="_ _b"> </span>programming<span class="_ _9"> </span>schemes<span class="_ _b"> </span>could<span class="_ _9"> </span>hav<span class="_ _0"></span>e<span class="_ _9"> </span>b<span class="_ _8"></span>een<span class="_ _b"> </span>reused.<span class="_ _9"> </span>This also<span class="_ _9"> </span>takes<span class="_ _9"> </span>adv<span class="_ _0"></span>an<span class="_ _0"></span>tage<span class="_ _b"> </span>of</div><div class="t m0 x19 h1 y5c ff1 fs0 fc0 sc0 ls0 ws0">the<span class="_ _b"> </span>fact<span class="_ _b"> </span>that<span class="_ _b"> </span>for<span class="_ _b"> </span>p<span class="_ _0"></span>yrosequencing<span class="_ _b"> </span>errors<span class="_ _b"> </span>are<span class="_ _b"> </span>m<span class="_ _0"></span>uc<span class="_ _0"></span>h<span class="_ _b"> </span>more<span class="_ _b"> </span>lik<span class="_ _0"></span>ely<span class="_ _b"> </span>at<span class="_ _b"> </span>the<span class="_ _b"> </span>end<span class="_ _b"> </span>of<span class="_ _b"> </span>a<span class="_ _b"> </span>sequence</div><div class="t m0 x19 h1 y5d ff1 fs0 fc0 sc0 ls0 ws0">than at the b<span class="_ _8"></span>eginning th<span class="_ _0"></span>us common preﬁxes are not <span class="ff11">destr<span class="_ _5"></span>oye<span class="_ _0"></span>d <span class="ff1">by sequencing-errors.</span></span></div><div class="t m0 x24 h1 y5e ff1 fs0 fc0 sc0 ls0 ws0">The<span class="_ _1"> </span>data<span class="_ _4"> </span>structure<span class="_ _1"> </span>most<span class="_ _1"> </span>appropriate<span class="_ _4"> </span>to<span class="_ _1"> </span>maintain<span class="_ _c"> </span>sequences<span class="_ _4"> </span>with<span class="_ _1"> </span>common<span class="_ _1"> </span>pre-</div><div class="t m0 x19 h1 y5f ff1 fs0 fc0 sc0 ls0 ws0">ﬁxes<span class="_ _c"> </span>is<span class="_ _c"> </span>called<span class="_ _c"> </span>a<span class="_ _1"> </span><span class="ff11">T<span class="_ _5"></span>rie<span class="_ _c"> </span><span class="ff1">(see</span></span></div><div class="t m0 x4d h7 yf6 ff8 fs3 fc0 sc0 ls0 ws0">12</div><div class="t m0 x11 h1 y5f ff1 fs0 fc0 sc0 ls0 ws0">for<span class="_ _c"> </span>details).<span class="_ _c"> </span>A<span class="_ _c"> </span>T<span class="_ _5"></span>rie<span class="_ _c"> </span>is<span class="_ _1"> </span>a<span class="_ _c"> </span>treelike structure<span class="_ _1"> </span>in<span class="_ _c"> </span>which each</div><div class="t m0 x19 h1 y60 ff1 fs0 fc0 sc0 ls0 ws0">sequence is<span class="_ _b"> </span>represen<span class="_ _0"></span>ted b<span class="_ _0"></span>y<span class="_ _b"> </span>a leaf.<span class="_ _b"> </span>Sym<span class="_ _0"></span>bols are attac<span class="_ _0"></span>hed to<span class="_ _b"> </span>edges suc<span class="_ _5"></span>h that eac<span class="_ _0"></span>h edge</div><div class="t m0 x19 h1 yf7 ff1 fs0 fc0 sc0 ls0 ws0">originating from a giv<span class="_ _5"></span>en vertex is uniquely<span class="_ _b"> </span>iden<span class="_ _0"></span>tiﬁed b<span class="_ _0"></span>y its<span class="_ _b"> </span>label. Concatenating the</div><div class="t m0 x19 h1 yf8 ff1 fs0 fc0 sc0 ls0 ws0">sym<span class="_ _0"></span>b<span class="_ _8"></span>ols<span class="_ _4"> </span>on<span class="_ _4"> </span>the<span class="_ _4"> </span>path<span class="_ _4"> </span>from<span class="_ _4"> </span>the<span class="_ _4"> </span>root<span class="_ _4"> </span>of<span class="_ _4"> </span>the<span class="_ _4"> </span>T<span class="_ _5"></span>rie<span class="_ _4"> </span>to<span class="_ _4"> </span>a<span class="_ _4"> </span>giv<span class="_ _0"></span>en<span class="_ _4"> </span>leaf<span class="_ _4"> </span>yields<span class="_ _4"> </span>the<span class="_ _4"> </span>sequence</div><div class="t m0 x19 h1 yf9 ff1 fs0 fc0 sc0 ls0 ws0">represen<span class="_ _0"></span>ted<span class="_ _1"> </span>by<span class="_ _c"> </span>that<span class="_ _1"> </span>leaf.<span class="_ _1"> </span>As<span class="_ _1"> </span>a<span class="_ _1"> </span>consequence,<span class="_ _4"> </span>common<span class="_ _c"> </span>preﬁxes<span class="_ _1"> </span>of<span class="_ _1"> </span>sequences<span class="_ _1"> </span>pro<span class="_ _8"></span>duce</div><div class="t m0 x19 h1 yfa ff1 fs0 fc0 sc0 ls0 ws0">a common<span class="_ _c"> </span>path<span class="_ _6"> </span>in<span class="_ _c"> </span>the<span class="_ _6"> </span>T<span class="_ _5"></span>rie<span class="_ _c"> </span>whic<span class="_ _0"></span>h splits<span class="_ _c"> </span>at<span class="_ _6"> </span>some<span class="_ _c"> </span>internal no<span class="_ _8"></span>de according to<span class="_ _c"> </span>the<span class="_ _6"> </span>ﬁrst</div><div class="t m0 x19 h1 yfb ff1 fs0 fc0 sc0 ls0 ws0">sym<span class="_ _0"></span>b<span class="_ _8"></span>ols<span class="_ _a"> </span>at<span class="_ _f"> </span>which<span class="_ _a"> </span>the<span class="_ _f"> </span>sequences<span class="_ _f"> </span>diﬀer.<span class="_ _f"> </span>Within<span class="_ _f"> </span><span class="ff7">JAguc<span class="_ _a"> </span></span>all<span class="_ _10"> </span>sequences<span class="_ _f"> </span>are<span class="_ _f"> </span>initially</div><div class="t m0 x19 h1 yfc ff1 fs0 fc0 sc0 ls0 ws0">inserted into a T<span class="_ _12"></span>rie and then pro<span class="_ _8"></span>cessed according to the left-to-right ordering of the</div><div class="t m0 x19 h1 yfd ff1 fs0 fc0 sc0 ls0 ws0">T<span class="_ _12"></span>ries’s<span class="_ _a"> </span>leav<span class="_ _0"></span>es.<span class="_ _4"> </span>When<span class="_ _a"> </span>ﬁxing<span class="_ _a"> </span>a<span class="_ _a"> </span>ﬁrst<span class="_ _a"> </span>sequence<span class="_ _a"> </span><span class="ff13">s<span class="_ _a"> </span></span>to<span class="_ _a"> </span>b<span class="_ _8"></span>e<span class="_ _a"> </span>part<span class="_ _a"> </span>of<span class="_ _a"> </span>a<span class="_ _a"> </span>pairwise<span class="_ _a"> </span>alignmen<span class="_ _0"></span>t,</div><div class="t m0 x19 h1 yfe ff1 fs0 fc0 sc0 ls0 ws0">a<span class="_ _a"> </span>second<span class="_ _f"> </span>sequence<span class="_ _a"> </span><span class="ff13">t<span class="_ _f"> </span></span>is<span class="_ _a"> </span>chosen<span class="_ _a"> </span>among<span class="_ _a"> </span>all<span class="_ _f"> </span>leav<span class="_ _0"></span>es<span class="_ _a"> </span>at<span class="_ _a"> </span>the<span class="_ _f"> </span>right<span class="_ _4"> </span>of<span class="_ _f"> </span><span class="ff13">s<span class="_ _a"> </span></span>(all<span class="_ _f"> </span>p<span class="_ _8"></span>ossibilities</div><div class="t m0 x19 h1 yff ff1 fs0 fc0 sc0 ls0 ws0">form left to righ<span class="_ _0"></span>t). The ﬁrst common ancestor of the t<span class="_ _0"></span>w<span class="_ _0"></span>o selected lea<span class="_ _0"></span>v<span class="_ _0"></span>es (sequences)</div><div class="t m0 x19 h1 y100 ff1 fs0 fc0 sc0 ls0 ws0">iden<span class="_ _0"></span>tiﬁes<span class="_ _1"> </span>the<span class="_ _1"> </span>parts<span class="_ _4"> </span>of<span class="_ _c"> </span>the<span class="_ _1"> </span>dynamic<span class="_ _4"> </span>programm<span class="_ _c"> </span>scheme<span class="_ _c"> </span>of<span class="_ _4"> </span>the<span class="_ _c"> </span>previous<span class="_ _1"> </span>run<span class="_ _4"> </span>that<span class="_ _c"> </span>can</div><div class="t m0 x19 h1 y101 ff1 fs0 fc0 sc0 ls0 ws0">b<span class="_ _8"></span>e<span class="_ _c"> </span>reused.</div><div class="t m0 x24 h1 y102 ff1 fs0 fc0 sc0 ls0 ws0">Besides accelerating the algorithm by reusing partial computations (parts of the</div><div class="t m0 x19 h1 y103 ff1 fs0 fc0 sc0 ls0 ws0">dynamic<span class="_ _a"> </span>programming<span class="_ _f"> </span>scheme),<span class="_ _a"> </span><span class="ff7">JAguc<span class="_ _4"> </span></span>takes<span class="_ _a"> </span>adv<span class="_ _0"></span>an<span class="_ _0"></span>tage<span class="_ _a"> </span>of<span class="_ _f"> </span>m<span class="_ _0"></span>ulticore<span class="_ _a"> </span>features<span class="_ _f"> </span>of</div><div class="t m0 x19 h1 y104 ff1 fs0 fc0 sc0 ls0 ws0">mo<span class="_ _8"></span>dern<span class="_ _1"> </span>computers.<span class="_ _4"> </span>Sev<span class="_ _0"></span>eral<span class="_ _1"> </span>CPUs<span class="_ _4"> </span>in<span class="_ _4"> </span>one<span class="_ _1"> </span>computer<span class="_ _4"> </span>allo<span class="_ _0"></span>w<span class="_ _1"> </span>for<span class="_ _4"> </span>the<span class="_ _4"> </span>parallelized<span class="_ _1"> </span>com-</div><div class="t m0 x19 h1 y105 ff1 fs0 fc0 sc0 ls0 ws0">putation<span class="_ _1"> </span>of<span class="_ _4"> </span>pairwise<span class="_ _4"> </span>alignmen<span class="_ _5"></span>ts.<span class="_ _4"> </span>F<span class="_ _12"></span>or<span class="_ _4"> </span>this<span class="_ _1"> </span>purp<span class="_ _8"></span>ose<span class="_ _4"> </span><span class="ff7">JA<span class="_ _5"></span>guc<span class="_ _4"> </span><span class="ff1">main<span class="_ _0"></span>tains<span class="_ _1"> </span>on<span class="_ _4"> </span>eac<span class="_ _0"></span>h<span class="_ _4"> </span>CPU</span></span></div><div class="t m0 x19 h1 y106 ff1 fs0 fc0 sc0 ls0 ws0">a<span class="_ _c"> </span>single<span class="_ _1"> </span>thread<span class="_ _c"> </span>for<span class="_ _1"> </span>the<span class="_ _c"> </span>computation<span class="_ _1"> </span>of<span class="_ _c"> </span>alignments.<span class="_ _c"> </span>The<span class="_ _c"> </span>set<span class="_ _1"> </span>of<span class="_ _c"> </span>all<span class="_ _1"> </span>pairs<span class="_ _c"> </span>of<span class="_ _1"> </span>sequences</div><div class="t m0 x19 h1 y107 ff1 fs0 fc0 sc0 ls0 ws0">is<span class="_ _10"> </span>distributed<span class="_ _11"> </span>among<span class="_ _10"> </span>the<span class="_ _11"> </span>threads.<span class="_ _10"> </span>Each<span class="_ _10"> </span>thread<span class="_ _11"> </span>main<span class="_ _0"></span>tains<span class="_ _10"> </span>its<span class="_ _11"> </span>o<span class="_ _0"></span>wn<span class="_ _10"> </span>dynamic<span class="_ _11"> </span>pro-</div><div class="t m0 x19 h1 y108 ff1 fs0 fc0 sc0 ls0 ws0">gramming<span class="_ _4"> </span>scheme.<span class="_ _4"> </span>Th<span class="_ _0"></span>us,<span class="_ _4"> </span>the<span class="_ _a"> </span>reuse<span class="_ _4"> </span>of<span class="_ _a"> </span>computations<span class="_ _4"> </span>is<span class="_ _a"> </span>restricted<span class="_ _4"> </span>to<span class="_ _4"> </span>computations</div><div class="t m0 x19 h1 y109 ff1 fs0 fc0 sc0 ls0 ws0">p<span class="_ _8"></span>erformed<span class="_ _c"> </span>by<span class="_ _c"> </span>the<span class="_ _1"> </span>same<span class="_ _1"> </span>thread.<span class="_ _1"> </span>Even<span class="_ _1"> </span>though<span class="_ _1"> </span>some<span class="_ _1"> </span>computations<span class="_ _1"> </span>may<span class="_ _c"> </span>b<span class="_ _8"></span>e<span class="_ _c"> </span>fully<span class="_ _4"> </span>per-</div><div class="t m0 x19 h1 y10a ff1 fs0 fc0 sc0 ls0 ws0">formed,<span class="_ _1"> </span>which<span class="_ _c"> </span>in<span class="_ _4"> </span>a<span class="_ _c"> </span>single<span class="_ _4"> </span>thread<span class="_ _c"> </span>scenario<span class="_ _4"> </span>w<span class="_ _0"></span>ould<span class="_ _c"> </span>reuse<span class="_ _4"> </span>partial<span class="_ _c"> </span>results,<span class="_ _4"> </span>this<span class="_ _c"> </span>strategy</div><div class="t m0 x19 h1 y10b ff1 fs0 fc0 sc0 ls0 ws0">pa<span class="_ _0"></span>ys<span class="_ _1"> </span>oﬀ<span class="_ _1"> </span>with<span class="_ _1"> </span>resp<span class="_ _8"></span>ect<span class="_ _c"> </span>to<span class="_ _1"> </span>the<span class="_ _1"> </span>ov<span class="_ _0"></span>erall<span class="_ _c"> </span>runtime:<span class="_ _c"> </span>in<span class="_ _1"> </span>the<span class="_ _1"> </span>case<span class="_ _1"> </span>of<span class="_ _1"> </span>parallel<span class="_ _4"> </span>threads<span class="_ _c"> </span>compu-</div><div class="t m0 x19 h1 y10c ff1 fs0 fc0 sc0 ls0 ws0">tation<span class="_ _4"> </span>time<span class="_ _4"> </span>sp<span class="_ _8"></span>eeds<span class="_ _4"> </span>up<span class="_ _4"> </span>proportional<span class="_ _4"> </span>to<span class="_ _4"> </span>1<span class="ff13">/</span>num<span class="_ _5"></span>b<span class="_ _8"></span>er<span class="_ _4"> </span>of<span class="_ _4"> </span>CPUs<span class="_ _4"> </span>(see<span class="_ _4"> </span>results<span class="_ _4"> </span>rep<span class="_ _8"></span>orted<span class="_ _4"> </span>in</div><div class="t m0 x19 h1 y10d ff1 fs0 fc0 sc0 ls0 ws0">Section<span class="_ _c"> </span>3).</div><div class="t m0 x24 h1 y10e ff1 fs0 fc0 sc0 ls0 ws0">Since<span class="_ _c"> </span>the<span class="_ _c"> </span>computation<span class="_ _1"> </span>of<span class="_ _c"> </span>all<span class="_ _1"> </span>pairwise<span class="_ _c"> </span>alignments<span class="_ _6"> </span>for<span class="_ _1"> </span>a<span class="_ _c"> </span>given<span class="_ _6"> </span>sam<span class="_ _8"></span>ple is<span class="_ _1"> </span>the<span class="_ _c"> </span>most</div><div class="t m0 x19 h1 y10f ff1 fs0 fc0 sc0 ls0 ws0">time-consuming<span class="_ _9"> </span>step<span class="_ _b"> </span>in<span class="_ _9"> </span><span class="ff7">JAguc</span>’s<span class="_ _9"> </span>pip<span class="_ _8"></span>eline,<span class="_ _9"> </span>it<span class="_ _9"> </span>allows<span class="_ _9"> </span>storage<span class="_ _b"> </span>of<span class="_ _9"> </span>the<span class="_ _b"> </span>resulting<span class="_ _9"> </span>similarity</div><div class="t m0 x19 h1 y110 ff1 fs0 fc0 sc0 ls0 ws0">matrix<span class="_ _c"> </span>to<span class="_ _1"> </span>a<span class="_ _1"> </span>ﬁle<span class="_ _1"> </span>for<span class="_ _1"> </span>later<span class="_ _1"> </span>use.</div><div class="t m0 x19 h1 y111 ff11 fs0 fc0 sc0 ls0 ws0">Clustering</div><div class="t m0 x19 h1 y7a ff1 fs0 fc0 sc0 ls0 ws0">Clustering<span class="_ _1"> </span>is<span class="_ _1"> </span>p<span class="_ _8"></span>erformed<span class="_ _c"> </span>according<span class="_ _1"> </span>to<span class="_ _1"> </span>DOTUR’s<span class="_ _1"> </span>nearest,<span class="_ _1"> </span>furthest<span class="_ _1"> </span>or<span class="_ _1"> </span>av<span class="_ _0"></span>erage<span class="_ _c"> </span>neigh-</div><div class="t m0 x19 h1 y7b ff1 fs0 fc0 sc0 ls0 ws0">b<span class="_ _8"></span>or<span class="_ _1"> </span>clustering<span class="_ _4"> </span>algorithm<span class="_ _1"> </span>(see</div><div class="t m0 x4e h7 y112 ff8 fs3 fc0 sc0 ls0 ws0">17</div><div class="t m0 x4a h1 y7b ff1 fs0 fc0 sc0 ls0 ws0">for<span class="_ _4"> </span>details).<span class="_ _1"> </span>Initially<span class="_ _5"></span>,<span class="_ _1"> </span>each<span class="_ _1"> </span>sequence<span class="_ _4"> </span>is<span class="_ _4"> </span>assumed<span class="_ _1"> </span>to</div><div class="t m0 x19 h1 y7c ff1 fs0 fc0 sc0 ls0 ws0">represen<span class="_ _0"></span>t<span class="_ _f"> </span>its<span class="_ _f"> </span>own<span class="_ _a"> </span>cluster.<span class="_ _f"> </span>The<span class="_ _f"> </span>matrix<span class="_ _f"> </span><span class="ff13">S<span class="_ _11"> </span></span>=<span class="_ _10"> </span>(<span class="ff13">s</span></div><div class="t m0 x4f h15 y113 ff9 fs3 fc0 sc0 ls0 ws0">i,j</div><div class="t m0 x50 h1 y7c ff1 fs0 fc0 sc0 ls0 ws0">)<span class="_ _f"> </span>assigned<span class="_ _f"> </span>to<span class="_ _f"> </span>this<span class="_ _f"> </span>initial<span class="_ _f"> </span>conﬁgu-</div><div class="t m0 x19 h1 y7d ff1 fs0 fc0 sc0 ls0 ws0">ration<span class="_ _a"> </span>is<span class="_ _f"> </span>given<span class="_ _4"> </span>by<span class="_ _a"> </span>the<span class="_ _a"> </span>results<span class="_ _f"> </span>of<span class="_ _a"> </span>our<span class="_ _f"> </span>alignment<span class="_ _4"> </span>run,<span class="_ _f"> </span>i.e.<span class="_ _a"> </span>entry<span class="_ _a"> </span><span class="ff13">s</span></div><div class="t m0 x51 h15 y114 ff9 fs3 fc0 sc0 ls0 ws0">i,j</div><div class="t m0 x52 h1 y7d ff1 fs0 fc0 sc0 ls0 ws0">of<span class="_ _a"> </span>that<span class="_ _f"> </span>matrix</div><div class="t m0 x19 h1 y7e ff1 fs0 fc0 sc0 ls0 ws0">(whic<span class="_ _0"></span>h<span class="_ _a"> </span>represents<span class="_ _a"> </span>the<span class="_ _a"> </span>similarity<span class="_ _a"> </span>of<span class="_ _a"> </span>the<span class="_ _f"> </span><span class="ff13">i</span>th<span class="_ _f"> </span>and<span class="_ _a"> </span>the<span class="_ _f"> </span><span class="ff13">j<span class="_ _8"></span></span>th<span class="_ _f"> </span>cluster)<span class="_ _f"> </span>and<span class="_ _a"> </span>is<span class="_ _f"> </span>initialized</div><div class="t m0 x19 h1 y7f ff1 fs0 fc0 sc0 ls0 ws0">b<span class="_ _0"></span>y<span class="_ _a"> </span>the<span class="_ _a"> </span>sequence<span class="_ _f"> </span>similarity<span class="_ _4"> </span>(p<span class="_ _8"></span>ercen<span class="_ _0"></span>tage)<span class="_ _a"> </span>given<span class="_ _4"> </span>by<span class="_ _a"> </span>the<span class="_ _a"> </span>alignment<span class="_ _a"> </span>of<span class="_ _a"> </span>the<span class="_ _a"> </span><span class="ff13">i</span>th<span class="_ _f"> </span>to<span class="_ _a"> </span>the</div><div class="t m0 x19 h1 y80 ff13 fs0 fc0 sc0 ls0 ws0">j<span class="_ _8"></span><span class="ff1">th<span class="_ _1"> </span>sequence.<span class="_ _1"> </span>Afterwards,<span class="_ _6"> </span>clusters<span class="_ _1"> </span>are<span class="_ _1"> </span>joined<span class="_ _1"> </span>until<span class="_ _c"> </span>there<span class="_ _1"> </span>are<span class="_ _1"> </span>no<span class="_ _c"> </span>tw<span class="_ _0"></span>o<span class="_ _c"> </span>clusters<span class="_ _1"> </span>with<span class="_ _1"> </span>a</span></div><div class="t m0 x19 h1 y2d ff1 fs0 fc0 sc0 ls0 ws0">similarit<span class="_ _0"></span>y larger<span class="_ _6"> </span>or<span class="_ _c"> </span>equal to<span class="_ _c"> </span>a given threshold (<span class="ff7">JAguc<span class="_ _b"> </span></span>handles<span class="_ _c"> </span>any ﬁnite num<span class="_ _5"></span>b<span class="_ _8"></span>er of</div></div><div class="pi" data-data='{"ctm":[2.351848,0.000000,0.000000,2.351848,-199.999718,-199.999718]}'></div></div>
