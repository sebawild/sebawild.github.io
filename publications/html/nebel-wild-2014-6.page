<div id="pf6" class="pf w0 h0" data-page-no="6"><div class="pc pc6 w0 h0"><img class="bi x14 y133 w4 h1e" alt="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJwAAAIKCAIAAABZerFtAAAACXBIWXMAABYlAAAWJQFJUiTwAAADHUlEQVR42u3RsQ0AMQwDsffX3n9T18oUSYCAN4AKsZJ8OtvMdPe+/YL6Xr8LoAqqoAqqoEIVVEEVVEGFKqiCKqiCKqhQBVVQBVVQoQqqoAqqoAoqVEEVVEEVVKiCKqiCKqiCClVQBVVQBRWqoAqqoAqqoEIVVEEVVEGFKqiCKqiCKqhQBVVQBVVQoQqqoAqqoAoqVEEVVEEVVKiCKqiCKqiCClVQBVVQBRWqoAqqoAqqoEIVVEEVVEGFKqiCKqiCKqhQBVVQBVVQoQqqoAqqoAoqVEEVVEEVVKiCKqiCKqiCClVQBVVQBRWqoAqqoAqqoEIVVEEVVEGFKqiCKqiCKqhQBVVQBVVQoQqqoAqqoAoqVEEVVEEVVKiCKqiCKqiCClVQBVVQBRWqoAqqoAqqoEIVVEEVVEGFKqiCKqiCKqhQBVVQBVVQoQqqoAqqoAoqVEEVVEEVVKiCKqiCKqiCClVQBVVQBRWqoAqqoAqqoEIVVEEVVEGFKqiCKqiCKqhQBVVQBVVQoQqqoAqqoAoqVEEVVEEVVKiCKqiCKqhQXQBVUAVVUAUVqqAKqqAKKlRBFVRBFVRBhSqogiqoggpVUAVVUAVVUKEKqqAKqqBCFVRBFVRBFVSogiqogiqoUAVVUAVVUAUVqqAKqqAKKlRBFVRBFVRBhSqogiqoggpVUAVVUAVVUKEKqqAKqqBCFVRBFVRBFVSogiqogiqoUAVVUAVVUAUVqqAKqqAKKlRBFVRBFVRBhSqogiqoggpVUAVVUAVVUKEKqqAKqqBCFVRBFVRBFVSogiqogiqoUAVVUAVVUAUVqqAKqqAKKlRBFVRBFVRBhSqogiqoggpVUAVVUAVVUKEKqqAKqqBCFVRBFVRBFVSogiqogiqoUAVVUAVVUAUVqqAKqqAKKlRBFVRBFVRBhSqogiqoggpVUAVVUAVVUKEKqqAKqqBCFVRBFVRBFVSogiqogiqoUAVVUAVVUAUVqqAKqqAKKlRBFVRBFVRBhSqogiqoggpVUAVVUAVVUKEKqqAKqqBCFVRBFVRBheoCqIKqG9XW9SQuPt8Ch0sQDPachPkAAAAASUVORK5CYII="/><div class="t m0 x0 hc y1 ff2 fs0 fc0 sc0 ls0 ws0">6<span class="_ _15"> </span><span class="ff1">Markus E. Nebel and Sebastian W<span class="_ _0"></span>ild</span></div><div class="t m0 x0 h13 y27 ff4 fs9 fc0 sc0 ls0 ws0">5.2<span class="_ _19"> </span>Distribution of P<span class="_ _3"></span>ar<span class="_ _21"></span>titioning Costs</div><div class="t m0 x0 h6 y134 ff2 fs0 fc0 sc0 ls0 ws0">Let<span class="_ _c"> </span>us<span class="_ _f"> </span>denote<span class="_ _f"> </span>by<span class="_ _f"> </span><span class="ff6">I</span></div><div class="t m0 x4d hf y135 ffb fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x11e h6 y134 ff2 fs0 fc0 sc0 ls0 ws0">,<span class="_ _f"> </span><span class="ff6">I</span></div><div class="t m0 x65 hf y135 ffb fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 x4f h6 y134 ff2 fs0 fc0 sc0 ls0 ws0">and<span class="_ _c"> </span><span class="ff6">I</span></div><div class="t m0 x58 hf y135 ffb fs6 fc0 sc0 ls0 ws0">3</div><div class="t m0 xa9 hc y134 ff2 fs0 fc0 sc0 ls0 ws0">the<span class="_ _c"> </span>number<span class="_ _f"> </span>of<span class="_ _f"> </span>small,<span class="_ _14"> </span>medium<span class="_ _c"> </span>and<span class="_ _f"> </span>large<span class="_ _c"> </span>elements<span class="_ _c"> </span>among<span class="_ _f"> </span>the<span class="_ _f"> </span>ordinary</div><div class="t m0 x0 h6 y136 ff2 fs0 fc0 sc0 ls0 ws0">elements,<span class="_ _2"> </span>(<span class="ff1">i.<span class="_ _4"></span>e.</span>,<span class="_ _2"> </span><span class="ff6">I</span></div><div class="t m0 xd3 hf y137 ffb fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x4c h6 y136 ff5 fs0 fc0 sc0 ls0 ws0">+ <span class="ff6">I</span></div><div class="t m0 x83 hf y137 ffb fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 x10f h6 y136 ff5 fs0 fc0 sc0 ls0 ws0">+ <span class="ff6">I</span></div><div class="t m0 x57 hf y137 ffb fs6 fc0 sc0 ls0 ws0">3</div><div class="t m0 xcc h6 y136 ff5 fs0 fc0 sc0 ls0 ws0">=<span class="_ _c"> </span><span class="ff6">n<span class="_ _8"> </span><span class="ffc">−<span class="_ _8"> </span></span>k<span class="_ _6"></span><span class="ff2">)<span class="_ _9"> </span>—<span class="_ _a"> </span>or<span class="_ _2"> </span>equiv<span class="_ _3"></span>alently<span class="_ _2"> </span>stated,<span class="_ _2"> </span><span class="ffd">I<span class="_ _c"> </span><span class="ff5">=<span class="_ _f"> </span>(<span class="ff6">I</span></span></span></span></span></div><div class="t m0 x21 hf y137 ffb fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x11f h6 y136 ff6 fs0 fc0 sc0 ls0 ws0">,<span class="_ _9"> </span>I</div><div class="t m0 xcf hf y137 ffb fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 x2a h6 y136 ff6 fs0 fc0 sc0 ls0 ws0">,<span class="_ _9"> </span>I</div><div class="t m0 x120 hf y137 ffb fs6 fc0 sc0 ls0 ws0">3</div><div class="t m0 x84 h6 y136 ff5 fs0 fc0 sc0 ls0 ws0">) <span class="ff2">is<span class="_ _2"> </span>the<span class="_ _2"> </span>(vector<span class="_ _8"> </span>of)<span class="_ _2"> </span>sizes</span></div><div class="t m0 x0 hc y138 ff2 fs0 fc0 sc0 ls0 ws0">of<span class="_ _f"> </span>the<span class="_ _14"> </span>three<span class="_ _f"> </span>partitions<span class="_ _14"> </span>(excluding<span class="_ _f"> </span>sampled-out<span class="_ _14"> </span>elements).<span class="_ _2c"> </span>Moreov<span class="_ _3"></span>er,<span class="_ _14"> </span>we<span class="_ _f"> </span>deﬁne<span class="_ _14"> </span>the<span class="_ _f"> </span>indicator<span class="_ _14"> </span>v<span class="_ _3"></span>ariable</div><div class="t m0 x0 h6 y139 ff6 fs0 fc0 sc0 ls0 ws0">δ<span class="_ _c"> </span><span class="ff5">= <span class="ff1b">1</span></span></div><div class="t m0 xbb hf y13a ff17 fs6 fc0 sc0 ls0 ws0">{<span class="fff">U</span></div><div class="t m0 x121 h1a y13b ff16 fs7 fc0 sc0 ls0 ws0">χ</div><div class="t m0 x2e hf y13a fff fs6 fc0 sc0 ls0 ws0">&gt;<span class="_ _a"> </span>Q<span class="ff17">}</span></div><div class="t m0 x122 hc y139 ff2 fs0 fc0 sc0 ls0 ws0">to account<span class="_ _8"> </span>for<span class="_ _8"> </span>an<span class="_ _8"> </span>idiosyncrasy<span class="_ _2"> </span>of Y<span class="_ _13"></span>aroslavskiy’<span class="_ _0"></span>s<span class="_ _8"> </span>algorithm<span class="_ _2"> </span>(see the proof of<span class="_ _8"> </span>Lemma<span class="_ _2"> </span>5.1),</div><div class="t m0 x0 h6 y13c ff2 fs0 fc0 sc0 ls0 ws0">where <span class="ff6">χ<span class="_ _11"> </span></span>is the point where indices<span class="_ _11"> </span><span class="ff6">k<span class="_ _8"> </span></span>and <span class="ff6">g<span class="_ _2"> </span></span>ﬁrst<span class="_ _11"> </span>meet.<span class="_ _2"> </span>As we will<span class="_ _11"> </span>see, we can characterize the<span class="_ _11"> </span>distribution</div><div class="t m0 x0 h1f y13d ff2 fs0 fc0 sc0 ls0 ws0">of partitioning costs <span class="ff1">conditional </span>on <span class="ffd">I</span>, <span class="ff1">i.<span class="_ _4"></span>e.</span>, when considering <span class="ffd">I<span class="_ _11"> </span><span class="ff1">ﬁxed</span></span>.</div><div class="t m0 x0 h13 y13e ff4 fs9 fc0 sc0 ls0 ws0">5.2.1<span class="_ _19"> </span>Comparisons</div><div class="t m0 x0 hc y13f ff2 fs0 fc0 sc0 ls0 ws0">For<span class="_ _11"> </span>constant<span class="_ _11"> </span>size<span class="_ _a"> </span>samples, only<span class="_ _11"> </span>the<span class="_ _11"> </span>comparisons<span class="_ _11"> </span>during<span class="_ _11"> </span>the<span class="_ _11"> </span>partitioning<span class="_ _11"> </span>process<span class="_ _11"> </span>contrib<span class="_ _3"></span>ute to<span class="_ _11"> </span>the<span class="_ _a"> </span>linearith-</div><div class="t m0 x0 hc y140 ff2 fs0 fc0 sc0 ls0 ws0">mic leading<span class="_ _2"> </span>term of the<span class="_ _8"> </span>asymptotic<span class="_ _2"> </span>a<span class="_ _3"></span>verage costs,<span class="_ _2"> </span>as the number<span class="_ _2"> </span>of partitioning steps<span class="_ _8"> </span>remains<span class="_ _2"> </span>linear<span class="_ _0"></span>.<span class="_ _f"> </span>W<span class="_ _0"></span>e</div><div class="t m0 x0 h6 y141 ff2 fs0 fc0 sc0 ls0 ws0">can<span class="_ _2"> </span>therefore<span class="_ _2"> </span>ignore<span class="_ _2"> </span>comparisons<span class="_ _2"> </span>needed<span class="_ _2"> </span>for<span class="_ _2"> </span>sorting<span class="_ _c"> </span>the<span class="_ _2"> </span>sample.<span class="_ _12"> </span>As<span class="_ _2"> </span><span class="ff6">w<span class="_ _c"> </span></span>is<span class="_ _2"> </span>constant,<span class="_ _2"> </span>the<span class="_ _2"> </span>same<span class="_ _2"> </span>is<span class="_ _c"> </span>true<span class="_ _2"> </span>for</div><div class="t m0 x0 h6 y142 ff2 fs0 fc0 sc0 ls0 ws0">subproblems of size<span class="_ _11"> </span>at most <span class="ff6">w<span class="_ _8"> </span></span>that are<span class="_ _11"> </span>sorted with Insertionsort.<span class="_ _2"> </span>It<span class="_ _11"> </span>remains to count<span class="_ _11"> </span>the comparisons dur<span class="_ _3"></span>-</div><div class="t m0 x0 hc y143 ff2 fs0 fc0 sc0 ls0 ws0">ing the<span class="_ _2"> </span>ﬁrst partitioning<span class="_ _8"> </span>step,<span class="_ _2"> </span>where contributions that<span class="_ _8"> </span>are<span class="_ _2"> </span>uniformly bounded<span class="_ _8"> </span>by<span class="_ _2"> </span>a constant can<span class="_ _2"> </span>like<span class="_ _3"></span>wise</div><div class="t m0 x0 hc y144 ff2 fs0 fc0 sc0 ls0 ws0">be ignored.</div><div class="t m0 x0 h6 y145 ff3 fs0 fc0 sc0 ls0 ws0">Lemma<span class="_ _8"> </span>5.1:<span class="_ _b"> </span><span class="ffa">Conditional<span class="_ _c"> </span>on<span class="_ _c"> </span>the<span class="_ _c"> </span>partition<span class="_ _c"> </span>sizes<span class="_ _c"> </span><span class="ffd">I</span>,<span class="_ _c"> </span>the<span class="_ _c"> </span>number<span class="_ _c"> </span>of<span class="_ _c"> </span>comparisons<span class="_ _2"> </span><span class="ff6">T</span></span></div><div class="t m0 x7d hf y146 fff fs6 fc0 sc0 ls0 ws0">C</div><div class="t m0 xb2 h6 y145 ff5 fs0 fc0 sc0 ls0 ws0">=<span class="_ _27"> </span><span class="ff6">T</span></div><div class="t m0 x123 hf y146 fff fs6 fc0 sc0 ls0 ws0">C</div><div class="t m0 x3f h6 y145 ff5 fs0 fc0 sc0 ls0 ws0">(<span class="ff6">n</span>)<span class="_ _c"> </span><span class="ffa">in<span class="_ _2"> </span>the<span class="_ _c"> </span>ﬁrst</span></div><div class="t m0 x0 h6 y147 ffa fs0 fc0 sc0 ls0 ws0">partitioning step of <span class="ff6">Y</span></div><div class="t m0 x81 hf y148 fff fs6 fc0 sc0 ls0 ws0">w</div><div class="t m0 x64 h19 y149 ff15 fs6 fc0 sc0 ls0 ws0">t</div><div class="t m0 x82 h6 y147 ffa fs0 fc0 sc0 ls0 ws0">on a random permutation of size <span class="ff6">n<span class="_ _8"> </span>&gt;<span class="_ _2"> </span>w<span class="_ _8"> </span></span>fulﬁlls</div><div class="t m0 xb9 h6 y14a ff6 fs0 fc0 sc0 ls0 ws0">T</div><div class="t m0 xba hf y14b fff fs6 fc0 sc0 ls0 ws0">C</div><div class="t m0 x124 h6 y14a ff5 fs0 fc0 sc0 ls0 ws0">(<span class="ff6">n</span>)<span class="_ _1b"> </span>=<span class="_ _1b"> </span>(<span class="ff6">n<span class="_ _11"> </span><span class="ffc">−<span class="_ _11"> </span></span>k</span>)<span class="_ _27"> </span>+<span class="_ _27"> </span><span class="ff6">I</span></div><div class="t m0 xa7 hf y14b ffb fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 x125 h6 y14a ff5 fs0 fc0 sc0 ls0 ws0">+<span class="_ _27"> </span>(<span class="ff6">l<span class="ff2">@<span class="_ _6"></span><span class="ffc">K<span class="_ _21"></span></span></span></span>)<span class="_ _27"> </span>+<span class="_ _27"> </span>(<span class="ff6">s<span class="ff2">@<span class="_ _6"></span><span class="ffc">G<span class="_ _6"></span></span></span></span>)<span class="_ _27"> </span>+<span class="_ _27"> </span>2<span class="ff6">δ<span class="_ _2d"> </span><span class="ff2">(5.4)</span></span></div><div class="t m0 x126 hf y14c ff17 fs6 fc0 sc0 ls0 ws0">D</div><div class="t m0 x127 h6 y14d ff5 fs0 fc0 sc0 ls0 ws0">=<span class="_ _1b"> </span>(<span class="ff6">n<span class="_ _11"> </span><span class="ffc">−<span class="_ _11"> </span></span>k<span class="_ _21"></span></span>)<span class="_ _27"> </span>+<span class="_ _27"> </span><span class="ff6">I</span></div><div class="t m0 xa7 hf y14e ffb fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 x125 h6 y14d ff5 fs0 fc0 sc0 ls0 ws0">+<span class="_ _27"> </span>HypG(<span class="ff6">I</span></div><div class="t m0 x6f hf y14e ffb fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x69 h6 y14d ff5 fs0 fc0 sc0 ls0 ws0">+<span class="_ _11"> </span><span class="ff6">I</span></div><div class="t m0 x53 hf y14e ffb fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 x54 h6 y14d ff6 fs0 fc0 sc0 ls0 ws0">,<span class="_ _9"> </span>I</div><div class="t m0 x55 hf y14e ffb fs6 fc0 sc0 ls0 ws0">3</div><div class="t m0 x56 h6 y14d ff6 fs0 fc0 sc0 ls0 ws0">,<span class="_ _9"> </span>n<span class="_ _8"> </span><span class="ffc">−<span class="_ _11"> </span></span>k<span class="ff5">)<span class="_ _27"> </span>+<span class="_ _27"> </span>HypG(</span>I</div><div class="t m0 x47 hf y14e ffb fs6 fc0 sc0 ls0 ws0">3</div><div class="t m0 xaf h6 y14d ff6 fs0 fc0 sc0 ls0 ws0">,<span class="_ _9"> </span>I</div><div class="t m0 x86 hf y14e ffb fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x22 h6 y14d ff6 fs0 fc0 sc0 ls0 ws0">,<span class="_ _9"> </span>n<span class="_ _8"> </span><span class="ffc">−<span class="_ _11"> </span></span>k<span class="ff5">)<span class="_ _27"> </span>+<span class="_ _27"> </span>3B</span></div><div class="t m0 x3f h16 y14f ff14 fs0 fc0 sc0 ls0 ws0"></div><div class="t m0 x128 hf y150 fff fs6 fc0 sc0 ls0 ws0">I</div><div class="t m0 xa3 h15 y151 ff13 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m0 x18 hf y152 fff fs6 fc0 sc0 ls0 ws0">n<span class="ff17">−</span>k</div><div class="t m0 x36 h16 y14f ff14 fs0 fc0 sc0 ls0 ws0"></div><div class="t m0 x92 h6 y14d ff6 fs0 fc0 sc0 ls0 ws0">.<span class="_ _2e"> </span><span class="ff2">(5.5)</span></div><div class="t m0 x0 h6 y153 ff3 fs0 fc0 sc0 ls0 ws0">Proof:<span class="_ _b"> </span><span class="ff2">Every<span class="_ _11"> </span>ordinary<span class="_ _11"> </span>element is<span class="_ _11"> </span>compared<span class="_ _11"> </span>to<span class="_ _11"> </span>at<span class="_ _11"> </span>least<span class="_ _11"> </span>one<span class="_ _11"> </span>of the<span class="_ _11"> </span>pi<span class="_ _3"></span>vots,<span class="_ _11"> </span>which<span class="_ _11"> </span>makes<span class="_ _11"> </span><span class="ff6">n<span class="_ _4"></span><span class="ffc">−<span class="_ _9"> </span></span>k<span class="_ _8"> </span></span>comparisons.</span></div><div class="t m0 x0 hc y154 ff2 fs0 fc0 sc0 ls0 ws0">Additionally<span class="_ _0"></span>,<span class="_ _2"> </span>for all<span class="_ _2"> </span>medium elements,<span class="_ _2"> </span>the second<span class="_ _8"> </span>comparison<span class="_ _2"> </span>is inevitably needed<span class="_ _2"> </span>to recognize<span class="_ _8"> </span>them<span class="_ _2"> </span>as</div><div class="t m0 x0 h6 y155 ff2 fs0 fc0 sc0 ls0 ws0">“medium”,<span class="_ _11"> </span>and<span class="_ _11"> </span>there<span class="_ _a"> </span>are<span class="_ _11"> </span><span class="ff6">I</span></div><div class="t m0 xa7 hf y156 ffb fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 x10a hc y155 ff2 fs0 fc0 sc0 ls0 ws0">such<span class="_ _11"> </span>elements.<span class="_ _8"> </span>Large<span class="_ _11"> </span>elements<span class="_ _a"> </span>only<span class="_ _11"> </span>cause<span class="_ _11"> </span>a<span class="_ _a"> </span>second comparison<span class="_ _a"> </span>if<span class="_ _11"> </span>they<span class="_ _a"> </span>are<span class="_ _11"> </span>ﬁrst</div><div class="t m0 x0 h6 y157 ff2 fs0 fc0 sc0 ls0 ws0">compared<span class="_ _2"> </span>with<span class="_ _8"> </span><span class="ff6">P<span class="_ _9"> </span></span>,<span class="_ _2"> </span>which<span class="_ _2"> </span>happens<span class="_ _8"> </span>if<span class="_ _2"> </span>and<span class="_ _2"> </span>only<span class="_ _8"> </span>if<span class="_ _2"> </span>they<span class="_ _8"> </span>are<span class="_ _2"> </span>located<span class="_ _2"> </span>in<span class="_ _8"> </span><span class="ff6">k<span class="_ _21"></span></span>’<span class="_ _3"></span>s<span class="_ _2"> </span>range,<span class="_ _2"> </span>see<span class="_ _2"> </span>(Y1).<span class="_ _14"> </span>W<span class="_ _0"></span>e<span class="_ _2"> </span>abbre<span class="_ _3"></span>viated</div><div class="t m0 x0 h6 y158 ff2 fs0 fc0 sc0 ls0 ws0">the (random)<span class="_ _2"> </span>number of<span class="_ _8"> </span>large<span class="_ _8"> </span>elements<span class="_ _2"> </span>in <span class="ffc">K<span class="_ _2"> </span></span>as <span class="ff6">l<span class="ff1">@<span class="_ _6"></span><span class="ffc">K<span class="_ _21"></span></span></span></span>.<span class="_ _f"> </span>Similarly<span class="_ _3"></span>,<span class="_ _8"> </span><span class="ff6">s<span class="ff1">@<span class="_ _6"></span><span class="ffc">G<span class="_ _c"> </span></span></span></span>counts<span class="_ _8"> </span>the<span class="_ _2"> </span>second comparison<span class="_ _8"> </span>for</div><div class="t m0 x0 h6 y159 ff2 fs0 fc0 sc0 ls0 ws0">all small elements found in <span class="ff6">g<span class="_ _21"></span></span>’<span class="_ _3"></span>s range, see (Y2).</div><div class="t m0 x5 h6 y15a ff2 fs0 fc0 sc0 ls0 ws0">The<span class="_ _f"> </span>last<span class="_ _f"> </span>summand<span class="_ _f"> </span><span class="ff5">2<span class="ff6">δ<span class="_ _14"> </span></span></span>accounts<span class="_ _f"> </span>for<span class="_ _f"> </span>a<span class="_ _14"> </span>technicality<span class="_ _c"> </span>in<span class="_ _f"> </span>Y<span class="_ _0"></span>aroslavskiy’<span class="_ _0"></span>s<span class="_ _f"> </span>algorithm.<span class="_ _22"> </span>If<span class="_ _f"> </span><span class="ff6">U</span></div><div class="t m0 x3f hf y15b fff fs6 fc0 sc0 ls0 ws0">χ</div><div class="t m0 x18 hc y15a ff2 fs0 fc0 sc0 ls0 ws0">,<span class="_ _14"> </span>the<span class="_ _f"> </span>element</div><div class="t m0 x0 h6 y15c ff2 fs0 fc0 sc0 ls0 ws0">where <span class="ff6">k<span class="_ _11"> </span></span>and <span class="ff6">g<span class="_ _8"> </span></span>meet, is<span class="_ _11"> </span>large,<span class="_ _11"> </span>then inde<span class="_ _3"></span>x <span class="ff6">k<span class="_ _8"> </span></span>ov<span class="_ _3"></span>ershoots <span class="ff6">g<span class="_ _8"> </span></span>by one,<span class="_ _11"> </span>which causes<span class="_ _11"> </span>two<span class="_ _11"> </span>additional (superﬂuous)</div><div class="t m0 x0 h6 y15d ff2 fs0 fc0 sc0 ls0 ws0">comparisons with this element.<span class="_ _2"> </span><span class="ff6">δ<span class="_ _2"> </span><span class="ff5">= <span class="ff1b">1</span></span></span></div><div class="t m0 x5a hf y15e ff17 fs6 fc0 sc0 ls0 ws0">{<span class="fff">U</span></div><div class="t m0 x129 h1a y15f ff16 fs7 fc0 sc0 ls0 ws0">χ</div><div class="t m0 x71 hf y15e fff fs6 fc0 sc0 ls0 ws0">&gt;<span class="_ _a"> </span>Q<span class="ff17">}</span></div><div class="t m0 xec hc y15d ff2 fs0 fc0 sc0 ls0 ws0">is the indicator variable of this e<span class="_ _3"></span>vent.<span class="_ _2"> </span>This pro<span class="_ _3"></span>ves (5.4).</div><div class="t m0 x5 h6 y160 ff2 fs0 fc0 sc0 ls0 ws0">For<span class="_ _2"> </span>the<span class="_ _8"> </span>equality<span class="_ _2"> </span>in<span class="_ _2"> </span>distribution,<span class="_ _2"> </span>recall<span class="_ _2"> </span>that<span class="_ _2"> </span><span class="ff6">I</span></div><div class="t m0 x12a hf y161 ffb fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x12b h6 y160 ff2 fs0 fc0 sc0 ls0 ws0">,<span class="_ _2"> </span><span class="ff6">I</span></div><div class="t m0 xb5 hf y161 ffb fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 x12c h6 y160 ff2 fs0 fc0 sc0 ls0 ws0">and<span class="_ _2"> </span><span class="ff6">I</span></div><div class="t m0 xac hf y161 ffb fs6 fc0 sc0 ls0 ws0">3</div><div class="t m0 x76 hc y160 ff2 fs0 fc0 sc0 ls0 ws0">are<span class="_ _2"> </span>the<span class="_ _2"> </span>number<span class="_ _2"> </span>of<span class="_ _2"> </span>small,<span class="_ _2"> </span>medium<span class="_ _2"> </span>and<span class="_ _2"> </span>lar<span class="_ _3"></span>ge</div><div class="t m0 x0 h6 y162 ff2 fs0 fc0 sc0 ls0 ws0">elements,<span class="_ _c"> </span>respecti<span class="_ _d"></span>vely<span class="_ _0"></span>.<span class="_ _2f"> </span>Then<span class="_ _2"> </span>we<span class="_ _c"> </span>need<span class="_ _2"> </span>the<span class="_ _c"> </span>cardinalities<span class="_ _2"> </span>of<span class="_ _2"> </span><span class="ffc">K<span class="_ _c"> </span></span>and<span class="_ _c"> </span><span class="ffc">G<span class="_ _6"></span></span>.<span class="_ _2f"> </span>Since<span class="_ _2"> </span>the<span class="_ _c"> </span>elements<span class="_ _2"> </span>right<span class="_ _c"> </span>of<span class="_ _2"> </span><span class="ff6">g<span class="_ _f"> </span></span>after</div><div class="t m0 x0 h6 y163 ff2 fs0 fc0 sc0 ls0 ws0">partitioning are<span class="_ _11"> </span>exactly<span class="_ _11"> </span>all lar<span class="_ _3"></span>ge elements, we<span class="_ _11"> </span>hav<span class="_ _3"></span>e <span class="ffc">|G<span class="_ _6"></span>|<span class="_ _2"> </span><span class="ff5">= <span class="ff6">I</span></span></span></div><div class="t m0 x12d hf y164 ffb fs6 fc0 sc0 ls0 ws0">3</div><div class="t m0 x11b h6 y163 ff2 fs0 fc0 sc0 ls0 ws0">and <span class="ffc">|K|<span class="_ _8"> </span><span class="ff5">= <span class="ff6">I</span></span></span></div><div class="t m0 x12e hf y164 ffb fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x86 h6 y163 ff5 fs0 fc0 sc0 ls0 ws0">+<span class="_ _9"> </span><span class="ff6">I</span></div><div class="t m0 x107 hf y164 ffb fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 x117 h6 y163 ff5 fs0 fc0 sc0 ls0 ws0">+<span class="_ _9"> </span><span class="ff6">δ<span class="_ _6"></span><span class="ff2">; (again,<span class="_ _11"> </span></span>δ<span class="_ _8"> </span><span class="ff2">accounts for</span></span></div><div class="t m0 x0 h6 y165 ff2 fs0 fc0 sc0 ls0 ws0">the ov<span class="_ _3"></span>ershoot, see W<span class="_ _3"></span>ild et al. (2013b) for<span class="_ _11"> </span>detailed arguments).<span class="_ _2"> </span>The<span class="_ _11"> </span>distribution<span class="_ _11"> </span>of <span class="ff6">s<span class="ff1">@<span class="_ _6"></span><span class="ffc">G<span class="_ _6"></span></span></span></span>, conditional on <span class="ffd">I</span>,</div><div class="t m0 x0 h6 y166 ff2 fs0 fc0 sc0 ls0 ws0">is<span class="_ _2"> </span>now<span class="_ _2"> </span>gi<span class="_ _3"></span>ven<span class="_ _2"> </span>by<span class="_ _2"> </span>the<span class="_ _2"> </span>following<span class="_ _2"> </span>urn<span class="_ _2"> </span>model:<span class="_ _14"> </span>we<span class="_ _2"> </span>put<span class="_ _2"> </span>all<span class="_ _2"> </span><span class="ff6">n<span class="_ _2"> </span><span class="ffc">−<span class="_ _8"> </span></span>k<span class="_ _2"> </span></span>ordinary<span class="_ _c"> </span>elements<span class="_ _2"> </span>in<span class="_ _2"> </span>an<span class="_ _2"> </span>urn<span class="_ _2"> </span>and<span class="_ _2"> </span>draw<span class="_ _2"> </span>their</div><div class="t m0 x0 hc y167 ff2 fs0 fc0 sc0 ls0 ws0">positions<span class="_ _8"> </span>in</div><div class="t m2 x7 h12 y168 ff12 fs8 fc0 sc0 ls0 ws0">A</div><div class="t m0 x12f h6 y167 ff2 fs0 fc0 sc0 ls0 ws0">.<span class="_ _14"> </span><span class="ff6">I</span></div><div class="t m0 xd3 hf y169 ffb fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x4c hc y167 ff2 fs0 fc0 sc0 ls0 ws0">of<span class="_ _8"> </span>the<span class="_ _2"> </span>elements<span class="_ _8"> </span>are<span class="_ _2"> </span>colored red<span class="_ _2"> </span>(namely the<span class="_ _2"> </span>small<span class="_ _8"> </span>ones),<span class="_ _2"> </span>the<span class="_ _8"> </span>rest<span class="_ _2"> </span>is<span class="_ _8"> </span>black<span class="_ _2"> </span>(non-small).</div><div class="t m0 x0 h6 y16a ff2 fs0 fc0 sc0 ls0 ws0">Now<span class="_ _11"> </span>we draw<span class="_ _11"> </span>the <span class="ffc">|G<span class="_ _21"></span>|<span class="_ _2"> </span><span class="ff5">= <span class="ff6">I</span></span></span></div><div class="t m0 x4f hf y16b ffb fs6 fc0 sc0 ls0 ws0">3</div><div class="t m0 xa6 h6 y16a ff2 fs0 fc0 sc0 ls0 ws0">elements in <span class="ff6">g</span>’<span class="_ _3"></span>s range from the urn<span class="_ _11"> </span>without replacement.<span class="_ _2"> </span>Then <span class="ff6">s<span class="ff1">@<span class="_ _21"></span><span class="ffc">G<span class="_ _2"> </span></span></span></span>is e<span class="_ _d"></span>xactly</div><div class="t m0 x0 h6 y4d ff2 fs0 fc0 sc0 ls0 ws0">the number of red (small) elements drawn and thus <span class="ff6">s<span class="ff1">@<span class="_ _21"></span><span class="ffc">G</span></span></span></div><div class="t m0 x130 h11 y16c ff11 fs7 fc0 sc0 ls0 ws0">D</div><div class="t m0 xe h6 y4d ff5 fs0 fc0 sc0 ls0 ws0">=<span class="_ _12"> </span>HypG(<span class="ff6">I</span></div><div class="t m0 x87 hf y16d ffb fs6 fc0 sc0 ls0 ws0">3</div><div class="t m0 x131 h6 y4d ff6 fs0 fc0 sc0 ls0 ws0">,<span class="_ _9"> </span>I</div><div class="t m0 x78 hf y16d ffb fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x132 h6 y4d ff6 fs0 fc0 sc0 ls0 ws0">,<span class="_ _9"> </span>n<span class="_ _8"> </span><span class="ffc">−<span class="_ _11"> </span></span>k<span class="ff5">)<span class="ff2">.</span></span></div><div class="t m0 x5 h6 y4f ff2 fs0 fc0 sc0 ls0 ws0">The arguments for<span class="_ _2"> </span><span class="ff6">l<span class="ff1">@<span class="_ _6"></span><span class="ffc">K<span class="_ _2"> </span></span></span></span>are similar<span class="_ _3"></span>,<span class="_ _2"> </span>ho<span class="_ _3"></span>wev<span class="_ _3"></span>er<span class="_ _2"> </span>the additional <span class="ff6">δ<span class="_ _2"> </span></span>in<span class="_ _2"> </span><span class="ffc">|K|<span class="_ _8"> </span></span>needs<span class="_ _8"> </span>special<span class="_ _2"> </span>care.<span class="_ _c"> </span>As<span class="_ _8"> </span>shown in</div><div class="t m0 x0 h6 y51 ff2 fs0 fc0 sc0 ls0 ws0">the<span class="_ _2"> </span>proof of<span class="_ _2"> </span>Lemma<span class="_ _8"> </span>3.7<span class="_ _2"> </span>of<span class="_ _8"> </span>Wild et<span class="_ _2"> </span>al.<span class="_ _8"> </span>(2013b),<span class="_ _2"> </span>the<span class="_ _2"> </span>additional element<span class="_ _2"> </span>in<span class="_ _8"> </span><span class="ff6">k<span class="_ _21"></span></span>’<span class="_ _3"></span>s<span class="_ _2"> </span>range<span class="_ _8"> </span>for<span class="_ _2"> </span>the<span class="_ _2"> </span>case <span class="ff6">δ<span class="_ _f"> </span><span class="ff5">=<span class="_ _c"> </span>1<span class="_ _2"> </span></span></span>is</div><div class="t m0 x0 h6 y55 ff6 fs0 fc0 sc0 ls0 ws0">U</div><div class="t m0 x2c hf y16e fff fs6 fc0 sc0 ls0 ws0">χ</div><div class="t m0 xba h6 y55 ff2 fs0 fc0 sc0 ls0 ws0">,<span class="_ _2"> </span>which<span class="_ _2"> </span>then<span class="_ _2"> </span>is<span class="_ _2"> </span>large<span class="_ _2"> </span>by<span class="_ _8"> </span>deﬁnition<span class="_ _2"> </span>of<span class="_ _2"> </span><span class="ff6">δ<span class="_ _6"></span></span>.<span class="_ _b"> </span>It<span class="_ _2"> </span>thus<span class="_ _2"> </span>simply<span class="_ _2"> </span>contributes<span class="_ _8"> </span>as<span class="_ _2"> </span>additional<span class="_ _2"> </span>summand:<span class="_ _14"> </span><span class="ff6">l<span class="_ _21"></span><span class="ff1">@<span class="_ _6"></span><span class="ffc">K</span></span></span></div><div class="t m0 x95 h11 y16f ff11 fs7 fc0 sc0 ls0 ws0">D</div><div class="t m0 x133 h6 y55 ff5 fs0 fc0 sc0 ls0 ws0">=</div><div class="t m0 x0 h6 y170 ff5 fs0 fc0 sc0 ls0 ws0">HypG(<span class="ff6">I</span></div><div class="t m0 x121 hf y171 ffb fs6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x6 h6 y170 ff5 fs0 fc0 sc0 ls0 ws0">+<span class="_ _11"> </span><span class="ff6">I</span></div><div class="t m0 x5e hf y171 ffb fs6 fc0 sc0 ls0 ws0">2</div><div class="t m0 x8b h6 y170 ff6 fs0 fc0 sc0 ls0 ws0">,<span class="_ _9"> </span>I</div><div class="t m0 xd2 hf y171 ffb fs6 fc0 sc0 ls0 ws0">3</div><div class="t m0 x134 h6 y170 ff6 fs0 fc0 sc0 ls0 ws0">,<span class="_ _9"> </span>n<span class="_ _11"> </span><span class="ffc">−<span class="_ _11"> </span></span>k<span class="_ _21"></span><span class="ff5">)<span class="_ _11"> </span>+<span class="_ _11"> </span></span>δ<span class="_ _6"></span><span class="ff2">.<span class="_ _2"> </span>Finally<span class="_ _0"></span>, the distribution of <span class="ff6">δ<span class="_ _8"> </span></span>is Bernoulli <span class="ff5">B</span></span></div><div class="t m0 x48 h16 y172 ff14 fs0 fc0 sc0 ls0 ws0"></div><div class="t m0 x15 hf y173 fff fs6 fc0 sc0 ls0 ws0">I</div><div class="t m0 x49 h15 y174 ff13 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m0 x14 hf y175 fff fs6 fc0 sc0 ls0 ws0">n<span class="ff17">−</span>k</div><div class="t m0 x135 h16 y172 ff14 fs0 fc0 sc0 ls0 ws0"></div><div class="t m0 x3c h1f y170 ff2 fs0 fc0 sc0 ls0 ws0">, since conditional on <span class="ffd">I</span>,</div><div class="t m0 x0 h6 yd8 ff2 fs0 fc0 sc0 ls0 ws0">the probability of an ordinary element to be large is <span class="ff6">I</span></div><div class="t m0 x136 hf y176 ffb fs6 fc0 sc0 ls0 ws0">3</div><div class="t m0 x98 h6 yd8 ff6 fs0 fc0 sc0 ls0 ws0">/<span class="ff5">(</span>n<span class="_ _11"> </span><span class="ffc">−<span class="_ _11"> </span></span>k<span class="_ _21"></span><span class="ff5">)<span class="ff2">.</span></span></div><div class="t m0 x137 h20 y177 ff1c fs0 fc0 sc0 ls0 ws0">2</div><a class="l" href="#pf6" data-dest-detail='[6,"XYZ",81.963,544.688,null]'><div class="d m1" style="border-style:none;position:absolute;left:752.716387px;bottom:1111.346669px;width:47.508000px;height:12.674000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4" data-dest-detail='[4,"XYZ",81.963,679.954,null]'><div class="d m1" style="border-style:none;position:absolute;left:691.371733px;bottom:701.432613px;width:20.802000px;height:11.068000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4" data-dest-detail='[4,"XYZ",81.963,661.327,null]'><div class="d m1" style="border-style:none;position:absolute;left:416.524436px;bottom:661.266371px;width:20.802000px;height:10.904000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf6" data-dest-detail='[6,"XYZ",481.305,512.211,null]'><div class="d m1" style="border-style:none;position:absolute;left:793.692338px;bottom:601.643607px;width:14.446000px;height:10.530000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",57.056,271.558,null]'><div class="d m1" style="border-style:none;position:absolute;left:259.701382px;bottom:520.682843px;width:43.217000px;height:10.984000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",57.056,271.558,null]'><div class="d m1" style="border-style:none;position:absolute;left:338.575719px;bottom:520.682843px;width:26.899000px;height:10.984000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",57.056,271.558,null]'><div class="d m1" style="border-style:none;position:absolute;left:321.413932px;bottom:400.182436px;width:44.104000px;height:11.067000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",57.056,271.558,null]'><div class="d m1" style="border-style:none;position:absolute;left:402.524207px;bottom:400.182436px;width:26.899000px;height:11.067000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.679893,0.000000,0.000000,1.679893,0.000000,0.000000]}'></div></div>
