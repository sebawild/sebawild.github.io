<div id="pf15" class="pf w0 h0" data-page-no="15"><div class="pc pc15 w0 h0"><img class="bi x143 y5c wf h2d" alt="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAXoAAACPCAIAAAB76ofZAAAACXBIWXMAABYlAAAWJQFJUiTwAAABf0lEQVR42u3WQQkAIBREQRUb2L+PpeTbQMSDIsxE2MNjc9oWEQngVBYR4I5iAkBuALkBkBtAbgC5AZAbQG4A5AaQG0BuAOQGkBsAuQHkBpAbALkB5AZAbgC5AeQGQG4AuQGQG0BuALkBkBtAbgDkBpAbQG4A5AaQGwC5AeQGkBsAuQHkBkBuALkB5AZAbgC5AZAbQG4AuQGQG0BuAOQGkBtAbgDkBpAbALkB5AaQGwC5AeQGQG4AuQHkBkBuALkBkBtAbgC5AZAbQG4A5AaQG0BuAOQGkBsAuQHkBpAbALkB5AZAbgC5AeQGQG4AuQGQG0BuALkBkBtAbgDkBpAbQG4A5AaQGwC5AeQGkBsAuQHkBkBuALkB5AZAbgC5AVirJvjR6M0IeDcAcgPIDSA3AHIDyA2A3AByA8gNgNwAcgMgN4DcAHIDIDeA3ADIDSA3gNwAyA0gNwByA8gNIDcAcgPIDYDcAHIDyA2A3AByAyA3gNwAcgMgN4DcAMgN8MYEV3YI8bXqgdAAAAAASUVORK5CYII="/><div class="t m0 x0 h5 y2e ff1 fs3 fc0 sc0 ls0 ws0">C.<span class="_ _a"> </span>M.<span class="_ _8"> </span>Rysgaa<span class="_ _4"></span>rd,<span class="_ _8"> </span>S.<span class="_ _a"> </span>Wild.<span class="_ _36"> </span>21</div><div class="t m5 x0 h7 y5d ff7 fs4 fc0 sc0 ls0 ws0">increases<span class="_ _5"> </span>the<span class="_ _a"> </span>time<span class="_ _7"> </span>to<span class="_ _a"> </span>searc<span class="_ _4"></span>h<span class="_ _5"> </span>for<span class="_ _a"> </span>the<span class="_ _7"> </span>correct<span class="_ _a"> </span>in<span class="_ _4"></span>terv<span class="_ _9"></span>al<span class="_ _a"> </span>upon<span class="_ _5"> </span>insertions<span class="_ _a"> </span>(and<span class="_ _5"> </span>other<span class="_ _5"> </span>op<span class="_ _2"></span>erations).</div><div class="t m27 x0 h7 y5e ff7 fs4 fc0 sc0 ls0 ws0">Lazy<span class="_ _5"> </span>search<span class="_ _7"> </span>trees<span class="_ _a"> </span>handle<span class="_ _7"> </span>this<span class="_ _a"> </span>trade-oﬀ<span class="_ _5"> </span>as<span class="_ _5"> </span>follows.<span class="_ _8"> </span>T<span class="_ _9"></span>o<span class="_ _5"> </span>b<span class="_ _2"></span>ound<span class="_ _5"> </span>the<span class="_ _5"> </span>worst<span class="_ _5"> </span>case<span class="_ _5"> </span>insertion<span class="_ _a"> </span>costs,</div><div class="t md x3 h7 y60 ff7 fs4 fc0 sc0 ls0 ws0">w<span class="_ _4"></span>e<span class="_ _5"> </span>enforce<span class="_ _a"> </span>a<span class="_ _5"> </span>hard<span class="_ _5"> </span>limit<span class="_ _a"> </span>n<span class="_ _4"></span>um<span class="_ _4"></span>b<span class="_ _2"></span>er<span class="_ _5"> </span>on<span class="_ _a"> </span>the<span class="_ _5"> </span>n<span class="_ _4"></span>umber<span class="_ _5"> </span>of<span class="_ _a"> </span>in<span class="_ _4"></span>terv<span class="_ _9"></span>als<span class="_ _a"> </span>via<span class="_ _5"> </span>a<span class="_ _5"> </span>merging<span class="_ _a"> </span>rule.<span class="_ _3"> </span>T<span class="_ _17"></span>o<span class="_ _a"> </span>amortize</div><div class="t m19 x0 h7 y61 ff7 fs4 fc0 sc0 ls0 ws0">o<span class="_ _2"></span>ccasional<span class="_ _5"> </span>high<span class="_ _5"> </span>costs<span class="_ _a"> </span>for<span class="_ _5"> </span>queries,<span class="_ _a"> </span>w<span class="_ _9"></span>e<span class="_ _a"> </span>accrue<span class="_ _5"> </span>p<span class="_ _2"></span>oten<span class="_ _4"></span>tial<span class="_ _a"> </span>(<span class="ffb">Φ</span></div><div class="t m0 x3f hd y62 ff13 fs7 fc0 sc0 ls0 ws0">i,j</div><div class="t m19 x11c h7 y61 ff7 fs4 fc0 sc0 ls0 ws0">b<span class="_ _2"></span>elo<span class="_ _4"></span>w)<span class="_ _5"> </span>for<span class="_ _a"> </span>an<span class="_ _4"></span>y<span class="_ _5"> </span>interv<span class="_ _6"></span>als<span class="_ _a"> </span>that<span class="_ _5"> </span>are</div><div class="t m0 x1c0 h7 y63 ff7 fs4 fc0 sc0 ls0 ws0">“to<span class="_ _2"></span>o<span class="_ _5"> </span>large”<span class="_ _5"> </span>relative<span class="_ _5"> </span>to<span class="_ _5"> </span>their<span class="_ _a"> </span>pro<span class="_ _9"></span>ximity<span class="_ _5"> </span>of<span class="_ _5"> </span>a<span class="_ _a"> </span>gap<span class="_ _5"> </span>b<span class="_ _2"></span>oundary<span class="_ _6"></span>.</div><div class="t m1 x2 h7 y53d ff7 fs4 fc0 sc0 ls0 ws0">Moreo<span class="_ _4"></span>ver,<span class="_ _a"> </span>for<span class="_ _a"> </span>queries<span class="_ _a"> </span>w<span class="_ _4"></span>e<span class="_ _a"> </span>would<span class="_ _5"> </span>like<span class="_ _a"> </span>to<span class="_ _a"> </span>ha<span class="_ _4"></span>ve<span class="_ _5"> </span>interv<span class="_ _9"></span>al<span class="_ _a"> </span>sizes<span class="_ _a"> </span>grow<span class="_ _5"> </span>exp<span class="_ _2"></span>onentially<span class="_ _a"> </span>to<span class="_ _9"></span>wards</div><div class="t m6 x0 h7 y53e ff7 fs4 fc0 sc0 ls0 ws0">the<span class="_ _5"> </span>middle,<span class="_ _a"> </span>as<span class="_ _5"> </span>this<span class="_ _5"> </span>allows<span class="_ _5"> </span>for<span class="_ _5"> </span>eﬃciently<span class="_ _5"> </span>manipulating<span class="_ _a"> </span>the<span class="_ _7"> </span>interv<span class="_ _9"></span>als<span class="_ _5"> </span>closest<span class="_ _a"> </span>to<span class="_ _5"> </span>the<span class="_ _a"> </span>edge.<span class="_ _3"> </span>This</div><div class="t m1 x0 h7 y53f ff7 fs4 fc0 sc0 ls0 ws0">folklore<span class="_ _8"> </span>rule<span class="_ _a"> </span>seems<span class="_ _8"> </span>too<span class="_ _8"> </span>rigid<span class="_ _8"> </span>to<span class="_ _a"> </span>maintain<span class="_ _a"> </span>up<span class="_ _2"></span>on<span class="_ _a"> </span>queries,<span class="_ _8"> </span>though,<span class="_ _8"> </span>as<span class="_ _8"> </span>many<span class="_ _a"> </span>changes<span class="_ _a"> </span>can<span class="_ _8"> </span>be</div><div class="t m0 x0 h7 y540 ff7 fs4 fc0 sc0 ls0 ws0">necessary<span class="_ _6"></span>.</div><div class="t m0 x0 h6 y3c ff1 fs1 fc0 sc0 ls0 ws0">A.1.1<span class="_ _12"> </span>Merging<span class="_ _3"> </span>Intervals</div><div class="t m0 x3 h7 y541 ff7 fs4 fc0 sc0 ls0 ws0">W<span class="_ _6"></span>e<span class="_ _5"> </span>maintain<span class="_ _5"> </span>the<span class="_ _5"> </span>following<span class="_ _5"> </span>inv<span class="_ _6"></span>ariant<span class="_ _5"> </span>on<span class="_ _5"> </span>the<span class="_ _a"> </span>n<span class="_ _9"></span>umber<span class="_ _a"> </span>of<span class="_ _5"> </span>interv<span class="_ _6"></span>als:</div><div class="t m0 x0 h7 y542 ff1 fs4 fc1 sc0 ls0 ws0">Inva<span class="_ _4"></span>riant<span class="_ _a"> </span>(#Int):<span class="_ _30"> </span><span class="ff7 fc0">F<span class="_ _6"></span>or<span class="_ _a"> </span>a<span class="_ _5"> </span>gap<span class="_ _5"> </span><span class="ffb">∆</span></span></div><div class="t m0 x34 hd y543 ff13 fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x8 h7 y542 ff7 fs4 fc0 sc0 ls0 ws0">,<span class="_ _5"> </span>the<span class="_ _a"> </span>n<span class="_ _9"></span>umber<span class="_ _a"> </span>of<span class="_ _5"> </span>interv<span class="_ _6"></span>als<span class="_ _a"> </span><span class="ff9">I</span></div><div class="t m0 x147 hd y543 ff13 fs7 fc0 sc0 ls0 ws0">i,j</div><div class="t m0 x14f h7 y542 ff7 fs4 fc0 sc0 ls0 ws0">is<span class="_ _5"> </span>at<span class="_ _a"> </span>most<span class="_ _7"> </span><span class="ffb">4<span class="_ _e"> </span>log</span></div><div class="t m0 xd4 hd y544 ff11 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x30 h7 y542 ffa fs4 fc0 sc0 ls0 ws0">|<span class="ffb">∆</span></div><div class="t m0 x17d hd y543 ff13 fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x165 h7 y542 ffa fs4 fc0 sc0 ls0 ws0">|<span class="_ _1d"> </span><span class="ffb">+<span class="_ _d"> </span>2<span class="ff7">.</span></span></div><div class="t m1 x2 h7 y545 ff7 fs4 fc0 sc0 ls0 ws0">This<span class="_ _8"> </span>allows<span class="_ _8"> </span>for<span class="_ _8"> </span>locating<span class="_ _8"> </span>an<span class="_ _3"> </span>in<span class="_ _9"></span>terv<span class="_ _4"></span>al<span class="_ _8"> </span>using</div><div class="t m0 xa0 h7 y545 ffa fs4 fc0 sc0 ls0 ws0">O<span class="_ _2"></span><span class="ffb">(log</span></div><div class="t m0 x76 hd y546 ff13 fs7 fc0 sc0 ls0 ws0">B</div><div class="t m0 x3e h7 y545 ffb fs4 fc0 sc0 ls0 ws0">log</div><div class="t m0 x188 hd y546 ff11 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x138 h7 y545 ffa fs4 fc0 sc0 ls0 ws0">|<span class="ffb">∆</span></div><div class="t m0 x166 hd y547 ff13 fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xbc h7 y545 ffa fs4 fc0 sc0 ls0 ws0">|<span class="ffb">)</span></div><div class="t m1 x1be h7 y545 ffb fs4 fc0 sc0 ls0 ws0">=</div><div class="t m0 x69 h7 y545 ffa fs4 fc0 sc0 ls0 ws0">O<span class="_ _2"></span><span class="ffb">(log</span></div><div class="t m0 x115 hd y546 ff13 fs7 fc0 sc0 ls0 ws0">B</div><div class="t m0 x59 h7 y545 ffb fs4 fc0 sc0 ls0 ws0">log</div><div class="t m0 x5b hd y546 ff13 fs7 fc0 sc0 ls0 ws0">B</div><div class="t m0 x17d h7 y545 ffa fs4 fc0 sc0 ls0 ws0">|<span class="ffb">∆</span></div><div class="t m0 x1ac hd y547 ff13 fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xcd h7 y545 ffa fs4 fc0 sc0 ls0 ws0">|<span class="ffb">)</span></div><div class="t m1 x121 h7 y545 ff7 fs4 fc0 sc0 ls0 ws0">I/Os.</div><div class="t m1a x3 h7 y548 ff7 fs4 fc0 sc0 ls0 ws0">This<span class="_ _5"> </span>I/O<span class="_ _5"> </span>cost<span class="_ _a"> </span>also<span class="_ _7"> </span>applies<span class="_ _a"> </span>to<span class="_ _7"> </span>recomputing<span class="_ _a"> </span>the<span class="_ _5"> </span>sizes<span class="_ _5"> </span>of<span class="_ _5"> </span>subtrees<span class="_ _a"> </span>when<span class="_ _7"> </span>up<span class="_ _2"></span>dating<span class="_ _5"> </span>an<span class="_ _a"> </span>in<span class="_ _4"></span>terv<span class="_ _9"></span>al.</div><div class="t ma x3 h7 y549 ff7 fs4 fc0 sc0 ls0 ws0">T<span class="_ _6"></span>o<span class="_ _5"> </span>b<span class="_ _2"></span>ound<span class="_ _5"> </span>the<span class="_ _a"> </span>I/O<span class="_ _7"> </span>cost<span class="_ _a"> </span>of<span class="_ _7"> </span>the<span class="_ _a"> </span>operations,<span class="_ _a"> </span>w<span class="_ _9"></span>e<span class="_ _a"> </span>deﬁne<span class="_ _5"> </span>the<span class="_ _5"> </span>following<span class="_ _7"> </span>for<span class="_ _a"> </span>the<span class="_ _7"> </span>analysis.<span class="_ _3"> </span>Let<span class="_ _a"> </span><span class="ff15">o</span></div><div class="t m0 x4c h7 y549 ffb fs4 fc0 sc0 ls0 ws0">(<span class="ff9">I</span></div><div class="t m0 x5c hd y54a ff13 fs7 fc0 sc0 ls0 ws0">i,j</div><div class="t m0 x78 h7 y549 ffb fs4 fc0 sc0 ls0 ws0">)</div><div class="t ma x180 h7 y549 ff7 fs4 fc0 sc0 ls0 ws0">,</div><div class="t m21 x0 h7 y54b ff7 fs4 fc0 sc0 ls0 ws0">the<span class="_ _5"> </span>“outside<span class="_ _5"> </span>(elements)<span class="_ _5"> </span>of</div><div class="t m0 x19a h7 y54b ff9 fs4 fc0 sc0 ls0 ws0">I</div><div class="t m0 x140 hd y54c ff13 fs7 fc0 sc0 ls0 ws0">i,j</div><div class="t m21 x19c h7 y54b ff7 fs4 fc0 sc0 ls0 ws0">”,<span class="_ _5"> </span>denote<span class="_ _5"> </span>the<span class="_ _a"> </span>n<span class="_ _4"></span>umber<span class="_ _5"> </span>of<span class="_ _a"> </span>elemen<span class="_ _9"></span>ts<span class="_ _a"> </span>betw<span class="_ _4"></span>een<span class="_ _5"> </span>interv<span class="_ _6"></span>al</div><div class="t m0 x7a h7 y54b ff9 fs4 fc0 sc0 ls0 ws0">I</div><div class="t m0 x7b hd y54c ff13 fs7 fc0 sc0 ls0 ws0">i,j</div><div class="t m21 x111 h7 y54b ff7 fs4 fc0 sc0 ls0 ws0">and<span class="_ _5"> </span>a</div><div class="t ma x3 h7 y54d ff8 fs4 fc0 sc0 ls0 ws0">querie<span class="_ _9"></span>d<span class="_ _8"> </span><span class="ff7">side<span class="_ _5"> </span>of<span class="_ _a"> </span>the<span class="_ _7"> </span>gap;<span class="_ _a"> </span>if<span class="_ _7"> </span>b<span class="_ _2"></span>oth<span class="_ _5"> </span>sides<span class="_ _a"> </span>ha<span class="_ _9"></span>ve<span class="_ _5"> </span>b<span class="_ _2"></span>een<span class="_ _5"> </span>queries,<span class="_ _5"> </span><span class="ff15">o</span></span></div><div class="t m0 x3f h7 y54d ffb fs4 fc0 sc0 ls0 ws0">(<span class="ff9">I</span></div><div class="t m0 x188 hd y54e ff13 fs7 fc0 sc0 ls0 ws0">i,j</div><div class="t m0 x184 h7 y54d ffb fs4 fc0 sc0 ls0 ws0">)</div><div class="t ma x19e h7 y54d ff7 fs4 fc0 sc0 ls0 ws0">is<span class="_ _5"> </span>the<span class="_ _5"> </span>tow<span class="_ _9"></span>ards<span class="_ _a"> </span>the<span class="_ _7"> </span><span class="ff8">closest<span class="_ _8"> </span></span>side.</div><div class="t m1a x3 h7 y54f ff7 fs4 fc0 sc0 ls0 ws0">W<span class="_ _6"></span>e<span class="_ _5"> </span>denote<span class="_ _a"> </span>an<span class="_ _7"> </span>interv<span class="_ _9"></span>al<span class="_ _5"> </span>to<span class="_ _5"> </span>b<span class="_ _2"></span>e<span class="_ _5"> </span><span class="ff8">left<span class="_ _8"> </span></span>if<span class="_ _5"> </span>the<span class="_ _a"> </span>closest<span class="_ _7"> </span>edge<span class="_ _a"> </span>is<span class="_ _7"> </span>to<span class="_ _a"> </span>the<span class="_ _7"> </span>left<span class="_ _a"> </span>and<span class="_ _7"> </span><span class="ff8">right<span class="_ _8"> </span></span>otherwise.<span class="_ _3"> </span>Note</div><div class="t m3 x0 h7 y550 ff7 fs4 fc0 sc0 ls0 ws0">for<span class="_ _5"> </span>a<span class="_ _5"> </span><span class="ffb">0</span>-sided<span class="_ _a"> </span>gap,<span class="_ _7"> </span>the<span class="_ _a"> </span>outside<span class="_ _7"> </span>is<span class="_ _a"> </span>alw<span class="_ _9"></span>ays<span class="_ _5"> </span><span class="ffb">0</span>.<span class="_ _3"> </span>F<span class="_ _6"></span>or<span class="_ _5"> </span>a<span class="_ _5"> </span><span class="ffb">1</span>-sided<span class="_ _a"> </span>gap<span class="_ _7"> </span>with<span class="_ _a"> </span>a<span class="_ _7"> </span>query<span class="_ _a"> </span>on<span class="_ _7"> </span>the<span class="_ _a"> </span>left<span class="_ _7"> </span>(resp.</div><div class="t m0 x0 h7 y551 ff7 fs4 fc0 sc0 ls0 ws0">righ<span class="_ _4"></span>t),<span class="_ _5"> </span>all<span class="_ _a"> </span>in<span class="_ _4"></span>terv<span class="_ _9"></span>als<span class="_ _a"> </span>are<span class="_ _7"> </span>left<span class="_ _a"> </span>(resp.<span class="_ _5"> </span>right).</div><div class="t m1 x2 h7 y552 ff7 fs4 fc0 sc0 ls0 ws0">When<span class="_ _8"> </span>an<span class="_ _8"> </span>insertion<span class="_ _8"> </span>o<span class="_ _2"></span>ccurs<span class="_ _8"> </span>in<span class="_ _8"> </span>the<span class="_ _8"> </span>gap,<span class="_ _8"> </span>the<span class="_ _8"> </span>interv<span class="_ _6"></span>al<span class="_ _8"> </span>containing<span class="_ _8"> </span>the<span class="_ _8"> </span>inserted<span class="_ _8"> </span>elemen<span class="_ _9"></span>t<span class="_ _8"> </span>is</div><div class="t m18 x0 h7 y553 ff7 fs4 fc0 sc0 ls0 ws0">lo<span class="_ _2"></span>cated,<span class="_ _5"> </span>and<span class="_ _5"> </span>the<span class="_ _a"> </span>inserted<span class="_ _5"> </span>element<span class="_ _5"> </span>is<span class="_ _5"> </span>app<span class="_ _2"></span>ended<span class="_ _5"> </span>to<span class="_ _a"> </span>the<span class="_ _5"> </span>list<span class="_ _a"> </span>of<span class="_ _5"> </span>the<span class="_ _5"> </span>interv<span class="_ _9"></span>al.<span class="_ _3"> </span>This<span class="_ _5"> </span>increases</div><div class="t m0 xc9 h7 y553 ffa fs4 fc0 sc0 ls0 ws0">|<span class="ffb">∆</span></div><div class="t m0 x1c1 hd y554 ff13 fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x190 h7 y553 ffa fs4 fc0 sc0 ls0 ws0">|</div><div class="t m0 x0 h7 y555 ff7 fs4 fc0 sc0 ls0 ws0">b<span class="_ _4"></span>y<span class="_ _5"> </span>one,<span class="_ _a"> </span>but<span class="_ _5"> </span>do<span class="_ _2"></span>es<span class="_ _5"> </span>not<span class="_ _5"> </span>create<span class="_ _a"> </span>an<span class="_ _4"></span>y<span class="_ _5"> </span>new<span class="_ _a"> </span>in<span class="_ _4"></span>terv<span class="_ _9"></span>als,<span class="_ _5"> </span>so<span class="_ _a"> </span>(#In<span class="_ _4"></span>t)<span class="_ _5"> </span>remains<span class="_ _a"> </span>satisﬁed.</div><div class="t ma x2 h7 y556 ff7 fs4 fc0 sc0 ls0 ws0">When<span class="_ _7"> </span>a<span class="_ _7"> </span>deletion<span class="_ _7"> </span>o<span class="_ _2"></span>ccurs,</div><div class="t m0 x14b h7 y556 ffa fs4 fc0 sc0 ls0 ws0">|<span class="ffb">∆</span></div><div class="t m0 x19c hd y557 ff13 fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x14e h7 y556 ffa fs4 fc0 sc0 ls0 ws0">|</div><div class="t ma x158 h7 y556 ff7 fs4 fc0 sc0 ls0 ws0">decreases,<span class="_ _7"> </span>which<span class="_ _7"> </span>ma<span class="_ _9"></span>y<span class="_ _7"> </span>inv<span class="_ _9"></span>alidate<span class="_ _7"> </span>(#Int).<span class="_ _8"> </span>W<span class="_ _6"></span>e<span class="_ _7"> </span>therefore<span class="_ _7"> </span>need<span class="_ _7"> </span>a</div><div class="t ma x3 h7 y558 ff7 fs4 fc0 sc0 ls0 ws0">w<span class="_ _4"></span>ay<span class="_ _7"> </span>to<span class="_ _7"> </span>reduce<span class="_ _5"> </span>the<span class="_ _5"> </span>num<span class="_ _9"></span>b<span class="_ _2"></span>er<span class="_ _7"> </span>of<span class="_ _5"> </span>interv<span class="_ _6"></span>als,<span class="_ _5"> </span>which<span class="_ _7"> </span>we<span class="_ _7"> </span>do<span class="_ _7"> </span>by<span class="_ _7"> </span>simply<span class="_ _5"> </span><span class="ff8">mer<span class="_ _9"></span>ging<span class="_ _8"> </span><span class="ff7">t<span class="_ _4"></span>w<span class="_ _4"></span>o<span class="_ _7"> </span>adjacent<span class="_ _7"> </span>interv<span class="_ _6"></span>als.</span></span></div><div class="t m15 x0 h7 y559 ff7 fs4 fc0 sc0 ls0 ws0">Recall<span class="_ _5"> </span>that<span class="_ _a"> </span>elemen<span class="_ _4"></span>ts<span class="_ _5"> </span>within<span class="_ _a"> </span>in<span class="_ _4"></span>terv<span class="_ _9"></span>als<span class="_ _a"> </span>are<span class="_ _5"> </span>not<span class="_ _a"> </span>sorted,<span class="_ _5"> </span>so<span class="_ _a"> </span>merging<span class="_ _5"> </span>tw<span class="_ _9"></span>o<span class="_ _a"> </span>in<span class="_ _4"></span>terv<span class="_ _9"></span>als<span class="_ _a"> </span>eﬀectiv<span class="_ _4"></span>ely<span class="_ _5"> </span>just</div><div class="t m1 x0 h7 y55a ff7 fs4 fc0 sc0 ls0 ws0">means<span class="_ _a"> </span>“forgetting”<span class="_ _a"> </span>ab<span class="_ _2"></span>out<span class="_ _8"> </span>the<span class="_ _a"> </span>piv<span class="_ _4"></span>ot<span class="_ _a"> </span>element<span class="_ _a"> </span>curren<span class="_ _4"></span>tly<span class="_ _a"> </span>separating<span class="_ _8"> </span>them;<span class="_ _8"> </span>here,<span class="_ _a"> </span>we<span class="_ _a"> </span>need<span class="_ _a"> </span>to</div><div class="t m29 x0 h7 y55b ff7 fs4 fc0 sc0 ls0 ws0">concatenate<span class="_ _5"> </span>the<span class="_ _a"> </span>list<span class="_ _5"> </span>of<span class="_ _a"> </span>elemen<span class="_ _4"></span>ts.<span class="_ _3"> </span>The<span class="_ _5"> </span>rule<span class="_ _a"> </span>in<span class="_ _5"> </span>lazy<span class="_ _a"> </span>searc<span class="_ _4"></span>h<span class="_ _a"> </span>trees<span class="_ _5"> </span>is<span class="_ _5"> </span>as<span class="_ _a"> </span>follo<span class="_ _4"></span>ws,<span class="_ _a"> </span>using<span class="_ _5"> </span>the<span class="_ _a"> </span>outside</div><div class="t m0 x0 h7 y55c ff7 fs4 fc0 sc0 ls0 ws0">as<span class="_ _5"> </span>a<span class="_ _a"> </span>measure<span class="_ _7"> </span>for<span class="_ _a"> </span>ho<span class="_ _4"></span>w<span class="_ _5"> </span>close<span class="_ _a"> </span>to<span class="_ _5"> </span>the<span class="_ _5"> </span>middle<span class="_ _a"> </span>an<span class="_ _5"> </span>in<span class="_ _4"></span>terv<span class="_ _9"></span>al<span class="_ _a"> </span>is:</div><div class="t m0 x0 h7 y55d ff1 fs4 fc1 sc0 ls0 ws0">Merge<span class="_ _a"> </span>R<span class="_ _4"></span>ule<span class="_ _a"> </span>(M):<span class="_ _30"> </span><span class="ff7 fc0">If<span class="_ _a"> </span><span class="ffa">|<span class="ff9">I</span></span></span></div><div class="t m0 xeb hd y55e ff13 fs7 fc0 sc0 ls0 ws0">i,j</div><div class="t m0 x13f h7 y55d ffa fs4 fc0 sc0 ls0 ws0">|<span class="_ _1d"> </span><span class="ffb">+<span class="_ _d"> </span></span>|<span class="ff9">I</span></div><div class="t m0 x57 hd y55e ff13 fs7 fc0 sc0 ls0 ws0">i,j<span class="_ _2"></span><span class="ff11">+1</span></div><div class="t m0 x9d h7 y55d ffa fs4 fc0 sc0 ls0 ws0">|<span class="_ _7"> </span><span class="ff9">&lt;<span class="_ _d"> </span><span class="ff15">o<span class="ffb">(</span></span>I</span></div><div class="t m0 xf hd y55e ff13 fs7 fc0 sc0 ls0 ws0">i,j</div><div class="t m0 xf9 h7 y55d ffb fs4 fc0 sc0 ls0 ws0">)<span class="ff7">,<span class="_ _5"> </span>merge<span class="_ _a"> </span><span class="ff9">I</span></span></div><div class="t m0 x123 hd y55e ff13 fs7 fc0 sc0 ls0 ws0">i,j</div><div class="t m0 xfe h7 y55d ff7 fs4 fc0 sc0 ls0 ws0">and<span class="_ _5"> </span><span class="ff9">I</span></div><div class="t m0 x6e hd y55e ff13 fs7 fc0 sc0 ls0 ws0">i,j<span class="_ _2"></span><span class="ff11">+1</span></div><div class="t m0 x126 h7 y55d ff7 fs4 fc0 sc0 ls0 ws0">.</div><div class="t m18 x2 h7 y55f ff7 fs4 fc0 sc0 ls0 ws0">This<span class="_ _5"> </span>rule<span class="_ _a"> </span>only<span class="_ _5"> </span>applies<span class="_ _a"> </span>betw<span class="_ _9"></span>een<span class="_ _a"> </span>in<span class="_ _4"></span>terv<span class="_ _9"></span>als<span class="_ _a"> </span>of<span class="_ _5"> </span>the<span class="_ _5"> </span>same<span class="_ _a"> </span>t<span class="_ _4"></span>yp<span class="_ _2"></span>e;<span class="_ _5"> </span>a<span class="_ _a"> </span>left<span class="_ _5"> </span>interv<span class="_ _6"></span>al<span class="_ _a"> </span>is<span class="_ _5"> </span>never<span class="_ _7"> </span>merged</div><div class="t m0 x2 h7 y560 ff7 fs4 fc0 sc0 ls0 ws0">with<span class="_ _5"> </span>a<span class="_ _a"> </span>righ<span class="_ _9"></span>t<span class="_ _a"> </span>in<span class="_ _4"></span>terv<span class="_ _9"></span>al.</div><div class="t ma x2 h7 y561 ff7 fs4 fc0 sc0 ls0 ws0">That<span class="_ _5"> </span>is,<span class="_ _a"> </span>an<span class="_ _5"> </span>interv<span class="_ _6"></span>al</div><div class="t m0 x68 h7 y561 ff9 fs4 fc0 sc0 ls0 ws0">I</div><div class="t m0 x107 hd y562 ff13 fs7 fc0 sc0 ls0 ws0">i,j</div><div class="t ma x48 h7 y561 ff7 fs4 fc0 sc0 ls0 ws0">is<span class="_ _5"> </span>merged<span class="_ _a"> </span>with<span class="_ _5"> </span>its<span class="_ _5"> </span>inner<span class="_ _a"> </span>neigh<span class="_ _4"></span>b<span class="_ _2"></span>or,<span class="_ _5"> </span>if<span class="_ _5"> </span>they<span class="_ _a"> </span>com<span class="_ _4"></span>bined<span class="_ _5"> </span>contain<span class="_ _5"> </span>fewer</div><div class="t m1a x0 h7 y563 ff7 fs4 fc0 sc0 ls0 ws0">elemen<span class="_ _4"></span>ts<span class="_ _5"> </span>than<span class="_ _a"> </span>outside<span class="_ _7"> </span>of<span class="_ _5"> </span>the<span class="_ _a"> </span>in<span class="_ _4"></span>terv<span class="_ _9"></span>als;<span class="_ _5"> </span>they<span class="_ _a"> </span>are<span class="_ _7"> </span>therefore<span class="_ _5"> </span>intuitiv<span class="_ _4"></span>ely<span class="_ _5"> </span>“to<span class="_ _2"></span>o<span class="_ _5"> </span>small”<span class="_ _5"> </span>for<span class="_ _a"> </span>where</div><div class="t ma x0 h7 y564 ff7 fs4 fc0 sc0 ls0 ws0">they<span class="_ _5"> </span>reside<span class="_ _5"> </span>in<span class="_ _a"> </span>the<span class="_ _5"> </span>gap.<span class="_ _3"> </span>Note<span class="_ _5"> </span>that<span class="_ _a"> </span>w<span class="_ _9"></span>e<span class="_ _a"> </span>do<span class="_ _5"> </span><span class="ff8">not<span class="_ _8"> </span></span>treat<span class="_ _5"> </span>this<span class="_ _5"> </span>rule<span class="_ _a"> </span>as<span class="_ _5"> </span>an<span class="_ _5"> </span>inv<span class="_ _6"></span>ariant;<span class="_ _5"> </span>we<span class="_ _7"> </span>do<span class="_ _a"> </span>not<span class="_ _7"> </span>require</div><div class="t m16 x0 h7 y565 ff7 fs4 fc0 sc0 ls0 ws0">it<span class="_ _5"> </span>to<span class="_ _5"> </span>b<span class="_ _2"></span>e<span class="_ _5"> </span>true<span class="_ _a"> </span>at<span class="_ _5"> </span>all<span class="_ _5"> </span>times,<span class="_ _5"> </span>but<span class="_ _a"> </span>only<span class="_ _5"> </span>use<span class="_ _5"> </span>it<span class="_ _5"> </span>to<span class="_ _a"> </span>reduce<span class="_ _5"> </span>the<span class="_ _5"> </span>num<span class="_ _9"></span>b<span class="_ _2"></span>er<span class="_ _5"> </span>of<span class="_ _a"> </span>in<span class="_ _4"></span>terv<span class="_ _9"></span>als<span class="_ _5"> </span>when<span class="_ _a"> </span>explicitly</div><div class="t m0 x0 h7 y566 ff7 fs4 fc0 sc0 ls0 ws0">in<span class="_ _4"></span>vok<span class="_ _9"></span>ed<span class="_ _a"> </span>in<span class="_ _5"> </span>op<span class="_ _2"></span>eration<span class="_ _5"> </span><span class="ff1b">Inter<span class="_ _6"></span>v<span class="_ _6"></span>alsMerge<span class="ff7">.</span></span></div><div class="t m23 x2 h7 y567 ff7 fs4 fc0 sc0 ls0 ws0">Supp<span class="_ _2"></span>ose<span class="_ _5"> </span>that<span class="_ _5"> </span><span class="ff1b">Inter<span class="_ _6"></span>v<span class="_ _6"></span>alsMerge<span class="_ _5"> </span><span class="ff7">has<span class="_ _5"> </span>just<span class="_ _a"> </span>merged<span class="_ _5"> </span>all<span class="_ _5"> </span>interv<span class="_ _6"></span>al<span class="_ _a"> </span>pairs<span class="_ _5"> </span>that<span class="_ _5"> </span>satisfy<span class="_ _5"> </span>(M).<span class="_ _a"> </span>W<span class="_ _6"></span>e</span></span></div><div class="t m0 x0 h7 y568 ff7 fs4 fc0 sc0 ls0 ws0">then<span class="_ _5"> </span>obtain<span class="_ _a"> </span>bounds<span class="_ _5"> </span>on<span class="_ _a"> </span>the<span class="_ _5"> </span>num<span class="_ _9"></span>b<span class="_ _2"></span>er<span class="_ _5"> </span>of<span class="_ _a"> </span>in<span class="_ _4"></span>terv<span class="_ _9"></span>als<span class="_ _a"> </span>as<span class="_ _7"> </span>stated<span class="_ _a"> </span>in<span class="_ _5"> </span>the<span class="_ _5"> </span>following<span class="_ _5"> </span>tw<span class="_ _9"></span>o<span class="_ _a"> </span>lemmas.</div><div class="t m0 x0 h19 y29 ff22 fs4 fc1 sc0 ls0 ws0">▶</div><div class="t ma x13a h7 y29 ff1 fs4 fc0 sc0 ls0 ws0">Lemma<span class="_ _a"> </span>7<span class="_ _a"> </span><span class="ff23">(The<span class="_ _5"> </span>Merge<span class="_ _a"> </span>rule<span class="_ _7"> </span>on<span class="_ _a"> </span>one<span class="_ _5"> </span>side<span class="_ _5"> </span>yields<span class="_ _a"> </span>loga<span class="_ _9"></span>rithmic<span class="_ _a"> </span>internals)<span class="ff1">.<span class="_ _30"> </span><span class="ff8">L<span class="_ _9"></span>et<span class="_ _a"> </span>a<span class="_ _a"> </span>set<span class="_ _a"> </span>of</span></span></span></div><div class="t m0 xbe h7 y29 ff9 fs4 fc0 sc0 ls0 ws0">N</div><div class="t ma xaf h7 y29 ff8 fs4 fc0 sc0 ls0 ws0">elements</div><div class="t ma x0 h7 y2a ff8 fs4 fc0 sc0 ls0 ws0">p<span class="_ _9"></span>artitione<span class="_ _4"></span>d<span class="_ _7"> </span>in<span class="_ _7"> </span>intervals<span class="_ _5"> </span>that<span class="_ _7"> </span>satisfy<span class="_ _5"> </span>rule<span class="_ _7"> </span>(M).<span class="_ _5"> </span>L<span class="_ _9"></span>et<span class="_ _5"> </span>further</div><div class="t m0 x3e h7 y2a ff9 fs4 fc0 sc0 ls0 ws0">I</div><div class="t ma x13c h7 y2a ff8 fs4 fc0 sc0 ls0 ws0">b<span class="_ _9"></span>e<span class="_ _7"> </span>one<span class="_ _5"> </span>of<span class="_ _7"> </span>the<span class="_ _5"> </span>intervals<span class="_ _7"> </span>and</div><div class="t m0 x1ac h7 y2a ff9 fs4 fc0 sc0 ls0 ws0">k</div><div class="t ma x25 h7 y2a ffb fs4 fc0 sc0 ls0 ws0">= <span class="ff15">o</span></div><div class="t m0 x17f h7 y2a ffb fs4 fc0 sc0 ls0 ws0">(<span class="ff9">I<span class="_ _2"></span></span>)</div><div class="t m1 x3 h7 y2b ff8 fs4 fc0 sc0 ls0 ws0">b<span class="_ _9"></span>e<span class="_ _8"> </span>its<span class="_ _a"> </span>numb<span class="_ _9"></span>er<span class="_ _8"> </span>of<span class="_ _a"> </span>outside<span class="_ _8"> </span>elements. Then<span class="_ _8"> </span>ther<span class="_ _9"></span>e<span class="_ _8"> </span>ar<span class="_ _9"></span>e<span class="_ _8"> </span>at<span class="_ _a"> </span>most</div><div class="t m0 x125 h7 y2b ffb fs4 fc0 sc0 ls0 ws0">max<span class="ffa">{</span></div><div class="t m1 xa1 h7 y2b ffb fs4 fc0 sc0 ls0 ws0">1</div><div class="t m0 x11a h7 y2b ff9 fs4 fc0 sc0 ls0 ws0">,</div><div class="t m1 x149 h7 y2b ffb fs4 fc0 sc0 ls0 ws0">2</div><div class="t m0 x178 h7 y2b ffb fs4 fc0 sc0 ls0 ws0">log</div><div class="t m0 x146 hd yfa ff11 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x143 hd yf7 ff13 fs7 fc0 sc0 ls0 ws0">N</div><div class="t m0 xf0 hd yf8 ff13 fs7 fc0 sc0 ls0 ws0">k</div><div class="t m1 x18f h7 y2b ffb fs4 fc0 sc0 ls0 ws0">+<span class="_ _d"> </span>2</div><div class="t m0 x17d h7 y2b ffa fs4 fc0 sc0 ls0 ws0">}</div><div class="t m1 x7b h7 y2b ff8 fs4 fc0 sc0 ls0 ws0">intervals</div><div class="t m0 x3 h7 y2c ff8 fs4 fc0 sc0 ls0 ws0">inside<span class="_ _a"> </span>of<span class="_ _a"> </span><span class="ff9">I<span class="_ _8"> </span></span>and<span class="_ _a"> </span>on<span class="_ _a"> </span>the<span class="_ _a"> </span>same<span class="_ _a"> </span>side<span class="_ _a"> </span>as<span class="_ _a"> </span><span class="ff9">I<span class="_ _b"></span></span>.</div></div><div class="pi" data-data='{"ctm":[1.633987,0.000000,0.000000,1.633987,0.000000,0.000000]}'></div></div>
